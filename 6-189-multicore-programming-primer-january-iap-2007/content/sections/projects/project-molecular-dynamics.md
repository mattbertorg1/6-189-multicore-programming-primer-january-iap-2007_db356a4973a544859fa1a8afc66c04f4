---
about_this_resource_text: '<p><strong>Topics covered:</strong> Molecular dynamics</p><p><strong>Instructor/speaker:
  </strong>Greg Pintilie</p>'
course_id: 6-189-multicore-programming-primer-january-iap-2007
embedded_media:
- id: p7.jpg
  parent_uid: d6d23ff4e90b60cb2c11e23c582e7787
  technical_location: https://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-189-multicore-programming-primer-january-iap-2007/projects/project-molecular-dynamics/p7.jpg
  title: Molecular Dynamics
  type: null
  uid: e1bd296ac789f0f7b2aca4c38e5f712a
- id: Video-YouTube-Stream
  media_location: Nd2SBfrsaw4
  parent_uid: d6d23ff4e90b60cb2c11e23c582e7787
  title: Video-YouTube-Stream
  type: Video
  uid: 27283fb9e68401c5a7f05dd723c50f7f
- id: Thumbnail-YouTube-JPG
  media_location: https://img.youtube.com/vi/Nd2SBfrsaw4/default.jpg
  parent_uid: d6d23ff4e90b60cb2c11e23c582e7787
  title: Thumbnail-YouTube-JPG
  type: Thumbnail
  uid: 2c1f4f95c3c8a65fe8445c3bf0467649
- id: Video-iTunesU-MP4
  media_location: https://itunes.apple.com/us/itunes-u/id341597759
  parent_uid: d6d23ff4e90b60cb2c11e23c582e7787
  title: Video-iTunes U-MP4
  type: Video
  uid: eeea2a5c186c7507ad18fba8a0cc8729
- id: Video-InternetArchive-MP4
  media_location: http://www.archive.org/download/MIT6.189IAP07/ocw-6.189-iap07-pro07_300k.mp4
  parent_uid: d6d23ff4e90b60cb2c11e23c582e7787
  title: Video-Internet Archive-MP4
  type: Video
  uid: eabeea029e117ffd466a46777f1e5b0a
- id: Thumbnail-OCW-JPG
  parent_uid: d6d23ff4e90b60cb2c11e23c582e7787
  title: Thumbnail-OCW-JPG
  type: Thumbnail
  uid: 84b60fdc63745e91f8ebe3ea87217973
- id: 3Play-3PlayYouTubeid-MP4
  media_location: Nd2SBfrsaw4
  parent_uid: d6d23ff4e90b60cb2c11e23c582e7787
  title: 3Play-3Play YouTube id
  type: 3Play
  uid: 32859d086092ef586a992f70db162a43
- id: Nd2SBfrsaw4.srt
  parent_uid: d6d23ff4e90b60cb2c11e23c582e7787
  technical_location: https://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-189-multicore-programming-primer-january-iap-2007/projects/project-molecular-dynamics/Nd2SBfrsaw4.srt
  title: 3play caption file
  type: null
  uid: 28663c61c72012dce320ff62b8f395f1
- id: Nd2SBfrsaw4.pdf
  parent_uid: d6d23ff4e90b60cb2c11e23c582e7787
  technical_location: https://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-189-multicore-programming-primer-january-iap-2007/projects/project-molecular-dynamics/Nd2SBfrsaw4.pdf
  title: 3play pdf file
  type: null
  uid: 6159069faf7ea250d5f19b9b78a27d94
- id: Caption-3Play YouTube id-SRT
  parent_uid: d6d23ff4e90b60cb2c11e23c582e7787
  title: Caption-3Play YouTube id-SRT-English - US
  type: Caption
  uid: 40fe2937af37352086b4a88e3b78eac5
- id: Transcript-3Play YouTube id-PDF
  parent_uid: d6d23ff4e90b60cb2c11e23c582e7787
  title: Transcript-3Play YouTube id-PDF-English - US
  type: Transcript
  uid: 53175198fbe7d100adc3f236c97e195c
inline_embed_id: 72650723project:moleculardynamics33909015
layout: video
order_index: null
parent_uid: b639672ad9ad956df1d830e6183298ae
related_resources_text: <p>(<a href="./resolveuid/f2adbe780fdedb81d13d1904e3e3d6f3"
  target="_blank" title="Open in a new window.">PDF</a>)</p>
short_url: project-molecular-dynamics
technical_location: https://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-189-multicore-programming-primer-january-iap-2007/projects/project-molecular-dynamics
template_type: Tabbed
title: 'Project: Molecular Dynamics '
transcript: '<p><span m=''60''>The</span> <span m=''180''>following</span> <span m=''620''>content</span>
  <span m=''1210''>is</span> <span m=''1330''>provided</span> <span m=''1770''>under</span>
  <span m=''2050''>a</span> <span m=''2090''>Creative</span> <span m=''2500''>Commons</span>
  <span m=''2900''>license.</span> <span m=''4010''>Your</span> <span m=''4200''>support</span>
  <span m=''4710''>will</span> <span m=''4860''>help</span> <span m=''5100''>MIT</span>
  <span m=''5560''>OpenCourseWare</span> <span m=''6350''>continue</span> <span m=''6860''>to</span>
  <span m=''6940''>offer</span> <span m=''7350''>high</span> <span m=''7590''>quality</span>
  <span m=''8109''>educational</span> <span m=''8740''>resources</span> <span m=''9360''>for</span>
  <span m=''9510''>free.</span> <span m=''10720''>To</span> <span m=''10820''>make</span>
  <span m=''10930''>a</span> <span m=''10980''>donation</span> <span m=''11660''>or</span>
  <span m=''11930''>view</span> <span m=''12370''>additional</span> <span m=''12790''>materials</span>
  <span m=''13330''>from</span> <span m=''13480''>hundreds</span> <span m=''13920''>of</span>
  <span m=''14020''>MIT</span> <span m=''14450''>courses,</span> <span m=''15550''>visit</span>
  <span m=''15780''>MIT</span> <span m=''16200''>OpenCourseWare</span> <span m=''17250''>at</span>
  <span m=''17410''>ocw.mit.edu.</span> </p><p><span m=''26550''>PROFESSOR: Greg</span>
  <span m=''26780''>was</span> <span m=''26940''>not</span> <span m=''27100''>here</span>
  <span m=''27280''>yesterday.</span> <span m=''28270''>He</span> <span m=''28390''>was</span>
  <span m=''28510''>away.</span> <span m=''29220''>And</span> <span m=''29400''>so</span>
  <span m=''29580''>this</span> <span m=''29760''>is</span> <span m=''29890''>work</span>
  <span m=''30110''>he''s</span> <span m=''30430''>largely</span> <span m=''30720''>done</span>
  <span m=''30900''>on</span> <span m=''31010''>his</span> <span m=''31150''>own</span>
  <span m=''31320''>again.</span> <span m=''32470''>He''s</span> <span m=''32710''>done</span>
  <span m=''32860''>a</span> <span m=''32900''>molecular</span> <span m=''33520''>dynamics</span>
  <span m=''33900''>simulator.</span> <span m=''34760''>So he''s</span> <span m=''34950''>going</span>
  <span m=''35060''>to</span> <span m=''35130''>tell</span> <span m=''35280''>us</span>
  <span m=''35410''>a</span> <span m=''35460''>little</span> <span m=''35560''>bit</span>
  <span m=''35660''>about</span> <span m=''35880''>that,</span> <span m=''36380''>and</span>
  <span m=''36510''>then</span> <span m=''36770''>after</span> <span m=''36970''>that</span>
  <span m=''37140''>we''ll</span> <span m=''37280''>do</span> <span m=''37950''>course</span>
  <span m=''38170''>evaluations,</span> <span m=''39770''>hand</span> <span m=''39950''>out</span>
  <span m=''40080''>some</span> <span m=''40220''>awards,</span> <span m=''40690''>have</span>
  <span m=''40860''>some</span> <span m=''41010''>cake,</span> <span m=''41780''>and</span>
  <span m=''41890''>then after</span> <span m=''42040''>that</span> <span m=''42530''>some</span>
  <span m=''42700''>pizza,</span> <span m=''43300''>and</span> <span m=''43430''>then</span>
  <span m=''43600''>play</span> <span m=''43830''>same</span> <span m=''43930''>PlayStation</span>
  <span m=''44390''>3s.</span> <span m=''45885''>All</span> <span m=''46290''>yours.</span>
  </p><p><span m=''48830''>GREG PINTILIE: OK,</span> <span m=''49110''>so</span> <span
  m=''49320''>I''ll</span> <span m=''49500''>talk</span> <span m=''49740''>about</span>
  <span m=''50030''>the</span> <span m=''50230''>make</span> <span m=''50790''>general</span>
  <span m=''51110''>molecular</span> <span m=''51470''>dynamics</span> <span m=''52320''>algorithm</span>
  <span m=''53080''>and</span> <span m=''53490''>then</span> <span m=''53990''>parallelization</span>
  <span m=''54610''>approaches.</span> <span m=''56930''>So</span> <span m=''57160''>molecular</span>
  <span m=''57510''>dynamics</span> <span m=''57890''>is</span> <span m=''58010''>based</span>
  <span m=''58330''>on</span> <span m=''58480''>a</span> <span m=''58620''>potential</span>
  <span m=''59080''>energy</span> <span m=''59390''>function,</span> <span m=''59980''>which</span>
  <span m=''60270''>includes</span> <span m=''60590''>two</span> <span m=''60750''>terms,</span>
  <span m=''61800''>bonded</span> <span m=''62490''>terms</span> <span m=''62910''>and</span>
  <span m=''62970''>non-bonded</span> <span m=''63540''>terms.</span> <span m=''64519''>And</span>
  <span m=''64840''>bonded</span> <span m=''65120''>terms</span> <span m=''65470''>are</span>
  <span m=''65630''>split</span> <span m=''65960''>up</span> <span m=''66140''>into</span>
  <span m=''67390''>three</span> <span m=''67890''>sub</span> <span m=''68170''>terms.</span>
  <span m=''72040''>So</span> <span m=''72220''>don''t</span> <span m=''72400''>confuse</span>
  <span m=''72780''>bonded</span> <span m=''73150''>with--</span> <span m=''73340''>actually,</span>
  <span m=''75270''>don''t</span> <span m=''75450''>think</span> <span m=''75560''>that
  these</span> <span m=''75780''>are</span> <span m=''75860''>non-bonded.</span> <span
  m=''76450''>These</span> <span m=''76620''>are</span> <span m=''76700''>actually</span>
  <span m=''76970''>all</span> <span m=''77300''>sort</span> <span m=''77490''>of</span>
  <span m=''77760''>grouped</span> <span m=''78130''>as</span> <span m=''78360''>bonded.</span>
  </p><p><span m=''78650''>I know</span> <span m=''78940''>it''s</span> <span m=''79090''>a</span>
  <span m=''79130''>little</span> <span m=''79230''>bit</span> <span m=''79360''>confusing,</span>
  <span m=''79810''>but</span> <span m=''80790''>right</span> <span m=''80960''>now</span>
  <span m=''81130''>I''m</span> <span m=''81250''>dealing</span> <span m=''81490''>just</span>
  <span m=''81720''>with</span> <span m=''81830''>the</span> <span m=''82050''>sort</span>
  <span m=''82240''>of</span> <span m=''82320''>bonded</span> <span m=''82680''>terms.</span>
  <span m=''82970''>And</span> <span m=''83170''>what</span> <span m=''83390''>that</span>
  <span m=''83560''>means</span> <span m=''83810''>is</span> <span m=''83910''>that</span>
  <span m=''84540''>it</span> <span m=''84680''>deals</span> <span m=''84930''>with</span>
  <span m=''85100''>atoms</span> <span m=''85380''>that are</span> <span m=''85510''>connected</span>
  <span m=''85910''>together</span> <span m=''86320''>covalently.</span> <span m=''87410''>So</span>
  <span m=''87570''>for</span> <span m=''87690''>example,</span> <span m=''88130''>the</span>
  <span m=''88530''>bonds</span> <span m=''89060''>term</span> <span m=''90200''>reflects</span>
  <span m=''91190''>some</span> <span m=''91500''>energy</span> <span m=''92610''>due</span>
  <span m=''92810''>to</span> <span m=''92970''>a</span> <span m=''93020''>displacement</span>
  <span m=''94770''>between</span> <span m=''95180''>two</span> <span m=''95360''>atoms,</span>
  <span m=''95830''>which</span> <span m=''97190''>are</span> <span m=''97380''>certain</span>
  <span m=''97590''>distance</span> <span m=''97880''>apart.</span> <span m=''98570''>There</span>
  <span m=''98850''>is</span> <span m=''98960''>an</span> <span m=''99100''>equilibrium</span>
  <span m=''99610''>distance</span> <span m=''100100''>that</span> <span m=''100260''>they</span>
  <span m=''100350''>like</span> <span m=''100550''>to</span> <span m=''100670''>stay</span>
  <span m=''101370''>at,</span> <span m=''101930''>and</span> <span m=''102200''>if</span>
  <span m=''102330''>they</span> <span m=''102500''>vary</span> <span m=''102890''>from</span>
  <span m=''103120''>that</span> <span m=''103360''>distance</span> <span m=''105280''>the</span>
  <span m=''105480''>potential</span> <span m=''106130''>increases</span> <span m=''107300''>as</span>
  <span m=''107680''>a</span> <span m=''107740''>squared</span> <span m=''108610''>of</span>
  <span m=''108820''>that</span> <span m=''109200''>separation</span> <span m=''109760''>distance.</span>
  </p><p><span m=''111770''>The</span> <span m=''112020''>angles</span> <span m=''112820''>term</span>
  <span m=''113750''>represents,</span> <span m=''115330''>basically,</span> <span
  m=''117890''>the</span> <span m=''118090''>deviation</span> <span m=''118580''>from</span>
  <span m=''118830''>an</span> <span m=''118940''>equilibrium</span> <span m=''119610''>angle</span>
  <span m=''119950''>between</span> <span m=''120260''>three</span> <span m=''120530''>atoms.</span>
  <span m=''121350''>So</span> <span m=''121390''>if</span> <span m=''121490''>you</span>
  <span m=''121550''>imagine</span> <span m=''121870''>these</span> <span m=''122150''>three</span>
  <span m=''122410''>nodes</span> <span m=''122710''>as</span> <span m=''122920''>three</span>
  <span m=''123230''>atoms,</span> <span m=''124360''>if</span> <span m=''124600''>this</span>
  <span m=''124830''>angle</span> <span m=''125120''>varies</span> <span m=''125620''>away</span>
  <span m=''125860''>from</span> <span m=''126090''>a</span> <span m=''126150''>certain</span>
  <span m=''126430''>equilibrium</span> <span m=''127560''>theta</span> <span m=''128030''>or</span>
  <span m=''128169''>angle,</span> <span m=''128979''>then</span> <span m=''130123''>the</span>
  <span m=''130460''>potential</span> <span m=''130910''>energy</span> <span m=''131260''>is</span>
  <span m=''131390''>also</span> <span m=''132225''>a</span> <span m=''132480''>quadratic</span>
  <span m=''133110''>term,</span> <span m=''134150''>which</span> <span m=''135800''>tends</span>
  <span m=''136120''>to</span> <span m=''136590''>bring</span> <span m=''137926''>the</span>
  <span m=''138310''>three</span> <span m=''138540''>atoms</span> <span m=''138900''>to</span>
  <span m=''139040''>have</span> <span m=''139300''>a</span> <span m=''139360''>certain</span>
  <span m=''139640''>equilibrium</span> <span m=''140110''>angle.</span> </p><p><span
  m=''142010''>And</span> <span m=''142200''>then,</span> <span m=''142720''>finally,</span>
  <span m=''143140''>the</span> <span m=''143310''>dihedral</span> <span m=''143890''>and</span>
  <span m=''144360''>improper</span> <span m=''144960''>term</span> <span m=''145350''>is</span>
  <span m=''145850''>probably</span> <span m=''145990''>one</span> <span m=''146110''>of</span>
  <span m=''146150''>the</span> <span m=''146220''>more</span> <span m=''146370''>complicated</span>
  <span m=''146930''>ones.</span> <span m=''147260''>The</span> <span m=''147460''>improper</span>
  <span m=''147820''>term</span> <span m=''148510''>basically</span> <span m=''150070''>deals</span>
  <span m=''150380''>with</span> <span m=''151190''>four</span> <span m=''151510''>atoms.</span>
  <span m=''151990''>So</span> <span m=''152090''>if</span> <span m=''152100''>you</span>
  <span m=''152180''>imagine</span> <span m=''152630''>this</span> <span m=''152850''>is</span>
  <span m=''152950''>one,</span> <span m=''153320''>two,</span> <span m=''153810''>three,</span>
  <span m=''154260''>and</span> <span m=''154310''>four.</span> <span m=''156080''>These</span>
  <span m=''156330''>three</span> <span m=''156490''>atoms,</span> <span m=''156850''>if</span>
  <span m=''156980''>you</span> <span m=''157090''>put</span> <span m=''157890''>two</span>
  <span m=''158060''>planes</span> <span m=''158370''>through</span> <span m=''158490''>them,</span>
  <span m=''159090''>the</span> <span m=''159260''>angle</span> <span m=''159790''>that</span>
  <span m=''160150''>those</span> <span m=''160350''>two</span> <span m=''160440''>planes</span>
  <span m=''160740''>make</span> <span m=''160940''>to</span> <span m=''161040''>each</span>
  <span m=''161210''>other</span> <span m=''163230''>is</span> <span m=''163910''>given</span>
  <span m=''164220''>a</span> <span m=''164290''>certain</span> <span m=''164590''>equilibrium</span>
  <span m=''165450''>angle</span> <span m=''165920''>again.</span> </p><p><span m=''166360''>And</span>
  <span m=''169180''>this</span> <span m=''169670''>should</span> <span m=''169780''>also</span>
  <span m=''169990''>be</span> <span m=''170140''>a</span> <span m=''170200''>quadratic</span>
  <span m=''170670''>term,</span> <span m=''170930''>but</span> <span m=''171060''>the</span>
  <span m=''171140''>energy</span> <span m=''171440''>also</span> <span m=''171700''>varies</span>
  <span m=''172000''>quadratically</span> <span m=''172650''>as</span> <span m=''173100''>that</span>
  <span m=''173340''>angle</span> <span m=''173750''>is</span> <span m=''174550''>deviated</span>
  <span m=''175070''>from.</span> <span m=''175760''>An</span> <span m=''176620''>actual</span>
  <span m=''177060''>dihedral</span> <span m=''178070''>is</span> <span m=''178390''>the</span>
  <span m=''178490''>rotation</span> <span m=''179670''>along</span> <span m=''180890''>a</span>
  <span m=''181000''>bond</span> <span m=''181460''>between</span> <span m=''181790''>the</span>
  <span m=''181900''>two</span> <span m=''182000''>central</span> <span m=''182470''>atoms.</span>
  <span m=''183330''>And</span> <span m=''184270''>this</span> <span m=''184730''>energy</span>
  <span m=''185230''>term</span> <span m=''185550''>has</span> <span m=''185870''>actually</span>
  <span m=''186410''>a</span> <span m=''186620''>cosine</span> <span m=''187130''>form.</span>
  <span m=''191680''>So</span> <span m=''191950''>as</span> <span m=''192250''>you</span>
  <span m=''192390''>rotate</span> <span m=''192740''>it</span> <span m=''192940''>along</span>
  <span m=''193340''>this</span> <span m=''193610''>bond,</span> <span m=''194070''>say</span>
  <span m=''194250''>for</span> <span m=''194410''>example,</span> <span m=''196040''>the</span>
  <span m=''196350''>energy</span> <span m=''196720''>will</span> <span m=''196910''>very</span>
  <span m=''197970''>sinusoidally.</span> <span m=''199990''>And</span> <span m=''200250''>there</span>
  <span m=''200410''>will be</span> <span m=''200790''>a</span> <span m=''200830''>restoring</span>
  <span m=''201240''>potential</span> <span m=''201800''>that</span> <span m=''202000''>will</span>
  <span m=''202160''>tend</span> <span m=''202380''>to</span> <span m=''202470''>make</span>
  <span m=''202730''>it</span> <span m=''203300''>either</span> <span m=''203840''>a
  line,</span> <span m=''204830''>or</span> <span m=''205410''>sometimes</span> <span
  m=''205770''>it</span> <span m=''206130''>will</span> <span m=''206410''>make</span>
  <span m=''206730''>the</span> <span m=''207090''>atom</span> <span m=''207390''>stagger.</span>
  </p><p><span m=''208320''>So</span> <span m=''209540''>all</span> <span m=''209700''>of</span>
  <span m=''209790''>these</span> <span m=''209960''>parameters</span> <span m=''210540''>are</span>
  <span m=''210660''>very</span> <span m=''211060''>sort</span> <span m=''211230''>of</span>
  <span m=''211300''>molecule</span> <span m=''211565''>and</span> <span m=''211900''>atom</span>
  <span m=''212090''>dependent.</span> <span m=''212750''>And</span> <span m=''213380''>all</span>
  <span m=''213500''>of</span> <span m=''213580''>these</span> <span m=''213750''>parameters</span>
  <span m=''214190''>are</span> <span m=''214300''>available,</span> <span m=''215350''>or</span>
  <span m=''215480''>have</span> <span m=''215650''>been</span> <span m=''215870''>built</span>
  <span m=''216380''>over</span> <span m=''216930''>many</span> <span m=''217190''>years</span>
  <span m=''218630''>by</span> <span m=''219670''>different</span> <span m=''219990''>methods</span>
  <span m=''220450''>like</span> <span m=''220630''>ab</span> <span m=''220790''>initio</span>
  <span m=''221110''>calculations</span> <span m=''221730''>or</span> <span m=''221810''>experimental</span>
  <span m=''222810''>calculations.</span> <span m=''223870''>But</span> <span m=''224030''>basically,</span>
  <span m=''224340''>if</span> <span m=''224430''>you</span> <span m=''224540''>plug</span>
  <span m=''224820''>those</span> <span m=''225040''>parameters</span> <span m=''225640''>in,</span>
  <span m=''225860''>for</span> <span m=''225980''>example,</span> <span m=''226380''>here</span>
  <span m=''226770''>k</span> <span m=''227040''>represents</span> <span m=''230222''>the</span>
  <span m=''230640''>spring</span> <span m=''231090''>constant,</span> <span m=''231550''>right?</span>
  <span m=''231730''>Because</span> <span m=''231930''>they''re</span> <span m=''232000''>basically</span>
  <span m=''232240''>just</span> <span m=''232420''>like</span> <span m=''232580''>spring</span>
  <span m=''232870''>constraints</span> <span m=''233370''>more</span> <span m=''233550''>or</span>
  <span m=''233580''>less.</span> <span m=''234250''>Or</span> <span m=''234400''>in</span>
  <span m=''234470''>this</span> <span m=''234660''>case,</span> <span m=''234940''>it</span>
  <span m=''234990''>will</span> <span m=''235140''>tell</span> <span m=''235320''>you</span>
  <span m=''235420''>how</span> <span m=''235550''>far</span> <span m=''235840''>up</span>
  <span m=''236020''>the</span> <span m=''236140''>potential,</span> <span m=''236860''>like</span>
  <span m=''237120''>what</span> <span m=''237310''>this</span> <span m=''237480''>value</span>
  <span m=''237800''>will</span> <span m=''237920''>be</span> <span m=''238090''>at</span>
  <span m=''238170''>the</span> <span m=''238310''>maximum,</span> <span m=''240820''>and</span>
  <span m=''241170''>will,</span> <span m=''241730''>for</span> <span m=''241880''>example,</span>
  <span m=''242290''>in</span> <span m=''242390''>this</span> <span m=''242400''>case,</span>
  <span m=''242570''>will</span> <span m=''242670''>specify</span> <span m=''245030''>how
  many</span> <span m=''245650''>fluctuations</span> <span m=''246230''>you</span>
  <span m=''246310''>have</span> <span m=''246540''>in</span> <span m=''246610''>the</span>
  <span m=''246720''>energy</span> <span m=''247000''>function.</span> </p><p><span
  m=''248400''>And</span> <span m=''249090''>the</span> <span m=''249280''>other</span>
  <span m=''249420''>parameters</span> <span m=''249880''>are</span> <span m=''249940''>usually</span>
  <span m=''250340''>the</span> <span m=''250660''>theta,</span> <span m=''251030''>the</span>
  <span m=''251400''>equilibrium</span> <span m=''251990''>theta,</span> <span m=''252460''>or</span>
  <span m=''252590''>the</span> <span m=''252710''>equilibrium,</span> <span m=''254116''>or</span>
  <span m=''254460''>the</span> <span m=''254550''>equilibrium</span> <span m=''255090''>bond</span>
  <span m=''255370''>length.</span> <span m=''257170''>So</span> <span m=''257300''>this</span>
  <span m=''257430''>is</span> <span m=''257560''>kind</span> <span m=''257690''>of</span>
  <span m=''258240''>what</span> <span m=''258459''>you</span> <span m=''258540''>can</span>
  <span m=''258670''>expect</span> <span m=''259279''>for</span> <span m=''259459''>it</span>
  <span m=''259560''>to</span> <span m=''259660''>look</span> <span m=''259870''>like</span>
  <span m=''261870''>as</span> <span m=''262040''>molecules</span> <span m=''262910''>will</span>
  <span m=''263220''>tend</span> <span m=''263440''>to</span> <span m=''264810''>move.</span>
  <span m=''267120''>The</span> <span m=''267200''>non</span> <span m=''267420''>bonded</span>
  <span m=''267780''>terms</span> <span m=''268260''>include</span> <span m=''268630''>van-der-Waals</span>
  <span m=''269770''>terms</span> <span m=''270240''>and</span> <span m=''270380''>electrostatic</span>
  <span m=''270980''>terms.</span> <span m=''271810''>So</span> <span m=''272090''>van-der-Waals</span>
  <span m=''272650''>forces</span> <span m=''273160''>occur</span> <span m=''273470''>between</span>
  <span m=''273880''>any</span> <span m=''274150''>two</span> <span m=''274310''>atoms,</span>
  <span m=''275450''>and</span> <span m=''276540''>if they''re</span> <span m=''277400''>far</span>
  <span m=''277600''>enough</span> <span m=''277770''>apart,</span> <span m=''279490''>they</span>
  <span m=''279560''>will</span> <span m=''279730''>attract</span> <span m=''280160''>to</span>
  <span m=''280260''>each</span> <span m=''280470''>other</span> <span m=''281780''>according</span>
  <span m=''282110''>to</span> <span m=''282210''>this</span> <span m=''282420''>formula.</span>
  <span m=''283220''>And</span> <span m=''283300''>if</span> <span m=''283390''>they''re</span>
  <span m=''283530''>too</span> <span m=''283680''>close</span> <span m=''283950''>together,</span>
  <span m=''285040''>so</span> <span m=''285290''>at</span> <span m=''285670''>equilibrium</span>
  <span m=''286460''>distance</span> <span m=''286980''>between</span> <span m=''287370''>them</span>
  <span m=''287610''>the</span> <span m=''287730''>energy</span> <span m=''288080''>is</span>
  <span m=''288190''>a</span> <span m=''288240''>minimum,</span> <span m=''289150''>but</span>
  <span m=''289870''>as</span> <span m=''290370''>they</span> <span m=''290480''>get</span>
  <span m=''290740''>any</span> <span m=''290970''>closer</span> <span m=''291780''>there</span>
  <span m=''291990''>will</span> <span m=''292110''>be</span> <span m=''292280''>a</span>
  <span m=''292330''>very</span> <span m=''292570''>strong</span> <span m=''292850''>group</span>
  <span m=''293060''>repulsive</span> <span m=''293360''>force,</span> <span m=''294410''>which</span>
  <span m=''294670''>is</span> <span m=''295070''>the</span> <span m=''295210''>r</span>
  <span m=''295350''>to</span> <span m=''295440''>the</span> <span m=''295580''>12th</span>
  <span m=''295930''>term.</span> <span m=''296600''>And</span> <span m=''297050''>as</span>
  <span m=''297160''>they</span> <span m=''297260''>get</span> <span m=''297490''>further</span>
  <span m=''297860''>apart,</span> <span m=''298350''>there</span> <span m=''298590''>is</span>
  <span m=''299530''>an</span> <span m=''299650''>attraction</span> <span m=''300880''>force,</span>
  <span m=''301290''>which</span> <span m=''301690''>varies</span> <span m=''302030''>as</span>
  <span m=''302580''>r</span> <span m=''302770''>to</span> <span m=''302870''>the</span>
  <span m=''302980''>sixth.</span> </p><p><span m=''306870''>And</span> <span m=''307090''>then</span>
  <span m=''307230''>the</span> <span m=''307330''>electrostatic</span> <span m=''308620''>force</span>
  <span m=''310120''>is just</span> <span m=''310450''>a</span> <span m=''311390''>simple</span>
  <span m=''311760''>Coulombic</span> <span m=''312300''>form.</span> <span m=''312630''>So</span>
  <span m=''312840''>you</span> <span m=''312930''>basically</span> <span m=''313270''>take</span>
  <span m=''313820''>two</span> <span m=''314140''>atoms</span> <span m=''314440''>that</span>
  <span m=''314550''>are,</span> <span m=''315120''>say</span> <span m=''315340''>oppositely</span>
  <span m=''315900''>charged,</span> <span m=''317000''>will</span> <span m=''317210''>attract</span>
  <span m=''317590''>each</span> <span m=''317750''>other.</span> <span m=''318050''>If</span>
  <span m=''318240''>they''re</span> <span m=''318360''>positively</span> <span m=''318840''>charged</span>
  <span m=''319140''>they</span> <span m=''319230''>will</span> <span m=''319370''>repel</span>
  <span m=''319690''>each</span> <span m=''319860''>other.</span> <span m=''320480''>And</span>
  <span m=''320760''>it''s</span> <span m=''320870''>just</span> <span m=''321840''>a</span>
  <span m=''322260''>matter</span> <span m=''322670''>of</span> <span m=''323180''>multiplying</span>
  <span m=''323730''>the</span> <span m=''323820''>charges,</span> <span m=''324320''>and</span>
  <span m=''324460''>then</span> <span m=''324600''>dividing</span> <span m=''325060''>by</span>
  <span m=''325280''>r</span> <span m=''325480''>to</span> <span m=''325600''>get</span>
  <span m=''325790''>the</span> <span m=''325860''>energy.</span> <span m=''329160''>OK,</span>
  <span m=''329410''>so</span> <span m=''329620''>to</span> <span m=''329750''>do</span>
  <span m=''329860''>molecular</span> <span m=''330260''>dynamics,</span> <span m=''330780''>basically,</span>
  <span m=''331520''>you</span> <span m=''331630''>have</span> <span m=''331760''>to</span>
  <span m=''331870''>take</span> <span m=''332090''>derivatives</span> <span m=''332640''>of</span>
  <span m=''332780''>all</span> <span m=''332940''>those</span> <span m=''334150''>formulas.</span>
  <span m=''334850''>I</span> <span m=''334950''>just</span> <span m=''335000''>showed</span>
  <span m=''335250''>you.</span> <span m=''335970''>And</span> <span m=''336190''>I</span>
  <span m=''336250''>didn''t</span> <span m=''336980''>do</span> <span m=''337100''>that</span>
  <span m=''337370''>all</span> <span m=''337540''>myself.</span> <span m=''337990''>It
  was</span> <span m=''338160''>pretty</span> <span m=''338360''>hard.</span> </p><p><span
  m=''338510''>I</span> <span m=''338580''>just</span> <span m=''339380''>got</span>
  <span m=''339580''>some</span> <span m=''339740''>code</span> <span m=''340050''>from</span>
  <span m=''340500''>some</span> <span m=''340950''>current</span> <span m=''341290''>existing</span>
  <span m=''342940''>molecular</span> <span m=''343310''>dynamic</span> <span m=''343730''>simulators.</span>
  <span m=''344420''>But</span> <span m=''344730''>basically,</span> <span m=''345055''>you</span>
  <span m=''345380''>take</span> <span m=''345540''>the</span> <span m=''345620''>derivative.</span>
  <span m=''346230''>And</span> <span m=''346290''>that</span> <span m=''346790''>basically</span>
  <span m=''347280''>equates</span> <span m=''347590''>to</span> <span m=''347670''>the</span>
  <span m=''347790''>force,</span> <span m=''348220''>right?</span> <span m=''348390''>The</span>
  <span m=''348500''>typical</span> <span m=''348990''>Newton</span> <span m=''349340''>Newtonian</span>
  <span m=''349830''>model.</span> <span m=''351150''>And</span> <span m=''352340''>that</span>
  <span m=''352560''>gives</span> <span m=''352680''>you</span> <span m=''352770''>the</span>
  <span m=''352890''>force</span> <span m=''353180''>in</span> <span m=''353270''>every</span>
  <span m=''353490''>atom,</span> <span m=''353980''>and</span> <span m=''354170''>then</span>
  <span m=''354360''>using</span> <span m=''354610''>that</span> <span m=''354840''>force</span>
  <span m=''356750''>and</span> <span m=''356900''>integration</span> <span m=''357440''>scheme,</span>
  <span m=''358590''>the</span> <span m=''358660''>leapfrog</span> <span m=''359090''>Verlet</span>
  <span m=''359800''>integration</span> <span m=''360360''>scheme</span> <span m=''360720''>just</span>
  <span m=''360970''>gives</span> <span m=''361130''>you</span> <span m=''361270''>the</span>
  <span m=''362190''>velocity</span> <span m=''363550''>at</span> <span m=''363750''>the</span>
  <span m=''363980''>next</span> <span m=''364290''>half</span> <span m=''364510''>time</span>
  <span m=''364750''>step.</span> <span m=''365420''>And</span> <span m=''365560''>then</span>
  <span m=''365670''>using</span> <span m=''365920''>that</span> <span m=''366200''>velocity</span>
  <span m=''366700''>at</span> <span m=''366780''>the</span> <span m=''366860''>half</span>
  <span m=''367100''>time</span> <span m=''367450''>step,</span> <span m=''368860''>the</span>
  <span m=''369030''>positions</span> <span m=''369650''>of</span> <span m=''370230''>each</span>
  <span m=''370410''>atom</span> <span m=''370680''>is</span> <span m=''370810''>updated</span>
  <span m=''373830''>based</span> <span m=''374170''>on</span> <span m=''374230''>the</span>
  <span m=''374320''>positions</span> <span m=''374740''>at</span> <span m=''374840''>the</span>
  <span m=''374920''>previous</span> <span m=''375230''>time</span> <span m=''375420''>step,</span>
  <span m=''376910''>and</span> <span m=''377010''>then</span> <span m=''377220''>some</span>
  <span m=''377420''>value.</span> </p><p><span m=''378570''>So I will</span> <span
  m=''379250''>show</span> <span m=''379470''>you</span> <span m=''379710''>a</span>
  <span m=''379780''>little</span> <span m=''380000''>bit</span> <span m=''380150''>of</span>
  <span m=''380350''>what</span> <span m=''380570''>it</span> <span m=''380690''>looks</span>
  <span m=''380960''>like</span> <span m=''382010''>on</span> <span m=''382160''>a</span>
  <span m=''382510''>simple</span> <span m=''382880''>molecule</span> <span m=''383400''>first.</span>
  <span m=''387770''>So</span> <span m=''387930''>here''s</span> <span m=''388260''>a</span>
  <span m=''388400''>sort</span> <span m=''388560''>of</span> <span m=''388630''>simple</span>
  <span m=''388910''>molecule,</span> <span m=''389400''>and it</span> <span m=''389500''>has</span>
  <span m=''389750''>just</span> <span m=''389950''>an initial</span> <span m=''390900''>configuration</span>
  <span m=''391550''>that</span> <span m=''391700''>is</span> <span m=''394250''>just</span>
  <span m=''394720''>sort</span> <span m=''394880''>of</span> <span m=''395040''>random.</span>
  <span m=''398990''>And</span> <span m=''401790''>so</span> <span m=''402060''>one</span>
  <span m=''402330''>technique</span> <span m=''402600''>that</span> <span m=''402730''>is</span>
  <span m=''402870''>done</span> <span m=''403070''>is</span> <span m=''403260''>first</span>
  <span m=''403540''>the</span> <span m=''404070''>geometry</span> <span m=''404375''>is</span>
  <span m=''404680''>minimized,</span> <span m=''405190''>which</span> <span m=''405360''>means</span>
  <span m=''405520''>that</span> <span m=''405690''>you</span> <span m=''405740''>just</span>
  <span m=''406300''>take</span> <span m=''406500''>small</span> <span m=''406740''>steps</span>
  <span m=''407140''>in</span> <span m=''407250''>the</span> <span m=''407350''>direction</span>
  <span m=''407720''>of</span> <span m=''407800''>the</span> <span m=''407880''>gradient</span>
  <span m=''408670''>until</span> <span m=''408940''>you</span> <span m=''409040''>reach</span>
  <span m=''409390''>the</span> <span m=''409490''>energy</span> <span m=''409800''>minimum.</span>
  <span m=''410740''>And</span> <span m=''410790''>if</span> <span m=''410940''>I</span>
  <span m=''411010''>do</span> <span m=''411220''>that,</span> <span m=''411650''>I</span>
  <span m=''411990''>sort of</span> <span m=''412110''>reach</span> <span m=''412680''>sort</span>
  <span m=''413500''>of</span> <span m=''413630''>the</span> <span m=''413720''>minimum</span>
  <span m=''414050''>configuration</span> <span m=''414335''>that</span> <span m=''414620''>this</span>
  <span m=''414850''>molecule</span> <span m=''415290''>likes</span> <span m=''415530''>to</span>
  <span m=''415620''>be</span> <span m=''415820''>in.</span> </p><p><span m=''417140''>And</span>
  <span m=''417340''>then,</span> <span m=''417620''>if</span> <span m=''417810''>I</span>
  <span m=''417890''>add</span> <span m=''418150''>some</span> <span m=''418880''>thermal</span>
  <span m=''419260''>noise,</span> <span m=''419690''>which</span> <span m=''419900''>means</span>
  <span m=''420080''>that</span> <span m=''420190''>I</span> <span m=''420260''>just</span>
  <span m=''420460''>set</span> <span m=''420750''>the</span> <span m=''421080''>initial</span>
  <span m=''421360''>velocities</span> <span m=''421930''>of</span> <span m=''422060''>the</span>
  <span m=''422190''>atoms</span> <span m=''422650''>to</span> <span m=''422770''>some</span>
  <span m=''424410''>random</span> <span m=''424670''>value</span> <span m=''425020''>based</span>
  <span m=''425250''>on</span> <span m=''425330''>the</span> <span m=''425440''>temperature,</span>
  <span m=''426370''>then</span> <span m=''426850''>the</span> <span m=''426940''>molecule</span>
  <span m=''427380''>starts</span> <span m=''427650''>sort</span> <span m=''427920''>of</span>
  <span m=''428190''>jiggling</span> <span m=''428570''>around.</span> <span m=''430680''>And</span>
  <span m=''431090''>the</span> <span m=''431250''>nice</span> <span m=''431540''>thing</span>
  <span m=''431730''>about</span> <span m=''432010''>the</span> <span m=''432090''>Verlet</span>
  <span m=''432440''>integration</span> <span m=''432900''>scheme</span> <span m=''433180''>is</span>
  <span m=''433290''>that</span> <span m=''433910''>it''s</span> <span m=''434120''>actually</span>
  <span m=''434410''>just</span> <span m=''434680''>right,</span> <span m=''434830''>like</span>
  <span m=''435000''>the</span> <span m=''435090''>energy</span> <span m=''435460''>is</span>
  <span m=''435620''>conserved</span> <span m=''436070''>in</span> <span m=''436130''>the</span>
  <span m=''436240''>system,</span> <span m=''436650''>although it</span> <span m=''436910''>fluctuates</span>
  <span m=''437420''>a</span> <span m=''437460''>little</span> <span m=''437640''>bit.</span>
  <span m=''438200''>So</span> <span m=''438380''>a</span> <span m=''438420''>lot</span>
  <span m=''438580''>of</span> <span m=''438660''>integration</span> <span m=''439120''>schemes</span>
  <span m=''439430''>the</span> <span m=''439510''>energy</span> <span m=''439800''>tends</span>
  <span m=''440090''>to</span> <span m=''440840''>be</span> <span m=''441820''>either</span>
  <span m=''442100''>decrease</span> <span m=''442640''>or</span> <span m=''442730''>increase,</span>
  <span m=''443220''>so</span> <span m=''443620''>the</span> <span m=''443810''>system</span>
  <span m=''444130''>explodes.</span> <span m=''444630''>But</span> <span m=''444990''>this</span>
  <span m=''445150''>integration</span> <span m=''445580''>scheme</span> <span m=''445790''>is</span>
  <span m=''445890''>very</span> <span m=''446100''>stable.</span> </p><p><span m=''449880''>One</span>
  <span m=''450060''>thing</span> <span m=''450210''>that</span> <span m=''450430''>you</span>
  <span m=''450520''>saw</span> <span m=''450820''>there</span> <span m=''451520''>is,</span>
  <span m=''452270''>so</span> <span m=''452490''>I just</span> <span m=''452610''>talked</span>
  <span m=''453130''>briefly</span> <span m=''453500''>about</span> <span m=''453670''>kinetic</span>
  <span m=''454000''>energy.</span> <span m=''454390''>This</span> <span m=''454450''>is</span>
  <span m=''454600''>kind</span> <span m=''454760''>of</span> <span m=''454870''>how</span>
  <span m=''455260''>the</span> <span m=''455430''>initial</span> <span m=''455800''>velocities</span>
  <span m=''456330''>are</span> <span m=''456440''>set</span> <span m=''456820''>based</span>
  <span m=''457110''>on</span> <span m=''457480''>the</span> <span m=''457560''>Boltzmann</span>
  <span m=''457970''>constant</span> <span m=''458240''>and</span> <span m=''458510''>the</span>
  <span m=''458710''>temperature.</span> <span m=''460100''>And</span> <span m=''460890''>the</span>
  <span m=''461040''>other</span> <span m=''461190''>thing</span> <span m=''461820''>that</span>
  <span m=''462290''>molecular</span> <span m=''462730''>dynamics</span> <span m=''463080''>usually</span>
  <span m=''463320''>do</span> <span m=''463520''>is</span> <span m=''463710''>called</span>
  <span m=''463920''>Langevin</span> <span m=''464350''>dynamics.</span> <span m=''465010''>And</span>
  <span m=''465170''>in</span> <span m=''465250''>this</span> <span m=''465440''>case,</span>
  <span m=''466130''>some</span> <span m=''466550''>random</span> <span m=''467520''>velocity</span>
  <span m=''468210''>vector</span> <span m=''468640''>is</span> <span m=''468770''>added</span>
  <span m=''469500''>to</span> <span m=''469650''>the</span> <span m=''470500''>normal</span>
  <span m=''470750''>velocity,</span> <span m=''471230''>which</span> <span m=''471350''>just</span>
  <span m=''472010''>sort</span> <span m=''472200''>of</span> <span m=''472730''>simulates</span>
  <span m=''473490''>collisions</span> <span m=''473950''>with</span> <span m=''474120''>other</span>
  <span m=''474340''>molecules</span> <span m=''474860''>in</span> <span m=''474950''>the</span>
  <span m=''475090''>environment.</span> <span m=''475950''>So</span> <span m=''475960''>this</span>
  <span m=''476150''>makes</span> <span m=''476450''>the</span> <span m=''476540''>simulation</span>
  <span m=''477000''>look</span> <span m=''477160''>a</span> <span m=''477210''>bit</span>
  <span m=''477360''>more</span> <span m=''477520''>realistic.</span> <span m=''478080''>So
  instead</span> <span m=''478390''>of</span> <span m=''478460''>the</span> <span
  m=''478520''>molecule</span> <span m=''478850''>just</span> <span m=''479030''>sitting</span>
  <span m=''479250''>there</span> <span m=''479530''>in</span> <span m=''479670''>space,</span>
  <span m=''480820''>this</span> <span m=''481120''>random</span> <span m=''482420''>sort</span>
  <span m=''482620''>of</span> <span m=''482750''>factor</span> <span m=''483730''>adds</span>
  <span m=''484870''>some</span> <span m=''485110''>movement.</span> </p><p><span
  m=''486350''>And</span> <span m=''487090''>there''s</span> <span m=''487310''>also</span>
  <span m=''487540''>a</span> <span m=''487770''>damping</span> <span m=''488290''>constant,</span>
  <span m=''488720''>which</span> <span m=''489230''>sort</span> <span m=''489470''>of</span>
  <span m=''489790''>opposes</span> <span m=''490390''>the</span> <span m=''490580''>velocity</span>
  <span m=''491690''>by</span> <span m=''492110''>some</span> <span m=''492350''>constant.</span>
  <span m=''493250''>So</span> <span m=''493770''>if</span> <span m=''494050''>you</span>
  <span m=''494130''>didn''t</span> <span m=''494420''>add</span> <span m=''494720''>any</span>
  <span m=''494910''>more</span> <span m=''495980''>sort of</span> <span m=''496430''>randomness</span>
  <span m=''496550''>into</span> <span m=''496700''>the</span> <span m=''496800''>system,</span>
  <span m=''497330''>the</span> <span m=''497430''>system</span> <span m=''497680''>would</span>
  <span m=''497780''>just</span> <span m=''498270''>eventually</span> <span m=''498990''>go</span>
  <span m=''500700''>to</span> <span m=''501050''>be</span> <span m=''501200''>completely</span>
  <span m=''501620''>still.</span> <span m=''502640''>So</span> <span m=''502860''>there</span>
  <span m=''503030''>would</span> <span m=''503130''>be</span> <span m=''503200''>no
  more</span> <span m=''503460''>movement,</span> <span m=''503900''>because</span>
  <span m=''504210''>this</span> <span m=''504340''>is</span> <span m=''504680''>kind</span>
  <span m=''504810''>of</span> <span m=''504850''>like</span> <span m=''505010''>a</span>
  <span m=''505070''>damping</span> <span m=''506030''>sort</span> <span m=''506180''>of</span>
  <span m=''506270''>factor.</span> <span m=''507600''>And</span> <span m=''507860''>there</span>
  <span m=''507950''>are</span> <span m=''508000''>some</span> <span m=''508180''>properties</span>
  <span m=''509761''>of</span> <span m=''510140''>this</span> <span m=''510350''>random</span>
  <span m=''510770''>vector</span> <span m=''511420''>that</span> <span m=''511710''>sort</span>
  <span m=''511900''>of</span> <span m=''512710''>make</span> <span m=''512970''>some</span>
  <span m=''513150''>physical</span> <span m=''513690''>sense.</span> <span m=''514419''>For</span>
  <span m=''514620''>example,</span> <span m=''515010''>it''s</span> <span m=''515470''>independent</span>
  <span m=''516070''>of</span> <span m=''516200''>previously</span> <span m=''516720''>picked</span>
  <span m=''516950''>random</span> <span m=''517270''>vectors,</span> <span m=''517789''>and</span>
  <span m=''518350''>it</span> <span m=''518400''>also</span> <span m=''518610''>depends</span>
  <span m=''518909''>on</span> <span m=''518960''>the</span> <span m=''519070''>temperature.</span>
  <span m=''519650''>So</span> <span m=''519750''>that</span> <span m=''519780''>if</span>
  <span m=''519890''>you</span> <span m=''520400''>keep</span> <span m=''520600''>adding</span>
  <span m=''520799''>this</span> <span m=''520960''>random</span> <span m=''521760''>factor</span>
  <span m=''522299''>to</span> <span m=''523049''>the</span> <span m=''523150''>simulation,</span>
  <span m=''523860''>the</span> <span m=''523980''>temperature</span> <span m=''524400''>will</span>
  <span m=''524540''>always</span> <span m=''524770''>stay</span> <span m=''524930''>constant.</span>
  </p><p><span m=''530590''>Another</span> <span m=''530870''>thing</span> <span m=''531100''>to</span>
  <span m=''531260''>consider</span> <span m=''531680''>is</span> <span m=''531770''>that</span>
  <span m=''532080''>these</span> <span m=''532330''>molecules,</span> <span m=''532990''>if</span>
  <span m=''533150''>you</span> <span m=''533220''>try</span> <span m=''533400''>to</span>
  <span m=''533530''>think</span> <span m=''533730''>of</span> <span m=''533800''>them</span>
  <span m=''534290''>as they</span> <span m=''534620''>are</span> <span m=''534940''>in</span>
  <span m=''535140''>a</span> <span m=''535190''>sort</span> <span m=''535380''>of</span>
  <span m=''535550''>typical</span> <span m=''535950''>biological</span> <span m=''536500''>system,</span>
  <span m=''536860''>is</span> <span m=''536940''>that</span> <span m=''537100''>they''ll</span>
  <span m=''537240''>be</span> <span m=''538550''>solvated</span> <span m=''538990''>in</span>
  <span m=''539210''>water.</span> <span m=''540030''>So</span> <span m=''540390''>in</span>
  <span m=''540540''>that</span> <span m=''540770''>case</span> <span m=''541560''>the</span>
  <span m=''541890''>Coulombic</span> <span m=''542640''>term</span> <span m=''543040''>is</span>
  <span m=''543180''>not</span> <span m=''543480''>actually</span> <span m=''544020''>that</span>
  <span m=''544250''>simple.</span> <span m=''545260''>You</span> <span m=''545400''>have</span>
  <span m=''545540''>to</span> <span m=''545730''>include</span> <span m=''546210''>some</span>
  <span m=''546370''>sort</span> <span m=''546540''>of</span> <span m=''546890''>dielectric</span>
  <span m=''547300''>constant.</span> <span m=''548270''>So</span> <span m=''549380''>for</span>
  <span m=''549500''>example,</span> <span m=''549840''>one</span> <span m=''550040''>that</span>
  <span m=''550150''>is</span> <span m=''550290''>typically</span> <span m=''550690''>used</span>
  <span m=''550990''>and</span> <span m=''551090''>is</span> <span m=''551200''>pretty</span>
  <span m=''551390''>simple</span> <span m=''551760''>is</span> <span m=''551870''>that</span>
  <span m=''552615''>the</span> <span m=''553000''>constant</span> <span m=''553380''>is</span>
  <span m=''553440''>just</span> <span m=''553620''>the</span> <span m=''553710''>distance.</span>
  <span m=''554500''>So</span> <span m=''554630''>that</span> <span m=''554810''>makes</span>
  <span m=''555080''>the</span> <span m=''555320''>electrostatic</span> <span m=''555900''>energy</span>
  <span m=''556380''>dependent</span> <span m=''556890''>on</span> <span m=''558130''>one</span>
  <span m=''558370''>over</span> <span m=''558530''>r</span> <span m=''558690''>squared</span>
  <span m=''559090''>rather</span> <span m=''559280''>than</span> <span m=''559480''>1</span>
  <span m=''559630''>over</span> <span m=''559820''>r.</span> <span m=''560440''>So</span>
  <span m=''560630''>that</span> <span m=''560860''>means</span> <span m=''561030''>that</span>
  <span m=''561210''>the</span> <span m=''561320''>electrostatic</span> <span m=''561900''>forces</span>
  <span m=''562250''>drop</span> <span m=''562500''>off</span> <span m=''563410''>a</span>
  <span m=''563500''>lot</span> <span m=''563720''>faster</span> <span m=''564500''>as</span>
  <span m=''564700''>the</span> <span m=''564830''>atoms</span> <span m=''565080''>get</span>
  <span m=''565250''>further</span> <span m=''565540''>and</span> <span m=''565620''>further</span>
  <span m=''565950''>apart.</span> </p><p><span m=''567240''>So</span> <span m=''567520''>for</span>
  <span m=''567830''>example,</span> <span m=''569300''>so</span> <span m=''569730''>two</span>
  <span m=''570120''>molecules</span> <span m=''570680''>that</span> <span m=''570780''>are</span>
  <span m=''571240''>oppositely</span> <span m=''571680''>charged,</span> <span m=''573430''>if</span>
  <span m=''573880''>you</span> <span m=''573960''>just</span> <span m=''574150''>put</span>
  <span m=''574290''>them</span> <span m=''574440''>in</span> <span m=''574540''>vacuum,</span>
  <span m=''575100''>they</span> <span m=''575240''>will</span> <span m=''575460''>eventually</span>
  <span m=''576030''>come</span> <span m=''576450''>close</span> <span m=''576770''>together.</span>
  <span m=''577090''>But</span> <span m=''577700''>if</span> <span m=''577890''>you</span>
  <span m=''578060''>add</span> <span m=''578330''>this</span> <span m=''578560''>term,</span>
  <span m=''580715''>the</span> <span m=''581110''>electrostatic</span> <span m=''581860''>attraction</span>
  <span m=''582320''>will be</span> <span m=''582480''>much</span> <span m=''582740''>weaker.</span>
  <span m=''583160''>So</span> <span m=''583420''>it</span> <span m=''583470''>will</span>
  <span m=''583650''>simulate</span> <span m=''584290''>them</span> <span m=''584450''>being</span>
  <span m=''584760''>solvated</span> <span m=''585010''>in</span> <span m=''585360''>water.</span>
  <span m=''585730''>And</span> <span m=''586570''>they</span> <span m=''586690''>will</span>
  <span m=''586840''>come</span> <span m=''587010''>together</span> <span m=''587340''>eventually</span>
  <span m=''587760''>but</span> <span m=''588110''>probably</span> <span m=''588480''>a</span>
  <span m=''588530''>lot</span> <span m=''588730''>slower.</span> <span m=''592200''>Another</span>
  <span m=''592460''>thing</span> <span m=''592620''>that</span> <span m=''592790''>is</span>
  <span m=''592960''>typically--</span> <span m=''594040''>so I''ll</span> <span m=''594340''>talk</span>
  <span m=''594540''>a</span> <span m=''594590''>little</span> <span m=''594730''>bit</span>
  <span m=''594830''>about</span> <span m=''595070''>the</span> <span m=''595150''>non-bonded</span>
  <span m=''595860''>forces</span> <span m=''596320''>right</span> <span m=''596490''>now,</span>
  <span m=''596680''>which</span> <span m=''597120''>are,</span> <span m=''597330''>again,</span>
  <span m=''597620''>the</span> <span m=''597760''>electrostatic</span> <span m=''598470''>forces</span>
  <span m=''599110''>and</span> <span m=''599365''>the</span> <span m=''599620''>van-der-Waal''s</span>
  <span m=''600160''>forces.</span> </p><p><span m=''601000''>So</span> <span m=''601130''>generally,</span>
  <span m=''601540''>what</span> <span m=''601800''>has</span> <span m=''601970''>to</span>
  <span m=''602060''>be</span> <span m=''602190''>done</span> <span m=''603310''>is,</span>
  <span m=''604060''>if</span> <span m=''604210''>you</span> <span m=''604340''>consider</span>
  <span m=''604770''>any</span> <span m=''605370''>single</span> <span m=''605760''>atom</span>
  <span m=''606110''>like</span> <span m=''606300''>say</span> <span m=''606450''>this</span>
  <span m=''606630''>one</span> <span m=''606800''>over</span> <span m=''606950''>here,</span>
  <span m=''609000''>well,</span> <span m=''609400''>so</span> <span m=''609530''>first</span>
  <span m=''609750''>of</span> <span m=''609820''>all</span> <span m=''609930''>the</span>
  <span m=''610010''>bonded</span> <span m=''610350''>forces</span> <span m=''610860''>basically</span>
  <span m=''611340''>include</span> <span m=''611670''>just</span> <span m=''611910''>the</span>
  <span m=''612020''>atoms</span> <span m=''612330''>that are</span> <span m=''612500''>connected</span>
  <span m=''612920''>to</span> <span m=''613120''>it,</span> <span m=''613420''>and</span>
  <span m=''613480''>that''s</span> <span m=''613710''>it.</span> <span m=''613990''>So</span>
  <span m=''614480''>it''s</span> <span m=''614600''>usually</span> <span m=''614850''>the</span>
  <span m=''614970''>fastest</span> <span m=''615720''>step</span> <span m=''616120''>in</span>
  <span m=''616240''>the</span> <span m=''616350''>computation.</span> <span m=''617530''>But</span>
  <span m=''618040''>for</span> <span m=''618280''>non-bonded</span> <span m=''618810''>forces,</span>
  <span m=''619510''>you</span> <span m=''619710''>have</span> <span m=''619860''>to</span>
  <span m=''619990''>consider</span> <span m=''620400''>basically</span> <span m=''620780''>every</span>
  <span m=''621060''>other</span> <span m=''621260''>atom</span> <span m=''621650''>in</span>
  <span m=''621830''>the</span> <span m=''621930''>system.</span> <span m=''624410''>And</span>
  <span m=''624720''>I</span> <span m=''624780''>didn''t</span> <span m=''624980''>include</span>
  <span m=''625260''>all</span> <span m=''625330''>of</span> <span m=''625440''>the</span>
  <span m=''626280''>atoms</span> <span m=''626550''>here,</span> <span m=''626800''>but</span>
  <span m=''626830''>basically</span> <span m=''627130''>just</span> <span m=''627280''>to</span>
  <span m=''627350''>give</span> <span m=''627480''>an</span> <span m=''627550''>idea,</span>
  <span m=''627970''>they</span> <span m=''628090''>could</span> <span m=''628270''>be</span>
  <span m=''628380''>atoms</span> <span m=''628640''>that</span> <span m=''628740''>are</span>
  <span m=''628850''>really</span> <span m=''629090''>far</span> <span m=''629330''>apart.</span>
  </p><p><span m=''631360''>So</span> <span m=''631550''>generally,</span> <span m=''631810''>what''s</span>
  <span m=''632060''>done</span> <span m=''632310''>is</span> <span m=''632700''>there</span>
  <span m=''632880''>is</span> <span m=''632970''>some</span> <span m=''633220''>cut</span>
  <span m=''633420''>off</span> <span m=''633650''>radius,</span> <span m=''634800''>outside</span>
  <span m=''635120''>of</span> <span m=''635220''>which</span> <span m=''635490''>those</span>
  <span m=''635700''>forces</span> <span m=''636020''>aren''t</span> <span m=''636200''>considered.</span>
  <span m=''636840''>And</span> <span m=''636850''>because</span> <span m=''637120''>the</span>
  <span m=''637210''>forces</span> <span m=''637600''>drop</span> <span m=''637850''>off
  really</span> <span m=''638290''>fast,</span> <span m=''638750''>sometimes</span>
  <span m=''639210''>that''s</span> <span m=''639360''>considered</span> <span m=''639750''>to</span>
  <span m=''639840''>be</span> <span m=''640290''>good</span> <span m=''640460''>enough</span>
  <span m=''640760''>for</span> <span m=''641160''>a</span> <span m=''641240''>lot</span>
  <span m=''641400''>of</span> <span m=''641450''>simulations.</span> <span m=''642340''>So</span>
  <span m=''642460''>that''s</span> <span m=''642620''>a</span> <span m=''642670''>consideration</span>
  <span m=''643330''>to</span> <span m=''643580''>take</span> <span m=''643830''>into</span>
  <span m=''644040''>account</span> <span m=''645035''>when</span> <span m=''645360''>doing</span>
  <span m=''645660''>these</span> <span m=''646310''>simulations.</span> <span m=''648100''>OK,</span>
  <span m=''648310''>so</span> <span m=''648420''>here''s</span> <span m=''648660''>the</span>
  <span m=''648720''>basic</span> <span m=''649220''>molecular</span> <span m=''649630''>dynamics</span>
  <span m=''650020''>algorithm.</span> <span m=''652190''>So</span> <span m=''652600''>you</span>
  <span m=''652670''>specify</span> <span m=''653110''>how</span> <span m=''653210''>many</span>
  <span m=''653430''>steps</span> <span m=''653770''>you</span> <span m=''653860''>want</span>
  <span m=''653970''>to</span> <span m=''654030''>run</span> <span m=''654220''>it</span>
  <span m=''654320''>to.</span> <span m=''654580''>And</span> <span m=''657270''>each</span>
  <span m=''657500''>time</span> <span m=''657710''>step</span> <span m=''658430''>is</span>
  <span m=''659380''>one</span> <span m=''659610''>femtosecond.</span> <span m=''663280''>So</span>
  <span m=''663450''>very</span> <span m=''663690''>small.</span> </p><p><span m=''666920''>So</span>
  <span m=''667680''>usually</span> <span m=''667980''>what</span> <span m=''668130''>happens</span>
  <span m=''668550''>is</span> <span m=''669210''>you</span> <span m=''669310''>can</span>
  <span m=''669470''>find</span> <span m=''669820''>the</span> <span m=''669940''>atom</span>
  <span m=''670210''>pairs.</span> <span m=''670720''>So</span> <span m=''670810''>that</span>
  <span m=''670960''>means</span> <span m=''671510''>all</span> <span m=''671690''>the</span>
  <span m=''671770''>non-bonded</span> <span m=''672300''>interactions,</span> <span
  m=''672990''>you</span> <span m=''673070''>have</span> <span m=''673200''>to</span>
  <span m=''673280''>make</span> <span m=''673470''>a</span> <span m=''673530''>list,</span>
  <span m=''674250''>basically</span> <span m=''674640''>an</span> <span m=''674750''>n</span>
  <span m=''674860''>squared</span> <span m=''675300''>list.</span> <span m=''675560''>If
  you have n</span> <span m=''675980''>atoms,</span> <span m=''676360''>you</span>
  <span m=''676550''>can</span> <span m=''676720''>expect</span> <span m=''677080''>to</span>
  <span m=''677120''>have</span> <span m=''677280''>about</span> <span m=''677840''>n</span>
  <span m=''678010''>squared</span> <span m=''678380''>atom</span> <span m=''678640''>pairs.</span>
  <span m=''679680''>But</span> <span m=''679940''>if</span> <span m=''680060''>you</span>
  <span m=''680390''>consider</span> <span m=''680780''>a</span> <span m=''680850''>cut</span>
  <span m=''681070''>off,</span> <span m=''681310''>then</span> <span m=''681450''>what''s</span>
  <span m=''681620''>usually</span> <span m=''681880''>done</span> <span m=''682150''>is</span>
  <span m=''683090''>only</span> <span m=''684390''>atom</span> <span m=''684610''>pairs</span>
  <span m=''686560''>within</span> <span m=''686780''>that cut</span> <span m=''686910''>off
  are</span> <span m=''687310''>considered</span> <span m=''687930''>and</span> <span
  m=''687980''>included</span> <span m=''688290''>into</span> <span m=''688490''>that</span>
  <span m=''688670''>list.</span> <span m=''690350''>And</span> <span m=''690610''>that</span>
  <span m=''690890''>computation</span> <span m=''691420''>is</span> <span m=''691510''>pretty</span>
  <span m=''691670''>expensive,</span> <span m=''692140''>d</span> <span m=''692280''>it''s</span>
  <span m=''692480''>sometimes</span> <span m=''692910''>only</span> <span m=''693160''>done</span>
  <span m=''694040''>only</span> <span m=''694870''>every,</span> <span m=''695180''>say</span>
  <span m=''695440''>every</span> <span m=''695720''>ten</span> <span m=''695910''>steps.</span>
  </p><p><span m=''696790''>And</span> <span m=''697060''>atoms</span> <span m=''697360''>don''t</span>
  <span m=''697510''>really</span> <span m=''697720''>move</span> <span m=''698050''>that</span>
  <span m=''698510''>much.</span> <span m=''699060''>So</span> <span m=''699170''>it''s</span>
  <span m=''699280''>usually</span> <span m=''699660''>pretty</span> <span m=''699910''>accurate.</span>
  <span m=''700990''>And if you</span> <span m=''701340''>use</span> <span m=''701480''>a</span>
  <span m=''701600''>cut</span> <span m=''701790''>off</span> <span m=''701970''>of,</span>
  <span m=''702190''>say</span> <span m=''702810''>15</span> <span m=''703240''>angstroms,</span>
  <span m=''703860''>and</span> <span m=''704050''>then,</span> <span m=''704460''>well,</span>
  <span m=''704650''>the</span> <span m=''704720''>forces</span> <span m=''705100''>have</span>
  <span m=''705220''>dropped to</span> <span m=''705530''>almost</span> <span m=''705850''>zero</span>
  <span m=''706110''>by</span> <span m=''706250''>12</span> <span m=''706510''>angstroms,</span>
  <span m=''706930''>then</span> <span m=''707020''>that''s</span> <span m=''707210''>pretty</span>
  <span m=''707430''>accurate.</span> <span m=''708190''>So</span> <span m=''708200''>this</span>
  <span m=''708370''>is</span> <span m=''708530''>usually</span> <span m=''710620''>an</span>
  <span m=''710730''>optimization.</span> <span m=''712180''>It</span> <span m=''712460''>optimizes</span>
  <span m=''712990''>the</span> <span m=''713050''>simulation</span> <span m=''713360''>a</span>
  <span m=''713670''>little</span> <span m=''713790''>bit.</span> <span m=''715210''>The</span>
  <span m=''715350''>next</span> <span m=''715600''>step</span> <span m=''715710''>is</span>
  <span m=''715830''>to</span> <span m=''715950''>compute</span> <span m=''716270''>the</span>
  <span m=''716350''>bonded</span> <span m=''716760''>forces.</span> <span m=''717250''>So</span>
  <span m=''717520''>that</span> <span m=''717720''>includes</span> <span m=''718020''>the</span>
  <span m=''718100''>bonds,</span> <span m=''718440''>angles,</span> <span m=''718610''>dihedrals</span>
  <span m=''719140''>and</span> <span m=''719230''>improper</span> <span m=''719710''>angles.</span>
  </p><p><span m=''723120''>And</span> <span m=''723200''>then</span> <span m=''723340''>compute</span>
  <span m=''723620''>the</span> <span m=''723700''>non-bonded</span> <span m=''724130''>forces,</span>
  <span m=''724800''>so</span> <span m=''725010''>that</span> <span m=''725500''>iterates</span>
  <span m=''725900''>over</span> <span m=''726100''>all</span> <span m=''726230''>the</span>
  <span m=''726350''>atom</span> <span m=''726570''>pairs.</span> <span m=''727310''>And</span>
  <span m=''727460''>then</span> <span m=''727600''>the</span> <span m=''727710''>integration</span>
  <span m=''728270''>is</span> <span m=''728380''>done</span> <span m=''728590''>to</span>
  <span m=''728930''>obtain</span> <span m=''729310''>the</span> <span m=''729580''>new</span>
  <span m=''729760''>atom</span> <span m=''729990''>positions.</span> <span m=''731400''>So</span>
  <span m=''731570''>here''s,</span> <span m=''732270''>running</span> <span m=''732590''>on</span>
  <span m=''732660''>the</span> <span m=''732750''>PlayStation,</span> <span m=''733500''>this</span>
  <span m=''733720''>is</span> <span m=''734470''>kind</span> <span m=''734670''>of</span>
  <span m=''734920''>roughly</span> <span m=''735250''>how</span> <span m=''736650''>this</span>
  <span m=''736890''>is</span> <span m=''737010''>just</span> <span m=''737200''>running</span>
  <span m=''737420''>on</span> <span m=''737490''>the</span> <span m=''737600''>PPU</span>
  <span m=''738040''>alone.</span> <span m=''739000''>So</span> <span m=''739680''>finding</span>
  <span m=''739970''>the</span> <span m=''740110''>atom</span> <span m=''740340''>pairs,</span>
  <span m=''742150''>if</span> <span m=''742350''>I</span> <span m=''742450''>don''t</span>
  <span m=''742650''>use</span> <span m=''742790''>a</span> <span m=''742890''>cut
  off,</span> <span m=''743350''>I</span> <span m=''743390''>can</span> <span m=''743530''>just</span>
  <span m=''743700''>compute</span> <span m=''744330''>the</span> <span m=''744510''>atom</span>
  <span m=''744710''>pairs</span> <span m=''745010''>list</span> <span m=''745300''>once,</span>
  <span m=''745570''>and</span> <span m=''745690''>then</span> <span m=''745740''>never</span>
  <span m=''745950''>do</span> <span m=''746130''>it</span> <span m=''746200''>again.</span>
  <span m=''746530''>So</span> <span m=''746680''>that''s</span> <span m=''746920''>why</span>
  <span m=''747480''>I</span> <span m=''747610''>put</span> <span m=''747790''>here</span>
  <span m=''748000''>0.</span> <span m=''749130''>But</span> <span m=''749410''>otherwise,</span>
  <span m=''749870''>generally</span> <span m=''750350''>takes</span> <span m=''751260''>a</span>
  <span m=''751350''>lot</span> <span m=''751620''>of</span> <span m=''751720''>time</span>
  <span m=''752070''>to</span> <span m=''752200''>compute</span> <span m=''752620''>the</span>
  <span m=''752750''>atom</span> <span m=''752990''>pairs,</span> <span m=''753410''>because</span>
  <span m=''753720''>it</span> <span m=''753790''>involves</span> <span m=''754810''>getting</span>
  <span m=''755140''>the</span> <span m=''755280''>distances</span> <span m=''755780''>between</span>
  <span m=''756100''>every</span> <span m=''757490''>two</span> <span m=''757640''>atoms.</span>
  </p><p><span m=''758650''>And</span> <span m=''761470''>this</span> <span m=''761650''>is</span>
  <span m=''761750''>a</span> <span m=''761830''>pretty</span> <span m=''762050''>big</span>
  <span m=''762240''>system,</span> <span m=''763450''>maybe</span> <span m=''763720''>about</span>
  <span m=''765000''>1,000</span> <span m=''765580''>atoms.</span> <span m=''766350''>So</span>
  <span m=''766500''>that''s</span> <span m=''766720''>why.</span> <span m=''767670''>So</span>
  <span m=''767940''>these</span> <span m=''768210''>times</span> <span m=''768480''>are</span>
  <span m=''768530''>not</span> <span m=''768700''>really</span> <span m=''769670''>representative</span>
  <span m=''770240''>of</span> <span m=''770340''>smaller</span> <span m=''770650''>systems.</span>
  </p><p><span m=''771772''>AUDIENCE: What is</span> <span m=''772204''>BF</span>
  <span m=''772636''>[INAUDIBLE]?</span> </p><p><span m=''773500''>GREG PINTILIE:
  BF,</span> <span m=''774180''>so</span> <span m=''774510''>that''s</span> <span
  m=''774810''>done</span> <span m=''774990''>using</span> <span m=''775220''>the</span>
  <span m=''775330''>brute</span> <span m=''775590''>force</span> <span m=''775870''>approach.</span>
  <span m=''776320''>So that means</span> <span m=''776740''>that you</span> <span
  m=''776910''>check</span> <span m=''777150''>every</span> <span m=''777780''>two</span>
  <span m=''777960''>atoms.</span> <span m=''778700''>And</span> <span m=''779510''>this</span>
  <span m=''779720''>is</span> <span m=''779800''>using</span> <span m=''780110''>a</span>
  <span m=''780160''>KD</span> <span m=''780400''>tree,</span> <span m=''781200''>so</span>
  <span m=''781340''>that</span> <span m=''781650''>breaks</span> <span m=''782390''>space</span>
  <span m=''782780''>up.</span> <span m=''786120''>So</span> <span m=''786760''>then</span>
  <span m=''788240''>checking</span> <span m=''788890''>the</span> <span m=''789020''>neighboring</span>
  <span m=''789440''>atoms</span> <span m=''789800''>is</span> <span m=''790610''>n</span>
  <span m=''790750''>log</span> <span m=''791030''>n.</span> <span m=''792621''>Or</span>
  <span m=''793030''>it''s</span> <span m=''793150''>actually</span> <span m=''793450''>a</span>
  <span m=''793680''>constant</span> <span m=''794070''>factor</span> <span m=''794390''>after</span>
  <span m=''794620''>you''ve</span> <span m=''794730''>built</span> <span m=''794950''>the</span>
  <span m=''795050''>tree.</span> <span m=''795280''>Building</span> <span m=''795530''>the</span>
  <span m=''795620''>tree is</span> <span m=''795890''>n</span> <span m=''796020''>log</span>
  <span m=''796390''>n.</span> <span m=''796690''>So</span> <span m=''797310''>using</span>
  <span m=''797670''>that</span> <span m=''797850''>kind</span> <span m=''797960''>of</span>
  <span m=''798040''>an</span> <span m=''798130''>algorithm,</span> <span m=''798520''>you</span>
  <span m=''798620''>get</span> <span m=''800010''>much</span> <span m=''800230''>better</span>
  <span m=''800370''>improvement.</span> <span m=''800740''>So</span> <span m=''801190''>this</span>
  <span m=''801600''>is</span> <span m=''801700''>a</span> <span m=''801770''>scaling</span>
  <span m=''802300''>of</span> <span m=''804020''>increasing</span> <span m=''804490''>the</span>
  <span m=''804610''>system</span> <span m=''804960''>size</span> <span m=''805680''>by</span>
  <span m=''806170''>two</span> <span m=''806540''>in</span> <span m=''806660''>the</span>
  <span m=''806720''>number</span> <span m=''806970''>of</span> <span m=''807050''>atoms.</span>
  </p><p><span m=''807650''>So</span> <span m=''807700''>say</span> <span m=''807860''>going</span>
  <span m=''808090''>from</span> <span m=''808270''>1,000</span> <span m=''808585''>to</span>
  <span m=''808900''>2,000</span> <span m=''809400''>atoms.</span> <span m=''810010''>The</span>
  <span m=''810150''>time</span> <span m=''810510''>too,</span> <span m=''810830''>using</span>
  <span m=''812390''>a</span> <span m=''812610''>brute</span> <span m=''812960''>force</span>
  <span m=''813260''>approach,</span> <span m=''814670''>increases</span> <span m=''815050''>exponentially.</span>
  <span m=''815840''>Whereas,</span> <span m=''816120''>using</span> <span m=''816370''>a</span>
  <span m=''816420''>KD</span> <span m=''816760''>tree,</span> <span m=''817025''>it</span>
  <span m=''817290''>actually</span> <span m=''818750''>just</span> <span m=''818980''>about</span>
  <span m=''819250''>doubles.</span> <span m=''819780''>So</span> <span m=''820290''>that</span>
  <span m=''820440''>kind</span> <span m=''820590''>of</span> <span m=''822020''>shows</span>
  <span m=''822320''>that</span> <span m=''822480''>using</span> <span m=''823250''>a</span>
  <span m=''823320''>better</span> <span m=''823550''>algorithm</span> <span m=''824010''>sometimes</span>
  <span m=''824370''>for</span> <span m=''824440''>these</span> <span m=''824630''>things</span>
  <span m=''824820''>is</span> <span m=''825120''>probably</span> <span m=''825580''>much</span>
  <span m=''825820''>better</span> <span m=''826000''>than</span> <span m=''826430''>trying</span>
  <span m=''826700''>to</span> <span m=''826790''>parallelize</span> <span m=''827380''>it.</span>
  <span m=''829590''>Doing</span> <span m=''829800''>the</span> <span m=''829890''>bonded</span>
  <span m=''830280''>forces,</span> <span m=''831640''>say</span> <span m=''831950''>about</span>
  <span m=''832210''>50</span> <span m=''832490''>milliseconds,</span> <span m=''834850''>and</span>
  <span m=''835270''>with</span> <span m=''835470''>cut</span> <span m=''835650''>off</span>
  <span m=''835870''>it''s</span> <span m=''836100''>the</span> <span m=''836190''>same</span>
  <span m=''836410''>time,</span> <span m=''836640''>because</span> <span m=''836910''>it</span>
  <span m=''836970''>doesn''t</span> <span m=''837200''>really</span> <span m=''837390''>affect</span>
  <span m=''837690''>the</span> <span m=''837790''>step.</span> </p><p><span m=''838700''>But</span>
  <span m=''838930''>then</span> <span m=''839490''>computing</span> <span m=''839910''>the</span>
  <span m=''840460''>non-bonded</span> <span m=''841060''>forces</span> <span m=''841480''>is</span>
  <span m=''841620''>actually</span> <span m=''841900''>the</span> <span m=''842010''>biggest</span>
  <span m=''842520''>chunk</span> <span m=''842790''>of</span> <span m=''842890''>time.</span>
  <span m=''843640''>So</span> <span m=''843940''>that</span> <span m=''844160''>takes</span>
  <span m=''845130''>about</span> <span m=''845540''>1.4</span> <span m=''846130''>seconds</span>
  <span m=''846500''>for</span> <span m=''846620''>the</span> <span m=''846770''>system.</span>
  <span m=''847870''>And</span> <span m=''847990''>then</span> <span m=''848750''>this</span>
  <span m=''848980''>is</span> <span m=''849170''>considering</span> <span m=''849810''>a</span>
  <span m=''849870''>million</span> <span m=''850280''>pairs.</span> <span m=''852760''>With</span>
  <span m=''853070''>a</span> <span m=''853190''>cut off</span> <span m=''853410''>there
  is</span> <span m=''853870''>less</span> <span m=''854100''>pairs</span> <span m=''854380''>to</span>
  <span m=''854480''>consider,</span> <span m=''855090''>but</span> <span m=''855240''>the</span>
  <span m=''855340''>time</span> <span m=''855720''>is</span> <span m=''855810''>still</span>
  <span m=''856790''>the</span> <span m=''856950''>dominant</span> <span m=''857430''>time</span>
  <span m=''857690''>basically.</span> <span m=''858660''>So</span> <span m=''858760''>generally,</span>
  <span m=''859110''>for</span> <span m=''859290''>molecular</span> <span m=''859630''>dynamic</span>
  <span m=''859980''>simulations</span> <span m=''860580''>this</span> <span m=''860780''>is</span>
  <span m=''860970''>the</span> <span m=''861100''>dominant</span> <span m=''861600''>time</span>
  <span m=''861860''>factor.</span> <span m=''862620''>And</span> <span m=''862740''>that''s</span>
  <span m=''862920''>what</span> <span m=''863040''>people</span> <span m=''863300''>really</span>
  <span m=''863650''>focus</span> <span m=''864050''>on,</span> <span m=''864260''>trying</span>
  <span m=''864590''>to</span> <span m=''864860''>speed</span> <span m=''865150''>things</span>
  <span m=''865390''>up.</span> <span m=''865990''>And</span> <span m=''866120''>then</span>
  <span m=''866240''>the</span> <span m=''866320''>integration</span> <span m=''866780''>is</span>
  <span m=''866910''>really</span> <span m=''867150''>fast,</span> <span m=''868460''>because</span>
  <span m=''868600''>it</span> <span m=''868670''>just</span> <span m=''868910''>loops</span>
  <span m=''869110''>over</span> <span m=''869490''>the</span> <span m=''869630''>atoms</span>
  <span m=''869920''>once.</span> </p><p><span m=''871480''>So</span> <span m=''871930''>there</span>
  <span m=''872160''>is</span> <span m=''872280''>basically</span> <span m=''873050''>three</span>
  <span m=''873490''>different</span> <span m=''873820''>parallelization</span> <span
  m=''874370''>approaches</span> <span m=''875260''>that</span> <span m=''875450''>I''ve</span>
  <span m=''876060''>come</span> <span m=''876220''>across</span> <span m=''876530''>in
  the</span> <span m=''876600''>literature.</span> <span m=''877440''>And</span> <span
  m=''877540''>one</span> <span m=''877680''>of</span> <span m=''877740''>them</span>
  <span m=''878890''>is</span> <span m=''879000''>referred</span> <span m=''879320''>to</span>
  <span m=''879420''>as</span> <span m=''879570''>force</span> <span m=''879830''>decomposition.</span>
  <span m=''880950''>So</span> <span m=''881120''>if</span> <span m=''881220''>you</span>
  <span m=''881310''>think</span> <span m=''881550''>of</span> <span m=''882900''>a</span>
  <span m=''882980''>force</span> <span m=''883450''>operation</span> <span m=''884000''>being,</span>
  <span m=''884420''>say</span> <span m=''884620''>a</span> <span m=''884670''>non-bonded</span>
  <span m=''885290''>force</span> <span m=''885590''>operation</span> <span m=''886500''>where</span>
  <span m=''886690''>you</span> <span m=''886820''>consider</span> <span m=''887220''>two</span>
  <span m=''887390''>atoms,</span> <span m=''887850''>and</span> <span m=''887940''>you</span>
  <span m=''888030''>compute</span> <span m=''888510''>the</span> <span m=''888600''>force</span>
  <span m=''889840''>the</span> <span m=''890040''>two,</span> <span m=''890460''>van-der-Waals</span>
  <span m=''891080''>and</span> <span m=''891290''>electrostatic</span> <span m=''892320''>forces,</span>
  <span m=''894840''>one</span> <span m=''895350''>easy</span> <span m=''895530''>way</span>
  <span m=''895680''>to</span> <span m=''895800''>split</span> <span m=''896070''>this</span>
  <span m=''896210''>up</span> <span m=''896330''>amongst,</span> <span m=''896830''>say</span>
  <span m=''897130''>six</span> <span m=''897450''>processors,</span> <span m=''898220''>is</span>
  <span m=''898510''>to</span> <span m=''898970''>just</span> <span m=''899200''>give</span>
  <span m=''899370''>each</span> <span m=''899530''>processor,</span> <span m=''901340''>say</span>
  <span m=''902450''>n</span> <span m=''902690''>divided</span> <span m=''903050''>by</span>
  <span m=''903180''>6</span> <span m=''904020''>of</span> <span m=''904160''>these</span>
  <span m=''904390''>force</span> <span m=''904660''>operations.</span> </p><p><span
  m=''908440''>So</span> <span m=''908600''>you</span> <span m=''908670''>have</span>
  <span m=''908810''>to</span> <span m=''908910''>send</span> <span m=''909100''>each</span>
  <span m=''909230''>processor</span> <span m=''910760''>both</span> <span m=''911080''>atom</span>
  <span m=''911370''>positions,</span> <span m=''912170''>and</span> <span m=''912350''>then</span>
  <span m=''912540''>some</span> <span m=''912750''>other</span> <span m=''913220''>properties</span>
  <span m=''913610''>of</span> <span m=''913700''>the</span> <span m=''913810''>atoms,</span>
  <span m=''914260''>such</span> <span m=''914460''>as</span> <span m=''914580''>the</span>
  <span m=''914660''>mass</span> <span m=''915120''>and--</span> <span m=''916120''>actually
  not</span> <span m=''916450''>the</span> <span m=''916530''>mass,</span> <span m=''916810''>but</span>
  <span m=''916950''>the</span> <span m=''917040''>charges</span> <span m=''917580''>and</span>
  <span m=''918320''>the</span> <span m=''919010''>minimum</span> <span m=''919390''>radius.</span>
  <span m=''922250''>And</span> <span m=''922570''>basically,</span> <span m=''923150''>once</span>
  <span m=''923500''>that</span> <span m=''923620''>computation</span> <span m=''924120''>is</span>
  <span m=''924250''>done,</span> <span m=''924950''>the</span> <span m=''925090''>processor</span>
  <span m=''925500''>just</span> <span m=''925700''>has</span> <span m=''925910''>to</span>
  <span m=''926430''>either</span> <span m=''926730''>store</span> <span m=''927220''>or</span>
  <span m=''927360''>return</span> <span m=''927600''>the</span> <span m=''927700''>force</span>
  <span m=''928090''>on</span> <span m=''928210''>both</span> <span m=''928490''>atom.</span>
  <span m=''929530''>And</span> <span m=''930440''>it</span> <span m=''930560''>has</span>
  <span m=''930750''>to</span> <span m=''930850''>come</span> <span m=''931050''>back</span>
  <span m=''931300''>to</span> <span m=''931390''>sort</span> <span m=''931520''>of</span>
  <span m=''931610''>like</span> <span m=''931800''>the</span> <span m=''931880''>main</span>
  <span m=''932100''>processor</span> <span m=''932650''>where all</span> <span m=''933000''>the</span>
  <span m=''933070''>forces</span> <span m=''933400''>are</span> <span m=''933510''>added</span>
  <span m=''933730''>up,</span> <span m=''933930''>and</span> <span m=''934020''>then</span>
  <span m=''934140''>the</span> <span m=''934250''>integration</span> <span m=''934790''>is</span>
  <span m=''934930''>done.</span> </p><p><span m=''939920''>So</span> <span m=''940900''>what</span>
  <span m=''941080''>I</span> <span m=''941150''>just</span> <span m=''941320''>described</span>
  <span m=''941625''>is</span> <span m=''941930''>sort</span> <span m=''942110''>of</span>
  <span m=''942460''>the</span> <span m=''942590''>approach</span> <span m=''942910''>I</span>
  <span m=''942990''>took.</span> <span m=''943240''>And</span> <span m=''944150''>it''s</span>
  <span m=''944380''>sort</span> <span m=''944560''>of</span> <span m=''944880''>an</span>
  <span m=''945060''>easy</span> <span m=''945290''>approach</span> <span m=''945690''>to</span>
  <span m=''945880''>sort of</span> <span m=''946150''>think</span> <span m=''946420''>of</span>
  <span m=''948040''>if</span> <span m=''948190''>you</span> <span m=''948540''>couldn''t</span>
  <span m=''948850''>store,</span> <span m=''949270''>say</span> <span m=''949460''>every</span>
  <span m=''949770''>atom</span> <span m=''950080''>on</span> <span m=''950160''>every</span>
  <span m=''950350''>processor.</span> <span m=''951350''>Because</span> <span m=''951660''>you</span>
  <span m=''951730''>just</span> <span m=''951910''>have</span> <span m=''952030''>to</span>
  <span m=''952130''>send</span> <span m=''952380''>each</span> <span m=''952550''>processor</span>
  <span m=''953620''>a</span> <span m=''953690''>certain</span> <span m=''953930''>number</span>
  <span m=''954180''>of</span> <span m=''954280''>these</span> <span m=''954480''>force</span>
  <span m=''955180''>computation</span> <span m=''955810''>units.</span> <span m=''956160''>And</span>
  <span m=''956340''>the</span> <span m=''956420''>processor</span> <span m=''956780''>does
  then</span> <span m=''957060''>and then</span> <span m=''957380''>returns</span>
  <span m=''957680''>the</span> <span m=''957760''>forces.</span> <span m=''958630''>And</span>
  <span m=''958790''>then</span> <span m=''958960''>you</span> <span m=''959030''>can</span>
  <span m=''959160''>just</span> <span m=''959370''>add</span> <span m=''959520''>up</span>
  <span m=''959770''>all</span> <span m=''959980''>the</span> <span m=''960290''>forces</span>
  <span m=''960860''>on</span> <span m=''960960''>every</span> <span m=''961170''>atom</span>
  <span m=''961480''>and</span> <span m=''961650''>do</span> <span m=''961780''>that.</span>
  <span m=''963110''>So</span> <span m=''963290''>basically</span> <span m=''963650''>here</span>
  <span m=''963830''>is</span> <span m=''964520''>the</span> <span m=''964710''>algorithm</span>
  <span m=''965180''>how</span> <span m=''965420''>it</span> <span m=''965520''>works</span>
  <span m=''965750''>roughly.</span> <span m=''966210''>And</span> <span m=''967370''>so</span>
  <span m=''968260''>basically,</span> <span m=''968770''>first</span> <span m=''969120''>set</span>
  <span m=''969300''>up</span> <span m=''969460''>the</span> <span m=''969590''>SPUs,</span>
  <span m=''970280''>send</span> <span m=''970390''>the</span> <span m=''970470''>control</span>
  <span m=''970740''>box</span> <span m=''971040''>with,</span> <span m=''971240''>say</span>
  <span m=''971450''>the</span> <span m=''971600''>addresses</span> <span m=''972020''>where
  a</span> <span m=''972290''>these</span> <span m=''972790''>force</span> <span m=''973100''>operations</span>
  <span m=''973640''>will</span> <span m=''973770''>be</span> <span m=''973880''>stored.</span>
  </p><p><span m=''975650''>The</span> <span m=''976430''>bonded</span> <span m=''976790''>forces</span>
  <span m=''977070''>are</span> <span m=''977190''>computed</span> <span m=''978430''>on</span>
  <span m=''978620''>the</span> <span m=''978720''>PPU,</span> <span m=''980090''>just</span>
  <span m=''980330''>for</span> <span m=''980430''>simplicity</span> <span m=''981070''>for</span>
  <span m=''981220''>now.</span> <span m=''983910''>And</span> <span m=''984080''>then</span>
  <span m=''984260''>the</span> <span m=''984350''>computation</span> <span m=''984820''>for</span>
  <span m=''984930''>the</span> <span m=''985030''>non-bonded</span> <span m=''985480''>forces,</span>
  <span m=''985960''>basically,</span> <span m=''988565''>all</span> <span m=''988920''>the</span>
  <span m=''989080''>non-bonded</span> <span m=''989590''>forces</span> <span m=''989950''>operations</span>
  <span m=''990550''>remaining</span> <span m=''990890''>are</span> <span m=''990980''>considered.</span>
  <span m=''992010''>And</span> <span m=''992080''>then</span> <span m=''992180''>they''re</span>
  <span m=''992300''>split</span> <span m=''992570''>up</span> <span m=''992710''>into</span>
  <span m=''992970''>blocks.</span> <span m=''993570''>So</span> <span m=''994120''>each</span>
  <span m=''994350''>SPU</span> <span m=''994810''>sent</span> <span m=''995040''>a</span>
  <span m=''995140''>block</span> <span m=''995590''>with,</span> <span m=''995770''>say</span>
  <span m=''995980''>a</span> <span m=''996040''>number</span> <span m=''996370''>of</span>
  <span m=''996450''>force</span> <span m=''996740''>operations.</span> <span m=''997690''>And</span>
  <span m=''997770''>in</span> <span m=''997830''>this</span> <span m=''998020''>case</span>
  <span m=''998250''>it</span> <span m=''998300''>was</span> <span m=''998510''>200.</span>
  <span m=''1000480''>So</span> <span m=''1000930''>the</span> <span m=''1001030''>control</span>
  <span m=''1001330''>block</span> <span m=''1001590''>is</span> <span m=''1001700''>sent</span>
  <span m=''1002130''>to</span> <span m=''1002330''>the</span> <span m=''1002600''>SPU,</span>
  <span m=''1003320''>the</span> <span m=''1003540''>SPU</span> <span m=''1004240''>is</span>
  <span m=''1004710''>told</span> <span m=''1004930''>to</span> <span m=''1005010''>start</span>
  <span m=''1005270''>processing.</span> </p><p><span m=''1006220''>And</span> <span
  m=''1006430''>then</span> <span m=''1006700''>the</span> <span m=''1006900''>PPU</span>
  <span m=''1007310''>waits</span> <span m=''1007700''>for</span> <span m=''1007930''>each</span>
  <span m=''1008130''>SPU</span> <span m=''1008490''>to</span> <span m=''1008600''>finish.</span>
  <span m=''1009370''>And</span> <span m=''1009540''>then</span> <span m=''1011190''>once</span>
  <span m=''1011560''>the</span> <span m=''1011670''>SPU</span> <span m=''1011900''>is</span>
  <span m=''1012030''>finished,</span> <span m=''1012320''>the</span> <span m=''1012410''>forces</span>
  <span m=''1012750''>are</span> <span m=''1012870''>added</span> <span m=''1013640''>to</span>
  <span m=''1014320''>the</span> <span m=''1014420''>two</span> <span m=''1014630''>atoms</span>
  <span m=''1015000''>that</span> <span m=''1015260''>are</span> <span m=''1015430''>involved</span>
  <span m=''1015720''>in</span> <span m=''1015770''>that</span> <span m=''1015960''>force</span>
  <span m=''1016160''>computation.</span> <span m=''1019100''>And</span> <span m=''1019260''>then</span>
  <span m=''1019400''>this</span> <span m=''1019610''>loop</span> <span m=''1019770''>is</span>
  <span m=''1019940''>done</span> <span m=''1020230''>once</span> <span m=''1020640''>all</span>
  <span m=''1020690''>the SPUs</span> <span m=''1021030''>are</span> <span m=''1021310''>finished.</span>
  <span m=''1022250''>And</span> <span m=''1022330''>then</span> <span m=''1022650''>it</span>
  <span m=''1022760''>goes,</span> <span m=''1023070''>in</span> <span m=''1023200''>this</span>
  <span m=''1023380''>repeats</span> <span m=''1023740''>until</span> <span m=''1024210''>there</span>
  <span m=''1024369''>is</span> <span m=''1025359''>non-bonded</span> <span m=''1025839''>operations</span>
  <span m=''1026270''>remaining.</span> <span m=''1026700''>So</span> <span m=''1026920''>for</span>
  <span m=''1027040''>example</span> <span m=''1027390''>here,</span> <span m=''1028720''>just</span>
  <span m=''1028940''>to</span> <span m=''1028980''>illustrate</span> <span m=''1029369''>this,</span>
  <span m=''1029640''>let''s</span> <span m=''1029859''>say</span> <span m=''1029970''>these</span>
  <span m=''1030150''>are</span> <span m=''1030230''>all</span> <span m=''1030329''>the</span>
  <span m=''1030579''>non-bonded</span> <span m=''1031119''>operations</span> <span
  m=''1031630''>I</span> <span m=''1031720''>have</span> <span m=''1031990''>to</span>
  <span m=''1032109''>do.</span> <span m=''1032800''>And</span> <span m=''1033230''>I''m</span>
  <span m=''1033319''>going</span> <span m=''1033480''>to</span> <span m=''1033540''>use</span>
  <span m=''1033829''>two</span> <span m=''1034140''>SPUs.</span> <span m=''1035310''>And</span>
  <span m=''1035490''>each SPU</span> <span m=''1035970''>can</span> <span m=''1036130''>only</span>
  <span m=''1036329''>store,</span> <span m=''1036990''>say</span> <span m=''1037240''>three</span>
  <span m=''1037549''>force</span> <span m=''1037859''>operations.</span> </p><p><span
  m=''1040890''>So</span> <span m=''1041200''>each</span> <span m=''1041460''>SPU</span>
  <span m=''1041560''>is</span> <span m=''1041740''>sent</span> <span m=''1042130''>by</span>
  <span m=''1042349''>a</span> <span m=''1042420''>block.</span> <span m=''1042730''>I</span>
  <span m=''1042790''>mean</span> <span m=''1042970''>that,</span> <span m=''1043339''>say</span>
  <span m=''1043599''>these</span> <span m=''1043869''>three</span> <span m=''1044089''>operations</span>
  <span m=''1044520''>are</span> <span m=''1044650''>sent</span> <span m=''1044920''>to</span>
  <span m=''1045000''>each</span> <span m=''1045160''>SPU.</span> <span m=''1045435''>The</span>
  <span m=''1045710''>SPU</span> <span m=''1046040''>does</span> <span m=''1046280''>them.</span>
  <span m=''1048560''>The</span> <span m=''1048680''>next</span> <span m=''1048920''>block</span>
  <span m=''1049330''>is</span> <span m=''1049930''>sent</span> <span m=''1050180''>to</span>
  <span m=''1050250''>the</span> <span m=''1050350''>next</span> <span m=''1050630''>SPU</span>
  <span m=''1051040''>at</span> <span m=''1051120''>the</span> <span m=''1051220''>same</span>
  <span m=''1051460''>time,</span> <span m=''1051720''>and</span> <span m=''1051800''>then</span>
  <span m=''1052100''>that</span> <span m=''1052270''>SPU</span> <span m=''1052630''>also</span>
  <span m=''1052850''>does</span> <span m=''1053090''>it.</span> <span m=''1053510''>And</span>
  <span m=''1053630''>this</span> <span m=''1053810''>is</span> <span m=''1054060''>iteration</span>
  <span m=''1054580''>0</span> <span m=''1054940''>for</span> <span m=''1055100''>example.</span>
  <span m=''1056040''>And</span> <span m=''1056190''>this</span> <span m=''1056360''>is</span>
  <span m=''1056530''>done</span> <span m=''1056820''>until</span> <span m=''1057600''>all</span>
  <span m=''1057770''>of</span> <span m=''1057920''>the</span> <span m=''1058000''>force</span>
  <span m=''1058250''>computations</span> <span m=''1058860''>are</span> <span m=''1058960''>done.</span>
  <span m=''1060500''>So</span> <span m=''1060820''>here''s</span> <span m=''1061120''>a</span>
  <span m=''1061210''>timing.</span> <span m=''1061590''>So</span> <span m=''1062520''>you</span>
  <span m=''1062650''>might</span> <span m=''1062830''>imagine</span> <span m=''1063190''>that,</span>
  <span m=''1064200''>as</span> <span m=''1064340''>I</span> <span m=''1064430''>said,</span>
  <span m=''1064680''>there is</span> <span m=''1068096''>there is</span> <span m=''1068590''>a</span>
  <span m=''1068620''>lot</span> <span m=''1068760''>of</span> <span m=''1068870''>communication</span>
  <span m=''1069540''>overhead</span> <span m=''1069930''>over</span> <span m=''1070090''>here.</span>
  </p><p><span m=''1072410''>So</span> <span m=''1073260''>here''s</span> <span m=''1073490''>how</span>
  <span m=''1073620''>this</span> <span m=''1073840''>performs.</span> <span m=''1075360''>So</span>
  <span m=''1075980''>on</span> <span m=''1076120''>the</span> <span m=''1076230''>PPU,</span>
  <span m=''1078770''>the MD</span> <span m=''1079400''>simulation</span> <span m=''1080270''>per</span>
  <span m=''1080460''>time step,</span> <span m=''1081080''>runs</span> <span m=''1081280''>in</span>
  <span m=''1081430''>310</span> <span m=''1082360''>milliseconds.</span> <span m=''1084320''>On</span>
  <span m=''1084470''>one</span> <span m=''1084680''>SPU,</span> <span m=''1086120''>the</span>
  <span m=''1086220''>time</span> <span m=''1086470''>was</span> <span m=''1086640''>up</span>
  <span m=''1086760''>to</span> <span m=''1086870''>630</span> <span m=''1088900''>milliseconds.</span>
  <span m=''1089580''>So</span> <span m=''1089770''>there is</span> <span m=''1090020''>a</span>
  <span m=''1090070''>lot</span> <span m=''1090260''>of</span> <span m=''1090700''>communication</span>
  <span m=''1091240''>overhead</span> <span m=''1091630''>here.</span> <span m=''1092350''>On  two</span>
  <span m=''1092650''>SPUs</span> <span m=''1093100''>it</span> <span m=''1093180''>goes</span>
  <span m=''1093410''>back</span> <span m=''1093680''>down</span> <span m=''1094510''>to</span>
  <span m=''1094720''>390.</span> <span m=''1095400''>And</span> <span m=''1096130''>as</span>
  <span m=''1096360''>the</span> <span m=''1096450''>number</span> <span m=''1096740''>of</span>
  <span m=''1096820''>SPUs</span> <span m=''1097060''>is</span> <span m=''1097200''>increased,</span>
  <span m=''1098560''>it</span> <span m=''1098730''>gets</span> <span m=''1098960''>lower</span>
  <span m=''1099210''>and</span> <span m=''1099290''>lower.</span> <span m=''1099620''>But</span>
  <span m=''1101240''>it''s</span> <span m=''1101470''>not</span> <span m=''1101650''>that</span>
  <span m=''1101760''>much</span> <span m=''1101960''>better</span> <span m=''1102150''>than</span>
  <span m=''1102310''>really</span> <span m=''1102530''>running</span> <span m=''1102850''>it</span>
  <span m=''1103310''>sequentially.</span> <span m=''1104400''>And</span> <span m=''1104590''>the</span>
  <span m=''1104670''>reason</span> <span m=''1104980''>is</span> <span m=''1105120''>that</span>
  <span m=''1105470''>the</span> <span m=''1105560''>way I</span> <span m=''1105790''>implemented</span>
  <span m=''1106715''>is</span> <span m=''1107070''>pretty</span> <span m=''1107280''>rough.</span>
  </p><p><span m=''1108120''>One</span> <span m=''1108370''>of</span> <span m=''1108480''>the</span>
  <span m=''1108670''>limitations,</span> <span m=''1109720''>I</span> <span m=''1109850''>mean</span>
  <span m=''1110030''>one</span> <span m=''1110730''>very</span> <span m=''1111010''>obvious</span>
  <span m=''1111300''>optimization</span> <span m=''1112130''>that</span> <span m=''1112340''>should</span>
  <span m=''1112540''>be</span> <span m=''1112670''>done</span> <span m=''1112930''>is</span>
  <span m=''1113680''>that</span> <span m=''1115230''>SPU</span> <span m=''1115810''>basically</span>
  <span m=''1116190''>waits</span> <span m=''1116460''>for</span> <span m=''1116570''>this</span>
  <span m=''1116760''>whole</span> <span m=''1116930''>block</span> <span m=''1117330''>to</span>
  <span m=''1117830''>arrive,</span> <span m=''1118350''>and</span> <span m=''1118470''>then</span>
  <span m=''1118580''>starts</span> <span m=''1118860''>computation.</span> <span
  m=''1119660''>But</span> <span m=''1119720''>really</span> <span m=''1120350''>what</span>
  <span m=''1120520''>I</span> <span m=''1120570''>should</span> <span m=''1120730''>have</span>
  <span m=''1120850''>done</span> <span m=''1121040''>is</span> <span m=''1124670''>once</span>
  <span m=''1125030''>one</span> <span m=''1125350''>force</span> <span m=''1125640''>computation</span>
  <span m=''1126310''>arrives,</span> <span m=''1127090''>you</span> <span m=''1127250''>can</span>
  <span m=''1127420''>already</span> <span m=''1127730''>do</span> <span m=''1127820''>that</span>
  <span m=''1128030''>computation.</span> <span m=''1130080''>Instead</span> <span
  m=''1130360''>of</span> <span m=''1130430''>waiting</span> <span m=''1130700''>for</span>
  <span m=''1130930''>all</span> <span m=''1131080''>of</span> <span m=''1131160''>them</span>
  <span m=''1131640''>to</span> <span m=''1131720''>be</span> <span m=''1131840''>transferred</span>
  <span m=''1132320''>and</span> <span m=''1132420''>then</span> <span m=''1132550''>starting</span>
  <span m=''1132880''>to do</span> <span m=''1132980''>the</span> <span m=''1133190''>operation.</span>
  <span m=''1133690''>So</span> <span m=''1133790''>that</span> <span m=''1133910''>I</span>
  <span m=''1133970''>think</span> <span m=''1134190''>that</span> <span m=''1134380''>could''ve</span>
  <span m=''1134900''>been</span> <span m=''1135910''>a</span> <span m=''1136020''>lot</span>
  <span m=''1136220''>better.</span> </p><p><span m=''1136540''>AUDIENCE: [INAUDIBLE]</span>
  </p><p><span m=''1137534''>GREG PINTILIE: No.</span> </p><p><span m=''1138031''>AUDIENCE:
  [INAUDIBLE]</span> </p><p><span m=''1143510''>GREG PINTILIE: No.</span> <span m=''1146790''>So</span>
  <span m=''1149040''>right,</span> <span m=''1149240''>so</span> <span m=''1149830''>this</span>
  <span m=''1150330''>is</span> <span m=''1150440''>sort</span> <span m=''1150590''>of</span>
  <span m=''1150660''>the</span> <span m=''1150750''>simplest</span> <span m=''1151120''>approach,</span>
  <span m=''1151830''>I</span> <span m=''1152200''>mean</span> <span m=''1152990''>sort</span>
  <span m=''1153160''>of</span> <span m=''1153410''>a</span> <span m=''1153550''>simple</span>
  <span m=''1153810''>approach</span> <span m=''1154110''>to</span> <span m=''1154200''>implement</span>
  <span m=''1154670''>on</span> <span m=''1154810''>this</span> <span m=''1154980''>architecture.</span>
  <span m=''1155620''>And</span> <span m=''1155730''>it</span> <span m=''1155780''>sort</span>
  <span m=''1155930''>of</span> <span m=''1156020''>scales</span> <span m=''1156340''>well</span>
  <span m=''1156680''>as</span> <span m=''1156850''>the</span> <span m=''1156930''>system</span>
  <span m=''1157300''>grows.</span> <span m=''1158120''>So</span> <span m=''1158280''>if</span>
  <span m=''1158450''>you</span> <span m=''1158540''>can''t</span> <span m=''1158740''>store</span>
  <span m=''1159180''>every</span> <span m=''1159480''>item,</span> <span m=''1159690''>for</span>
  <span m=''1159830''>example,</span> <span m=''1160250''>in</span> <span m=''1160350''>every</span>
  <span m=''1160700''>SPU,</span> <span m=''1163060''>this</span> <span m=''1163540''>doesn''t</span>
  <span m=''1163780''>really</span> <span m=''1164690''>care.</span> <span m=''1165660''>The</span>
  <span m=''1165960''>system</span> <span m=''1166420''>can</span> <span m=''1166580''>grow</span>
  <span m=''1166770''>as</span> <span m=''1166900''>large</span> <span m=''1167170''>as</span>
  <span m=''1167260''>you</span> <span m=''1167380''>want.</span> <span m=''1168690''>There''s</span>
  <span m=''1168830''>some</span> <span m=''1168970''>other</span> <span m=''1169150''>approaches</span>
  <span m=''1169530''>that</span> <span m=''1169680''>are</span> <span m=''1169760''>done</span>
  <span m=''1170310''>sort of</span> <span m=''1170590''>in</span> <span m=''1170660''>the</span>
  <span m=''1170750''>literature.</span> <span m=''1171270''>I</span> <span m=''1171470''>didn''t</span>
  <span m=''1171830''>implement</span> <span m=''1172300''>these,</span> <span m=''1172870''>but</span>
  <span m=''1173640''>another</span> <span m=''1173930''>one</span> <span m=''1174070''>is</span>
  <span m=''1174190''>called</span> <span m=''1174370''>atomic</span> <span m=''1174780''>decomposition.</span>
  </p><p><span m=''1175410''>So</span> <span m=''1175580''>here,</span> <span m=''1175880''>if</span>
  <span m=''1176070''>you</span> <span m=''1176140''>have,</span> <span m=''1176360''>say</span>
  <span m=''1176510''>a</span> <span m=''1176530''>number</span> <span m=''1176760''>of</span>
  <span m=''1176830''>atoms,</span> <span m=''1177570''>you</span> <span m=''1177700''>send</span>
  <span m=''1178060''>each</span> <span m=''1178220''>one</span> <span m=''1178360''>of</span>
  <span m=''1178410''>these</span> <span m=''1178560''>atoms</span> <span m=''1178900''>to</span>
  <span m=''1180170''>one</span> <span m=''1180440''>SPU.</span> <span m=''1181140''>And</span>
  <span m=''1181320''>then</span> <span m=''1181530''>that</span> <span m=''1181700''>SPU</span>
  <span m=''1182040''>is</span> <span m=''1182370''>solely</span> <span m=''1182710''>responsible</span>
  <span m=''1183460''>for</span> <span m=''1185040''>computing</span> <span m=''1185370''>the</span>
  <span m=''1185470''>forces</span> <span m=''1185880''>on</span> <span m=''1186060''>it,</span>
  <span m=''1187180''>and</span> <span m=''1187440''>also</span> <span m=''1187730''>integrating</span>
  <span m=''1189250''>to</span> <span m=''1189370''>get</span> <span m=''1189550''>the</span>
  <span m=''1189620''>new</span> <span m=''1189750''>positions.</span> <span m=''1190550''>And</span>
  <span m=''1190680''>then</span> <span m=''1191030''>all</span> <span m=''1191220''>you</span>
  <span m=''1191290''>have</span> <span m=''1191460''>to</span> <span m=''1191560''>communicate</span>
  <span m=''1192060''>is</span> <span m=''1192180''>the</span> <span m=''1192300''>atomic</span>
  <span m=''1192740''>positions.</span> <span m=''1193630''>But</span> <span m=''1193760''>this</span>
  <span m=''1194110''>is</span> <span m=''1194250''>a</span> <span m=''1194310''>little</span>
  <span m=''1194410''>bit</span> <span m=''1194520''>more</span> <span m=''1194680''>complicated,</span>
  <span m=''1195220''>because</span> <span m=''1196200''>then</span> <span m=''1198630''>every</span>
  <span m=''1199500''>SPU</span> <span m=''1200010''>has</span> <span m=''1200210''>to</span>
  <span m=''1200300''>know</span> <span m=''1200500''>about</span> <span m=''1200850''>all</span>
  <span m=''1201060''>of</span> <span m=''1201190''>the</span> <span m=''1201310''>force</span>
  <span m=''1202040''>computations</span> <span m=''1202670''>that</span> <span m=''1203100''>you</span>
  <span m=''1203550''>want</span> <span m=''1203850''>to</span> <span m=''1203920''>do.</span>
  <span m=''1204190''>So</span> <span m=''1204350''>for</span> <span m=''1204470''>example,</span>
  <span m=''1204900''>in</span> <span m=''1205000''>this</span> <span m=''1205010''>case</span>
  <span m=''1205190''>it''s</span> <span m=''1205280''>just</span> <span m=''1205470''>a</span>
  <span m=''1205510''>non-bonded,</span> <span m=''1206610''>but</span> <span m=''1209070''>the</span>
  <span m=''1209180''>SPU</span> <span m=''1209560''>also</span> <span m=''1209750''>has</span>
  <span m=''1209890''>to</span> <span m=''1209980''>know</span> <span m=''1210210''>about--</span>
  </p><p><span m=''1210530''>AUDIENCE: So that</span> <span m=''1211005''>would be</span>
  <span m=''1211480''>like the</span> <span m=''1211560''>same</span> <span m=''1212053''>example
  that we did in</span> <span m=''1212546''>[INAUDIBLE].</span> </p><p><span m=''1214520''>GREG
  PINTILIE: Yeah,</span> <span m=''1216580''>it</span> <span m=''1216730''>would</span>
  <span m=''1216900''>be.</span> <span m=''1219100''>Yeah,</span> <span m=''1219350''>the</span>
  <span m=''1219440''>only</span> <span m=''1219590''>problem</span> <span m=''1219770''>with</span>
  <span m=''1219870''>that</span> <span m=''1219990''>approach</span> <span m=''1220260''>is</span>
  <span m=''1220330''>that</span> <span m=''1220560''>if</span> <span m=''1220690''>the</span>
  <span m=''1220780''>system</span> <span m=''1221290''>was</span> <span m=''1221490''>much</span>
  <span m=''1221750''>larger</span> <span m=''1222060''>than</span> <span m=''1222350''>the</span>
  <span m=''1222510''>SPU</span> <span m=''1223090''>could</span> <span m=''1223220''>store,</span>
  <span m=''1224460''>and</span> <span m=''1224710''>you couldn''t</span> <span m=''1225070''>store</span>
  <span m=''1225330''>every</span> <span m=''1225550''>single</span> <span m=''1225940''>atom</span>
  <span m=''1226590''>on</span> <span m=''1226860''>the</span> <span m=''1227340''>SPU,</span>
  <span m=''1228450''>then</span> <span m=''1229940''>an</span> <span m=''1230060''>operation</span>
  <span m=''1230690''>might</span> <span m=''1231070''>refer</span> <span m=''1231590''>to</span>
  <span m=''1231780''>atoms</span> <span m=''1232180''>that</span> <span m=''1232310''>are</span>
  <span m=''1232440''>not</span> <span m=''1233990''>there.</span> <span m=''1237170''>So</span>
  <span m=''1237330''>yeah,</span> <span m=''1237600''>it</span> <span m=''1237670''>would</span>
  <span m=''1237900''>be</span> <span m=''1238070''>similar</span> <span m=''1238490''>to</span>
  <span m=''1238620''>that.</span> <span m=''1239010''>But</span> <span m=''1239220''>it</span>
  <span m=''1239480''>would</span> <span m=''1239670''>get</span> <span m=''1239850''>more</span>
  <span m=''1240000''>complicated</span> <span m=''1240450''>in</span> <span m=''1240530''>this</span>
  <span m=''1240690''>case</span> <span m=''1240980''>as</span> <span m=''1241140''>a</span>
  <span m=''1241190''>system</span> <span m=''1241550''>grew,</span> <span m=''1241820''>because</span>
  <span m=''1242160''>you''d</span> <span m=''1242270''>have</span> <span m=''1242450''>to</span>
  <span m=''1242530''>keep</span> <span m=''1242710''>track</span> <span m=''1243020''>of</span>
  <span m=''1243150''>where</span> <span m=''1243370''>each</span> <span m=''1243600''>atom</span>
  <span m=''1243900''>is</span> <span m=''1244040''>and</span> <span m=''1244170''>then</span>
  <span m=''1244650''>implement</span> <span m=''1245090''>communication.</span> <span
  m=''1245870''>If</span> <span m=''1246000''>you</span> <span m=''1246120''>don''t</span>
  <span m=''1246370''>have</span> <span m=''1246960''>a</span> <span m=''1247070''>certain</span>
  <span m=''1247410''>atom,</span> <span m=''1248120''>to</span> <span m=''1248240''>get</span>
  <span m=''1248540''>to</span> <span m=''1248700''>that</span> <span m=''1248920''>atom</span>
  <span m=''1249120''>position</span> <span m=''1249510''>and</span> <span m=''1249610''>use</span>
  <span m=''1249770''>it</span> <span m=''1249840''>in</span> <span m=''1249930''>the</span>
  <span m=''1250010''>force</span> <span m=''1250280''>computation.</span> <span m=''1252020''>So</span>
  <span m=''1252480''>yeah,</span> <span m=''1253200''>this</span> <span m=''1253390''>approach,</span>
  <span m=''1254990''>OK,</span> <span m=''1255440''>I''ll</span> <span m=''1255620''>talk</span>
  <span m=''1255840''>a</span> <span m=''1255890''>little</span> <span m=''1255990''>bit</span>
  <span m=''1256100''>more</span> <span m=''1256230''>about</span> <span m=''1256430''>this.</span>
  <span m=''1256735''>This</span> <span m=''1257040''>is</span> <span m=''1257230''>a--</span>
  </p><p><span m=''1257931''>AUDIENCE: [INAUDIBLE]</span> <span m=''1259374''>I mean</span>
  <span m=''1259855''>not</span> <span m=''1260336''>SPU,</span> <span m=''1260817''>but</span>
  <span m=''1261298''>[INAUDIBLE].</span> </p><p><span m=''1263710''>GREG PINTILIE:
  That''s</span> <span m=''1263930''>true,</span> <span m=''1264300''>yeah.</span>
  <span m=''1265360''>So</span> <span m=''1265620''>you</span> <span m=''1265830''>only</span>
  <span m=''1266040''>sort</span> <span m=''1266230''>of</span> <span m=''1266350''>give</span>
  <span m=''1266580''>a</span> <span m=''1266630''>certain</span> <span m=''1266800''>number</span>
  <span m=''1266980''>of</span> <span m=''1267060''>atoms</span> <span m=''1267340''>to</span>
  <span m=''1267430''>every</span> <span m=''1267680''>SPU,</span> <span m=''1268130''>and</span>
  <span m=''1268240''>then,</span> <span m=''1268890''>yeah.</span> <span m=''1269940''>That''s</span>
  <span m=''1270160''>true.</span> <span m=''1270360''>And</span> <span m=''1270470''>then</span>
  <span m=''1270600''>you would</span> <span m=''1270740''>have</span> <span m=''1270940''>to</span>
  <span m=''1271250''>sort of</span> <span m=''1271510''>store</span> <span m=''1271740''>every</span>
  <span m=''1271950''>single</span> <span m=''1272280''>force</span> <span m=''1272940''>that</span>
  <span m=''1273330''>that</span> <span m=''1273530''>atom</span> <span m=''1274690''>is</span>
  <span m=''1275170''>included</span> <span m=''1275680''>in</span> <span m=''1276870''>on</span>
  <span m=''1277060''>the</span> <span m=''1277200''>SPU.</span> </p><p><span m=''1277659''>AUDIENCE:
  [INAUDIBLE]</span> </p><p><span m=''1281790''>GREG PINTILIE: Yeah,</span> <span
  m=''1282910''>like</span> <span m=''1283940''>when</span> <span m=''1284200''>this</span>
  <span m=''1284340''>will</span> <span m=''1284410''>become</span> <span m=''1284690''>a</span>
  <span m=''1284780''>problem</span> <span m=''1285230''>is,</span> <span m=''1286390''>say</span>
  <span m=''1286560''>the</span> <span m=''1286680''>system</span> <span m=''1286960''>was</span>
  <span m=''1287130''>much</span> <span m=''1287370''>larger</span> <span m=''1288260''>than
  you</span> <span m=''1288550''>had</span> <span m=''1288710''>local</span> <span
  m=''1289010''>store.</span> <span m=''1289530''>Then</span> <span m=''1290760''>say</span>
  <span m=''1290980''>you</span> <span m=''1291180''>had</span> <span m=''1291630''>like</span>
  <span m=''1292290''>1/10</span> <span m=''1292620''>of</span> <span m=''1292710''>the</span>
  <span m=''1292840''>system</span> <span m=''1293280''>on</span> <span m=''1293520''>SPUs</span>
  <span m=''1294130''>and</span> <span m=''1294240''>then</span> <span m=''1294510''>9/10</span>
  <span m=''1295000''>of the</span> <span m=''1295110''>system</span> <span m=''1295420''>on</span>
  <span m=''1295490''>the</span> <span m=''1295590''>PPU.</span> </p><p><span m=''1295900''>AUDIENCE:
  [INAUDIBLE]</span> </p><p><span m=''1298610''>GREG PINTILIE: Yeah,</span> <span
  m=''1299170''>it</span> <span m=''1299240''>would</span> <span m=''1299400''>be</span>
  <span m=''1299510''>hard</span> <span m=''1299720''>to</span> <span m=''1299840''>think</span>
  <span m=''1300320''>of</span> <span m=''1300410''>it</span> <span m=''1300500''>scaling</span>
  <span m=''1300990''>properly.</span> <span m=''1304950''>So</span> <span m=''1305750''>a</span>
  <span m=''1305830''>special</span> <span m=''1306190''>case</span> <span m=''1306430''>of</span>
  <span m=''1306510''>this</span> <span m=''1306670''>atomic</span> <span m=''1307080''>decomposition</span>
  <span m=''1307640''>is</span> <span m=''1307730''>actually</span> <span m=''1307990''>spatial</span>
  <span m=''1308370''>decomposition.</span> <span m=''1309370''>OK,</span> <span m=''1309750''>I''m</span>
  <span m=''1310020''>almost</span> <span m=''1310340''>done.</span> <span m=''1311400''>So</span>
  <span m=''1311530''>a</span> <span m=''1311580''>special</span> <span m=''1311910''>case</span>
  <span m=''1312130''>of</span> <span m=''1312210''>spatial</span> <span m=''1312540''>decomposition.</span>
  <span m=''1315710''>So</span> <span m=''1315890''>what</span> <span m=''1316100''>makes</span>
  <span m=''1316320''>this</span> <span m=''1316490''>approach</span> <span m=''1316890''>sort</span>
  <span m=''1317160''>of</span> <span m=''1317870''>not</span> <span m=''1318270''>good,</span>
  <span m=''1318510''>and</span> <span m=''1318860''>it</span> <span m=''1319050''>sort</span>
  <span m=''1319200''>of</span> <span m=''1320150''>involves</span> <span m=''1320550''>a</span>
  <span m=''1320600''>lot</span> <span m=''1320750''>of</span> <span m=''1320810''>communication,</span>
  <span m=''1321510''>is</span> <span m=''1321700''>just</span> <span m=''1321920''>this</span>
  <span m=''1322170''>fact</span> <span m=''1322520''>that</span> <span m=''1323170''>some</span>
  <span m=''1323400''>of</span> <span m=''1323550''>these</span> <span m=''1323750''>force</span>
  <span m=''1324180''>computations,</span> <span m=''1324920''>or</span> <span m=''1325030''>force</span>
  <span m=''1325310''>operations</span> <span m=''1325720''>that</span> <span m=''1325870''>you</span>
  <span m=''1325960''>have</span> <span m=''1326225''>could</span> <span m=''1326490''>include</span>
  <span m=''1326830''>atoms</span> <span m=''1327130''>on</span> <span m=''1327240''>different</span>
  <span m=''1327530''>units.</span> <span m=''1328320''>So</span> <span m=''1328380''>if</span>
  <span m=''1328470''>you</span> <span m=''1328550''>don''t</span> <span m=''1328730''>split</span>
  <span m=''1328940''>up</span> <span m=''1329090''>these</span> <span m=''1329260''>atoms</span>
  <span m=''1330100''>sort</span> <span m=''1330280''>of</span> <span m=''1330420''>smartly,</span>
  <span m=''1331130''>then</span> <span m=''1331270''>you</span> <span m=''1331360''>could</span>
  <span m=''1331500''>end</span> <span m=''1331630''>up</span> <span m=''1332360''>having</span>
  <span m=''1332610''>to</span> <span m=''1332700''>communicate</span> <span m=''1333200''>a</span>
  <span m=''1333250''>lot</span> <span m=''1333900''>while</span> <span m=''1334090''>computing
  these</span> <span m=''1334520''>forces.</span> </p><p><span m=''1335330''>So</span>
  <span m=''1335450''>spatial</span> <span m=''1335870''>decomposition</span> <span
  m=''1336390''>tries</span> <span m=''1336650''>to</span> <span m=''1336760''>address</span>
  <span m=''1337150''>this.</span> <span m=''1337410''>And</span> <span m=''1337600''>basically,</span>
  <span m=''1338080''>you</span> <span m=''1338190''>store</span> <span m=''1340130''>atoms</span>
  <span m=''1340520''>that</span> <span m=''1340630''>are</span> <span m=''1340750''>close</span>
  <span m=''1341060''>to</span> <span m=''1341140''>each</span> <span m=''1341340''>other.</span>
  <span m=''1341590''>So</span> <span m=''1341720''>say</span> <span m=''1342150''>I</span>
  <span m=''1342270''>had</span> <span m=''1342460''>the</span> <span m=''1342550''>system,</span>
  <span m=''1343380''>and</span> <span m=''1343570''>I</span> <span m=''1343600''>wanted</span>
  <span m=''1343850''>to</span> <span m=''1343920''>split</span> <span m=''1344200''>this</span>
  <span m=''1344370''>up</span> <span m=''1345830''>on</span> <span m=''1346000''>six</span>
  <span m=''1346270''>SPUs,</span> <span m=''1347270''>then</span> <span m=''1349390''>right,</span>
  <span m=''1349600''>I</span> <span m=''1349640''>would</span> <span m=''1349810''>give</span>
  <span m=''1349960''>each  SPU,</span> <span m=''1350315''>say</span> <span m=''1350880''>a</span>
  <span m=''1350970''>certain</span> <span m=''1351380''>area</span> <span m=''1351570''>of</span>
  <span m=''1351630''>space.</span> <span m=''1352010''>But</span> <span m=''1352500''>you</span>
  <span m=''1352640''>could</span> <span m=''1352900''>see</span> <span m=''1353090''>right</span>
  <span m=''1353250''>away</span> <span m=''1353430''>what</span> <span m=''1353590''>the</span>
  <span m=''1353670''>problem</span> <span m=''1353910''>with</span> <span m=''1354060''>this  is</span>
  <span m=''1354250''>is</span> <span m=''1354580''>that</span> <span m=''1354840''>it''s</span>
  <span m=''1355060''>not</span> <span m=''1355360''>load</span> <span m=''1355600''>balanced.</span>
  <span m=''1356010''>So some</span> <span m=''1356230''>SPUs</span> <span m=''1357346''>could</span>
  <span m=''1357690''>not</span> <span m=''1357870''>have</span> <span m=''1358030''>too</span>
  <span m=''1358120''>much</span> <span m=''1358310''>work</span> <span m=''1358490''>to</span>
  <span m=''1358600''>do.</span> <span m=''1360190''>And</span> <span m=''1360340''>there''s</span>
  <span m=''1360480''>still</span> <span m=''1360620''>some</span> <span m=''1360770''>communication,</span>
  <span m=''1361470''>because</span> <span m=''1361730''>you</span> <span m=''1361790''>have</span>
  <span m=''1361920''>to</span> <span m=''1362010''>communicate</span> <span m=''1362560''>between</span>
  <span m=''1364080''>neighboring</span> <span m=''1364590''>SPUs,</span> <span m=''1365060''>say</span>
  <span m=''1365390''>some</span> <span m=''1365650''>certain</span> <span m=''1365930''>cases.</span>
  </p><p><span m=''1366770''>But</span> <span m=''1367150''>the</span> <span m=''1367280''>communication</span>
  <span m=''1367810''>is</span> <span m=''1367890''>still</span> <span m=''1368290''>probably</span>
  <span m=''1368620''>a</span> <span m=''1368670''>lot</span> <span m=''1368890''>better</span>
  <span m=''1370072''>than in</span> <span m=''1370530''>the</span> <span m=''1370640''>previous</span>
  <span m=''1371080''>case,</span> <span m=''1371280''>just</span> <span m=''1371450''>for</span>
  <span m=''1371540''>atomic</span> <span m=''1371910''>decomposition.</span> <span
  m=''1375230''>So</span> <span m=''1375370''>here''s</span> <span m=''1375590''>the</span>
  <span m=''1375650''>state</span> <span m=''1375840''>of</span> <span m=''1375950''>the</span>
  <span m=''1376080''>art</span> <span m=''1377216''>on</span> <span m=''1377690''>parallelization</span>
  <span m=''1378410''>MD.</span> <span m=''1378910''>And</span> <span m=''1379190''>it''s</span>
  <span m=''1379470''>implemented</span> <span m=''1379970''>in</span> <span m=''1380070''>this</span>
  <span m=''1380490''>program</span> <span m=''1381060''>called</span> <span m=''1381260''>NAMD,</span>
  <span m=''1382240''>which</span> <span m=''1382440''>stands</span> <span m=''1382740''>for</span>
  <span m=''1383660''>Not</span> <span m=''1383860''>Another</span> <span m=''1384500''>Molecular</span>
  <span m=''1384870''>Dynamics</span> <span m=''1385340''>simulator.</span> <span
  m=''1386600''>So</span> <span m=''1388400''>initially,</span> <span m=''1389100''>NAMD</span>
  <span m=''1389520''>1.0</span> <span m=''1390840''>used</span> <span m=''1391110''>solely</span>
  <span m=''1391550''>a spatial</span> <span m=''1392020''>decomposition.</span> <span
  m=''1392630''>And</span> <span m=''1392710''>they</span> <span m=''1392790''>try</span>
  <span m=''1392960''>to</span> <span m=''1393090''>address</span> <span m=''1393400''>this</span>
  <span m=''1393580''>load</span> <span m=''1393760''>balancing</span> <span m=''1394540''>by</span>
  <span m=''1394710''>actually</span> <span m=''1394940''>creating</span> <span m=''1395390''>many</span>
  <span m=''1395640''>more</span> <span m=''1395820''>patches</span> <span m=''1396290''>than</span>
  <span m=''1396360''>you</span> <span m=''1396430''>have</span> <span m=''1396570''>processors.</span>
  <span m=''1398870''>And</span> <span m=''1399040''>then</span> <span m=''1399180''>you</span>
  <span m=''1399270''>just</span> <span m=''1399490''>sort</span> <span m=''1399690''>of</span>
  <span m=''1399980''>split</span> <span m=''1400500''>these</span> <span m=''1400710''>patches</span>
  <span m=''1401150''>up,</span> <span m=''1402260''>load</span> <span m=''1402500''>balance</span>
  <span m=''1402790''>them</span> <span m=''1403070''>amongst</span> <span m=''1403340''>the</span>
  <span m=''1403390''>different</span> <span m=''1403650''>processors.</span> </p><p><span
  m=''1404770''>That</span> <span m=''1405000''>didn''t</span> <span m=''1405140''>really</span>
  <span m=''1405350''>work.</span> <span m=''1405650''>So</span> <span m=''1405750''>NAMD</span>
  <span m=''1406060''>1</span> <span m=''1406520''>didn''t</span> <span m=''1406800''>parallelize</span>
  <span m=''1407290''>very</span> <span m=''1407500''>well.</span> <span m=''1408100''>So</span>
  <span m=''1408280''>what</span> <span m=''1408470''>they</span> <span m=''1408590''>added</span>
  <span m=''1408880''>later</span> <span m=''1409270''>was</span> <span m=''1410250''>they</span>
  <span m=''1410580''>added</span> <span m=''1410830''>this</span> <span m=''1411010''>idea</span>
  <span m=''1411460''>of</span> <span m=''1412270''>patch</span> <span m=''1412550''>objects,</span>
  <span m=''1413130''>and</span> <span m=''1413250''>also</span> <span m=''1413520''>compute</span>
  <span m=''1413970''>objects.</span> <span m=''1414610''>So</span> <span m=''1414850''>basically</span>
  <span m=''1415400''>a</span> <span m=''1415470''>patch</span> <span m=''1415790''>object</span>
  <span m=''1418260''>puts</span> <span m=''1418430''>a</span> <span m=''1418460''>number</span>
  <span m=''1418710''>of</span> <span m=''1418790''>patches</span> <span m=''1419140''>on</span>
  <span m=''1419230''>a</span> <span m=''1419310''>processor,</span> <span m=''1420020''>but</span>
  <span m=''1420200''>then you can</span> <span m=''1420420''>also</span> <span m=''1420690''>create</span>
  <span m=''1420990''>compute</span> <span m=''1421340''>patches,</span> <span m=''1422110''>which</span>
  <span m=''1423010''>include</span> <span m=''1423550''>all</span> <span m=''1423680''>of</span>
  <span m=''1423780''>these</span> <span m=''1424000''>force</span> <span m=''1424290''>operations.</span>
  <span m=''1425450''>And</span> <span m=''1425720''>these</span> <span m=''1425910''>force</span>
  <span m=''1426060''>operations are</span> <span m=''1426520''>also</span> <span
  m=''1426880''>equally</span> <span m=''1427220''>distributed</span> <span m=''1427760''>amongst</span>
  <span m=''1428040''>processors.</span> <span m=''1428990''>And</span> <span m=''1429110''>then</span>
  <span m=''1429200''>there''s</span> <span m=''1429370''>a</span> <span m=''1429410''>lot</span>
  <span m=''1429540''>communication</span> <span m=''1430180''>between</span> <span
  m=''1430520''>these</span> <span m=''1430760''>two.</span> </p><p><span m=''1431030''>And
  it</span> <span m=''1431500''>started</span> <span m=''1431940''>off</span> <span
  m=''1432120''>with</span> <span m=''1432260''>sort</span> <span m=''1434790''>message</span>
  <span m=''1435150''>oriented</span> <span m=''1435640''>communication.</span> <span
  m=''1436410''>Then</span> <span m=''1436650''>it</span> <span m=''1436780''>moved</span>
  <span m=''1437010''>to</span> <span m=''1437230''>a</span> <span m=''1437360''>dependency</span>
  <span m=''1437970''>oriented</span> <span m=''1438220''>communication</span> <span
  m=''1439330''>so</span> <span m=''1439440''>that</span> <span m=''1439660''>each</span>
  <span m=''1439930''>compute</span> <span m=''1440950''>object</span> <span m=''1441490''>would</span>
  <span m=''1441640''>sort</span> <span m=''1441810''>of</span> <span m=''1441890''>signal</span>
  <span m=''1442560''>which</span> <span m=''1442840''>atoms</span> <span m=''1443160''>it</span>
  <span m=''1443280''>needs.</span> <span m=''1445760''>And</span> <span m=''1446130''>it</span>
  <span m=''1446190''>also</span> <span m=''1446460''>sort</span> <span m=''1446630''>of</span>
  <span m=''1446760''>optimized</span> <span m=''1447240''>things</span> <span m=''1449306''>by</span>
  <span m=''1449750''>doing</span> <span m=''1450060''>communication</span> <span
  m=''1450870''>and</span> <span m=''1451350''>force</span> <span m=''1451650''>computation</span>
  <span m=''1451925''>at</span> <span m=''1452200''>the</span> <span m=''1452260''>same</span>
  <span m=''1452510''>time.</span> <span m=''1452770''>So it did</span> <span m=''1452970''>that</span>
  <span m=''1453180''>really</span> <span m=''1453410''>well.</span> <span m=''1454160''>And</span>
  <span m=''1454310''>actually</span> <span m=''1455070''>it</span> <span m=''1455430''>had</span>
  <span m=''1455680''>really</span> <span m=''1455890''>good</span> <span m=''1456050''>parallel</span>
  <span m=''1456460''>performance.</span> <span m=''1457170''>So</span> <span m=''1457700''>on</span>
  <span m=''1457820''>this</span> <span m=''1458000''>graph it</span> <span m=''1458400''>shows</span>
  <span m=''1459830''>the</span> <span m=''1460610''>number</span> <span m=''1460880''>of</span>
  <span m=''1460950''>processors</span> <span m=''1461450''>times</span> <span m=''1461800''>the</span>
  <span m=''1462000''>time</span> <span m=''1462270''>per</span> <span m=''1462410''>time</span>
  <span m=''1462680''>step.</span> <span m=''1463560''>And</span> <span m=''1463900''>as</span>
  <span m=''1464720''>the</span> <span m=''1464820''>number</span> <span m=''1465050''>of</span>
  <span m=''1465110''>processors</span> <span m=''1465850''>is</span> <span m=''1466000''>increased,</span>
  <span m=''1468800''>I</span> <span m=''1468900''>mean</span> <span m=''1469090''>optimal</span>
  <span m=''1469510''>parallel</span> <span m=''1469810''>performance</span> <span
  m=''1470290''>would</span> <span m=''1470390''>be</span> <span m=''1470560''>a</span>
  <span m=''1471000''>straight</span> <span m=''1471300''>horizontal</span> <span
  m=''1471820''>line,</span> <span m=''1472190''>which</span> <span m=''1472600''>is</span>
  <span m=''1472830''>pretty</span> <span m=''1473040''>close</span> <span m=''1473310''>to</span>
  <span m=''1473390''>what</span> <span m=''1473550''>they</span> <span m=''1473660''>achieve.</span>
  </p><p><span m=''1474520''>And</span> <span m=''1474620''>they</span> <span m=''1474680''>also</span>
  <span m=''1474870''>did it</span> <span m=''1475140''>on</span> <span m=''1475360''>many</span>
  <span m=''1475650''>thousands</span> <span m=''1476020''>of</span> <span m=''1476110''>processors</span>
  <span m=''1476830''>on</span> <span m=''1477010''>Blue</span> <span m=''1477230''>Gene.</span>
  <span m=''1477520''>But</span> <span m=''1478290''>as</span> <span m=''1478490''>you</span>
  <span m=''1478590''>might</span> <span m=''1478750''>expect,</span> <span m=''1479200''>the</span>
  <span m=''1479270''>more</span> <span m=''1479470''>processors</span> <span m=''1480080''>you</span>
  <span m=''1480090''>add,</span> <span m=''1480910''>the</span> <span m=''1481270''>step</span>
  <span m=''1481690''>time</span> <span m=''1482200''>actually</span> <span m=''1482540''>still</span>
  <span m=''1482960''>sort</span> <span m=''1483140''>of</span> <span m=''1483910''>levels</span>
  <span m=''1484310''>off</span> <span m=''1484600''>at</span> <span m=''1484890''>a</span>
  <span m=''1484990''>certain</span> <span m=''1485230''>time.</span> <span m=''1486290''>So</span>
  <span m=''1487310''>I</span> <span m=''1487420''>guess</span> <span m=''1487770''>I''ll</span>
  <span m=''1488020''>skip</span> <span m=''1488950''>the</span> <span m=''1489360''>sort</span>
  <span m=''1489560''>of</span> <span m=''1489940''>live</span> <span m=''1490400''>demo
  I was</span> <span m=''1490730''>going to</span> <span m=''1490870''>do,</span>
  <span m=''1491010''>but</span> <span m=''1491160''>I''ll</span> <span m=''1491280''>just</span>
  <span m=''1491450''>show</span> <span m=''1491620''>one</span> <span m=''1491800''>more</span>
  <span m=''1491940''>thing.</span> <span m=''1495930''>So</span> <span m=''1496120''>here</span>
  <span m=''1496380''>is</span> <span m=''1496470''>sort</span> <span m=''1496630''>of</span>
  <span m=''1496720''>the</span> <span m=''1497110''>kind</span> <span m=''1497270''>of</span>
  <span m=''1497340''>systems</span> <span m=''1497710''>that</span> <span m=''1497830''>I</span>
  <span m=''1497910''>was</span> <span m=''1499180''>looking</span> <span m=''1499600''>at.</span>
  <span m=''1500580''>This</span> <span m=''1500820''>is</span> <span m=''1500930''>actually
  a</span> <span m=''1501150''>simulation</span> <span m=''1501630''>that</span> <span
  m=''1501910''>was</span> <span m=''1502360''>done</span> <span m=''1502600''>on</span>
  <span m=''1502940''>one</span> <span m=''1503130''>of</span> <span m=''1503240''>the</span>
  <span m=''1504150''>PPUs</span> <span m=''1504770''>and</span> <span m=''1504900''>then</span>
  <span m=''1505010''>recorded</span> <span m=''1505560''>in</span> <span m=''1505670''>positions</span>
  <span m=''1506240''>file.</span> <span m=''1507060''>And</span> <span m=''1509880''>there</span>
  <span m=''1510070''>is</span> <span m=''1510220''>five</span> <span m=''1510500''>different</span>
  <span m=''1510950''>molecules</span> <span m=''1511600''>here.</span> </p><p><span
  m=''1513610''>So</span> <span m=''1513870''>generally,</span> <span m=''1514270''>what</span>
  <span m=''1514310''>happens</span> <span m=''1514650''>is</span> <span m=''1514820''>first</span>
  <span m=''1515190''>they''re</span> <span m=''1515440''>just</span> <span m=''1515640''>placed</span>
  <span m=''1515910''>randomly.</span> <span m=''1516460''>Then</span> <span m=''1516660''>they''re</span>
  <span m=''1517070''>an</span> <span m=''1517250''>overlap</span> <span m=''1517800''>just</span>
  <span m=''1518080''>very</span> <span m=''1518330''>coarsely,</span> <span m=''1518700''>to</span>
  <span m=''1518810''>make</span> <span m=''1518950''>sure</span> <span m=''1519080''>that</span>
  <span m=''1521390''>huge</span> <span m=''1521640''>forces</span> <span m=''1522020''>are</span>
  <span m=''1522150''>not</span> <span m=''1522360''>entered into</span> <span m=''1522650''>the</span>
  <span m=''1522780''>system.</span> <span m=''1523850''>And</span> <span m=''1524020''>I''ll</span>
  <span m=''1524150''>just</span> <span m=''1524330''>color</span> <span m=''1524540''>each</span>
  <span m=''1524730''>one</span> <span m=''1524940''>differently.</span> <span m=''1527800''>So</span>
  <span m=''1528000''>here''s</span> <span m=''1528310''>what</span> <span m=''1528460''>happens</span>
  <span m=''1529480''>during</span> <span m=''1529640''>the</span> <span m=''1529720''>simulation.</span>
  <span m=''1530960''>And</span> <span m=''1531270''>here,</span> <span m=''1532370''>in</span>
  <span m=''1532490''>this</span> <span m=''1532640''>simulation,</span> <span m=''1533140''>actually,</span>
  <span m=''1537700''>the</span> <span m=''1537920''>positions</span> <span m=''1538310''>were</span>
  <span m=''1538410''>recorded</span> <span m=''1538900''>every</span> <span m=''1539150''>20</span>
  <span m=''1539730''>time</span> <span m=''1540080''>steps.</span> <span m=''1540460''>So</span>
  <span m=''1540550''>that''s</span> <span m=''1540790''>why</span> <span m=''1540960''>it</span>
  <span m=''1541060''>sort</span> <span m=''1541200''>of</span> <span m=''1541510''>seems</span>
  <span m=''1541830''>to</span> <span m=''1541920''>go</span> <span m=''1542040''>a</span>
  <span m=''1542100''>lot</span> <span m=''1542350''>faster.</span> <span m=''1544070''>If</span>
  <span m=''1544250''>I</span> <span m=''1544320''>did</span> <span m=''1544510''>it</span>
  <span m=''1545000''>on</span> <span m=''1545160''>a</span> <span m=''1545220''>single</span>
  <span m=''1545570''>molecule,</span> <span m=''1546646''>I actually</span> <span
  m=''1547002''>done</span> <span m=''1547360''>that</span> <span m=''1547640''>first.</span>
  </p><p><span m=''1548385''>So</span> <span m=''1548720''>here</span> <span m=''1548900''>what</span>
  <span m=''1549060''>a</span> <span m=''1549110''>single</span> <span m=''1549560''>molecule</span>
  <span m=''1550040''>of</span> <span m=''1550110''>this</span> <span m=''1550290''>looks</span>
  <span m=''1550480''>like.</span> <span m=''1550630''>And this</span> <span m=''1550800''>is</span>
  <span m=''1550930''>a</span> <span m=''1551010''>protein</span> <span m=''1551430''>with</span>
  <span m=''1551860''>eight</span> <span m=''1552100''>residues,</span> <span m=''1553310''>which</span>
  <span m=''1553620''>is</span> <span m=''1553730''>pretty</span> <span m=''1553920''>big.</span>
  <span m=''1554130''>And</span> <span m=''1554220''>this</span> <span m=''1554360''>is</span>
  <span m=''1554550''>running</span> <span m=''1554890''>in</span> <span m=''1554960''>real</span>
  <span m=''1555230''>time</span> <span m=''1555660''>on</span> <span m=''1555790''>my</span>
  <span m=''1555920''>computer</span> <span m=''1556300''>right</span> <span m=''1556470''>now.</span>
  <span m=''1556680''>So</span> <span m=''1557990''>like</span> <span m=''1558210''>on</span>
  <span m=''1558290''>a</span> <span m=''1558340''>small</span> <span m=''1558720''>system</span>
  <span m=''1559040''>like</span> <span m=''1559240''>this,</span> <span m=''1561050''>it</span>
  <span m=''1561260''>runs</span> <span m=''1561530''>reasonably</span> <span m=''1562000''>fast.</span>
  <span m=''1563020''>But</span> <span m=''1563290''>as</span> <span m=''1563530''>you</span>
  <span m=''1564670''>add</span> <span m=''1564970''>more</span> <span m=''1565240''>and</span>
  <span m=''1565310''>more</span> <span m=''1565540''>of</span> <span m=''1565620''>these</span>
  <span m=''1565820''>things,</span> <span m=''1566630''>the</span> <span m=''1566710''>computations</span>
  <span m=''1567210''>do</span> <span m=''1567310''>get</span> <span m=''1567590''>pretty</span>
  <span m=''1568130''>expensive.</span> <span m=''1568700''>So</span> <span m=''1571040''>parallelization</span>
  <span m=''1571690''>really</span> <span m=''1571920''>helps.</span> <span m=''1572930''>Well,</span>
  <span m=''1573235''>not</span> <span m=''1573540''>in</span> <span m=''1573770''>what</span>
  <span m=''1573980''>I</span> <span m=''1574050''>implemented,</span> <span m=''1574580''>but</span>
  <span m=''1574970''>generally.</span> <span m=''1576634''>Generally,</span> <span
  m=''1578400''>as</span> <span m=''1578510''>you</span> <span m=''1578590''>saw,</span>
  <span m=''1578780''>NAMD</span> <span m=''1579190''>can do</span> <span m=''1579260''>a</span>
  <span m=''1579330''>pretty</span> <span m=''1579560''>good</span> <span m=''1579690''>job</span>
  <span m=''1579990''>at</span> <span m=''1580330''>doing</span> <span m=''1580600''>it.</span>
  <span m=''1582104''>Oh</span> <span m=''1582572''>OK,</span> <span m=''1583040''>I</span>
  <span m=''1583300''>didn''t</span> <span m=''1583520''>minimize</span> <span m=''1583860''>the</span>
  <span m=''1583950''>system</span> <span m=''1584860''>well</span> <span m=''1585060''>enough.</span>
  <span m=''1585400''>But</span> <span m=''1585970''>yeah,</span> <span m=''1586270''>that''s</span>
  <span m=''1586400''>about</span> <span m=''1586630''>it.</span> </p><p><span m=''1587710''>AUDIENCE:
  Great.</span> <span m=''1588200''>[INAUDIBLE]</span> </p><p><span m=''1595550''>AUDIENCE:
  So</span> <span m=''1596040''>basically,</span> <span m=''1596530''>on the</span>
  <span m=''1597020''>SPUs,</span> <span m=''1597510''>you managed</span> <span m=''1598000''>to
  get</span> <span m=''1598490''>them synchronized</span> <span m=''1599470''>properly,</span>
  <span m=''1600450''>data in</span> <span m=''1600940''>and data</span> <span m=''1601430''>out?</span>
  </p><p><span m=''1602440''>GREG PINTILIE: Yeah,</span> <span m=''1602680''>exactly.</span>
  <span m=''1603580''>So</span> <span m=''1604480''>that''s</span> <span m=''1604650''>kind
  of</span> <span m=''1604860''>to</span> <span m=''1604980''>the</span> <span m=''1605060''>extent
  that</span> <span m=''1605430''>I</span> <span m=''1605500''>went.</span> <span
  m=''1605750''>And that</span> <span m=''1605910''>still</span> <span m=''1606140''>took</span>
  <span m=''1606340''>a</span> <span m=''1606400''>long</span> <span m=''1606610''>time.</span>
  <span m=''1606870''>So</span> <span m=''1607020''>[INAUDIBLE].</span> </p>'
type: course
uid: d6d23ff4e90b60cb2c11e23c582e7787

---
None