---
about_this_resource_text: <p><strong>Topics covered:</strong> Software radio</p><p><strong>Instructor/speaker:</strong>
  Micah Brodsky and Arvind Thiagarajan</p>
course_id: 6-189-multicore-programming-primer-january-iap-2007
embedded_media:
- id: p4.jpg
  parent_uid: 184452f8919184055a18a9c47db2608a
  technical_location: https://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-189-multicore-programming-primer-january-iap-2007/projects/project-software-radio/p4.jpg
  title: Software Radio
  type: null
  uid: 18c5bf86b3f378240bd1bc418ee41a4c
- id: Video-YouTube-Stream
  media_location: s8dZi6eqsJU
  parent_uid: 184452f8919184055a18a9c47db2608a
  title: Video-YouTube-Stream
  type: Video
  uid: edd7f1b8f2290f26489c4a6a04f81145
- id: Thumbnail-YouTube-JPG
  media_location: https://img.youtube.com/vi/s8dZi6eqsJU/default.jpg
  parent_uid: 184452f8919184055a18a9c47db2608a
  title: Thumbnail-YouTube-JPG
  type: Thumbnail
  uid: aab2dbda35b96c9e1f558c67cd73443f
- id: Video-iTunesU-MP4
  media_location: https://itunes.apple.com/us/itunes-u/id341597759
  parent_uid: 184452f8919184055a18a9c47db2608a
  title: Video-iTunes U-MP4
  type: Video
  uid: 713827ba9dda236fc79fd1d6d7ee24f3
- id: Video-InternetArchive-MP4
  media_location: http://www.archive.org/download/MIT6.189IAP07/ocw-6.189-iap07-pro04_300k.mp4
  parent_uid: 184452f8919184055a18a9c47db2608a
  title: Video-Internet Archive-MP4
  type: Video
  uid: 2cfdcc9d9d64591ee68b32240d2907d1
- id: Thumbnail-OCW-JPG
  parent_uid: 184452f8919184055a18a9c47db2608a
  title: Thumbnail-OCW-JPG
  type: Thumbnail
  uid: da8dc6d03b8feeabd923dbd38deb635c
- id: 3Play-3PlayYouTubeid-MP4
  media_location: s8dZi6eqsJU
  parent_uid: 184452f8919184055a18a9c47db2608a
  title: 3Play-3Play YouTube id
  type: 3Play
  uid: 0bb7622c8c099a2472854cb4923659cf
- id: s8dZi6eqsJU.srt
  parent_uid: 184452f8919184055a18a9c47db2608a
  technical_location: https://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-189-multicore-programming-primer-january-iap-2007/projects/project-software-radio/s8dZi6eqsJU.srt
  title: 3play caption file
  type: null
  uid: 1657c1b373997c7d55d71e6563d94aa9
- id: s8dZi6eqsJU.pdf
  parent_uid: 184452f8919184055a18a9c47db2608a
  technical_location: https://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-189-multicore-programming-primer-january-iap-2007/projects/project-software-radio/s8dZi6eqsJU.pdf
  title: 3play pdf file
  type: null
  uid: 2e7af4afebd5da148f43ac39a9d31c5d
- id: Caption-3Play YouTube id-SRT
  parent_uid: 184452f8919184055a18a9c47db2608a
  title: Caption-3Play YouTube id-SRT-English - US
  type: Caption
  uid: f0edf5bb4b9725e05ec5104d98842582
- id: Transcript-3Play YouTube id-PDF
  parent_uid: 184452f8919184055a18a9c47db2608a
  title: Transcript-3Play YouTube id-PDF-English - US
  type: Transcript
  uid: d555a0ab602f4726ad2d96ac7fb51b08
inline_embed_id: 1749406project:softwareradio19238857
layout: video
order_index: null
parent_uid: b639672ad9ad956df1d830e6183298ae
related_resources_text: <p>(<a href="./resolveuid/8a4fa3fd099a55f9c6deda50ea110c7d"
  target="_blank" title="Open in a new window.">PDF</a>)</p>
short_url: project-software-radio
technical_location: https://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-189-multicore-programming-primer-january-iap-2007/projects/project-software-radio
template_type: Tabbed
title: 'Project: Software Radio '
transcript: '<p><span m=''50''>The</span> <span m=''180''>following</span> <span m=''620''>content</span>
  <span m=''1210''>is</span> <span m=''1330''>provided</span> <span m=''1770''>under</span>
  <span m=''2050''>a</span> <span m=''2090''>Creative</span> <span m=''2500''>Commons</span>
  <span m=''2900''>license.</span> <span m=''4010''>Your</span> <span m=''4200''>support</span>
  <span m=''4710''>will</span> <span m=''4860''>help</span> <span m=''5100''>MIT</span>
  <span m=''5560''>OpenCourseWare</span> <span m=''6350''>continue</span> <span m=''6860''>to</span>
  <span m=''6940''>offer</span> <span m=''7350''>high</span> <span m=''7590''>quality</span>
  <span m=''8109''>educational</span> <span m=''8740''>resources</span> <span m=''9360''>for</span>
  <span m=''9510''>free.</span> <span m=''10720''>To</span> <span m=''10730''>make</span>
  <span m=''10930''>a</span> <span m=''10980''>donation</span> <span m=''11660''>or</span>
  <span m=''11930''>view</span> <span m=''12370''>additional</span> <span m=''12790''>materials</span>
  <span m=''13330''>from</span> <span m=''13480''>hundreds</span> <span m=''13920''>of</span>
  <span m=''14020''>MIT</span> <span m=''14450''>courses,</span> <span m=''15570''>visit</span>
  <span m=''15770''>MIT</span> <span m=''16200''>OpenCourseWare</span> <span m=''17250''>at</span>
  <span m=''17410''>ocw.mit.edu.</span> </p><p><span m=''21630''>ARVIND THIAGARAJAN:
  So</span> <span m=''23970''>I''m</span> <span m=''24410''>Arvind</span> <span m=''24630''>and</span>
  <span m=''24750''>this is</span> <span m=''25190''>Micah.</span> <span m=''25903''>And
  we worked</span> <span m=''26366''>together</span> <span m=''26829''>on</span> <span
  m=''27755''>a</span> <span m=''28220''>framework</span> <span m=''28510''>for</span>
  <span m=''28830''>flexible</span> <span m=''29060''>stream</span> <span m=''29290''>processing</span>
  <span m=''29570''>on the</span> <span m=''29840''>cell.</span> <span m=''31530''>So</span>
  <span m=''32000''>we were</span> <span m=''32030''>also oriented</span> <span m=''32430''>towards</span>
  <span m=''33080''>an</span> <span m=''33410''>application</span> <span m=''33715''>which</span>
  <span m=''34020''>is,</span> <span m=''34370''>in this  case,</span> <span m=''34790''>a
  software radio.</span> <span m=''35290''>And</span> <span m=''35710''>we</span>
  <span m=''35780''>used</span> <span m=''36040''>this</span> <span m=''36300''>application</span>
  <span m=''36570''>as</span> <span m=''36840''>a case</span> <span m=''37240''>study.</span>
  <span m=''38040''>Where is the mic?</span> </p><p><span m=''41390''>I''ll</span>
  <span m=''41550''>try and</span> <span m=''41770''>speak</span> <span m=''41980''>as
  loud</span> <span m=''42255''>as I can.</span> <span m=''43230''>So our</span> <span
  m=''43485''>project</span> <span m=''43740''>was</span> <span m=''44200''>about</span>
  <span m=''45630''>flexible</span> <span m=''46020''>stream</span> <span m=''46330''>processing</span>
  <span m=''46710''>framework</span> <span m=''47160''>for</span> <span m=''47230''>the</span>
  <span m=''47330''>cell.</span> <span m=''48030''>And</span> <span m=''48340''>we</span>
  <span m=''48440''>used</span> <span m=''48660''>the</span> <span m=''48750''>software</span>
  <span m=''49110''>radios</span> <span m=''50170''>as</span> <span m=''50290''>a</span>
  <span m=''50360''>case</span> <span m=''50580''>study,</span> <span m=''50870''>essentially,</span>
  <span m=''51500''>of</span> <span m=''51890''>an</span> <span m=''52000''>application</span>
  <span m=''52480''>you could</span> <span m=''52620''>build</span> <span m=''52740''>using</span>
  <span m=''53080''>this</span> <span m=''53250''>framework.</span> </p><p><span m=''54480''>The</span>
  <span m=''54560''>motivation</span> <span m=''55070''>for</span> <span m=''55970''>our</span>
  <span m=''56110''>project</span> <span m=''56480''>is</span> <span m=''56540''>essentially</span>
  <span m=''58050''>what</span> <span m=''58280''>we''ve</span> <span m=''58420''>been</span>
  <span m=''58530''>discussing</span> <span m=''58960''>in</span> <span m=''59110''>class.</span>
  <span m=''59490''>It''s</span> <span m=''59620''>been</span> <span m=''59800''>reiterated.</span>
  <span m=''60380''>The</span> <span m=''60460''>cell</span> <span m=''60690''>isn''t</span>
  <span m=''60890''>easy</span> <span m=''61110''>to</span> <span m=''61200''>program.</span>
  <span m=''61940''>There''s</span> <span m=''62100''>no</span> <span m=''62220''>shared</span>
  <span m=''62560''>memory.</span> <span m=''63530''>There''s</span> <span m=''63830''>just</span>
  <span m=''64040''>message</span> <span m=''64709''>passing,</span> <span m=''64989''>which</span>
  <span m=''65110''>is</span> <span m=''65220''>quite</span> <span m=''65489''>messy.</span>
  <span m=''66680''>You</span> <span m=''66780''>have</span> <span m=''66940''>to</span>
  <span m=''67010''>explicitly</span> <span m=''67570''>parallelize</span> <span m=''67845''>your</span>
  <span m=''68120''>programs</span> <span m=''68540''>if</span> <span m=''68620''>you</span>
  <span m=''68710''>want</span> <span m=''68880''>to</span> <span m=''68940''>write</span>
  <span m=''69230''>them</span> <span m=''70240''>as,</span> <span m=''70560''>say,</span>
  <span m=''70620''>custom</span> <span m=''70970''>C</span> <span m=''71180''>programs.</span>
  </p><p><span m=''71920''>Some</span> <span m=''72120''>of</span> <span m=''72170''>the</span>
  <span m=''72250''>groups</span> <span m=''72430''>have</span> <span m=''72550''>describe</span>
  <span m=''72920''>the</span> <span m=''72990''>challenges</span> <span m=''73410''>they</span>
  <span m=''73530''>faced</span> <span m=''74110''>when</span> <span m=''74230''>doing</span>
  <span m=''74480''>that.</span> <span m=''75660''>Extracting</span> <span m=''76320''>parallelism</span>
  <span m=''76750''>can</span> <span m=''76880''>be</span> <span m=''77010''>tricky.</span>
  <span m=''77470''>For</span> <span m=''77520''>example,</span> <span m=''77990''>if</span>
  <span m=''78090''>you</span> <span m=''78190''>want</span> <span m=''78240''>to</span>
  <span m=''78280''>do</span> <span m=''78400''>pipelining,</span> <span m=''78940''>then</span>
  <span m=''79700''>on</span> <span m=''79870''>DSPs</span> <span m=''80700''>you</span>
  <span m=''80770''>have</span> <span m=''80910''>to</span> <span m=''81010''>predict</span>
  <span m=''81400''>what</span> <span m=''81740''>addresses</span> <span m=''82130''>you''re</span>
  <span m=''82280''>going</span> <span m=''82460''>to</span> <span m=''82540''>require,</span>
  <span m=''83280''>and</span> <span m=''83940''>set</span> <span m=''84150''>up</span>
  <span m=''84290''>a</span> <span m=''84380''>DMA</span> <span m=''84800''>so</span>
  <span m=''84980''>that</span> <span m=''85060''>those addresses</span> <span m=''85320''>are</span>
  <span m=''85520''>fetched</span> <span m=''85960''>in</span> <span m=''86090''>advance.</span>
  <span m=''87210''>And</span> <span m=''87590''>as</span> <span m=''88080''>Bill</span>
  <span m=''88450''>mentioned</span> <span m=''88770''>in</span> <span m=''88830''>his</span>
  <span m=''88920''>talk</span> <span m=''89860''>in</span> <span m=''90020''>class,</span>
  <span m=''90680''>stream</span> <span m=''91020''>programming</span> <span m=''91620''>can</span>
  <span m=''91750''>help</span> <span m=''92200''>alleviate</span> <span m=''92510''>some</span>
  <span m=''92650''>of</span> <span m=''92720''>these</span> <span m=''92900''>issues</span>
  <span m=''93590''>for</span> <span m=''94500''>some</span> <span m=''94720''>applications,</span>
  <span m=''95200''>like</span> <span m=''95360''>software</span> <span m=''95690''>radio</span>
  <span m=''96090''>where</span> <span m=''97000''>the</span> <span m=''97090''>applications</span>
  <span m=''97560''>fit</span> <span m=''97760''>naturally</span> <span m=''98015''>into</span>
  <span m=''98270''>the</span> <span m=''98370''>streaming</span> <span m=''98670''>model.</span>
  </p><p><span m=''99790''>So</span> <span m=''99930''>what</span> <span m=''100150''>we</span>
  <span m=''100610''>tried</span> <span m=''100810''>to</span> <span m=''100880''>do</span>
  <span m=''101050''>for</span> <span m=''101230''>our</span> <span m=''101330''>project</span>
  <span m=''102110''>was</span> <span m=''102650''>build a</span> <span m=''103150''>light</span>
  <span m=''103430''>weight--</span> <span m=''104560''>as</span> <span m=''104740''>light</span>
  <span m=''104950''>weight as</span> <span m=''105250''>possible</span> <span m=''105590''>because</span>
  <span m=''105900''>the</span> <span m=''105990''>code</span> <span m=''106180''>has</span>
  <span m=''106320''>to</span> <span m=''106410''>fit</span> <span m=''106730''>on</span>
  <span m=''106900''>DSPs,</span> <span m=''107910''>but</span> <span m=''109660''>as</span>
  <span m=''109820''>expressive</span> <span m=''110200''>as</span> <span m=''110370''>possible,</span>
  <span m=''110770''>as</span> <span m=''110900''>well,</span> <span m=''111040''>so</span>
  <span m=''111170''>as</span> <span m=''111350''>to</span> <span m=''111420''>simplify</span>
  <span m=''111810''>life</span> <span m=''112140''>for</span> <span m=''112610''>developers.</span>
  <span m=''113800''>The</span> <span m=''113890''>streaming</span> <span m=''114210''>framework</span>
  <span m=''114470''>which is</span> <span m=''114730''>targeted</span> <span m=''115060''>specifically</span>
  <span m=''115590''>at</span> <span m=''115680''>signal</span> <span m=''115940''>processing</span>
  <span m=''116280''>applications.</span> <span m=''118870''>The</span> <span m=''118950''>data</span>
  <span m=''119170''>model,</span> <span m=''119440''>at</span> <span m=''119510''>least,
  is</span> <span m=''119860''>based</span> <span m=''120230''>on</span> <span m=''120970''>a</span>
  <span m=''121290''>research</span> <span m=''121590''>project</span> <span m=''121960''>that</span>
  <span m=''122560''>I</span> <span m=''122710''>have</span> <span m=''123000''>worked
  on</span> <span m=''123150''>in</span> <span m=''123200''>the</span> <span m=''123330''>past,</span>
  <span m=''123710''>which</span> <span m=''123720''>is</span> <span m=''123960''>a</span>
  <span m=''124250''>WaveScope</span> <span m=''124730''>streaming</span> <span m=''125050''>database</span>
  <span m=''125470''>management</span> <span m=''125830''>system.</span> <span m=''126520''>It
  is</span> <span m=''126610''>is</span> <span m=''126680''>a research</span> <span
  m=''126840''>project</span> <span m=''127140''>with the</span> <span m=''127910''>database</span>
  <span m=''128289''>group.</span> </p><p><span m=''129480''>The</span> <span m=''129910''>data</span>
  <span m=''130080''>model</span> <span m=''130250''>is</span> <span m=''130370''>essentially</span>
  <span m=''130750''>an</span> <span m=''130889''>extension</span> <span m=''131310''>of</span>
  <span m=''131360''>the</span> <span m=''131420''>streaming</span> <span m=''132240''>model</span>
  <span m=''132820''>to handle</span> <span m=''133490''>larger</span> <span m=''133820''>blocks</span>
  <span m=''134170''>of</span> <span m=''134260''>data</span> <span m=''134940''>so
  as to</span> <span m=''135150''>process</span> <span m=''135580''>them</span> <span
  m=''135760''>better.</span> <span m=''136250''>For example,</span> <span m=''136780''>several</span>
  <span m=''137180''>signal</span> <span m=''137540''>processing</span> <span m=''137740''>operators,</span>
  <span m=''138040''>like</span> <span m=''138630''>the</span> <span m=''138710''>fast</span>
  <span m=''139140''>Fourier</span> <span m=''139220''>transform,</span> <span m=''139680''>need</span>
  <span m=''139830''>to</span> <span m=''139900''>do</span> <span m=''140870''>multiple</span>
  <span m=''141220''>passes</span> <span m=''141330''>over</span> <span m=''141850''>the</span>
  <span m=''141950''>data</span> <span m=''142270''>and,</span> <span m=''142380''>therefore,</span>
  <span m=''143320''>trying</span> <span m=''143440''>to</span> <span m=''144030''>treat</span>
  <span m=''144410''>streams</span> <span m=''144830''>on</span> <span m=''144890''>a</span>
  <span m=''144940''>sample</span> <span m=''145240''>by</span> <span m=''145330''>sample</span>
  <span m=''145630''>basis</span> <span m=''146290''>leads</span> <span m=''146580''>to</span>
  <span m=''147180''>high</span> <span m=''147370''>cost,</span> <span m=''148300''>scheduling</span>
  <span m=''148880''>overhead,</span> <span m=''149300''>as</span> <span m=''149440''>well</span>
  <span m=''149610''>as</span> <span m=''150280''>inefficiency.</span> </p><p><span
  m=''151790''>So</span> <span m=''153150''>that''s</span> <span m=''153330''>what</span>
  <span m=''153440''>the</span> <span m=''153500''>data</span> <span m=''153710''>model</span>
  <span m=''153970''>does.</span> <span m=''154380''>And</span> <span m=''154580''>we</span>
  <span m=''154730''>tried</span> <span m=''154900''>to</span> <span m=''154960''>port</span>
  <span m=''155260''>this</span> <span m=''155390''>data</span> <span m=''155600''>model</span>
  <span m=''155860''>over</span> <span m=''156170''>to</span> <span m=''156760''>the</span>
  <span m=''156850''>cell</span> <span m=''157070''>processor</span> <span m=''157920''>and</span>
  <span m=''158080''>see</span> <span m=''158230''>how</span> <span m=''158780''>well</span>
  <span m=''158950''>we</span> <span m=''159100''>could</span> <span m=''159230''>exploit</span>
  <span m=''159660''>the</span> <span m=''159730''>features</span> <span m=''160050''>of</span>
  <span m=''160110''>the</span> <span m=''160180''>cell</span> <span m=''160380''>processor.</span>
  <span m=''161150''>In</span> <span m=''161250''>particular,</span> <span m=''161640''>the</span>
  <span m=''161720''>high</span> <span m=''162710''>on-chip</span> <span m=''163170''>bandwidth</span>
  <span m=''163570''>between</span> <span m=''163950''>the</span> <span m=''164395''>SPEs</span>
  <span m=''165730''>to do</span> <span m=''165960''>with</span> <span m=''166240''>streaming.</span>
  </p><p><span m=''167860''>So</span> <span m=''168360''>our</span> <span m=''168460''>case</span>
  <span m=''168690''>study</span> <span m=''168980''>was,</span> <span m=''169690''>as</span>
  <span m=''169790''>we</span> <span m=''169870''>mentioned,</span> <span m=''170240''>a</span>
  <span m=''170320''>simple</span> <span m=''170630''>software radio</span> <span
  m=''171100''>application.</span> <span m=''171690''>It''s</span> <span m=''171830''>really</span>
  <span m=''172040''>simple.</span> <span m=''172390''>It</span> <span m=''172630''>uses</span>
  <span m=''174620''>incoherent</span> <span m=''175840''>demodulation,</span> <span
  m=''176470''>as</span> <span m=''176580''>well</span> <span m=''176740''>as</span>
  <span m=''177130''>just</span> <span m=''177230''>simple</span> <span m=''177600''>amplitude-shift
  key</span> <span m=''178350''>modulation.</span> <span m=''180510''>As</span> <span
  m=''180660''>I</span> <span m=''180730''>said,</span> <span m=''180940''>the</span>
  <span m=''181000''>main</span> <span m=''181220''>goals</span> <span m=''181330''>of
  our</span> <span m=''181630''>framework</span> <span m=''181900''>were</span> <span
  m=''182170''>to</span> <span m=''182662''>simplify life</span> <span m=''183154''>and
  modeling</span> <span m=''184140''>as</span> <span m=''184320''>much</span> <span
  m=''184540''>parallelism</span> <span m=''184860''>as</span> <span m=''185110''>possible--</span>
  <span m=''185480''>try and</span> <span m=''185670''>extract</span> <span m=''186220''>pipeline</span>
  <span m=''186485''>parallelism,</span> <span m=''187250''>data</span> <span m=''187470''>parallelism.</span>
  <span m=''188170''>Some of the</span> <span m=''188586''>kinds of</span> <span m=''189002''>parallelism,</span>
  <span m=''189420''>We''ll</span> <span m=''189440''>mention.</span> <span m=''190650''>The</span>
  <span m=''191660''>kind of</span> <span m=''192090''>parallelism</span> <span m=''192520''>we
  were</span> <span m=''192950''>able to finally</span> <span m=''193380''>implement--</span>
  <span m=''193850''>so</span> <span m=''193980''>far,</span> <span m=''194290''>it''s</span>
  <span m=''194560''>only</span> <span m=''194740''>pipeline</span> <span m=''194940''>parallelism,</span>
  <span m=''196055''>but</span> <span m=''196490''>as</span> <span m=''196670''>future</span>
  <span m=''196950''>work, we''d</span> <span m=''197220''>be</span> <span m=''197300''>interested</span>
  <span m=''197680''>in</span> <span m=''197970''>the other kinds</span> <span m=''198220''>of
  parallelism</span> <span m=''198620''>as well.</span> <span m=''199020''>More</span>
  <span m=''199330''>about</span> <span m=''199530''>it as</span> <span m=''199850''>I
  go on.</span> </p><p><span m=''201540''>So</span> <span m=''202090''>in</span> <span
  m=''202190''>the</span> <span m=''202280''>framework</span> <span m=''202630''>we</span>
  <span m=''202730''>at least</span> <span m=''202990''>implemented,</span> <span
  m=''203660''>the</span> <span m=''203960''>programming</span> <span m=''204310''>model</span>
  <span m=''204540''>is</span> <span m=''204670''>quite</span> <span m=''204890''>simple.</span>
  <span m=''206010''>The</span> <span m=''206110''>basic</span> <span m=''206300''>execution</span>
  <span m=''206980''>unit</span> <span m=''207290''>is</span> <span m=''207370''>what</span>
  <span m=''207550''>we</span> <span m=''207670''>call an</span> <span m=''207960''>operator.</span>
  <span m=''208910''>It''s</span> <span m=''209310''>analogous</span> <span m=''209710''>to</span>
  <span m=''209810''>what</span> <span m=''209960''>in</span> <span m=''210040''>StreamIt</span>
  <span m=''210530''>would be</span> <span m=''210650''>called</span> <span m=''210990''>a
  work</span> <span m=''211150''>function,</span> <span m=''211620''>or</span> <span
  m=''211750''>what</span> <span m=''212040''>in GNURadio,</span> <span m=''213680''>which</span>
  <span m=''213820''>is</span> <span m=''213960''>a framework</span> <span m=''214215''>for
  building</span> <span m=''214470''>soft</span> <span m=''214670''>radios,</span>
  <span m=''215730''>would be</span> <span m=''215940''>called</span> <span m=''216130''>a</span>
  <span m=''216200''>block.</span> <span m=''217210''>So</span> <span m=''217360''>these</span>
  <span m=''217560''>operators</span> <span m=''218030''>can</span> <span m=''218210''>be</span>
  <span m=''218320''>any</span> <span m=''218510''>arbitrary</span> <span m=''218890''>C++</span>
  <span m=''219550''>classes</span> <span m=''220320''>with</span> <span m=''220530''>state,</span>
  <span m=''221320''>and</span> <span m=''221575''>they</span> <span m=''221830''>implement</span>
  <span m=''223120''>an</span> <span m=''223340''>iterate</span> <span m=''223890''>method</span>
  <span m=''224040''>which</span> <span m=''224560''>the</span> <span m=''224860''>developer</span>
  <span m=''225160''>has to</span> <span m=''225470''>overload</span> <span m=''226170''>in
  order to</span> <span m=''226480''>process</span> <span m=''226870''>a</span> <span
  m=''226920''>block of</span> <span m=''227290''>data.</span> </p><p><span m=''228330''>The</span>
  <span m=''228820''>WaveScope</span> <span m=''229140''>data</span> <span m=''229360''>model</span>
  <span m=''229590''>also</span> <span m=''229820''>provides</span> <span m=''230640''>a</span>
  <span m=''230680''>library</span> <span m=''231060''>for</span> <span m=''231150''>managing</span>
  <span m=''231520''>memory</span> <span m=''232340''>and</span> <span m=''232640''>passing</span>
  <span m=''233110''>blocks</span> <span m=''233380''>of</span> <span m=''233440''>signal</span>
  <span m=''233760''>data</span> <span m=''234000''>between</span> <span m=''234380''>these</span>
  <span m=''234760''>operators.</span> <span m=''236370''>Applications</span> <span
  m=''236960''>in</span> <span m=''237040''>this</span> <span m=''237170''>model</span>
  <span m=''237450''>are</span> <span m=''237510''>built</span> <span m=''237770''>by</span>
  <span m=''238110''>chaining</span> <span m=''238450''>operators</span> <span m=''238840''>together.</span>
  <span m=''239330''>So</span> <span m=''239440''>this</span> <span m=''239560''>is</span>
  <span m=''239610''>a</span> <span m=''239690''>snippet</span> <span m=''240120''>of</span>
  <span m=''240970''>some</span> <span m=''241140''>of</span> <span m=''241200''>the</span>
  <span m=''241290''>code we</span> <span m=''241630''>wrote for the</span> <span
  m=''241990''>software</span> <span m=''242150''>radio,</span> <span m=''243150''>roughly.</span>
  <span m=''244800''>So</span> <span m=''244940''>you</span> <span m=''245520''>create</span>
  <span m=''245800''>a</span> <span m=''245850''>box,</span> <span m=''246500''>let''s
  say</span> <span m=''246720''>a</span> <span m=''246960''>FIRFilter,</span> <span
  m=''247730''>which</span> <span m=''247890''>processes</span> <span m=''248410''>elements</span>
  <span m=''248770''>of</span> <span m=''248910''>type</span> <span m=''249740''>float.</span>
  <span m=''250590''>And</span> <span m=''250730''>then,</span> <span m=''251260''>it</span>
  <span m=''251410''>takes in</span> <span m=''251570''>some</span> <span m=''251840''>arguments,</span>
  <span m=''252260''>initialize</span> <span m=''252690''>the</span> <span m=''252780''>filters,</span>
  <span m=''253110''>parameters,</span> <span m=''253390''>and</span> <span m=''253660''>so</span>
  <span m=''253820''>on.</span> <span m=''254730''>You</span> <span m=''254820''>want</span>
  <span m=''254940''>to</span> <span m=''254990''>create</span> <span m=''255180''>a</span>
  <span m=''255240''>white</span> <span m=''255470''>noise generator</span> <span
  m=''255970''>and</span> <span m=''256120''>hook</span> <span m=''256339''>up</span>
  <span m=''256550''>the</span> <span m=''257790''>filter</span> <span m=''257959''>to
  the</span> <span m=''258040''>white noise generator.</span> <span m=''258374''>We</span>
  <span m=''258709''>use</span> <span m=''258880''>this</span> <span m=''259079''>to</span>
  <span m=''259279''>simulate</span> <span m=''259620''>a</span> <span m=''259700''>simple</span>
  <span m=''260740''>channel,</span> <span m=''261160''>[INAUDIBLE]</span> <span m=''261620''>channel.</span>
  </p><p><span m=''263040''>So</span> <span m=''263810''>I''ll</span> <span m=''263890''>just</span>
  <span m=''264070''>describe</span> <span m=''264620''>the</span> <span m=''264720''>components</span>
  <span m=''265140''>of</span> <span m=''265230''>our</span> <span m=''265300''>framework.</span>
  <span m=''268080''>We</span> <span m=''268180''>have</span> <span m=''268390''>a
  lightweight</span> <span m=''268880''>scheduler</span> <span m=''269320''>on</span>
  <span m=''269550''>both</span> <span m=''269830''>the</span> <span m=''269910''>PPE,</span>
  <span m=''270190''>as</span> <span m=''270470''>well</span> <span m=''270640''>as</span>
  <span m=''271340''>the</span> <span m=''271690''>SPEs.</span> <span m=''273490''>Right</span>
  <span m=''273610''>now,</span> <span m=''273890''>it uses</span> <span m=''274070''>a</span>
  <span m=''274190''>static</span> <span m=''274560''>operator</span> <span m=''274950''>mapping</span>
  <span m=''275720''>in the sense</span> <span m=''276090''>that</span> <span m=''276190''>you</span>
  <span m=''276300''>have</span> <span m=''276440''>to</span> <span m=''276510''>specify</span>
  <span m=''276920''>a static</span> <span m=''277310''>configuration</span> <span
  m=''277880''>file,</span> <span m=''278570''>where</span> <span m=''278980''>you</span>
  <span m=''279080''>say</span> <span m=''279880''>this</span> <span m=''280060''>operator</span>
  <span m=''280400''>name</span> <span m=''280940''>will</span> <span m=''281140''>run</span>
  <span m=''281360''>on</span> <span m=''281660''>this</span> <span m=''282230''>[?
  SPU ?]</span> <span m=''282550''>number.</span> </p><p><span m=''283390''>But</span>
  <span m=''285250''>we''ve</span> <span m=''285750''>not</span> <span m=''285980''>completely</span>
  <span m=''286290''>implemented</span> <span m=''287140''>dynamically</span> <span
  m=''287435''>reconfiguring</span> <span m=''288180''>at</span> <span m=''288730''>runtime.</span>
  <span m=''289290''>And</span> <span m=''289490''>we</span> <span m=''289570''>haven''t</span>
  <span m=''289860''>yet</span> <span m=''290140''>seen</span> <span m=''290800''>the</span>
  <span m=''290870''>need</span> <span m=''291080''>for</span> <span m=''291180''>doing</span>
  <span m=''291430''>that.</span> <span m=''291680''>So</span> <span m=''292270''>it</span>
  <span m=''292550''>wouldn''t</span> <span m=''292730''>be</span> <span m=''292830''>too</span>
  <span m=''292940''>hard</span> <span m=''293230''>to add</span> <span m=''293470''>if</span>
  <span m=''293600''>needed.</span> <span m=''294640''>But</span> <span m=''294790''>right
  now,</span> <span m=''294910''>you</span> <span m=''295130''>can</span> <span m=''295230''>easily</span>
  <span m=''295440''>shuffle</span> <span m=''295800''>around</span> <span m=''296030''>the</span>
  <span m=''296120''>operator</span> <span m=''296450''>mapping</span> <span m=''296780''>by</span>
  <span m=''297400''>tweaking</span> <span m=''297650''>the</span> <span m=''297740''>configuration</span>
  <span m=''298270''>file.</span> </p><p><span m=''299310''>Signal</span> <span m=''299630''>blocks,</span>
  <span m=''299980''>as</span> <span m=''300070''>I</span> <span m=''300140''>said,</span>
  <span m=''300380''>were</span> <span m=''300490''>adapted</span> <span m=''300900''>from</span>
  <span m=''302030''>WaveScope.</span> <span m=''302810''>They</span> <span m=''303190''>use</span>
  <span m=''303400''>reference</span> <span m=''303750''>counting</span> <span m=''304060''>and</span>
  <span m=''304150''>avoid</span> <span m=''304450''>in-memory</span> <span m=''304870''>copies,</span>
  <span m=''305190''>which</span> <span m=''305290''>can</span> <span m=''305400''>be</span>
  <span m=''305510''>quite</span> <span m=''305710''>expensive,</span> <span m=''306500''>especially</span>
  <span m=''306860''>on</span> <span m=''306940''>the</span> <span m=''307020''>cell.</span>
  <span m=''308650''>They</span> <span m=''308750''>also</span> <span m=''309100''>provide</span>
  <span m=''309340''>a</span> <span m=''309400''>convenient</span> <span m=''309880''>API</span>
  <span m=''310120''>to</span> <span m=''310190''>manipulate</span> <span m=''310880''>signals.</span>
  <span m=''311220''>So</span> <span m=''311310''>you</span> <span m=''311380''>don''t</span>
  <span m=''311530''>have</span> <span m=''311680''>to</span> <span m=''311790''>do</span>
  <span m=''311930''>much</span> <span m=''312140''>of the</span> <span m=''312220''>memory</span>
  <span m=''312520''>management</span> <span m=''312930''>yourself</span> <span m=''313775''>or</span>
  <span m=''314060''>debug</span> <span m=''314490''>any of</span> <span m=''314560''>the</span>
  <span m=''314610''>hard</span> <span m=''314870''>problems</span> <span m=''315670''>to
  do</span> <span m=''316000''>with</span> <span m=''316110''>memory</span> <span
  m=''316350''>management.</span> <span m=''317450''>We also</span> <span m=''317640''>ported</span>
  <span m=''318040''>this</span> <span m=''318160''>library</span> <span m=''318500''>to</span>
  <span m=''318570''>ensure</span> <span m=''318930''>that</span> <span m=''319930''>data</span>
  <span m=''320130''>is</span> <span m=''320160''>aligned for you</span> <span m=''320550''>automatically</span>
  <span m=''320970''>and</span> <span m=''321270''>transported</span> <span m=''323410''>via</span>
  <span m=''323720''>queues.</span> </p><p><span m=''324180''>So</span> <span m=''324470''>one</span>
  <span m=''324960''>of</span> <span m=''325010''>the</span> <span m=''325400''>major</span>
  <span m=''325730''>things</span> <span m=''325990''>we</span> <span m=''326070''>had</span>
  <span m=''326240''>to</span> <span m=''326280''>implement</span> <span m=''326710''>was</span>
  <span m=''327250''>a</span> <span m=''327390''>queuing</span> <span m=''327770''>library</span>
  <span m=''328860''>and</span> <span m=''329220''>remote</span> <span m=''329605''>heap</span>
  <span m=''329930''>management--</span> <span m=''330360''>what</span> <span m=''330520''>amounted</span>
  <span m=''330840''>essentially</span> <span m=''331200''>to a remote</span> <span
  m=''331580''>heap</span> <span m=''331850''>management</span> <span m=''332320''>library.</span>
  <span m=''333180''>So</span> <span m=''333570''>in</span> <span m=''333740''>some</span>
  <span m=''333910''>sense,</span> <span m=''334180''>we</span> <span m=''334300''>faced</span>
  <span m=''335130''>a choice</span> <span m=''335490''>here.</span> <span m=''335750''>We</span>
  <span m=''335850''>could</span> <span m=''336000''>either</span> <span m=''336410''>have</span>
  <span m=''337040''>the</span> <span m=''337150''>PPE</span> <span m=''337870''>control</span>
  <span m=''338710''>and</span> <span m=''339250''>allocate</span> <span m=''339710''>memory</span>
  <span m=''340470''>statically</span> <span m=''340860''>and</span> <span m=''341050''>make</span>
  <span m=''341430''>all</span> <span m=''341600''>the</span> <span m=''341670''>decisions</span>
  <span m=''342030''>about</span> <span m=''342780''>what</span> <span m=''343010''>memory
  is</span> <span m=''343340''>allocated</span> <span m=''343800''>where.</span> <span
  m=''344390''>Or,</span> <span m=''345000''>we</span> <span m=''345090''>could</span>
  <span m=''345250''>have the</span> <span m=''345740''>SPEs</span> <span m=''346120''>manage</span>
  <span m=''346400''>it</span> <span m=''346500''>themselves.</span> </p><p><span
  m=''347390''>We decided</span> <span m=''347600''>to</span> <span m=''347900''>go
  for</span> <span m=''348120''>the</span> <span m=''348210''>latter,</span> <span
  m=''349480''>partly</span> <span m=''349720''>because</span> <span m=''349930''>it</span>
  <span m=''350010''>was</span> <span m=''350120''>more</span> <span m=''350280''>dynamic</span>
  <span m=''350720''>and,</span> <span m=''350800''>also,</span> <span m=''351050''>because</span>
  <span m=''351440''>we</span> <span m=''351530''>weren''t</span> <span m=''351730''>sure</span>
  <span m=''352020''>what</span> <span m=''352280''>the</span> <span m=''352650''>implications</span>
  <span m=''353250''>of</span> <span m=''354020''>all the control</span> <span m=''354370''>flow</span>
  <span m=''354540''>passing</span> <span m=''354865''>through the</span> <span m=''355190''>PPE</span>
  <span m=''355460''>were</span> <span m=''356130''>for</span> <span m=''356240''>this.</span>
  <span m=''357080''>So</span> <span m=''357260''>we</span> <span m=''357370''>chose</span>
  <span m=''357610''>the</span> <span m=''357680''>second</span> <span m=''357970''>approach,</span>
  <span m=''358360''>which is</span> <span m=''358670''>autonomous</span> <span m=''359080''>memory</span>
  <span m=''359350''>management.</span> </p><p><span m=''360350''>So</span> <span
  m=''360790''>when</span> <span m=''361030''>an SPE</span> <span m=''361210''>sends</span>
  <span m=''362460''>a</span> <span m=''362560''>streaming</span> <span m=''363150''>data</span>
  <span m=''363360''>element</span> <span m=''363700''>to</span> <span m=''363780''>another</span>
  <span m=''364000''>SPE,</span> <span m=''366040''>it</span> <span m=''366140''>doesn''t</span>
  <span m=''366350''>have to</span> <span m=''366530''>actually</span> <span m=''366780''>explicitly</span>
  <span m=''367240''>request</span> <span m=''367690''>the</span> <span m=''367830''>other</span>
  <span m=''367970''>SPE</span> <span m=''368190''>for</span> <span m=''368710''>allocating</span>
  <span m=''369100''>memory.</span> <span m=''369480''>It has</span> <span m=''370160''>a</span>
  <span m=''370250''>remote</span> <span m=''370410''>heap</span> <span m=''370690''>interface</span>
  <span m=''371630''>so</span> <span m=''371870''>that it can</span> <span m=''372010''>directly</span>
  <span m=''372450''>allocate</span> <span m=''372800''>data</span> <span m=''373150''>and
  write</span> <span m=''373360''>to the</span> <span m=''373430''>SPE.</span> <span
  m=''374450''>This</span> <span m=''374570''>is</span> <span m=''374800''>currently</span>
  <span m=''375180''>of</span> <span m=''375280''>fixed</span> <span m=''375920''>size,</span>
  <span m=''377620''>but</span> <span m=''378940''>it</span> <span m=''379080''>could</span>
  <span m=''379250''>be</span> <span m=''380120''>improved</span> <span m=''380180''>by</span>
  <span m=''380890''>using</span> <span m=''381570''>this</span> <span m=''381720''>heap</span>
  <span m=''381970''>to</span> <span m=''382010''>share</span> <span m=''382560''>a</span>
  <span m=''382640''>bunch</span> <span m=''382840''>of</span> <span m=''382910''>queues.</span>
  </p><p><span m=''383110''>Right</span> <span m=''383290''>now,</span> <span m=''383390''>we</span>
  <span m=''383500''>have</span> <span m=''383700''>one</span> <span m=''383990''>remote</span>
  <span m=''384150''>heap</span> <span m=''384370''>for each</span> <span m=''384530''>queue</span>
  <span m=''386200''>between</span> <span m=''386660''>operators</span> <span m=''387240''>on</span>
  <span m=''387410''>different</span> <span m=''388290''>SPEs.</span> <span m=''391520''>So</span>
  <span m=''392060''>our</span> <span m=''392100''>system</span> <span m=''392390''>automatically</span>
  <span m=''392820''>handles</span> <span m=''393170''>pipelining</span> <span m=''395070''>streaming</span>
  <span m=''395260''>data</span> <span m=''395520''>from</span> <span m=''395730''>SPE</span>
  <span m=''396005''>to</span> <span m=''396280''>SPE</span> <span m=''396770''>using</span>
  <span m=''396990''>the</span> <span m=''397070''>DMA</span> <span m=''398160''>API.</span>
  <span m=''400740''>So Micah</span> <span m=''401210''>will</span> <span m=''401290''>takeover</span>
  <span m=''401910''>from</span> <span m=''402080''>here</span> <span m=''402270''>and</span>
  <span m=''402360''>describe</span> <span m=''402770''>the</span> <span m=''402860''>software</span>
  <span m=''403230''>radio implementation</span> <span m=''403980''>briefly.</span>
  </p><p></p><p><span m=''424900''>MICAH BRODSKY: So</span> <span m=''425060''>our
  software radio</span> <span m=''425510''>implementation</span> <span m=''426570''>is</span>
  <span m=''426990''>relatively</span> <span m=''427430''>simple.</span> <span m=''429430''>We</span>
  <span m=''429560''>weren''t</span> <span m=''430090''>pushing</span> <span m=''430300''>on</span>
  <span m=''430380''>that</span> <span m=''430530''>too</span> <span m=''430660''>hard,</span>
  <span m=''430800''>especially</span> <span m=''431170''>because</span> <span m=''431610''>it
  took the</span> <span m=''431660''>vast</span> <span m=''431970''>majority</span>
  <span m=''432300''>of our</span> <span m=''432430''>time</span> <span m=''432650''>just
  to</span> <span m=''432860''>get</span> <span m=''432980''>the</span> <span m=''433050''>framework</span>
  <span m=''433390''>to</span> <span m=''433490''>work.</span> <span m=''434390''>Saving</span>
  <span m=''434710''>the</span> <span m=''434820''>programmer</span> <span m=''435280''>trouble</span>
  <span m=''435600''>meant</span> <span m=''435860''>that</span> <span m=''436080''>we</span>
  <span m=''436450''>inherited</span> <span m=''436910''>a</span> <span m=''436950''>lot</span>
  <span m=''437120''>of</span> <span m=''437200''>trouble</span> <span m=''437490''>ourselves.</span>
  <span m=''442320''>It</span> <span m=''442510''>breaks</span> <span m=''442760''>down</span>
  <span m=''442970''>to</span> <span m=''443030''>about</span> <span m=''443760''>25</span>
  <span m=''444140''>boxes,</span> <span m=''446330''>which</span> <span m=''446510''>we</span>
  <span m=''446820''>took</span> <span m=''447460''>in</span> <span m=''447480''>our
  config file</span> <span m=''447710''>which is</span> <span m=''448080''>manually</span>
  <span m=''449810''>mapped</span> <span m=''450070''>to</span> <span m=''450160''>the</span>
  <span m=''450790''>SPEs.</span> <span m=''452690''>About</span> <span m=''453060''>3,000</span>
  <span m=''453560''>lines</span> <span m=''453820''>of code,</span> <span m=''455230''>most
  of</span> <span m=''455490''>which is</span> <span m=''455750''>framework.</span>
  </p><p><span m=''460250''>So</span> <span m=''461020''>I guess,</span> <span m=''462460''>if</span>
  <span m=''462570''>we were</span> <span m=''462690''>more put-together,</span> <span
  m=''463340''>we''d</span> <span m=''463590''>have a nice</span> <span m=''463780''>diagram</span>
  <span m=''464160''>to</span> <span m=''464240''>show</span> <span m=''464460''>you.</span>
  <span m=''465663''>There''s enough</span> <span m=''466066''>time.</span> <span
  m=''466470''>I''ll try to</span> <span m=''466690''>draw a</span> <span m=''467030''>quick</span>
  <span m=''467220''>diagram</span> <span m=''468300''>on</span> <span m=''468410''>the</span>
  <span m=''468480''>chalkboard.</span> <span m=''472540''>We''re</span> <span m=''472680''>simulating</span>
  <span m=''473835''>both</span> <span m=''474230''>sender,</span> <span m=''474660''>receiver</span>
  <span m=''475490''>and</span> <span m=''475800''>a channel.</span> </p><p><span
  m=''483373''>So the</span> <span m=''484140''>computation</span> <span m=''484475''>in</span>
  <span m=''484810''>question</span> <span m=''485700''>looks</span> <span m=''485780''>something</span>
  <span m=''485940''>like</span> <span m=''486090''>you</span> <span m=''486170''>have</span>
  <span m=''486680''>a</span> <span m=''486750''>bitstream.</span> <span m=''489270''>You</span>
  <span m=''489330''>need</span> <span m=''489480''>to</span> <span m=''489560''>take</span>
  <span m=''489850''>these</span> <span m=''490120''>and</span> <span m=''490230''>convert</span>
  <span m=''490620''>them</span> <span m=''490950''>into</span> <span m=''491410''>some--</span>
  <span m=''493378''>can you read</span> <span m=''493864''>anything?</span> <span
  m=''507360''>So</span> <span m=''507520''>you</span> <span m=''507600''>take</span>
  <span m=''508652''>stream</span> <span m=''509080''>of bits</span> <span m=''509420''>in.</span>
  <span m=''514270''>Take</span> <span m=''515350''>bits.</span> <span m=''516850''>Basically,</span>
  <span m=''518159''>use a</span> <span m=''518220''>lookup</span> <span m=''518510''>mechanism</span>
  <span m=''518950''>to</span> <span m=''519059''>convert</span> <span m=''519390''>it</span>
  <span m=''519600''>to</span> <span m=''520090''>an</span> <span m=''520270''>analog</span>
  <span m=''520669''>waveform,</span> <span m=''522659''>and</span> <span m=''522860''>filter</span>
  <span m=''523260''>that</span> <span m=''524080''>to produce</span> <span m=''524220''>something</span>
  <span m=''524560''>that</span> <span m=''524720''>has</span> <span m=''524830''>a</span>
  <span m=''524890''>narrower</span> <span m=''525310''>spectrum.</span> </p><p><span
  m=''528986''>Running out of</span> <span m=''529464''>space here.</span> <span m=''530420''>Means</span>
  <span m=''530898''>that.</span> <span m=''531376''>Multiply that</span> <span m=''531854''>against</span>
  <span m=''532332''>a sine wave.</span> </p><p><span m=''535200''>ARVIND THIAGARAJAN:
  That''s for modulation</span> </p><p><span m=''536640''>MICAH BRODSKY: And</span>
  <span m=''537030''>so</span> <span m=''537120''>you</span> <span m=''537260''>get--</span>
  <span m=''540860''>you''ve</span> <span m=''541080''>probably</span> <span m=''541410''>seen</span>
  <span m=''541610''>pictures of</span> <span m=''542010''>this.</span> <span m=''543900''>It''s</span>
  <span m=''544140''>very</span> <span m=''544450''>much</span> <span m=''544610''>like
  AM</span> <span m=''545180''>It''s basically</span> <span m=''545430''>binary</span>
  <span m=''545860''>AM.</span> <span m=''546290''>[INAUDIBLE].</span> <span m=''547150''>It''s</span>
  <span m=''547670''>one</span> <span m=''547790''>of</span> <span m=''547840''>the</span>
  <span m=''547910''>simplest</span> <span m=''548295''>things you can</span> <span
  m=''548680''>do.</span> </p><p><span m=''554830''>Then,</span> <span m=''555400''>this</span>
  <span m=''555470''>is</span> <span m=''555806''>to</span> <span m=''556480''>simulate</span>
  <span m=''556905''>a channel,</span> <span m=''557330''>which</span> <span m=''557780''>is</span>
  <span m=''558400''>a</span> <span m=''558570''>random</span> <span m=''559050''>FIR
  filter,</span> <span m=''559700''>finite</span> <span m=''560150''>impulse</span>
  <span m=''560530''>response.</span> <span m=''562170''>What that</span> <span m=''562360''>means,</span>
  <span m=''562550''>it''s</span> <span m=''562640''>basically</span> <span m=''563140''>taking</span>
  <span m=''564690''>the</span> <span m=''564900''>copies</span> <span m=''565350''>of</span>
  <span m=''565450''>the</span> <span m=''565550''>input</span> <span m=''565940''>at</span>
  <span m=''566160''>different</span> <span m=''566430''>time</span> <span m=''566640''>offsets</span>
  <span m=''567060''>with</span> <span m=''567190''>random</span> <span m=''567870''>coefficients</span>
  <span m=''568400''>and just</span> <span m=''568590''>summing</span> <span m=''568850''>them
  up.</span> <span m=''569190''>It''s a</span> <span m=''569360''>huge</span> <span
  m=''570630''>multiply add</span> <span m=''571060''>computation.</span> </p><p><span
  m=''572010''>AUDIENCE: [INAUDIBLE]</span> </p><p><span m=''573350''>So</span> <span
  m=''574840''>this is</span> <span m=''575050''>80</span> <span m=''575360''>taps.</span>
  <span m=''578960''>And</span> <span m=''579680''>add</span> <span m=''579970''>some</span>
  <span m=''580370''>Gaussian</span> <span m=''580480''>noise.</span> <span m=''586050''>And</span>
  <span m=''586385''>then</span> <span m=''586720''>this,</span> <span m=''586960''>we</span>
  <span m=''587100''>take</span> <span m=''587350''>over,</span> <span m=''587820''>and</span>
  <span m=''588010''>then</span> <span m=''588220''>try</span> <span m=''588450''>to</span>
  <span m=''588630''>figure</span> <span m=''588890''>out</span> <span m=''589190''>what</span>
  <span m=''589460''>we put in in the</span> <span m=''589810''>first</span> <span
  m=''590070''>place.</span> <span m=''593530''>So</span> <span m=''593880''>a</span>
  <span m=''594230''>bunch of</span> <span m=''594380''>filtering.</span> <span m=''598310''>Again,</span>
  <span m=''599220''>more</span> <span m=''599370''>finite</span> <span m=''599780''>impulse</span>
  <span m=''599990''>response</span> <span m=''600300''>filtering.</span> </p><p><span
  m=''603180''>There''s</span> <span m=''603580''>a little</span> <span m=''603850''>closed</span>
  <span m=''604240''>loop</span> <span m=''605250''>that</span> <span m=''605950''>tries</span>
  <span m=''606280''>to estimate</span> <span m=''606630''>the</span> <span m=''606880''>signal</span>
  <span m=''607250''>amplitude</span> <span m=''608560''>and</span> <span m=''608780''>correct</span>
  <span m=''609090''>for it.</span> <span m=''609360''>That''s called</span> <span
  m=''609630''>automatic</span> <span m=''609990''>gain</span> <span m=''610240''>control</span>
  <span m=''610600''>to sort of</span> <span m=''610690''>keep it</span> <span m=''611360''>constant.</span>
  </p><p><span m=''614400''>And</span> <span m=''615090''>I''m</span> <span m=''615260''>probably
  getting</span> <span m=''615770''>these</span> <span m=''615890''>things</span>
  <span m=''616265''>a little out of</span> <span m=''616640''>order.</span> <span
  m=''621390''>This</span> <span m=''621470''>is the incoherent</span> <span m=''622035''>demodulation</span>
  <span m=''622300''>part.</span> <span m=''622605''>We</span> <span m=''622910''>square
  the signal</span> <span m=''623390''>to get rid of</span> <span m=''623746''>the
  carrier.</span> <span m=''627010''>Automatic</span> <span m=''627290''>gain control.</span>
  <span m=''627830''>Filtering.</span> </p><p><span m=''629420''>There''s</span> <span
  m=''629870''>another</span> <span m=''630200''>loop.</span> <span m=''631800''>This
  is called a</span> <span m=''632210''>phase</span> <span m=''632540''>lock</span>
  <span m=''632830''>loop.</span> <span m=''633370''>The</span> <span m=''633560''>idea</span>
  <span m=''633970''>is</span> <span m=''634390''>try</span> <span m=''634610''>to</span>
  <span m=''634690''>match</span> <span m=''635110''>a</span> <span m=''635180''>sine</span>
  <span m=''635570''>wave</span> <span m=''637330''>to</span> <span m=''637560''>some</span>
  <span m=''637760''>input</span> <span m=''638100''>signal.</span> <span m=''641605''>I
  don''t know how to</span> <span m=''641870''>explain it</span> <span m=''642110''>very</span>
  <span m=''642230''>well.</span> </p><p><span m=''644190''>It''s</span> <span m=''644320''>basically</span>
  <span m=''644720''>a</span> <span m=''644780''>locking</span> <span m=''645210''>type
  of</span> <span m=''645290''>detector.</span> <span m=''645960''>The</span> <span
  m=''646090''>idea is</span> <span m=''646400''>to</span> <span m=''646520''>lock</span>
  <span m=''646790''>into</span> <span m=''647060''>the</span> <span m=''647410''>phase</span>
  <span m=''648170''>of some</span> <span m=''648435''>periodic</span> <span m=''648700''>thing.</span>
  <span m=''649330''>This is for</span> <span m=''649830''>recovering</span> <span
  m=''650870''>when</span> <span m=''651250''>do you</span> <span m=''651440''>sample.</span>
  <span m=''652230''>Because you''ve</span> <span m=''652500''>got</span> <span m=''652760''>this
  messy</span> <span m=''653130''>waveform,</span> <span m=''653430''>you''ve</span>
  <span m=''653850''>got to know</span> <span m=''654730''>when</span> <span m=''655170''>to</span>
  <span m=''655280''>look</span> <span m=''655460''>and,</span> <span m=''655570''>say,</span>
  <span m=''655830''>OK,</span> <span m=''655950''>is it</span> <span m=''656270''>high,
  is it</span> <span m=''656650''>low to get</span> <span m=''657030''>a bit out.</span>
  </p><p><span m=''657478''>ARVIND THIAGARAJAN: [INAUDIBLE].</span> </p><p><span m=''658822''>MICAH
  BRODSKY: Yeah.</span> <span m=''660620''>I think that</span> <span m=''660970''>gives
  the</span> <span m=''661430''>picture.</span> <span m=''661705''>I''m</span> <span
  m=''661980''>probably boring</span> <span m=''662190''>everybody.</span> <span m=''664220''>Here''s</span>
  <span m=''664560''>a</span> <span m=''664600''>picture generated from the</span>
  <span m=''665030''>system.</span> <span m=''667200''>So</span> <span m=''667290''>the</span>
  <span m=''667400''>green line</span> <span m=''667660''>is the data</span> <span
  m=''668010''>in.</span> <span m=''671224''>Hi, low.</span> <span m=''671696''>[INAUDIBLE].</span>
  <span m=''673112''>The red line</span> <span m=''673584''>is</span> <span m=''674528''>the</span>
  <span m=''675000''>analog</span> <span m=''675472''>signal out</span> <span m=''675950''>right</span>
  <span m=''676090''>before</span> <span m=''676660''>it''s</span> <span m=''676810''>supposed</span>
  <span m=''677100''>to</span> <span m=''677260''>decide</span> <span m=''677760''>what</span>
  <span m=''677910''>the</span> <span m=''677990''>heck</span> <span m=''678150''>the
  input</span> <span m=''678597''>was.</span> <span m=''682110''>This is after</span>
  <span m=''682420''>squaring,</span> <span m=''682990''>and filtering,</span> <span
  m=''683250''>and</span> <span m=''683741''>automatic gain</span> <span m=''684232''>control,</span>
  <span m=''684723''>and all that.</span> </p><p><span m=''685705''>The</span> <span
  m=''686200''>little blips</span> <span m=''687500''>are</span> <span m=''687650''>actually</span>
  <span m=''687890''>because</span> <span m=''688170''>we</span> <span m=''688300''>used</span>
  <span m=''688940''>a</span> <span m=''689150''>modulation</span> <span m=''689410''>called</span>
  <span m=''689820''>alternate-mark-inversion.</span> <span m=''690785''>It</span>
  <span m=''691010''>basically</span> <span m=''691290''>flips</span> <span m=''691950''>every</span>
  <span m=''692280''>one.</span> <span m=''693232''>That''s why it''s blipping</span>
  <span m=''693708''>instead</span> <span m=''694184''>of being</span> <span m=''694660''>constant,</span>
  <span m=''695612''>which is</span> <span m=''696088''>to</span> <span m=''696326''>be</span>
  <span m=''696445''>[INAUDIBLE].</span> <span m=''697516''>And then the little blue</span>
  <span m=''698000''>daggers</span> <span m=''698600''>are</span> <span m=''698915''>the</span>
  <span m=''699230''>results</span> <span m=''699729''>of the phase lock</span> <span
  m=''700228''>loop</span> <span m=''700727''>to try and</span> <span m=''701226''>recover
  when to</span> <span m=''701725''>sample.</span> <span m=''702723''>And they''re
  kind of off,</span> <span m=''703222''>but they''re kind of</span> <span m=''703721''>right.</span>
  </p><p><span m=''704720''>And</span> <span m=''704860''>so,</span> <span m=''705770''>if</span>
  <span m=''705980''>you take</span> <span m=''706325''>the</span> <span m=''706670''>little</span>
  <span m=''707340''>blue blip,</span> <span m=''708300''>if the</span> <span m=''708660''>red
  line</span> <span m=''709020''>is above</span> <span m=''709570''>0,</span> <span
  m=''710190''>it''s a 1.</span> <span m=''711330''>And</span> <span m=''711585''>if
  it''s</span> <span m=''711840''>below 0,</span> <span m=''712763''>it''s</span>
  <span m=''713216''>0.</span> <span m=''715940''>And that''s how</span> <span m=''716120''>you
  get your</span> <span m=''716530''>bits out.</span> </p><p><span m=''724530''>This
  was</span> <span m=''725000''>hard to get</span> <span m=''725470''>right,</span>
  <span m=''727360''>mostly</span> <span m=''727730''>because</span> <span m=''728110''>of
  the framework issues.</span> <span m=''731960''>Implementing</span> <span m=''733190''>distributed</span>
  <span m=''733770''>objects</span> <span m=''734490''>on</span> <span m=''734860''>a</span>
  <span m=''734930''>system</span> <span m=''735280''>without</span> <span m=''736320''>real</span>
  <span m=''736640''>shared</span> <span m=''737010''>memory</span> <span m=''738270''>is</span>
  <span m=''738400''>hard</span> <span m=''738670''>because</span> <span m=''738730''>you</span>
  <span m=''738940''>have to</span> <span m=''738980''>serialize</span> <span m=''739490''>everything</span>
  <span m=''739840''>into</span> <span m=''740010''>a</span> <span m=''740070''>stream</span>
  <span m=''740300''>of bits</span> <span m=''740670''>and deserialize.</span> <span
  m=''744560''>So</span> <span m=''744800''>it</span> <span m=''745240''>really</span>
  <span m=''745450''>makes</span> <span m=''745680''>pie</span> <span m=''746040''>out
  of</span> <span m=''746310''>any</span> <span m=''746510''>existing</span> <span
  m=''747060''>object</span> <span m=''747410''>oriented</span> <span m=''747880''>code.</span>
  </p><p><span m=''749770''>We</span> <span m=''750260''>did</span> <span m=''750590''>quite</span>
  <span m=''750740''>a</span> <span m=''750770''>bit</span> <span m=''750880''>of</span>
  <span m=''750960''>work</span> <span m=''751200''>to</span> <span m=''751290''>get</span>
  <span m=''753000''>decent</span> <span m=''753430''>lock-free</span> <span m=''754626''>almost</span>
  <span m=''755044''>zero-copy.</span> <span m=''756300''>Another</span> <span m=''756520''>day</span>
  <span m=''756700''>or</span> <span m=''756820''>so,</span> <span m=''756980''>we</span>
  <span m=''757050''>probably</span> <span m=''757370''>would have</span> <span m=''757650''>gotten</span>
  <span m=''757730''>zero-copy--</span> <span m=''760080''>transfer--</span> <span
  m=''760530''>streaming</span> <span m=''760860''>of the</span> <span m=''761190''>data</span>
  <span m=''761450''>from</span> <span m=''761710''>place</span> <span m=''762020''>to</span>
  <span m=''762120''>place.</span> <span m=''763400''>And we</span> <span m=''763530''>had</span>
  <span m=''763790''>to</span> <span m=''764120''>keep</span> <span m=''764192''>the</span>
  <span m=''764265''>code</span> <span m=''764337''>footprint</span> <span m=''764850''>low.</span>
  </p><p><span m=''767680''>C++</span> <span m=''768270''>is</span> <span m=''768440''>bloated.</span>
  <span m=''769640''>We</span> <span m=''769840''>don''t</span> <span m=''769990''>have</span>
  <span m=''770120''>an</span> <span m=''770190''>overlay</span> <span m=''770490''>system</span>
  <span m=''770830''>yet</span> <span m=''771080''>to--</span> <span m=''772590''>if</span>
  <span m=''773220''>SPE</span> <span m=''774250''>is</span> <span m=''774370''>not</span>
  <span m=''774610''>running</span> <span m=''774870''>a</span> <span m=''774900''>particular</span>
  <span m=''775320''>box,</span> <span m=''775740''>it</span> <span m=''776160''>still</span>
  <span m=''776455''>has to have</span> <span m=''776750''>the code  for it.</span>
  <span m=''777230''>So</span> <span m=''778450''>we</span> <span m=''778550''>don''t</span>
  <span m=''778670''>have</span> <span m=''779130''>any</span> <span m=''779260''>infrastructure</span>
  <span m=''779950''>for--</span> </p><p><span m=''780210''>ARVIND THIAGARAJAN: There''s</span>
  <span m=''780595''>some macros</span> <span m=''780980''>to get around that,</span>
  <span m=''781450''>right?</span> </p><p><span m=''781960''>MICAH BRODSKY: Yeah.</span>
  <span m=''782230''>It''s</span> <span m=''782600''>pretty</span> <span m=''782760''>messy.</span>
  <span m=''783190''>So</span> <span m=''783280''>all</span> <span m=''783490''>the</span>
  <span m=''783580''>code</span> <span m=''783840''>is on all</span> <span m=''784205''>the
  SPEs.</span> <span m=''786530''>So</span> <span m=''786760''>code bloat  is</span>
  <span m=''787260''>particularly a</span> <span m=''787660''>issue.</span> <span
  m=''787980''>And</span> <span m=''788480''>XLC</span> <span m=''789070''>has</span>
  <span m=''789250''>this</span> <span m=''789430''>particular</span> <span m=''790370''>penchant</span>
  <span m=''790900''>for</span> <span m=''791150''>runtime</span> <span m=''791560''>type</span>
  <span m=''791780''>information</span> <span m=''792050''>and</span> <span m=''792320''>exception</span>
  <span m=''792850''>handling.</span> <span m=''796240''>Incredible</span> <span m=''796740''>amount</span>
  <span m=''796990''>of</span> <span m=''797070''>voodoo</span> <span m=''797370''>is</span>
  <span m=''797520''>necessary</span> <span m=''798700''>to</span> <span m=''798970''>get</span>
  <span m=''799200''>them</span> <span m=''799450''>and</span> <span m=''799540''>that</span>
  <span m=''799730''>70</span> <span m=''800075''>K of</span> <span m=''800420''>useless</span>
  <span m=''800840''>bloat</span> <span m=''801095''>out of</span> <span m=''801350''>there.</span>
  </p><p><span m=''805865''>ARVIND THIAGARAJAN: We</span> <span m=''806260''>pretty
  much</span> <span m=''806360''>have</span> <span m=''806730''>the--</span> </p><p><span
  m=''807470''>MICAH BRODSKY: It</span> <span m=''808070''>works,</span> <span m=''809160''>but</span>
  <span m=''809810''>not</span> <span m=''810450''>always.</span> </p><p><span m=''812634''>ARVIND
  THIAGARAJAN: We did</span> <span m=''813098''>manage</span> <span m=''813562''>to
  get  it</span> <span m=''814026''>running long enough</span> <span m=''814490''>to
  get some measurements.</span> </p><p><span m=''815420''>MICAH BRODSKY: Yeah,</span>
  <span m=''816920''>we</span> <span m=''817090''>did</span> <span m=''817290''>get</span>
  <span m=''817560''>some decent</span> <span m=''817810''>data</span> <span m=''818115''>out.</span>
  <span m=''819660''>Running</span> <span m=''820141''>on the PPE</span> <span m=''820622''>only,</span>
  <span m=''821584''>we can about</span> <span m=''822065''>170,000</span> <span m=''823027''>samples</span>
  <span m=''823508''>per second</span> <span m=''823989''>through.</span> <span m=''825440''>And</span>
  <span m=''826100''>with</span> <span m=''826150''>the</span> <span m=''826220''>scheduling</span>
  <span m=''826680''>file,</span> <span m=''826970''>that''s</span> <span m=''827460''>kind</span>
  <span m=''827870''>of</span> <span m=''828030''>rule</span> <span m=''828490''>of
  thumb--</span> <span m=''828640''>we</span> <span m=''828730''>just</span> <span
  m=''829080''>roughly</span> <span m=''829310''>said,</span> <span m=''829560''>OK,</span>
  <span m=''829800''>that</span> <span m=''829970''>looks</span> <span m=''830130''>about</span>
  <span m=''830360''>this big.</span> <span m=''830640''>We''ll</span> <span m=''830740''>throw
  it</span> <span m=''830810''>on</span> <span m=''831110''>this</span> <span m=''831360''>SPE,</span>
  <span m=''831910''>SPE,</span> <span m=''832656''>SPE.</span> <span m=''833520''>We
  got</span> <span m=''834010''>roughly</span> <span m=''834500''>four</span> <span
  m=''834990''>times that</span> <span m=''835480''>using five</span> <span m=''835970''>SPEs.</span>
  </p><p><span m=''836950''>ARVIND THIAGARAJAN: The core</span> <span m=''837440''>foorprints
  are</span> <span m=''837930''>really large,</span> <span m=''838420''>but--</span>
  </p><p><span m=''839400''>[INTERPOSING VOICES]</span> </p><p><span m=''842946''>MICAH
  BRODSKY: We</span> <span m=''844850''>really</span> <span m=''845100''>had</span>
  <span m=''845230''>to</span> <span m=''845300''>push</span> <span m=''845510''>down</span>
  <span m=''845690''>things</span> <span m=''845900''>like</span> <span m=''846050''>our</span>
  <span m=''846130''>queue.</span> <span m=''846580''>We</span> <span m=''846900''>just</span>
  <span m=''847040''>didn''t</span> <span m=''847110''>have</span> <span m=''847370''>enough
  memory.</span> <span m=''848572''>It sucked.</span> <span m=''854440''>We basically</span>
  <span m=''854740''>just said</span> <span m=''855182''>that already.</span> </p><p><span
  m=''855624''>ARVIND THIAGARAJAN: Some performance bottlenecks,</span> <span m=''856066''>I</span>
  <span m=''856508''>guess.</span> </p><p><span m=''856950''>[INTERPOSING VOICES]</span>
  </p><p><span m=''857840''>MICAH BRODSKY: Interesting</span> <span m=''858780''>performance</span>
  <span m=''859250''>behavior.</span> <span m=''860050''>We</span> <span m=''860190''>found</span>
  <span m=''860640''>that</span> <span m=''861170''>the</span> <span m=''861490''>SPEs</span>
  <span m=''861820''>are</span> <span m=''861900''>ridiculously</span> <span m=''862590''>underutilized.</span>
  <span m=''865870''>Most</span> <span m=''866170''>of</span> <span m=''866210''>the</span>
  <span m=''866300''>algorithms</span> <span m=''866710''>are quite</span> <span m=''867030''>a
  bit</span> <span m=''867150''>zippier</span> <span m=''867840''>on</span> <span
  m=''868090''>the</span> <span m=''868470''>SPEs.</span> <span m=''869970''>And</span>
  <span m=''870110''>so,</span> <span m=''870510''>they</span> <span m=''870640''>may</span>
  <span m=''870790''>be</span> <span m=''870920''>running</span> <span m=''871130''>about</span>
  <span m=''871300''>a</span> <span m=''871360''>third</span> <span m=''871700''>of</span>
  <span m=''871760''>the</span> <span m=''871850''>time,</span> <span m=''872880''>and</span>
  <span m=''873030''>the</span> <span m=''873090''>rest</span> <span m=''873290''>of</span>
  <span m=''873450''>time just</span> <span m=''873670''>waiting</span> <span m=''873960''>for</span>
  <span m=''874100''>input.</span> </p><p><span m=''874860''>And</span> <span m=''875140''>then
  the</span> <span m=''875210''>PPE,</span> <span m=''876510''>which</span> <span
  m=''876750''>is</span> <span m=''876860''>doing</span> <span m=''877070''>only</span>
  <span m=''877290''>a</span> <span m=''877320''>tiny</span> <span m=''877760''>amount</span>
  <span m=''877950''>of the</span> <span m=''878070''>computation--</span> <span m=''878650''>basically</span>
  <span m=''878910''>just</span> <span m=''879180''>feeding it</span> <span m=''879450''>in
  and</span> <span m=''879800''>sucking</span> <span m=''880180''>it</span> <span
  m=''880250''>out--</span> <span m=''881010''>is</span> <span m=''881280''>spending</span>
  <span m=''881850''>half of</span> <span m=''882150''>its</span> <span m=''882360''>time</span>
  <span m=''883440''>all</span> <span m=''883660''>busy</span> <span m=''884540''>and,</span>
  <span m=''884650''>the</span> <span m=''884750''>other</span> <span m=''884880''>half
  of</span> <span m=''885020''>the</span> <span m=''885160''>time,</span> <span m=''885480''>stuck</span>
  <span m=''885880''>in</span> <span m=''886070''>flow</span> <span m=''886360''>control</span>
  <span m=''887930''>waiting</span> <span m=''888350''>for</span> <span m=''888520''>queue</span>
  <span m=''888780''>space,</span> <span m=''889130''>which</span> <span m=''889510''>is--</span>
  <span m=''891730''>our</span> <span m=''891870''>flow</span> <span m=''892080''>control</span>
  <span m=''892400''>algorithm</span> <span m=''892760''>sucks.</span> <span m=''894790''>Better</span>
  <span m=''895150''>with</span> <span m=''895340''>time.</span> <span m=''897290''>So</span>
  <span m=''897460''>it</span> <span m=''898040''>seems</span> <span m=''898390''>like</span>
  <span m=''898550''>you</span> <span m=''898620''>should</span> <span m=''898790''>be</span>
  <span m=''898880''>able</span> <span m=''898990''>to</span> <span m=''899060''>do</span>
  <span m=''899190''>quite</span> <span m=''899450''>a</span> <span m=''899490''>bit</span>
  <span m=''899690''>better</span> <span m=''900020''>than</span> <span m=''900500''>we
  did</span> <span m=''901940''>with a bit</span> <span m=''902170''>more</span> <span
  m=''902350''>work.</span> </p><p><span m=''909810''>We</span> <span m=''910070''>need</span>
  <span m=''910330''>to</span> <span m=''910690''>cut down the</span> <span m=''911096''>footprint.</span>
  <span m=''912720''>And</span> <span m=''912900''>once</span> <span m=''913110''>we</span>
  <span m=''913200''>have</span> <span m=''913310''>a</span> <span m=''913350''>little</span>
  <span m=''913480''>bit</span> <span m=''913600''>of</span> <span m=''913660''>breathing</span>
  <span m=''914040''>room</span> <span m=''914600''>and</span> <span m=''914950''>get</span>
  <span m=''915120''>rid</span> <span m=''915240''>of</span> <span m=''915330''>the</span>
  <span m=''915650''>nasty</span> <span m=''915890''>race</span> <span m=''916220''>bugs</span>
  <span m=''916550''>and</span> <span m=''916690''>such,</span> <span m=''917240''>we
  can finally</span> <span m=''917700''>investigate</span> <span m=''918200''>what</span>
  <span m=''918350''>was</span> <span m=''918470''>our</span> <span m=''918960''>original,</span>
  <span m=''919440''>pie</span> <span m=''919650''>in</span> <span m=''919730''>the</span>
  <span m=''919810''>sky</span> <span m=''920210''>goal</span> <span m=''920850''>of</span>
  <span m=''921080''>automatically</span> <span m=''921560''>deciding</span> <span
  m=''922160''>what</span> <span m=''922370''>goes</span> <span m=''922590''>where,</span>
  <span m=''925690''>taking</span> <span m=''926020''>measurements</span> <span m=''926700''>of</span>
  <span m=''926970''>the</span> <span m=''927050''>performance</span> <span m=''928070''>and</span>
  <span m=''928280''>then</span> <span m=''928440''>feeding</span> <span m=''928750''>that</span>
  <span m=''928950''>back</span> <span m=''929755''>to</span> <span m=''930170''>producing</span>
  <span m=''930600''>a</span> <span m=''930650''>better</span> <span m=''930920''>placement</span>
  <span m=''931370''>of</span> <span m=''931480''>operators,</span> <span m=''933150''>and</span>
  <span m=''934390''>applying</span> <span m=''934610''>data</span> <span m=''934870''>parallelism</span>
  <span m=''935390''>by</span> <span m=''935630''>instantiating</span> <span m=''936150''>operators</span>
  <span m=''936600''>on</span> <span m=''937620''>multiple</span> <span m=''937960''>different</span>
  <span m=''938280''>SPEs</span> <span m=''939360''>and</span> <span m=''939540''>splitting</span>
  <span m=''939870''>the</span> <span m=''939960''>data</span> <span m=''940190''>stream.</span>
  <span m=''943240''>And</span> <span m=''943610''>just</span> <span m=''943800''>doing</span>
  <span m=''944010''>more.</span> </p><p></p><p><span m=''949818''>AUDIENCE: Since
  your</span> <span m=''950300''>PPE</span> <span m=''950782''>is at</span> <span
  m=''951264''>40% to 50%</span> <span m=''951746''>utilization,</span> <span m=''952228''>did
  you</span> <span m=''952710''>put</span> <span m=''953192''>actual</span> <span
  m=''953674''>work on there?</span> </p><p><span m=''954638''>MICAH BRODSKY: We did</span>
  <span m=''955120''>put some</span> <span m=''955602''>work on there.</span> <span
  m=''956100''>Actually,</span> <span m=''956290''>we put</span> <span m=''956630''>work
  on</span> <span m=''956970''>there</span> <span m=''957110''>because</span> <span
  m=''957500''>we</span> <span m=''957600''>couldn''t</span> <span m=''957890''>fit</span>
  <span m=''958190''>all</span> <span m=''958340''>the</span> <span m=''958400''>boxes--</span>
  <span m=''959190''>the</span> <span m=''959300''>code</span> <span m=''959580''>for
  all the</span> <span m=''959800''>boxes</span> <span m=''960230''>under the</span>
  <span m=''960400''>SPEs.</span> <span m=''961430''>So</span> <span m=''961620''>we</span>
  <span m=''962060''>started</span> <span m=''962160''>strategically</span> <span
  m=''962460''>to put</span> <span m=''962760''>a few</span> <span m=''963120''>things</span>
  <span m=''963310''>at the beginning</span> <span m=''963440''>and a</span> <span
  m=''963750''>few things</span> <span m=''964060''>at</span> <span m=''964290''>the
  end</span> <span m=''964450''>which</span> <span m=''964630''>weren''t</span> <span
  m=''965020''>supposed</span> <span m=''965400''>to</span> <span m=''965440''>be</span>
  <span m=''965530''>very</span> <span m=''965710''>computationally</span> <span m=''966340''>intensive,</span>
  <span m=''967290''>and</span> <span m=''967350''>yet</span> <span m=''967480''>they</span>
  <span m=''967560''>managed</span> <span m=''968110''>to</span> <span m=''968200''>take
  up half</span> <span m=''968440''>the</span> <span m=''968510''>CPU.</span> </p><p><span
  m=''970200''>The</span> <span m=''970270''>issue</span> <span m=''970490''>with</span>
  <span m=''970590''>the</span> <span m=''970720''>other</span> <span m=''970930''>half</span>
  <span m=''971090''>of the</span> <span m=''971230''>CPU</span> <span m=''971680''>is</span>
  <span m=''972130''>that</span> <span m=''972250''>it''s</span> <span m=''972370''>actually</span>
  <span m=''973150''>inside</span> <span m=''973500''>an</span> <span m=''973610''>inner</span>
  <span m=''973830''>loop</span> <span m=''974210''>deep</span> <span m=''974590''>recursive</span>
  <span m=''975030''>in</span> <span m=''975410''>blocking</span> <span m=''976570''>because,</span>
  <span m=''977200''>basically,</span> <span m=''977580''>our</span> <span m=''977650''>back</span>
  <span m=''977950''>pressure</span> <span m=''978310''>isn''t</span> <span m=''978610''>online</span>
  <span m=''979190''>yet.</span> <span m=''979840''>So</span> <span m=''980260''>if</span>
  <span m=''981210''>it</span> <span m=''981290''>tries</span> <span m=''981630''>to</span>
  <span m=''981810''>emit</span> <span m=''982010''>something</span> <span m=''982310''>to</span>
  <span m=''982420''>a</span> <span m=''982470''>queue,</span> <span m=''982690''>and
  that queue</span> <span m=''983035''>is full, it</span> <span m=''983380''>just</span>
  <span m=''983510''>stops.</span> <span m=''984860''>And</span> <span m=''985150''>it</span>
  <span m=''985270''>really</span> <span m=''985540''>could</span> <span m=''985660''>be</span>
  <span m=''985770''>running a</span> <span m=''986000''>whole bunch of</span> <span
  m=''986460''>other</span> <span m=''986560''>stuff,</span> <span m=''987030''>but</span>
  <span m=''987504''>it''s not  smart enough</span> <span m=''987978''>to do that
  ahead.</span> </p><p><span m=''988452''>AUDIENCE: [INAUDIBLE]</span> </p><p><span
  m=''996850''>MICAH BRODSKY: Unlike</span> <span m=''996940''>a</span> <span m=''997210''>model
  like</span> <span m=''997690''>StreamIt,</span> <span m=''998410''>everything</span>
  <span m=''998780''>here is</span> <span m=''999250''>asynchronous</span> <span m=''999640''>and</span>
  <span m=''1000030''>code</span> <span m=''1000350''>driven.</span> <span m=''1001130''>The</span>
  <span m=''1001460''>SPUs</span> <span m=''1001890''>they</span> <span m=''1002120''>can</span>
  <span m=''1002400''>decide</span> <span m=''1002900''>on the</span> <span m=''1003170''>fly</span>
  <span m=''1003905''>how</span> <span m=''1004350''>much to emit.</span> <span m=''1005685''>The
  programmer</span> <span m=''1006130''>doesn''t have</span> <span m=''1006575''>to
  declare anything,</span> <span m=''1007640''>But  it</span> <span m=''1007780''>means</span>
  <span m=''1008300''>everything''s</span> <span m=''1008743''>asynchronous.</span>
  <span m=''1010980''>And</span> <span m=''1011150''>so</span> <span m=''1011790''>you
  basically</span> <span m=''1012510''>[? race the issues ?]</span> <span m=''1013240''>galore.</span>
  </p><p><span m=''1014220''>AUDIENCE: But</span> <span m=''1014340''>in</span> <span
  m=''1014440''>this a</span> <span m=''1014540''>application,</span> <span m=''1014855''>do</span>
  <span m=''1015170''>you</span> <span m=''1015300''>find any</span> <span m=''1015770''>dynamic</span>
  <span m=''1016170''>rates?</span> </p><p><span m=''1016570''>MICAH BRODSKY: In this</span>
  <span m=''1017067''>application, there''s</span> <span m=''1017564''>not much.</span>
  <span m=''1018061''>It''s a very</span> <span m=''1018558''>simple application.</span>
  <span m=''1019055''>If we actually</span> <span m=''1019552''>went to</span> <span
  m=''1020049''>packetization,</span> <span m=''1022037''>error</span> <span m=''1022534''>correction,</span>
  <span m=''1023031''>compression,</span> <span m=''1023528''>things</span> <span
  m=''1024025''>like that,</span> <span m=''1024522''>we''d probably see a lot more</span>
  <span m=''1025019''>of that.</span> <span m=''1026013''>This is</span> <span m=''1026510''>definitely</span>
  <span m=''1027007''>underutilized</span> <span m=''1027504''>in</span> <span m=''1028001''>the</span>
  <span m=''1028498''>asynchronous</span> <span m=''1028995''>capabilities</span>
  <span m=''1029989''>of</span> <span m=''1030486''>the system.</span> </p><p><span
  m=''1033468''>AUDIENCE: In the case</span> <span m=''1033965''>of radio,</span>
  <span m=''1034462''>wouldn''t</span> <span m=''1034959''>it be OK</span> <span m=''1035456''>to
  draw</span> <span m=''1035953''>[INAUDIBLE]</span> <span m=''1036450''>frame</span>
  <span m=''1036947''>into</span> <span m=''1037444''>audio</span> <span m=''1037941''>data</span>
  <span m=''1038438''>just</span> <span m=''1038935''>because</span> <span m=''1040440''>you''re</span>
  <span m=''1040599''>spending</span> <span m=''1040990''>so</span> <span m=''1041099''>much</span>
  <span m=''1041359''>time</span> <span m=''1041809''>waiting,</span> <span m=''1042260''>it''d
  be better</span> <span m=''1042640''>just to</span> <span m=''1043596''>relieve</span>
  <span m=''1044074''>pressure</span> <span m=''1044552''>on the queues</span> <span
  m=''1045030''>by just</span> <span m=''1045508''>dropping</span> <span m=''1045986''>some
  frames</span> <span m=''1046464''>that are</span> <span m=''1046942''>unnecessary.</span>
  </p><p><span m=''1047420''>MICAH BRODSKY: It might well be.</span> </p><p><span
  m=''1047898''>AUDIENCE: And interpolating</span> <span m=''1048376''>it in the</span>
  <span m=''1048854''>end</span> <span m=''1049332''>to try</span> <span m=''1049810''>to
  fix it up a</span> <span m=''1050288''>little bit.</span> </p><p><span m=''1050766''>MICAH
  BRODSKY: It might well be.</span> <span m=''1051244''>We decided not to do</span>
  <span m=''1051730''>that</span> <span m=''1052210''>as</span> <span m=''1052290''>a
  part of the</span> <span m=''1052570''>framework</span> <span m=''1053890''>because</span>
  <span m=''1054354''>[INAUDIBLE]</span> <span m=''1055282''>policy</span> <span m=''1055746''>decision,</span>
  <span m=''1056210''>and we didn''t</span> <span m=''1056674''>want to make that</span>
  <span m=''1057138''>for all possible applications.</span> <span m=''1058994''>But</span>
  <span m=''1059458''>if we figure</span> <span m=''1059930''>out a</span> <span m=''1060270''>good
  way to</span> <span m=''1060610''>dispose that,</span> <span m=''1061050''>that</span>
  <span m=''1061527''>definitely  would be</span> <span m=''1062004''>an option.</span>
  <span m=''1062960''>Just drop</span> <span m=''1063335''>a few</span> <span m=''1063710''>packets.</span>
  <span m=''1064140''>Drop</span> <span m=''1064598''>a few</span> <span m=''1065056''>samples.</span>
  </p><p><span m=''1067810''>AUDIENCE: So</span> <span m=''1068050''>what about  buffer</span>
  <span m=''1068540''>sizes?</span> <span m=''1068875''>Do you declare</span> <span
  m=''1069210''>the buffer</span> <span m=''1069697''>size</span> <span m=''1070184''>as
  well?</span> </p><p><span m=''1071240''>MICAH BRODSKY: Yeah.</span> <span m=''1071770''>The
  way</span> <span m=''1072110''>we</span> <span m=''1072220''>have</span> <span m=''1072380''>it</span>
  <span m=''1072480''>now--</span> <span m=''1073315''>there''s</span> <span m=''1073710''>actually
  just a</span> <span m=''1073940''>#define</span> <span m=''1074360''>in the code</span>
  <span m=''1074520''>that</span> <span m=''1074690''>says</span> <span m=''1074820''>all</span>
  <span m=''1075180''>buffers are</span> <span m=''1075450''>this</span> <span m=''1075660''>size.</span>
  </p><p><span m=''1077030''>AUDIENCE: Do you need</span> <span m=''1077260''>any
  double</span> <span m=''1077590''>buffering in there?</span> </p><p><span m=''1079340''>MICAH
  BRODSKY: You</span> <span m=''1079590''>don''t</span> <span m=''1079800''>need</span>
  <span m=''1079960''>it.</span> <span m=''1080300''>Well,</span> <span m=''1080730''>actually,</span>
  <span m=''1081850''>the</span> <span m=''1081960''>way</span> <span m=''1082080''>it</span>
  <span m=''1082190''>works</span> <span m=''1082490''>is</span> <span m=''1082580''>that</span>
  <span m=''1082760''>there''s</span> <span m=''1083250''>this</span> <span m=''1083650''>remote</span>
  <span m=''1084010''>heap</span> <span m=''1084280''>input</span> <span m=''1084640''>queue.</span>
  <span m=''1085360''>And</span> <span m=''1086050''>an</span> <span m=''1086310''>upstream</span>
  <span m=''1086450''>SPE</span> <span m=''1086820''>just</span> <span m=''1087190''>DMAs</span>
  <span m=''1087800''>things</span> <span m=''1088120''>in</span> <span m=''1088270''>as</span>
  <span m=''1088460''>it</span> <span m=''1088660''>feels</span> <span m=''1088950''>like.</span>
  <span m=''1089640''>And</span> <span m=''1089860''>then</span> <span m=''1090170''>the</span>
  <span m=''1090570''>downstream</span> <span m=''1091040''>SPE</span> <span m=''1091590''>looks.</span>
  <span m=''1091950''>Is</span> <span m=''1092300''>there</span> <span m=''1092420''>something</span>
  <span m=''1092710''>here?</span> <span m=''1093140''>Grab it,</span> <span m=''1093500''>use
  it.</span> <span m=''1094330''>So</span> <span m=''1095830''>it</span> <span m=''1095950''>just</span>
  <span m=''1096240''>works,</span> <span m=''1096720''>however</span> <span m=''1096990''>much</span>
  <span m=''1097180''>buffering</span> <span m=''1097670''>there is.</span> </p><p><span
  m=''1098110''>ARVIND THIAGARAJAN: The ring buffer</span> <span m=''1098550''>and</span>
  <span m=''1098696''>the</span> <span m=''1098843''>[INAUDIBLE]</span> <span m=''1099430''>should
  get that block</span> <span m=''1099870''>[? free. ?]</span> </p><p><span m=''1101620''>MICAH
  BRODSKY: That''s</span> <span m=''1102940''>a</span> <span m=''1102970''>benefit</span>
  <span m=''1103380''>of</span> <span m=''1103440''>the</span> <span m=''1103740''>asynchronous</span>
  <span m=''1104150''>approach.</span> <span m=''1104610''>It just</span> <span m=''1104990''>works,</span>
  <span m=''1105760''>if</span> <span m=''1105910''>you</span> <span m=''1106010''>have</span>
  <span m=''1106270''>memory,</span> <span m=''1106610''>which we</span> <span m=''1107062''>don''t.</span>
  <span m=''1110165''>Queues</span> <span m=''1110550''>are</span> <span m=''1110680''>tiny.</span>
  </p><p><span m=''1115995''>SPEAKER: [INAUDIBLE]</span> <span m=''1116490''>is</span>
  <span m=''1116985''>angrily</span> <span m=''1117480''>telling</span> <span m=''1117975''>me
  that his</span> <span m=''1118470''>connection</span> <span m=''1118965''>dropped</span>
  <span m=''1119460''>but he''s not</span> <span m=''1119955''>picking up the phone.</span>
  <span m=''1129870''>Yeah,</span> <span m=''1130243''>I could see it</span> <span
  m=''1130616''>in there.</span> </p><p></p><p><span m=''1141427''>AUDIENCE: Any other</span>
  <span m=''1141924''>questions for them?</span> <span m=''1144906''>Did</span> <span
  m=''1145410''>you</span> <span m=''1145530''>want</span> <span m=''1145640''>to
  do</span> <span m=''1145960''>the demo?</span> </p><p><span m=''1147920''>MICAH
  BRODSKY: Nah.</span> </p><p><span m=''1150370''>SPEAKER ON PHONE: What did you</span>
  <span m=''1150860''>do to get</span> <span m=''1151350''>race conditions?</span>
  </p><p><span m=''1153320''>MICAH BRODSKY: How</span> <span m=''1153700''>did</span>
  <span m=''1153830''>we</span> <span m=''1153890''>manage to get</span> <span m=''1154320''>ourselves</span>
  <span m=''1154640''>race</span> <span m=''1154890''>conditions?</span> <span m=''1158150''>Well,</span>
  <span m=''1159460''>it''s</span> <span m=''1159690''>a</span> <span m=''1159730''>mix</span>
  <span m=''1160200''>of</span> <span m=''1160470''>the</span> <span m=''1160550''>fact</span>
  <span m=''1160910''>that</span> <span m=''1161290''>all</span> <span m=''1161480''>the</span>
  <span m=''1161810''>SPUs</span> <span m=''1162775''>can</span> <span m=''1163050''>essentially</span>
  <span m=''1163590''>operate</span> <span m=''1163890''>as</span> <span m=''1164190''>independent</span>
  <span m=''1164680''>threads</span> <span m=''1165170''>and</span> <span m=''1165280''>are</span>
  <span m=''1165390''>sort</span> <span m=''1165550''>of</span> <span m=''1165620''>asynchronously</span>
  <span m=''1166250''>DMAing</span> <span m=''1166780''>things</span> <span m=''1167110''>to</span>
  <span m=''1167180''>each</span> <span m=''1167360''>other</span> <span m=''1168200''>and</span>
  <span m=''1169650''>somewhat</span> <span m=''1170010''>poor--</span> <span m=''1171350''>legacy</span>
  <span m=''1171730''>driven</span> <span m=''1172170''>architectural</span> <span
  m=''1172495''>decisions</span> <span m=''1172820''>on the</span> <span m=''1173180''>way
  the</span> <span m=''1173530''>PPU</span> <span m=''1173880''>code</span> <span
  m=''1174230''>works.</span> <span m=''1175462''>Because we ported</span> <span m=''1175830''>a
  lot</span> <span m=''1176240''>of code</span> <span m=''1176650''>from the</span>
  <span m=''1177090''>WaveScope</span> <span m=''1177530''>platform.</span> </p><p><span
  m=''1178850''>[? ARVIND THIAGARAJAN: Which wasn''t very ?]</span> <span m=''1179180''>well</span>
  <span m=''1179380''>documented.</span> </p><p><span m=''1180085''>MICAH BRODSKY:
  And</span> <span m=''1180370''>that</span> <span m=''1180720''>was</span> <span
  m=''1180920''>intended to be</span> <span m=''1181260''>multithreaded</span> <span
  m=''1181860''>with</span> <span m=''1182280''>Pthreads,</span> <span m=''1182770''>which</span>
  <span m=''1183740''>in</span> <span m=''1183920''>our</span> <span m=''1184210''>original,</span>
  <span m=''1184450''>naive</span> <span m=''1185260''>before</span> <span m=''1185700''>we</span>
  <span m=''1185750''>actually</span> <span m=''1186050''>started</span> <span m=''1186350''>the
  class</span> <span m=''1187770''>impression,</span> <span m=''1188290''>we</span>
  <span m=''1188540''>thought</span> <span m=''1188605''>we</span> <span m=''1188671''>were</span>
  <span m=''1188737''>just</span> <span m=''1188802''>going</span> <span m=''1188868''>to</span>
  <span m=''1188934''>port</span> <span m=''1189000''>the whole thing and use</span>
  <span m=''1189430''>Pthreads</span> <span m=''1189700''>on the sub,</span> <span
  m=''1190160''>which  of</span> <span m=''1190500''>course is not</span> <span m=''1190850''>possible.</span>
  <span m=''1192800''>So</span> <span m=''1193890''>there</span> <span m=''1194100''>were</span>
  <span m=''1194580''>still</span> <span m=''1194860''>some</span> <span m=''1195180''>threaded</span>
  <span m=''1195480''>components</span> <span m=''1196000''>in</span> <span m=''1196100''>there.</span>
  <span m=''1197490''>And</span> <span m=''1198140''>we</span> <span m=''1198530''>introduced</span>
  <span m=''1198750''>a lot</span> <span m=''1199080''>of bugs</span> <span m=''1199780''>trying</span>
  <span m=''1200060''>to port</span> <span m=''1200502''>the</span> <span m=''1200944''>thing.</span>
  <span m=''1203920''>See</span> <span m=''1204470''>if i can--</span> </p><p><span
  m=''1205080''>ARVIND THIAGARAJAN: The</span> <span m=''1205480''>surprising</span>
  <span m=''1205890''>thing was</span> <span m=''1206010''>the</span> <span m=''1206090''>fact</span>
  <span m=''1206440''>that</span> <span m=''1206530''>we</span> <span m=''1206600''>had</span>
  <span m=''1206730''>to</span> <span m=''1206790''>replace</span> <span m=''1207380''>array</span>
  <span m=''1207530''>constructors</span> <span m=''1208070''>in</span> <span m=''1208330''>order</span>
  <span m=''1208510''>to eliminate</span> <span m=''1208590''>[? RTTI. ?]</span> <span
  m=''1210200''>And</span> <span m=''1210490''>it</span> <span m=''1210970''>was just
  a big deal</span> </p><p><span m=''1211240''>[INTERPOSING VOICES].</span> </p><p><span
  m=''1211550''>MICAH BRODSKY: We had to get</span> <span m=''1211805''>rid of</span>
  <span m=''1212060''>new,</span> <span m=''1212335''>we had to get</span> <span m=''1212610''>rid</span>
  <span m=''1212850''>of</span> <span m=''1213290''>delete.</span> <span m=''1213770''>We
  had</span> <span m=''1214000''>to get</span> <span m=''1214295''>rid of</span> <span
  m=''1214590''>array</span> <span m=''1214895''>constructors.</span> <span m=''1215689''>We
  had</span> <span m=''1216178''>to get rid</span> <span m=''1216667''>of--</span>
  </p><p><span m=''1217156''>ARVIND THIAGARAJAN: Virtual</span> <span m=''1217645''>destructors.</span>
  </p><p><span m=''1218134''>MICAH BRODSKY: --pure virtual</span> <span m=''1218623''>functions</span>
  <span m=''1219112''>and virtual</span> <span m=''1219601''>destructors.</span> <span
  m=''1220090''>It was a mess.</span> <span m=''1221490''>I</span> <span m=''1221570''>guess</span>
  <span m=''1222280''>one</span> <span m=''1224050''>more</span> <span m=''1224540''>pithy
  thing I</span> <span m=''1225030''>could say about</span> <span m=''1225520''>race
  conditions is</span> <span m=''1227480''>it''s</span> <span m=''1227590''>incredible</span>
  <span m=''1227950''>how many</span> <span m=''1228290''>subtle</span> <span m=''1228660''>race</span>
  <span m=''1229030''>conditions</span> <span m=''1229400''>and bugs</span> <span
  m=''1229888''>we found</span> <span m=''1230376''>in the</span> <span m=''1230864''>remote</span>
  <span m=''1231352''>keeping</span> <span m=''1231840''>queueing</span> <span m=''1232328''>library.</span>
  </p><p><span m=''1235260''>Because</span> <span m=''1235770''>there''s</span> <span
  m=''1235960''>one--</span> <span m=''1237470''>it''s a lock</span> <span m=''1237840''>free</span>
  <span m=''1238255''>asynchronous</span> <span m=''1238670''>data</span> <span m=''1238930''>structure.</span>
  <span m=''1241110''>There are</span> <span m=''1241360''>two</span> <span m=''1241980''>threads--</span>
  <span m=''1243436''>two</span> <span m=''1243810''>SPUs</span> <span m=''1244185''>reading</span>
  <span m=''1244560''>and writing</span> <span m=''1244900''>from</span> <span m=''1245235''>it
  at the</span> <span m=''1245570''>same time.</span> <span m=''1246660''>And</span>
  <span m=''1246850''>there''s</span> <span m=''1247090''>all sorts of</span> <span
  m=''1247340''>little</span> <span m=''1247700''>subtleties</span> <span m=''1248380''>where</span>
  <span m=''1249140''>if you</span> <span m=''1249330''>get</span> <span m=''1249780''>it
  a little bit</span> <span m=''1249900''>wrong,</span> <span m=''1250110''>you end
  up</span> <span m=''1250515''>with one of the</span> <span m=''1250920''>queue</span>
  <span m=''1251100''>pointers</span> <span m=''1251650''>overrunning</span> <span
  m=''1252250''>the</span> <span m=''1252370''>other</span> <span m=''1252530''>guy,</span>
  <span m=''1253340''>and</span> <span m=''1253595''>you have basically</span> <span
  m=''1253850''>dangling</span> <span m=''1254295''>pointers</span> <span m=''1254740''>and</span>
  <span m=''1255000''>things</span> <span m=''1255310''>like</span> <span m=''1255620''>that.</span>
  <span m=''1257130''>At</span> <span m=''1257310''>least</span> <span m=''1257660''>three</span>
  <span m=''1257830''>or four times,</span> <span m=''1258140''>we</span> <span m=''1258450''>spent
  a</span> <span m=''1258860''>few</span> <span m=''1259090''>hours</span> <span m=''1259910''>until</span>
  <span m=''1260080''>we</span> <span m=''1260630''>discovered</span> <span m=''1261200''>that</span>
  <span m=''1261610''>was the cause</span> <span m=''1261910''>of</span> <span m=''1262510''>mysterious</span>
  <span m=''1263110''>behavior.</span> </p><p></p><p><span m=''1270610''>AUDIENCE:
  Anything else?</span> <span m=''1272110''>Thank you.</span> </p><p><span m=''1272710''>[APPLAUSE]</span>
  </p>'
type: course
uid: 184452f8919184055a18a9c47db2608a

---
None