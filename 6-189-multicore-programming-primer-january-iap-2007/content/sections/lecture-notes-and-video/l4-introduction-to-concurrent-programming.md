---
about_this_resource_text: <p><strong>Topics covered:</strong> Introduction to concurrent
  programming</p><p><strong>Instructor:</strong> Saman Amarasinghe</p><p>Subtitles
  are provided through the generous assistance of Rohan Pai.</p>
course_id: 6-189-multicore-programming-primer-january-iap-2007
embedded_media:
- id: l4.jpg
  parent_uid: 5bb0a95608e37ec6dc17e8a9b44d408a
  technical_location: https://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-189-multicore-programming-primer-january-iap-2007/lecture-notes-and-video/l4-introduction-to-concurrent-programming/l4.jpg
  title: 'L4: Introduction to Concurrent Programming'
  type: null
  uid: 658df4d0ce609c6e9571b947d78ffb3d
- id: Video-YouTube-Stream
  media_location: qhH6ysHlaiM
  parent_uid: 5bb0a95608e37ec6dc17e8a9b44d408a
  title: Video-YouTube-Stream
  type: Video
  uid: d64306355687552a6790bdaf7786651f
- id: Thumbnail-YouTube-JPG
  media_location: https://img.youtube.com/vi/qhH6ysHlaiM/default.jpg
  parent_uid: 5bb0a95608e37ec6dc17e8a9b44d408a
  title: Thumbnail-YouTube-JPG
  type: Thumbnail
  uid: 8dd0cd284f090ae0f96cfa465ac8873a
- id: Video-iTunesU-MP4
  media_location: https://itunes.apple.com/us/itunes-u/id341597759
  parent_uid: 5bb0a95608e37ec6dc17e8a9b44d408a
  title: Video-iTunes U-MP4
  type: Video
  uid: 884a0df5e1534a350d405b8c619ad0da
- id: Video-InternetArchive-MP4
  media_location: http://www.archive.org/download/MIT6.189IAP07/ocw-6.189-iap07-lec04_300k.mp4
  parent_uid: 5bb0a95608e37ec6dc17e8a9b44d408a
  title: Video-Internet Archive-MP4
  type: Video
  uid: d30e86754b149e8d494ae86b6e8a9f30
- id: Thumbnail-OCW-JPG
  parent_uid: 5bb0a95608e37ec6dc17e8a9b44d408a
  title: Thumbnail-OCW-JPG
  type: Thumbnail
  uid: 35f1522d60900237dd2b9b6134200ed3
- id: 3Play-3PlayYouTubeid-MP4
  media_location: qhH6ysHlaiM
  parent_uid: 5bb0a95608e37ec6dc17e8a9b44d408a
  title: 3Play-3Play YouTube id
  type: 3Play
  uid: 79c57bb907614cb19e193d81789270e6
- id: qhH6ysHlaiM.srt
  parent_uid: 5bb0a95608e37ec6dc17e8a9b44d408a
  technical_location: https://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-189-multicore-programming-primer-january-iap-2007/lecture-notes-and-video/l4-introduction-to-concurrent-programming/qhH6ysHlaiM.srt
  title: 3play caption file
  type: null
  uid: 8ebf070a833890e46729bb8ecf2527a9
- id: qhH6ysHlaiM.pdf
  parent_uid: 5bb0a95608e37ec6dc17e8a9b44d408a
  technical_location: https://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-189-multicore-programming-primer-january-iap-2007/lecture-notes-and-video/l4-introduction-to-concurrent-programming/qhH6ysHlaiM.pdf
  title: 3play pdf file
  type: null
  uid: 167270c5ac5f0ad118ee016a2105d468
- id: Caption-3Play YouTube id-SRT
  parent_uid: 5bb0a95608e37ec6dc17e8a9b44d408a
  title: Caption-3Play YouTube id-SRT-English - US
  type: Caption
  uid: d794d2506b1c41341b647baae3533622
- id: Transcript-3Play YouTube id-PDF
  parent_uid: 5bb0a95608e37ec6dc17e8a9b44d408a
  title: Transcript-3Play YouTube id-PDF-English - US
  type: Transcript
  uid: 6fc83185d0c25f3552131234f59035a1
inline_embed_id: 72511818l4:introductiontoconcurrentprogramming18373924
layout: video
order_index: null
parent_uid: 69885f30bae5c69316fc5492e4404278
related_resources_text: <p>Lecture Notes (<a title="Open in a new window." target="_blank"
  href="./resolveuid/473fa522f1a7a03c89130c6de55ebc51">PDF</a>)</p>
short_url: l4-introduction-to-concurrent-programming
technical_location: https://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-189-multicore-programming-primer-january-iap-2007/lecture-notes-and-video/l4-introduction-to-concurrent-programming
template_type: Tabbed
title: 'L4: Introduction to Concurrent Programming'
transcript: '<p><span m=''30''>The</span> <span m=''120''>following</span> <span m=''540''>content</span>
  <span m=''1130''>is</span> <span m=''1240''>provided</span> <span m=''1710''>under
  a</span> <span m=''2020''>Creative</span> <span m=''2430''>Commons</span> <span
  m=''2700''>license.</span> <span m=''3850''>Your</span> <span m=''4120''>support</span>
  <span m=''4650''>will</span> <span m=''4790''>help</span> <span m=''5040''>MIT</span>
  <span m=''5460''>OpenCourseWare</span> <span m=''6270''>continue</span> <span m=''6790''>to</span>
  <span m=''6860''>offer</span> <span m=''7270''>high</span> <span m=''7540''>quality</span>
  <span m=''8050''>educational</span> <span m=''8660''>resources</span> <span m=''9250''>for</span>
  <span m=''9450''>free.</span> <span m=''10550''>To</span> <span m=''10670''>make</span>
  <span m=''10870''>a</span> <span m=''10920''>donation</span> <span m=''11600''>or</span>
  <span m=''11850''>view</span> <span m=''12330''>additional</span> <span m=''12740''>materials</span>
  <span m=''13250''>from</span> <span m=''13420''>hundreds</span> <span m=''13860''>of</span>
  <span m=''13940''>MIT</span> <span m=''14410''>courses,</span> <span m=''15580''>visit</span>
  <span m=''15720''>MIT</span> <span m=''16160''>OpenCourseWare</span> <span m=''17220''>at</span>
  <span m=''17510''>ocw.mit.edu.</span> </p><p><span m=''21370''>PROFESSOR:</span>
  <span m=''22550''>So,</span> <span m=''23880''>the</span> <span m=''23990''>next</span>
  <span m=''24300''>part,</span> <span m=''25230''>today''s</span> <span m=''25570''>going</span>
  <span m=''25770''>to</span> <span m=''25860''>be</span> <span m=''25930''>about</span>
  <span m=''26280''>concurrent</span> <span m=''26690''>programming.</span> <span
  m=''28420''>So</span> <span m=''28570''>in</span> <span m=''28750''>this</span>
  <span m=''28850''>lecture</span> <span m=''29160''>we</span> <span m=''29280''>are</span>
  <span m=''29380''>going</span> <span m=''29570''>to</span> <span m=''29650''>study</span>
  <span m=''30060''>concurrent</span> <span m=''30550''>programing</span> <span m=''31460''>with</span>
  <span m=''31770''>the emphasis</span> <span m=''32090''>for</span> <span m=''32530''>correctness</span>
  <span m=''33060''>of</span> <span m=''33180''>programs.</span> <span m=''33680''>Because</span>
  <span m=''34030''>parallel</span> <span m=''34460''>programs</span> <span m=''35150''>will</span>
  <span m=''35390''>have the</span> <span m=''35470''>same</span> <span m=''35805''>correctness</span>
  <span m=''36140''>issues.</span> <span m=''36860''>So,</span> <span m=''37430''>if</span>
  <span m=''37580''>you</span> <span m=''37660''>want</span> <span m=''37840''>to</span>
  <span m=''37950''>get</span> <span m=''38190''>parallel,</span> <span m=''38270''>you''d</span>
  <span m=''38360''>better</span> <span m=''38550''>get</span> <span m=''38680''>the</span>
  <span m=''38760''>concurrency</span> <span m=''39180''>right</span> <span m=''39510''>first.</span>
  </p><p><span m=''41610''>What we''re</span> <span m=''41940''>also</span> <span
  m=''42280''>going</span> <span m=''42520''>do is</span> <span m=''42620''>start</span>
  <span m=''43100''>with</span> <span m=''43190''>a much</span> <span m=''43380''>simpler</span>
  <span m=''44060''>machine</span> <span m=''44350''>model.</span> <span m=''45530''>In
  a</span> <span m=''45580''>program</span> <span m=''46030''>where</span> <span m=''46140''>we</span>
  <span m=''46230''>are going to</span> <span m=''46450''>use</span> <span m=''46720''>Java,</span>
  <span m=''48090''>because</span> <span m=''48850''>I</span> <span m=''48980''>think</span>
  <span m=''50170''>a</span> <span m=''50230''>lot</span> <span m=''50340''>of</span>
  <span m=''50420''>people</span> <span m=''50630''>understand</span> <span m=''51100''>Java.</span>
  <span m=''51680''>Also,</span> <span m=''52140''>we</span> <span m=''52370''>are</span>
  <span m=''52550''>going</span> <span m=''52680''>to</span> <span m=''52830''>do
  some</span> <span m=''53020''>very simple</span> <span m=''53680''>shared</span>
  <span m=''54010''>[UNINTELLIGIBLE]</span> <span m=''54240''>machine</span> <span
  m=''54540''>abstraction.</span> <span m=''55500''>I''m</span> <span m=''55630''>not</span>
  <span m=''55830''>going</span> <span m=''55960''>to</span> <span m=''56020''>even</span>
  <span m=''56180''>talk</span> <span m=''56460''>about</span> <span m=''56570''>any</span>
  <span m=''56700''>machine</span> <span m=''57060''>anymore.</span> <span m=''57350''>I''m</span>
  <span m=''57450''>just</span> <span m=''57620''>going to</span> <span m=''57790''>talk</span>
  <span m=''58000''>about</span> <span m=''58180''>concurrent</span> <span m=''58820''>programming
  here.</span> <span m=''61090''>You</span> <span m=''61160''>need</span> <span m=''61290''>to</span>
  <span m=''61360''>get</span> <span m=''61610''>through</span> <span m=''61790''>this</span>
  <span m=''62080''>one</span> <span m=''62400''>before</span> <span m=''62680''>you</span>
  <span m=''62770''>can</span> <span m=''63290''>start</span> <span m=''63710''>to</span>
  <span m=''63980''>dig in</span> <span m=''64240''>deep</span> <span m=''64500''>into</span>
  <span m=''64640''>the</span> <span m=''64730''>next</span> <span m=''64950''>level.</span>
  </p><p><span m=''75970''>So in the</span> <span m=''76170''>next</span> <span m=''76460''>lecture,</span>
  <span m=''77620''>we</span> <span m=''77780''>will</span> <span m=''77950''>switch</span>
  <span m=''78240''>from</span> <span m=''78460''>Java</span> <span m=''78850''>to</span>
  <span m=''78950''>C-C  ,</span> <span m=''79800''>I</span> <span m=''79890''>guess</span>
  <span m=''80080''>using</span> <span m=''80490''>MPI</span> <span m=''81810''>primitives</span>
  <span m=''82090''>in</span> <span m=''82400''>here.</span> <span m=''84070''>We''ll</span>
  <span m=''84210''>start</span> <span m=''84490''>moving</span> <span m=''84720''>into</span>
  <span m=''84840''>parallelism</span> <span m=''85380''>with</span> <span m=''85520''>emphasis</span>
  <span m=''85880''>on</span> <span m=''86190''>performance.</span> <span m=''86930''>And,
  of</span> <span m=''87040''>course,</span> <span m=''87220''>you</span> <span m=''87320''>have
  to</span> <span m=''87390''>get</span> <span m=''87510''>correctness,</span> <span
  m=''88720''>that''s</span> <span m=''88910''>given,</span> <span m=''89200''>but</span>
  <span m=''89690''>we''ll</span> <span m=''89780''>start</span> <span m=''90090''>looking</span>
  <span m=''90300''>at</span> <span m=''90390''>performance</span> <span m=''90840''>in</span>
  <span m=''90990''>there.</span> <span m=''91460''>And we''ll</span> <span m=''91830''>start</span>
  <span m=''92060''>using</span> <span m=''92360''>the</span> <span m=''92450''>distributive</span>
  <span m=''92890''>memory</span> <span m=''93160''>machine,</span> <span m=''93490''>all</span>
  <span m=''93840''>the</span> <span m=''93930''>notions</span> <span m=''94430''>and</span>
  <span m=''94890''>details</span> <span m=''95490''>of Cell,</span> <span m=''96180''>so</span>
  <span m=''96280''>we''ll</span> <span m=''96410''>just</span> <span m=''96580''>kind
  of</span> <span m=''96820''>go</span> <span m=''96950''>down</span> <span m=''97220''>and</span>
  <span m=''97360''>down</span> <span m=''97570''>in that</span> <span m=''97840''>direction.</span>
  </p><p><span m=''100100''>So,</span> <span m=''100280''>what''s</span> <span m=''100390''>concurrency?</span>
  <span m=''102490''>Sequential</span> <span m=''102970''>program</span> <span m=''103590''>is
  --</span> <span m=''104180''>because</span> <span m=''104520''>sequential</span>
  <span m=''104880''>program</span> <span m=''105180''>opposite.</span> <span m=''105640''>It''s</span>
  <span m=''105820''>basically</span> <span m=''106410''>single</span> <span m=''106610''>thread</span>
  <span m=''106990''>of</span> <span m=''107060''>execution,</span> <span m=''107640''>with</span>
  <span m=''107890''>is a good</span> <span m=''108110''>one.</span> <span m=''108620''>Finish</span>
  <span m=''108970''>that,</span> <span m=''109150''>go</span> <span m=''109280''>to</span>
  <span m=''109380''>the</span> <span m=''109480''>next,</span> <span m=''109940''>go</span>
  <span m=''110160''>to</span> <span m=''110240''>the</span> <span m=''110330''>next.</span>
  <span m=''110710''>That''s</span> <span m=''110910''>a very</span> <span m=''111360''>simple</span>
  <span m=''111500''>abstract</span> <span m=''111920''>model</span> <span m=''112570''>that</span>
  <span m=''112980''>for</span> <span m=''113210''>about</span> <span m=''113720''>35</span>
  <span m=''114270''>years,</span> <span m=''114500''>40 years,</span> <span m=''115070''>none</span>
  <span m=''115670''>of</span> <span m=''115760''>the</span> <span m=''115820''>machines</span>
  <span m=''116100''>were actually</span> <span m=''116510''>following,</span> <span
  m=''116840''>that</span> <span m=''116970''>they</span> <span m=''117290''>had things</span>
  <span m=''117490''>in</span> <span m=''117570''>the</span> <span m=''117640''>back</span>
  <span m=''118230''>that</span> <span m=''118360''>actually</span> <span m=''118600''>had</span>
  <span m=''118760''>some</span> <span m=''118900''>parallelism.</span> </p><p><span
  m=''120660''>A</span> <span m=''120810''>concurrent</span> <span m=''121220''>program</span>
  <span m=''121720''>is</span> <span m=''123220''>the</span> <span m=''123550''>[UNINTELLIGIBLE
  PHRASE]</span> <span m=''124270''>because</span> <span m=''124530''>it''s</span>
  <span m=''124680''>a</span> <span m=''124980''>collection</span> <span m=''125470''>of</span>
  <span m=''125740''>autonomous</span> <span m=''126060''>sequential</span> <span
  m=''126720''>threads</span> <span m=''127470''>executing</span> <span m=''128210''>logically</span>
  <span m=''128580''>in</span> <span m=''128930''>parallel.</span> </p><p><span m=''132220''>So</span>
  <span m=''132380''>you</span> <span m=''132480''>can</span> <span m=''132620''>execute</span>
  <span m=''133030''>this</span> <span m=''133560''>thing</span> <span m=''134000''>either</span>
  <span m=''134190''>multi-programming,</span> <span m=''135040''>so</span> <span
  m=''135180''>we</span> <span m=''135280''>can</span> <span m=''135720''>multiplex</span>
  <span m=''136760''>different</span> <span m=''137100''>parts</span> <span m=''137420''>on</span>
  <span m=''138450''>multiprocessing.</span> <span m=''139790''>Well,</span> <span
  m=''140000''>multiprocessing</span> <span m=''140760''>basically</span> <span m=''142070''>has</span>
  <span m=''142500''>[UNINTELLIGIBLE]</span> <span m=''142920''>starting</span> <span
  m=''143100''>on</span> <span m=''143270''>different</span> <span m=''143570''>machines.</span>
  <span m=''144720''>You can</span> <span m=''144900''>distribute,</span> <span m=''145190''>you</span>
  <span m=''145540''>can actually</span> <span m=''145750''>send</span> <span m=''146160''>it</span>
  <span m=''146870''>to</span> <span m=''146940''>different</span> <span m=''147300''>places.</span>
  <span m=''147820''>Of</span> <span m=''148190''>course,</span> <span m=''148330''>you
  have to deal with</span> <span m=''148580''>memory</span> <span m=''149120''>issues.</span>
  </p><p><span m=''150110''>So,</span> <span m=''151220''>concurrency''s</span> <span
  m=''151860''>not</span> <span m=''152140''>only</span> <span m=''152650''>parallel</span>
  <span m=''153140''>systems.</span> <span m=''153280''>So</span> <span m=''153770''>you</span>
  <span m=''153880''>can</span> <span m=''154040''>do</span> <span m=''154230''>interleaved</span>
  <span m=''155060''>concurrency.</span> <span m=''155450''>You</span> <span m=''155580''>can</span>
  <span m=''155860''>have</span> <span m=''155990''>logically</span> <span m=''156490''>parallel,</span>
  <span m=''156980''>but</span> <span m=''157790''>you</span> <span m=''157970''>run</span>
  <span m=''158540''>Thread A</span> <span m=''158940''>for a</span> <span m=''159060''>while,</span>
  <span m=''159660''>contacts</span> <span m=''160240''>with</span> <span m=''160440''>Thread</span>
  <span m=''160505''>B</span> <span m=''160570''>for</span> <span m=''160740''>a</span>
  <span m=''160810''>while,</span> <span m=''161240''>contacts</span> <span m=''161610''>with</span>
  <span m=''161830''>Thread C,</span> <span m=''162170''>so you can</span> <span m=''162310''>have</span>
  <span m=''162380''>multiple</span> <span m=''162610''>threads</span> <span m=''163070''>on</span>
  <span m=''163220''>the</span> <span m=''163300''>same</span> <span m=''164650''>machine</span>
  <span m=''164940''>running.</span> <span m=''165630''>Or</span> <span m=''166130''>you</span>
  <span m=''166210''>can</span> <span m=''166370''>actually</span> <span m=''166740''>have</span>
  <span m=''166790''>running</span> <span m=''166930''>parallel.</span> <span m=''167830''>You
  can</span> <span m=''168120''>have</span> <span m=''168230''>three</span> <span
  m=''168380''>different</span> <span m=''168680''>machines</span> <span m=''168940''>running,</span>
  <span m=''169220''>A,</span> <span m=''169330''>B</span> <span m=''169560''>and</span>
  <span m=''169700''>C</span> <span m=''169810''>all</span> <span m=''169970''>the</span>
  <span m=''170070''>time.</span> <span m=''170870''>So</span> <span m=''171250''>you</span>
  <span m=''171570''>can</span> <span m=''171730''>have</span> <span m=''171880''>both</span>
  <span m=''172450''>in</span> <span m=''172700''>there.</span> <span m=''173510''>But</span>
  <span m=''174030''>logically</span> <span m=''174600''>you</span> <span m=''174980''>should</span>
  <span m=''175200''>not</span> <span m=''175430''>see</span> <span m=''175510''>a</span>
  <span m=''175560''>difference</span> <span m=''175900''>except</span> <span m=''176240''>for</span>
  <span m=''176570''>performance</span> <span m=''177220''>and</span> <span m=''177540''>stuff</span>
  <span m=''177850''>like</span> <span m=''178020''>that.</span> </p><p><span m=''179540''>So</span>
  <span m=''179740''>what</span> <span m=''179920''>I''m</span> <span m=''180230''>going</span>
  <span m=''180410''>to do is</span> <span m=''180540''>do</span> <span m=''180666''>a</span>
  <span m=''180793''>bunch</span> <span m=''180920''>of</span> <span m=''181140''>examples.</span>
  <span m=''183060''>Can you read</span> <span m=''183440''>this?</span> <span m=''187250''>Let''s</span>
  <span m=''187440''>start with</span> <span m=''187940''>a</span> <span m=''188010''>bank.</span>
  <span m=''188670''>So</span> <span m=''188830''>you have a</span> <span m=''189010''>bank</span>
  <span m=''189420''>account.</span> <span m=''190430''>So</span> <span m=''190750''>in</span>
  <span m=''190960''>Java</span> <span m=''191280''>you</span> <span m=''191420''>just</span>
  <span m=''191610''>basically</span> <span m=''191990''>have</span> <span m=''192220''>ID,</span>
  <span m=''192620''>password,</span> <span m=''192960''>and</span> <span m=''193130''>balance,</span>
  <span m=''194190''>and</span> <span m=''195000''>you</span> <span m=''195080''>have</span>
  <span m=''195340''>some</span> <span m=''195580''>way</span> <span m=''195960''>to</span>
  <span m=''196210''>construct</span> <span m=''196410''>this</span> <span m=''198050''>object</span>
  <span m=''198450''>in</span> <span m=''198570''>here.</span> <span m=''199330''>And</span>
  <span m=''199950''>you</span> <span m=''200020''>can</span> <span m=''200430''>ask,
  and see</span> <span m=''200940''>the</span> <span m=''201270''>password</span>
  <span m=''201660''>is</span> <span m=''201760''>correct.</span> <span m=''203180''>You
  can</span> <span m=''203430''>get</span> <span m=''203590''>the</span> <span m=''203670''>balance.</span>
  <span m=''205160''>And</span> <span m=''206040''>you</span> <span m=''206100''>can</span>
  <span m=''206260''>post</span> <span m=''206520''>the</span> <span m=''206710''>balance.</span>
  <span m=''207840''>So</span> <span m=''207950''>that''s</span> <span m=''208130''>a</span>
  <span m=''208230''>very simple</span> <span m=''208990''>account</span> <span m=''209330''>object.</span>
  <span m=''210470''>If</span> <span m=''210540''>you</span> <span m=''210810''>have
  a bank,</span> <span m=''211970''>you</span> <span m=''212140''>have</span> <span
  m=''212270''>a</span> <span m=''212300''>bunch</span> <span m=''212570''>of</span>
  <span m=''212680''>accounts</span> <span m=''213050''>in</span> <span m=''213220''>a
  hash</span> <span m=''213510''>map,</span> <span m=''214150''>and</span> <span m=''214550''>you
  create</span> <span m=''214840''>the</span> <span m=''215160''>hash</span> <span
  m=''215280''>map</span> <span m=''215533''>in</span> <span m=''215786''>here.</span>
  <span m=''217210''>Then</span> <span m=''217320''>you</span> <span m=''217420''>can</span>
  <span m=''217630''>basically</span> <span m=''218040''>[? figure out ?]</span> <span
  m=''218360''>the</span> <span m=''218460''>bank,</span> <span m=''218790''>you</span>
  <span m=''218890''>actually</span> <span m=''219220''>create</span> <span m=''219520''>a</span>
  <span m=''219580''>bank in</span> <span m=''220020''>here,</span> <span m=''221710''>and</span>
  <span m=''222400''>you</span> <span m=''222480''>can</span> <span m=''222670''>get</span>
  <span m=''222790''>an</span> <span m=''222870''>account,</span> <span m=''223310''>given</span>
  <span m=''223490''>an</span> <span m=''223590''>ID.</span> </p><p><span m=''226170''>Now,</span>
  <span m=''226280''>assume</span> <span m=''226490''>you</span> <span m=''226580''>want
  to</span> <span m=''226810''>build an</span> <span m=''227190''>ATM.</span> <span
  m=''228280''>How</span> <span m=''228520''>do you</span> <span m=''228700''>build
  an</span> <span m=''228840''>ATM?</span> <span m=''229740''>So,</span> <span m=''230250''>you</span>
  <span m=''230400''>have</span> <span m=''230560''>a</span> <span m=''230630''>bank
  --</span> <span m=''230970''>you</span> <span m=''231140''>need</span> <span m=''231210''>a</span>
  <span m=''231280''>bank in</span> <span m=''231730''>here,</span> <span m=''232210''>and</span>
  <span m=''232390''>here''s</span> <span m=''232670''>some</span> <span m=''232870''>input</span>
  <span m=''233050''>and</span> <span m=''233160''>output</span> <span m=''233470''>streams</span>
  <span m=''233850''>in</span> <span m=''234000''>here.</span> <span m=''236120''>When</span>
  <span m=''236300''>you</span> <span m=''236680''>start the</span> <span m=''236900''>ATM,</span>
  <span m=''237570''>you</span> <span m=''237670''>will</span> <span m=''237780''>set</span>
  <span m=''237930''>up</span> <span m=''238050''>these</span> <span m=''238170''>input</span>
  <span m=''238460''>and</span> <span m=''238830''>output</span> <span m=''238960''>streams</span>
  <span m=''239330''>in here.</span> <span m=''240790''>In the</span> <span m=''240860''>main</span>
  <span m=''241150''>function,</span> <span m=''241700''>what</span> <span m=''241870''>you''ll</span>
  <span m=''242050''>do</span> <span m=''242140''>is,</span> <span m=''242630''>you</span>
  <span m=''242850''>get</span> <span m=''243000''>a</span> <span m=''243050''>bank,</span>
  <span m=''244810''>create</span> <span m=''245390''>where</span> <span m=''245460''>the</span>
  <span m=''246870''>input</span> <span m=''247190''>streams</span> <span m=''247500''>are</span>
  <span m=''247610''>coming</span> <span m=''247870''>from.</span> <span m=''249710''>Create</span>
  <span m=''250730''>output</span> <span m=''251090''>goes</span> <span m=''251350''>standard</span>
  <span m=''251800''>--</span> <span m=''252630''>system</span> <span m=''253190''>output</span>
  <span m=''253650''>goes</span> <span m=''253900''>there.</span> <span m=''254400''>And</span>
  <span m=''254660''>create</span> <span m=''255010''>an</span> <span m=''255290''>ATM</span>
  <span m=''255400''>in here,</span> <span m=''256020''>and</span> <span m=''256220''>you</span>
  <span m=''256350''>will</span> <span m=''256610''>make the</span> <span m=''256750''>ATM</span>
  <span m=''256940''>run.</span> <span m=''257860''>So</span> <span m=''258030''>how</span>
  <span m=''258210''>do</span> <span m=''258300''>you</span> <span m=''258380''>run
  the</span> <span m=''258540''>ATM?</span> </p><p><span m=''260240''>So,</span> <span
  m=''260870''>what</span> <span m=''261150''>happens</span> <span m=''261460''>in</span>
  <span m=''261620''>run</span> <span m=''261880''>is,</span> <span m=''262020''>you</span>
  <span m=''262090''>run</span> <span m=''262350''>forever?</span> <span m=''262750''>ATM</span>
  <span m=''263330''>doesn''t</span> <span m=''264050''>stop</span> <span m=''264350''>any
  time.</span> <span m=''266150''>What</span> <span m=''266340''>you</span> <span
  m=''266440''>can</span> <span m=''266640''>do</span> <span m=''266750''>is</span>
  <span m=''266940''>you</span> <span m=''267030''>can</span> <span m=''267170''>ask</span>
  <span m=''267440''>when</span> <span m=''267640''>somebody</span> <span m=''267910''>walks</span>
  <span m=''268140''>into the</span> <span m=''268350''>ATM,</span> <span m=''268630''>you</span>
  <span m=''268830''>can</span> <span m=''269040''>say</span> <span m=''269170''>what''s</span>
  <span m=''269320''>the</span> <span m=''269410''>account</span> <span m=''269720''>ID.</span>
  <span m=''270540''>Type</span> <span m=''270770''>the account</span> <span m=''271140''>ID.</span>
  <span m=''274260''>You</span> <span m=''274340''>can</span> <span m=''274520''>get</span>
  <span m=''274710''>that</span> <span m=''274890''>account,</span> <span m=''275190''>so</span>
  <span m=''275290''>of course,</span> <span m=''275680''>if</span> <span m=''275860''>the</span>
  <span m=''275950''>account</span> <span m=''276160''>already is</span> <span m=''276480''>wrong
  it</span> <span m=''276760''>says,</span> <span m=''277040''>throw</span> <span
  m=''278810''>exception.</span> <span m=''280040''>You can</span> <span m=''280280''>say</span>
  <span m=''280620''>OK,</span> <span m=''280800''>what''s</span> <span m=''280960''>the</span>
  <span m=''281120''>password,</span> <span m=''281400''>get</span> <span m=''281740''>the</span>
  <span m=''281910''>password.</span> <span m=''283560''>You</span> <span m=''283730''>take</span>
  <span m=''283960''>the</span> <span m=''284030''>password,</span> <span m=''284580''>if
  it''s</span> <span m=''284860''>wrong</span> <span m=''285420''>you throw</span>
  <span m=''285870''>exception.</span> <span m=''287170''>Then</span> <span m=''287270''>you</span>
  <span m=''287390''>can</span> <span m=''287620''>say,</span> <span m=''288450''>here''s</span>
  <span m=''288810''>your</span> <span m=''288910''>balance</span> <span m=''289150''>today.</span>
  <span m=''290160''>What</span> <span m=''290320''>do you</span> <span m=''290390''>want</span>
  <span m=''290550''>to</span> <span m=''290610''>do?</span> <span m=''291440''>If</span>
  <span m=''291930''>you</span> <span m=''292130''>want</span> <span m=''292550''>to</span>
  <span m=''293650''>withdraw or</span> <span m=''294220''>deposit.</span> <span m=''295300''>If</span>
  <span m=''295400''>you</span> <span m=''295470''>want</span> <span m=''295600''>to</span>
  <span m=''295730''>withdraw</span> <span m=''296440''>you</span> <span m=''296610''>can</span>
  <span m=''296770''>do a</span> <span m=''296910''>minus</span> <span m=''297230''>number,</span>
  <span m=''297540''>if</span> <span m=''297550''>you</span> <span m=''297560''>want</span>
  <span m=''297570''>to deposit</span> <span m=''298010''>it will</span> <span m=''298120''>be</span>
  <span m=''298220''>a</span> <span m=''298380''>plus</span> <span m=''298640''>number.</span>
  <span m=''300620''>Then</span> <span m=''300750''>you</span> <span m=''300860''>can</span>
  <span m=''302170''>post</span> <span m=''302420''>that</span> <span m=''302660''>into</span>
  <span m=''304860''>your</span> <span m=''305020''>balance.</span> </p><p><span m=''307310''>Everybody</span>
  <span m=''307670''>got</span> <span m=''307880''>the</span> <span m=''307980''>thing</span>
  <span m=''308220''>for ATMs?</span> <span m=''309540''>So,</span> <span m=''310290''>assume</span>
  <span m=''312510''>activity trace.</span> <span m=''313160''>So</span> <span m=''313420''>somebody</span>
  <span m=''313820''>comes</span> <span m=''314170''>and</span> <span m=''314830''>gives</span>
  <span m=''315010''>the</span> <span m=''315110''>account</span> <span m=''315390''>ID,</span>
  <span m=''315740''>at</span> <span m=''315880''>least</span> <span m=''317040''>gives</span>
  <span m=''317120''>the</span> <span m=''317430''>password,</span> <span m=''317900''>and</span>
  <span m=''318830''>say</span> <span m=''319050''>that they have</span> <span m=''319300''>$100,000</span>
  <span m=''320330''>and</span> <span m=''320630''>say</span> <span m=''320790''>how</span>
  <span m=''321020''>much</span> <span m=''321200''>you</span> <span m=''321280''>withdraw,</span>
  <span m=''322250''>$200</span> <span m=''322720''>withdraw.</span> <span m=''323050''>And</span>
  <span m=''323270''>you</span> <span m=''323360''>get</span> <span m=''323570''>the</span>
  <span m=''323680''>balance</span> <span m=''324140''>in</span> <span m=''324290''>here.</span>
  <span m=''325080''>Looks</span> <span m=''325270''>nice.</span> <span m=''326100''>It
  works.</span> </p><p><span m=''328630''>So</span> <span m=''329070''>I</span> <span
  m=''329310''>need</span> <span m=''329620''>to</span> <span m=''329790''>run multiple</span>
  <span m=''329950''>ATMs.</span> <span m=''330880''>Assume</span> <span m=''331110''>I</span>
  <span m=''331210''>am in a place</span> <span m=''331760''>that I</span> <span m=''331860''>actually</span>
  <span m=''332390''>want to put</span> <span m=''332480''>two</span> <span m=''332690''>ATMs</span>
  <span m=''333040''>or</span> <span m=''333230''>four</span> <span m=''333500''>ATMs</span>
  <span m=''333810''>next</span> <span m=''333990''>to</span> <span m=''334070''>each</span>
  <span m=''334240''>other.</span> <span m=''335410''>So</span> <span m=''335590''>how</span>
  <span m=''335910''>am I</span> <span m=''336010''>going</span> <span m=''336240''>to</span>
  <span m=''336490''>do</span> <span m=''336770''>that?</span> </p><p><span m=''338920''>So,</span>
  <span m=''339430''>in</span> <span m=''339680''>order to</span> <span m=''339770''>do</span>
  <span m=''339950''>that,</span> <span m=''340800''>there''s</span> <span m=''341580''>concurrency</span>
  <span m=''341820''>in</span> <span m=''342280''>Java.</span> <span m=''342840''>So</span>
  <span m=''343030''>one</span> <span m=''343200''>way</span> <span m=''343330''>to</span>
  <span m=''343410''>get</span> <span m=''343740''>Java</span> <span m=''343930''>concurrency</span>
  <span m=''344570''>is</span> <span m=''345780''>you</span> <span m=''346060''>can</span>
  <span m=''346590''>extend this</span> <span m=''347470''>class thread</span> <span
  m=''348730''>and</span> <span m=''350070''>define</span> <span m=''351880''>a</span>
  <span m=''352950''>method</span> <span m=''353560''>run.</span> <span m=''354150''>Or</span>
  <span m=''354630''>you</span> <span m=''354770''>have</span> <span m=''355110''>interface</span>
  <span m=''355430''>called</span> <span m=''355670''>[? Runabout, ?]</span> <span
  m=''356490''>that</span> <span m=''356680''>you</span> <span m=''356770''>can</span>
  <span m=''356990''>basically</span> <span m=''358150''>use</span> <span m=''358590''>that</span>
  <span m=''358820''>interface</span> <span m=''359300''>and</span> <span m=''359490''>has</span>
  <span m=''359690''>estimated</span> <span m=''360190''>run.</span> <span m=''362840''>Then</span>
  <span m=''363030''>when</span> <span m=''363110''>you</span> <span m=''364020''>have</span>
  <span m=''364190''>made</span> <span m=''364320''>that</span> <span m=''364450''>run</span>
  <span m=''364770''>and</span> <span m=''364930''>when</span> <span m=''365130''>[UNINTELLIGIBLE
  PHRASE]</span> <span m=''366370''>start,</span> <span m=''366860''>that</span> <span
  m=''367930''>will</span> <span m=''368300''>get</span> <span m=''368500''>started.</span>
  <span m=''369430''>Very</span> <span m=''369920''>simple</span> <span m=''370290''>way</span>
  <span m=''370480''>to do</span> <span m=''370670''>that.</span> <span m=''371150''>Let
  me give you</span> <span m=''371270''>an</span> <span m=''371380''>example.</span>
  </p><p><span m=''374340''>Little</span> <span m=''374700''>bit of a digression.</span>
  <span m=''374940''>Why</span> <span m=''375180''>do</span> <span m=''375400''>you</span>
  <span m=''375440''>want</span> <span m=''375950''>concurrent</span> <span m=''376430''>programming?</span>
  <span m=''376600''>A</span> <span m=''376630''>lot</span> <span m=''376870''>of</span>
  <span m=''376960''>times,</span> <span m=''377320''>natural</span> <span m=''377820''>application</span>
  <span m=''378580''>structure</span> <span m=''380150''>is</span> <span m=''380410''>not</span>
  <span m=''380580''>sequential.</span> <span m=''381570''>The world</span> <span
  m=''381950''>is</span> <span m=''382060''>not</span> <span m=''382210''>sequential.</span>
  <span m=''383010''>And then</span> <span m=''383170''>try</span> <span m=''383410''>to</span>
  <span m=''383750''>sequentialize</span> <span m=''384270''>the</span> <span m=''384410''>world</span>
  <span m=''384800''>sometimes</span> <span m=''385230''>means</span> <span m=''385550''>it''s
  much</span> <span m=''385810''>more</span> <span m=''386080''>complicated</span>
  <span m=''386660''>[UNINTELLIGIBLE]</span> <span m=''387150''>So</span> <span m=''387550''>sometimes</span>
  <span m=''388050''>it''s</span> <span m=''388180''>natural</span> <span m=''388440''>to</span>
  <span m=''388660''>do</span> <span m=''388890''>things</span> <span m=''389110''>in
  parallel.</span> <span m=''391660''>A</span> <span m=''391730''>lot</span> <span
  m=''391870''>of</span> <span m=''391980''>times</span> <span m=''392150''>the</span>
  <span m=''392230''>sequentiality''s</span> <span m=''392760''>an</span> <span m=''392940''>artifact</span>
  <span m=''393460''>of</span> <span m=''393570''>the</span> <span m=''393660''>programming</span>
  <span m=''394300''>language,</span> <span m=''394460''>because</span> <span m=''394710''>we</span>
  <span m=''394980''>use</span> <span m=''395160''>a language like that.</span> <span
  m=''397740''>Sometimes</span> <span m=''398550''>doing</span> <span m=''398810''>things</span>
  <span m=''399110''>in</span> <span m=''399390''>parallel</span> <span m=''399830''>ways,</span>
  <span m=''400090''>you</span> <span m=''400160''>can</span> <span m=''400310''>really</span>
  <span m=''400960''>improve</span> <span m=''401460''>things</span> <span m=''401690''>like</span>
  <span m=''401890''>throughput</span> <span m=''402280''>and</span> <span m=''402410''>responsiveness.</span>
  <span m=''403390''>If</span> <span m=''403690''>you</span> <span m=''403840''>are
  doing</span> <span m=''404090''>IO,</span> <span m=''405100''>if</span> <span m=''405156''>you''re</span>
  <span m=''405213''>doing</span> <span m=''405370''>sequential</span> <span m=''405840''>programming</span>
  <span m=''406020''>[UNINTELLIGIBLE PHRASE]</span> <span m=''406620''>you''re</span>
  <span m=''406770''>just</span> <span m=''407110''>twiddling</span> <span m=''407410''>your</span>
  <span m=''407510''>thumb waiting</span> <span m=''407930''>for</span> <span m=''408160''>the</span>
  <span m=''408250''>IO</span> <span m=''408390''>to</span> <span m=''408500''>come</span>
  <span m=''408700''>back.</span> <span m=''409160''>In</span> <span m=''409390''>parallel</span>
  <span m=''409780''>things</span> <span m=''410020''>actually,</span> <span m=''410300''>you</span>
  <span m=''410390''>can</span> <span m=''410570''>do</span> <span m=''410670''>parallel</span>
  <span m=''411110''>IO</span> <span m=''411370''>and</span> <span m=''411850''>you</span>
  <span m=''411920''>can</span> <span m=''412060''>do</span> <span m=''412130''>a</span>
  <span m=''412160''>lot</span> <span m=''412460''>cool</span> <span m=''412730''>stuff
  in</span> <span m=''413290''>here.</span> </p><p><span m=''415110''>Of</span> <span
  m=''415240''>course,</span> <span m=''416000''>in this</span> <span m=''416310''>class,</span>
  <span m=''417570''>if you</span> <span m=''417760''>are</span> <span m=''417960''>multicore</span>
  <span m=''418470''>and</span> <span m=''418810''>multiprocessor</span> <span m=''418960''>multicore,</span>
  <span m=''419760''>you</span> <span m=''419880''>can</span> <span m=''420000''>get</span>
  <span m=''420140''>parallel</span> <span m=''420370''>executions.</span> <span m=''420830''>So</span>
  <span m=''420920''>there</span> <span m=''421090''>are</span> <span m=''421230''>more</span>
  <span m=''421410''>than</span> <span m=''422240''>one</span> <span m=''424550''>[UNINTELLIGIBLE
  PHRASE].</span> <span m=''430440''>Also,</span> <span m=''430830''>if</span> <span
  m=''430930''>you are</span> <span m=''431050''>building</span> <span m=''431380''>a
  very</span> <span m=''431570''>large</span> <span m=''431930''>distributed</span>
  <span m=''432470''>system,</span> <span m=''434970''>concurrent</span> <span m=''435410''>programming</span>
  <span m=''435870''>is,</span> <span m=''436000''>you</span> <span m=''436110''>had</span>
  <span m=''436230''>to</span> <span m=''436300''>deal</span> <span m=''436500''>with,</span>
  <span m=''436810''>especially</span> <span m=''437210''>dealing</span> <span m=''437480''>with</span>
  <span m=''437570''>things</span> <span m=''437740''>like</span> <span m=''437910''>client-server</span>
  <span m=''438200''>type</span> <span m=''438340''>of</span> <span m=''438600''>applications.</span>
  </p><p><span m=''440840''>So</span> <span m=''440990''>here''s</span> <span m=''442020''>our
  original</span> <span m=''443290''>ATMs.</span> <span m=''443860''>So</span> <span
  m=''444110''>to</span> <span m=''444180''>go</span> <span m=''444350''>to</span>
  <span m=''444450''>multiple</span> <span m=''444850''>ATMs,</span> <span m=''445170''>I
  am</span> <span m=''445360''>doing</span> <span m=''445460''>a</span> <span m=''445510''>few</span>
  <span m=''445710''>changes.</span> <span m=''448030''>I''ll</span> <span m=''448240''>go</span>
  <span m=''448380''>back</span> <span m=''448630''>and</span> <span m=''448740''>forth</span>
  <span m=''448920''>a few</span> <span m=''449070''>times.</span> <span m=''449910''>So</span>
  <span m=''450080''>the</span> <span m=''450160''>first</span> <span m=''450430''>thing</span>
  <span m=''450610''>I</span> <span m=''450670''>have</span> <span m=''450940''>done</span>
  <span m=''451130''>is</span> <span m=''451430''>I</span> <span m=''451570''>have
  sett here</span> <span m=''451700''>number</span> <span m=''451990''>of</span> <span
  m=''452090''>ATMs</span> <span m=''452340''>to</span> <span m=''452560''>be four.</span>
  <span m=''453310''>Can you really read it</span> <span m=''453840''>from</span>
  <span m=''454030''>back</span> <span m=''454300''>there?</span> </p><p><span m=''454520''>AUDIENCE:</span>
  <span m=''455034''>[INAUDIBLE PHRASE].</span> </p><p><span m=''457090''>PROFESSOR:</span>
  <span m=''458140''>OK, good.</span> <span m=''458920''>Then</span> <span m=''459680''>what</span>
  <span m=''459860''>I</span> <span m=''459930''>have</span> <span m=''460180''>done</span>
  <span m=''460350''>is, in</span> <span m=''460700''>here,</span> <span m=''462280''>I</span>
  <span m=''462760''>did</span> <span m=''462930''>four</span> <span m=''463210''>ATMs</span>
  <span m=''463790''>here,</span> <span m=''464240''>and</span> <span m=''464690''>then</span>
  <span m=''464790''>I</span> <span m=''464930''>put</span> <span m=''465120''>it</span>
  <span m=''465220''>in</span> <span m=''465320''>a</span> <span m=''465420''>loop</span>
  <span m=''465750''>to</span> <span m=''465850''>create</span> <span m=''466150''>this</span>
  <span m=''466310''>ATM,</span> <span m=''466600''>so</span> <span m=''466750''>I</span>
  <span m=''466870''>created</span> <span m=''467140''>four</span> <span m=''467350''>ATMs</span>
  <span m=''467720''>in</span> <span m=''467880''>here</span> <span m=''468110''>and</span>
  <span m=''468400''>start</span> <span m=''468700''>four</span> <span m=''468910''>ATMs,</span>
  <span m=''469740''>basically.</span> <span m=''470960''>Then</span> <span m=''471090''>of</span>
  <span m=''471190''>course</span> <span m=''471520''>I</span> <span m=''472200''>extended</span>
  <span m=''472660''>these</span> <span m=''472900''>ATMs</span> <span m=''473290''>so</span>
  <span m=''473340''>now</span> <span m=''473390''>we</span> <span m=''473440''>will</span>
  <span m=''473490''>extend</span> <span m=''473830''>[? up a thread. ?]</span> <span
  m=''474670''>And</span> <span m=''474800''>I</span> <span m=''475460''>haven''t</span>
  <span m=''476240''>started that.</span> <span m=''477260''>And the</span> <span
  m=''477410''>ATMs</span> <span m=''477830''>[UNINTELLIGIBLE]</span> <span m=''478110''>ATMs,</span>
  <span m=''478270''>so</span> <span m=''478460''>it''s</span> <span m=''478710''>great.</span>
  <span m=''479560''>So</span> <span m=''479780''>now</span> <span m=''480000''>what</span>
  <span m=''480200''>happens</span> <span m=''480550''>is</span> <span m=''480660''>I</span>
  <span m=''480690''>assume</span> <span m=''481970''>now</span> <span m=''482150''>there''s</span>
  <span m=''482350''>two</span> <span m=''482540''>guys</span> <span m=''482820''>going,</span>
  <span m=''483250''>both</span> <span m=''483640''>ATMs,</span> <span m=''484360''>at</span>
  <span m=''484480''>least</span> <span m=''484630''>[UNINTELLIGIBLE]</span> <span
  m=''484790''>been.</span> <span m=''485800''>Then</span> <span m=''486100''>enter</span>
  <span m=''486310''>the</span> <span m=''486570''>account</span> <span m=''486840''>and</span>
  <span m=''487620''>[UNINTELLIGIBLE PHRASE],</span> <span m=''487920''>that''s</span>
  <span m=''488130''>works</span> <span m=''488330''>really</span> <span m=''488430''>well.</span>
  <span m=''488960''>No</span> <span m=''489100''>problem.</span> <span m=''489710''>So</span>
  <span m=''489850''>we</span> <span m=''490070''>have</span> <span m=''490300''>two</span>
  <span m=''490370''>ATMs,</span> <span m=''490580''>two</span> <span m=''490720''>people</span>
  <span m=''490980''>actually</span> <span m=''491100''>went</span> <span m=''491270''>on</span>
  <span m=''491380''>parallel.</span> <span m=''492660''>One</span> <span m=''493360''>then</span>
  <span m=''493620''>deposited</span> <span m=''493810''>some</span> <span m=''494150''>money,</span>
  <span m=''494430''>other one</span> <span m=''494540''>took</span> <span m=''494830''>money,</span>
  <span m=''495310''>great.</span> </p><p><span m=''496580''>Now,</span> <span m=''497700''>as</span>
  <span m=''498040''>MIT</span> <span m=''498260''>students,</span> <span m=''498850''>they</span>
  <span m=''499040''>want to do</span> <span m=''499200''>something,</span> <span
  m=''499580''>they</span> <span m=''499690''>can</span> <span m=''499830''>hack it.</span>
  <span m=''501170''>So,</span> <span m=''502100''>[UNINTELLIGIBLE]</span> <span m=''502410''>basically</span>
  <span m=''503130''>[UNINTELLIGIBLE]</span> <span m=''503690''>went</span> <span
  m=''503850''>[UNINTELLIGIBLE],</span> <span m=''504740''>and</span> <span m=''505550''>basically</span>
  <span m=''507020''>what</span> <span m=''507230''>[UNINTELLIGIBLE PHRASE]</span>
  <span m=''508040''>enter</span> <span m=''508130''>the</span> <span m=''508210''>password,</span>
  <span m=''509050''>and</span> <span m=''509760''>they</span> <span m=''509860''>said</span>
  <span m=''509970''>I</span> <span m=''510030''>want</span> <span m=''510210''>to</span>
  <span m=''510270''>get</span> <span m=''510370''>$100.</span> <span m=''513890''>I</span>
  <span m=''514040''>would</span> <span m=''514240''>get</span> <span m=''514350''>$90,</span>
  <span m=''514900''>basically.</span> <span m=''515510''>So</span> <span m=''515820''>he
  had</span> <span m=''516090''>$100</span> <span m=''516620''>in</span> <span m=''516690''>his</span>
  <span m=''517010''>account.</span> <span m=''518630''>Then</span> <span m=''519350''>what
  he</span> <span m=''519760''>got</span> <span m=''520030''>was,</span> <span m=''520880''>so</span>
  <span m=''521020''>he</span> <span m=''521260''>actually</span> <span m=''521550''>managed</span>
  <span m=''521820''>to</span> <span m=''521890''>get</span> <span m=''522780''>$180</span>
  <span m=''523610''>out</span> <span m=''523830''>of</span> <span m=''523970''>an</span>
  <span m=''524160''>account</span> <span m=''524220''>that had</span> <span m=''524460''>$100.</span>
  <span m=''525990''>This</span> <span m=''526200''>is</span> <span m=''526530''>not</span>
  <span m=''526670''>a</span> <span m=''526740''>good</span> <span m=''526860''>ATM,</span>
  <span m=''527640''>at</span> <span m=''527770''>least</span> <span m=''528340''>from</span>
  <span m=''528510''>the</span> <span m=''528580''>bank''s</span> <span m=''528850''>perspective.</span>
  <span m=''530440''>So</span> <span m=''530710''>what</span> <span m=''530930''>went
  wrong?</span> </p><p><span m=''532760''>If</span> <span m=''532950''>you</span>
  <span m=''533060''>look</span> <span m=''533190''>at</span> <span m=''533330''>what</span>
  <span m=''533490''>happened</span> <span m=''533790''>in activity</span> <span m=''533920''>trace,</span>
  <span m=''535200''>so</span> <span m=''536660''>we</span> <span m=''537190''>print</span>
  <span m=''538250''>100</span> <span m=''538630''>in</span> <span m=''538860''>here.</span>
  <span m=''539480''>And</span> <span m=''541150''>then</span> <span m=''541330''>you</span>
  <span m=''541440''>said,</span> <span m=''543690''>you</span> <span m=''544720''>want
  to</span> <span m=''545150''>read</span> <span m=''545850''>this value,</span> <span
  m=''546640''>you</span> <span m=''546810''>both</span> <span m=''546990''>entered
  90,</span> <span m=''547840''>right here.</span> <span m=''548820''>And</span> <span
  m=''549950''>this</span> <span m=''551410''>account</span> <span m=''551630''>balance</span>
  <span m=''551770''>[UNINTELLIGIBLE PHRASE]</span> <span m=''553790''>because</span>
  <span m=''554240''>the</span> <span m=''554420''>account</span> <span m=''554690''>balance</span>
  <span m=''554790''>was</span> <span m=''554920''>100.</span> <span m=''555840''>You
  saw</span> <span m=''556010''>also</span> <span m=''556260''>the</span> <span m=''556460''>account</span>
  <span m=''556880''>balance</span> <span m=''557110''>[UNINTELLIGIBLE PHRASE],</span>
  <span m=''557860''>yes,</span> <span m=''558110''>it</span> <span m=''558220''>is</span>
  <span m=''558570''>[UNINTELLIGIBLE].</span> <span m=''560280''>Then</span> <span
  m=''560340''>each</span> <span m=''560590''>went</span> <span m=''560680''>post,</span>
  <span m=''561170''>it</span> <span m=''561290''>went</span> <span m=''561590''>to</span>
  <span m=''561906''>10</span> <span m=''562223''>--</span> <span m=''562540''>this</span>
  <span m=''562670''>also</span> <span m=''563010''>did</span> <span m=''563080''>a</span>
  <span m=''563190''>post</span> <span m=''563440''>of</span> <span m=''563510''>the</span>
  <span m=''563600''>same</span> <span m=''563880''>time,</span> <span m=''564130''>result</span>
  <span m=''564370''>came</span> <span m=''564560''>both</span> <span m=''565000''>10.</span>
  <span m=''566680''>How</span> <span m=''566910''>could</span> <span m=''567140''>this</span>
  <span m=''567340''>happen?</span> </p><p><span m=''569350''>So</span> <span m=''569500''>that</span>
  <span m=''569870''>way it can</span> <span m=''570050''>happen</span> <span m=''570490''>is,</span>
  <span m=''570950''>so</span> <span m=''571050''>in</span> <span m=''571220''>the</span>
  <span m=''571450''>ATM,</span> <span m=''571690''>the</span> <span m=''571780''>[UNINTELLIGIBLE
  PHRASE],</span> <span m=''573140''>what</span> <span m=''573360''>happens</span>
  <span m=''573700''>is</span> <span m=''575510''>v is</span> <span m=''576560''>minus</span>
  <span m=''576860''>90,</span> <span m=''578320''>and</span> <span m=''578600''>this</span>
  <span m=''578760''>post</span> <span m=''579130''>[UNINTELLIGIBLE]</span> <span
  m=''579330''>also</span> <span m=''579760''>when</span> <span m=''579880''>you</span>
  <span m=''580060''>start a</span> <span m=''580390''>v it''s</span> <span m=''580640''>minus</span>
  <span m=''580960''>90.</span> <span m=''582970''>Then</span> <span m=''583070''>you</span>
  <span m=''583170''>treat</span> <span m=''583520''>the</span> <span m=''583610''>balance</span>
  <span m=''584020''>as</span> <span m=''584190''>100.</span> <span m=''585480''>So</span>
  <span m=''586300''>in</span> <span m=''586370''>this</span> <span m=''586450''>interleaving,</span>
  <span m=''587390''>and</span> <span m=''588880''>so</span> <span m=''589130''>it</span>
  <span m=''589310''>is</span> <span m=''589440''>the plus,</span> <span m=''590020''>you</span>
  <span m=''590130''>get</span> <span m=''590360''>10.</span> <span m=''591810''>Also,</span>
  <span m=''592420''>before</span> <span m=''592820''>you</span> <span m=''592940''>write</span>
  <span m=''593180''>it</span> <span m=''593290''>out,</span> <span m=''593480''>you</span>
  <span m=''593590''>read</span> <span m=''593700''>the</span> <span m=''593810''>balance</span>
  <span m=''594070''>in the</span> <span m=''594240''>other</span> <span m=''594630''>interleaving,</span>
  <span m=''595080''>you''ve</span> <span m=''595190''>got</span> <span m=''595350''>the</span>
  <span m=''595420''>balance as</span> <span m=''595850''>100, and</span> <span m=''596860''>you</span>
  <span m=''597100''>do the</span> <span m=''597190''>plus</span> <span m=''597290''>as
  10.</span> <span m=''598820''>So</span> <span m=''599010''>it</span> <span m=''599240''>destroyed</span>
  <span m=''599640''>the</span> <span m=''599730''>balance,</span> <span m=''600080''>now</span>
  <span m=''600200''>balance</span> <span m=''600470''>became</span> <span m=''600780''>10,</span>
  <span m=''601790''>and</span> <span m=''602020''>also</span> <span m=''602230''>this</span>
  <span m=''602400''>guy also</span> <span m=''602530''>wrote</span> <span m=''602960''>the</span>
  <span m=''603030''>balance -- it</span> <span m=''603350''>doesn''t</span> <span
  m=''603580''>matter,</span> <span m=''603710''>it</span> <span m=''603820''>got</span>
  <span m=''604300''>10</span> <span m=''604500''>updated</span> <span m=''605050''>twice,</span>
  <span m=''605410''>and</span> <span m=''605910''>that''s</span> <span m=''606100''>it.</span>
  <span m=''606960''>So you</span> <span m=''607140''>can</span> <span m=''607320''>have</span>
  <span m=''607590''>interleaving</span> <span m=''608010''>in</span> <span m=''608120''>here,</span>
  <span m=''608900''>that</span> <span m=''609800''>actually</span> <span m=''610220''>did</span>
  <span m=''610460''>something</span> <span m=''610820''>that''s</span> <span m=''611010''>not</span>
  <span m=''611170''>a</span> <span m=''611220''>signature</span> <span m=''611520''>program.</span>
  <span m=''613550''>And</span> <span m=''614700''>you''re</span> <span m=''614870''>in</span>
  <span m=''614960''>big</span> <span m=''615120''>trouble.</span> <span m=''616680''>So</span>
  <span m=''616920''>in order</span> <span m=''617030''>to</span> <span m=''617370''>get</span>
  <span m=''617530''>out</span> <span m=''617710''>of</span> <span m=''617870''>that,</span>
  <span m=''619820''>problem</span> <span m=''620240''>is</span> <span m=''620350''>all</span>
  <span m=''620530''>interleaving</span> <span m=''620670''>of</span> <span m=''621200''>threads</span>
  <span m=''621760''>are</span> <span m=''622010''>not</span> <span m=''622200''>acceptable</span>
  <span m=''622700''>and</span> <span m=''622870''>current.</span> <span m=''624110''>What</span>
  <span m=''624320''>you</span> <span m=''624420''>want</span> <span m=''624720''>is</span>
  <span m=''624790''>some</span> <span m=''624990''>kind</span> <span m=''625130''>of</span>
  <span m=''625190''>a</span> <span m=''625240''>sequential-looking</span> <span m=''626250''>performance,</span>
  <span m=''626570''>even</span> <span m=''626750''>though</span> <span m=''626960''>you''d</span>
  <span m=''627190''>get</span> <span m=''627380''>parallel,</span> <span m=''627680''>you</span>
  <span m=''627760''>don''t</span> <span m=''628120''>want</span> <span m=''628620''>to</span>
  <span m=''628720''>do</span> <span m=''629030''>all</span> <span m=''629400''>these</span>
  <span m=''629800''>interleavings</span> <span m=''630170''>in</span> <span m=''630860''>here.</span>
  </p><p><span m=''632050''>So</span> <span m=''632230''>in</span> <span m=''632340''>order
  to</span> <span m=''632690''>do</span> <span m=''632990''>that,</span> <span m=''633190''>Java</span>
  <span m=''633590''>provides</span> <span m=''633730''>this</span> <span m=''634030''>synchronization</span>
  <span m=''634850''>mechanism.</span> <span m=''635910''>That''s</span> <span m=''636100''>just</span>
  <span m=''636390''>strict</span> <span m=''636720''>interleaving.</span> <span m=''639240''>So,</span>
  <span m=''639960''>what</span> <span m=''640170''>synchronizations</span> <span
  m=''640940''>do</span> <span m=''641150''>is,</span> <span m=''641460''>they</span>
  <span m=''641700''>ensure</span> <span m=''642050''>safety</span> <span m=''642640''>for</span>
  <span m=''642930''>shared</span> <span m=''644190''>updates.</span> <span m=''644760''>So
  if you''re</span> <span m=''645040''>sharing</span> <span m=''645310''>something,</span>
  <span m=''646070''>so</span> <span m=''646200''>it</span> <span m=''646330''>avoids</span>
  <span m=''646500''>races,</span> <span m=''646710''>basically.</span> <span m=''647180''>It</span>
  <span m=''647290''>avoids</span> <span m=''648020''>this</span> <span m=''648450''>old</span>
  <span m=''649170''>interleaving</span> <span m=''649670''>ordering here.</span>
  <span m=''650760''>Also,</span> <span m=''651330''>it</span> <span m=''651440''>allows</span>
  <span m=''651580''>you</span> <span m=''651850''>to</span> <span m=''652060''>coordinate</span>
  <span m=''652540''>actions</span> <span m=''653020''>among</span> <span m=''653500''>shared</span>
  <span m=''653770''>space, basically.</span> <span m=''654240''>Because</span> <span
  m=''654340''>at</span> <span m=''654450''>some</span> <span m=''654650''>point</span>
  <span m=''654850''>people</span> <span m=''655020''>have</span> <span m=''655080''>to</span>
  <span m=''655140''>coordinate</span> <span m=''655940''>and</span> <span m=''657050''>take</span>
  <span m=''657500''>that</span> <span m=''657650''>parallel</span> <span m=''657740''>computation.</span>
  <span m=''658140''>With</span> <span m=''658500''>notification</span> <span m=''659180''>you
  can</span> <span m=''659350''>do</span> <span m=''659470''>that.</span> </p><p><span
  m=''661960''>So, when</span> <span m=''662300''>multiple</span> <span m=''662880''>threads</span>
  <span m=''663430''>access</span> <span m=''663850''>the</span> <span m=''663920''>shared</span>
  <span m=''664180''>resource,</span> <span m=''664540''>simultaneously,</span> <span
  m=''665250''>it''s</span> <span m=''665450''>safe</span> <span m=''665890''>only</span>
  <span m=''667810''>if</span> <span m=''668100''>all accesses</span> <span m=''668400''>have</span>
  <span m=''668570''>no</span> <span m=''669250''>effect</span> <span m=''669620''>on</span>
  <span m=''669850''>the</span> <span m=''669940''>resource.</span> <span m=''671660''>Basically,</span>
  <span m=''672020''>we''re</span> <span m=''672170''>reading</span> <span m=''672410''>variables.</span>
  <span m=''672660''>But</span> <span m=''673720''>everybody</span> <span m=''673920''>can</span>
  <span m=''674050''>read</span> <span m=''674150''>the</span> <span m=''674270''>same</span>
  <span m=''674500''>variable,</span> <span m=''674860''>because</span> <span m=''675020''>you''re
  not</span> <span m=''675190''>changing</span> <span m=''675610''>anything.</span>
  <span m=''675880''>I</span> <span m=''675980''>can</span> <span m=''676170''>do</span>
  <span m=''676290''>that.</span> <span m=''677050''>Or</span> <span m=''677880''>all</span>
  <span m=''678200''>accesses</span> <span m=''678710''>are</span> <span m=''679430''>idempotent.</span>
  <span m=''680850''>So</span> <span m=''680980''>you</span> <span m=''681050''>can</span>
  <span m=''681250''>say,</span> <span m=''682430''>we</span> <span m=''682550''>can</span>
  <span m=''682740''>do</span> <span m=''682870''>that.</span> <span m=''683800''>Or</span>
  <span m=''684460''>only</span> <span m=''684760''>one</span> <span m=''684930''>access</span>
  <span m=''685450''>at a</span> <span m=''685540''>time.</span> <span m=''686310''>Which
  is called</span> <span m=''686480''>mutual</span> <span m=''687550''>exclusion.</span>
  <span m=''689100''>So in</span> <span m=''689330''>this</span> <span m=''689570''>case
  we are</span> <span m=''689990''>changing</span> <span m=''690430''>something.</span>
  <span m=''690780''>It''s not that</span> <span m=''691200''>important.</span> <span
  m=''691670''>So</span> <span m=''691810''>we</span> <span m=''691900''>have to</span>
  <span m=''692040''>actually</span> <span m=''692200''>do</span> <span m=''692290''>mutual</span>
  <span m=''692400''>exclusion.</span> </p><p><span m=''694560''>So</span> <span m=''694770''>here''s</span>
  <span m=''695900''>a</span> <span m=''696820''>way</span> <span m=''697200''>to</span>
  <span m=''697430''>look</span> <span m=''697580''>at</span> <span m=''697680''>safety</span>
  <span m=''697960''>problems.</span> <span m=''698290''>Here</span> <span m=''698460''>might</span>
  <span m=''698710''>be</span> <span m=''698840''>an</span> <span m=''699030''>algorithm</span>
  <span m=''699820''>that</span> <span m=''700210''>you</span> <span m=''700360''>and</span>
  <span m=''700510''>your</span> <span m=''700630''>roommate</span> <span m=''701080''>have.</span>
  <span m=''702830''>So</span> <span m=''702940''>you</span> <span m=''703050''>arrive</span>
  <span m=''703340''>home,</span> <span m=''705000''>look</span> <span m=''705140''>in</span>
  <span m=''705310''>the fridge,</span> <span m=''705430''>no</span> <span m=''705560''>milk.</span>
  <span m=''706700''>Leave</span> <span m=''706910''>for</span> <span m=''707060''>grocery,</span>
  <span m=''707500''>arrive</span> <span m=''707780''>at</span> <span m=''707990''>grocery,</span>
  <span m=''708270''>buy</span> <span m=''708490''>milk</span> <span m=''708680''>and</span>
  <span m=''709970''>arrive</span> <span m=''710130''>at</span> <span m=''710260''>home.</span>
  <span m=''710800''>The</span> <span m=''710900''>minute</span> <span m=''711120''>you
  leave</span> <span m=''711430''>for</span> <span m=''711590''>grocery,</span> <span
  m=''712020''>your</span> <span m=''712360''>roommate</span> <span m=''712720''>arrives</span>
  <span m=''713080''>and</span> <span m=''713240''>do</span> <span m=''713380''>this.</span>
  <span m=''714790''>Then</span> <span m=''715180''>what</span> <span m=''715340''>do</span>
  <span m=''715410''>you</span> <span m=''715470''>have</span> <span m=''715690''>is</span>
  <span m=''715850''>you</span> <span m=''715940''>have</span> <span m=''716090''>too</span>
  <span m=''716180''>much</span> <span m=''716410''>milk.</span> </p><p><span m=''717620''>So</span>
  <span m=''718620''>here''s</span> <span m=''719440''>the</span> <span m=''719600''>problem</span>
  <span m=''720160''>in</span> <span m=''720350''>a little</span> <span m=''720440''>bit</span>
  <span m=''720770''>more</span> <span m=''721330''>abstract</span> <span m=''721870''>sense.</span>
  <span m=''723060''>And you</span> <span m=''723150''>need</span> <span m=''723450''>a</span>
  <span m=''724570''>way</span> <span m=''724740''>to</span> <span m=''724860''>synchronize</span>
  <span m=''725360''>this.</span> <span m=''725890''>So</span> <span m=''726010''>how</span>
  <span m=''726100''>about</span> <span m=''726320''>this.</span> <span m=''728290''>No</span>
  <span m=''728510''>milk</span> <span m=''729010''>and</span> <span m=''729113''>no</span>
  <span m=''729216''>note.</span> <span m=''729320''>So</span> <span m=''729740''>you</span>
  <span m=''730420''>leave</span> <span m=''730740''>a note</span> <span m=''731310''>before</span>
  <span m=''731690''>you</span> <span m=''731790''>actually</span> <span m=''732000''>leave</span>
  <span m=''732250''>the</span> <span m=''732340''>house</span> <span m=''732700''>and</span>
  <span m=''733280''>buy</span> <span m=''733470''>milk,</span> <span m=''734080''>and</span>
  <span m=''735710''>then</span> <span m=''735820''>you</span> <span m=''736200''>come</span>
  <span m=''736410''>back</span> <span m=''736580''>and</span> <span m=''736680''>remove
  the</span> <span m=''736980''>note.</span> <span m=''738070''>Does</span> <span
  m=''738340''>this</span> <span m=''738480''>work?</span> </p><p><span m=''743180''>AUDIENCE:</span>
  <span m=''743670''>[INAUDIBLE PHRASE].</span> </p><p><span m=''747910''>PROFESSOR:</span>
  <span m=''748160''>I</span> <span m=''748270''>mean</span> <span m=''748410''>here</span>
  <span m=''748690''>also</span> <span m=''748820''>you</span> <span m=''748940''>can</span>
  <span m=''749610''>do</span> <span m=''749740''>that,</span> <span m=''749900''>no
  milk</span> <span m=''750180''>and</span> <span m=''750420''>no</span> <span m=''750550''>note.</span>
  <span m=''751230''>So</span> <span m=''751720''>both</span> <span m=''751990''>are</span>
  <span m=''752210''>started.</span> <span m=''753420''>We</span> <span m=''753570''>would</span>
  <span m=''753740''>leave</span> <span m=''753920''>a</span> <span m=''754040''>note,</span>
  <span m=''755580''>and</span> <span m=''757680''>these</span> <span m=''757970''>things</span>
  <span m=''758280''>can</span> <span m=''758470''>happen at</span> <span m=''758750''>the</span>
  <span m=''758830''>same</span> <span m=''759080''>time.</span> <span m=''759300''>There''s</span>
  <span m=''759510''>a</span> <span m=''759540''>little</span> <span m=''759710''>bit</span>
  <span m=''759800''>of</span> <span m=''759890''>things</span> <span m=''760060''>saying</span>
  <span m=''760290''>OK,</span> <span m=''760460''>why didn''t</span> <span m=''760710''>you</span>
  <span m=''760840''>see</span> <span m=''760990''>your</span> <span m=''761190''>roommate.</span>
  <span m=''762680''>They</span> <span m=''762820''>go</span> <span m=''762950''>buy</span>
  <span m=''763150''>milk,</span> <span m=''763410''>he</span> <span m=''763490''>goes
  to</span> <span m=''763770''>buy</span> <span m=''764000''>milk</span> <span m=''764290''>and</span>
  <span m=''764620''>you</span> <span m=''764700''>have</span> <span m=''764820''>too</span>
  <span m=''764940''>much</span> <span m=''765150''>milk too.</span> </p><p><span
  m=''766880''>So</span> <span m=''767060''>the</span> <span m=''767160''>way</span>
  <span m=''767550''>to do</span> <span m=''767800''>this</span> <span m=''768510''>in</span>
  <span m=''769610''>Java</span> <span m=''770660''>is</span> <span m=''771350''>this</span>
  <span m=''771610''>notion</span> <span m=''771930''>of</span> <span m=''772030''>critical</span>
  <span m=''772420''>section.</span> <span m=''773670''>Critical</span> <span m=''774020''>section</span>
  <span m=''774320''>is</span> <span m=''774460''>where</span> <span m=''774920''>only
  one</span> <span m=''775390''>thread</span> <span m=''775570''>can</span> <span
  m=''775830''>be</span> <span m=''776000''>in it</span> <span m=''776170''>at a</span>
  <span m=''776380''>given</span> <span m=''776630''>time.</span> <span m=''779200''>The</span>
  <span m=''779390''>way</span> <span m=''779630''>you</span> <span m=''779710''>can</span>
  <span m=''779890''>do it</span> <span m=''780110''>with</span> <span m=''780140''>Java</span>
  <span m=''780510''>is,</span> <span m=''780650''>you</span> <span m=''780730''>can</span>
  <span m=''781160''>put</span> <span m=''781670''>synchronized</span> <span m=''782740''>in</span>
  <span m=''782840''>front</span> <span m=''783050''>of</span> <span m=''783110''>the</span>
  <span m=''783260''>method.</span> <span m=''783730''>And</span> <span m=''783940''>you</span>
  <span m=''784090''>do</span> <span m=''784360''>that</span> <span m=''784570''>method,</span>
  <span m=''784880''>only</span> <span m=''785170''>one</span> <span m=''785470''>person</span>
  <span m=''785750''>can</span> <span m=''786710''>be</span> <span m=''787020''>executing</span>
  <span m=''787250''>that</span> <span m=''787380''>method</span> <span m=''787520''>at</span>
  <span m=''787600''>any</span> <span m=''787720''>one</span> <span m=''787880''>time.</span>
  <span m=''788530''>So in</span> <span m=''788660''>here</span> <span m=''789070''>I</span>
  <span m=''789190''>would</span> <span m=''789350''>say</span> <span m=''789480''>get</span>
  <span m=''789720''>balance</span> <span m=''790320''>and</span> <span m=''791070''>post</span>
  <span m=''791430''>so you can</span> <span m=''791530''>synchronize.</span> </p><p><span
  m=''792990''>So</span> <span m=''793160''>when</span> <span m=''793300''>you</span>
  <span m=''793400''>do</span> <span m=''793600''>that,</span> <span m=''794250''>what</span>
  <span m=''794460''>happens</span> <span m=''794890''>is</span> <span m=''795290''>--</span>
  <span m=''796810''>so</span> <span m=''796955''>in</span> <span m=''797100''>here</span>
  <span m=''797280''>you</span> <span m=''797450''>read.</span> <span m=''797700''>No</span>
  <span m=''797830''>problem,</span> <span m=''798180''>you</span> <span m=''798240''>can</span>
  <span m=''798390''>do</span> <span m=''798480''>this</span> <span m=''798630''>parallel.</span>
  <span m=''799050''>You</span> <span m=''799230''>can</span> <span m=''799420''>do</span>
  <span m=''799560''>this</span> <span m=''799680''>in</span> <span m=''799870''>parallel.</span>
  <span m=''800490''>And</span> <span m=''800600''>then</span> <span m=''800710''>you</span>
  <span m=''801010''>say,</span> <span m=''803570''>first</span> <span m=''803890''>take</span>
  <span m=''804000''>out</span> <span m=''804240''>post</span> <span m=''804590''>in</span>
  <span m=''804680''>here.</span> <span m=''805390''>And</span> <span m=''805900''>this</span>
  <span m=''806180''>[? takes out ?]</span> <span m=''806380''>post.</span> <span
  m=''809230''>Because</span> <span m=''809630''>of</span> <span m=''811220''>synchronization</span>
  <span m=''811730''>these</span> <span m=''811950''>things</span> <span m=''812170''>can''t</span>
  <span m=''812450''>have an</span> <span m=''812750''>order,</span> <span m=''813150''>because</span>
  <span m=''813370''>this</span> <span m=''813520''>has to</span> <span m=''813700''>happen</span>
  <span m=''814340''>in</span> <span m=''814510''>some</span> <span m=''814720''>order.</span>
  <span m=''815000''>Either</span> <span m=''815160''>this</span> <span m=''815280''>happens</span>
  <span m=''815610''>first</span> <span m=''816180''>and</span> <span m=''816410''>this</span>
  <span m=''816480''>has to</span> <span m=''816720''>finish</span> <span m=''816940''>before</span>
  <span m=''817180''>this one.</span> <span m=''818090''>At</span> <span m=''818200''>that</span>
  <span m=''818450''>point</span> <span m=''818790''>you</span> <span m=''820760''>can</span>
  <span m=''820980''>actually --</span> <span m=''821720''>what</span> <span m=''821940''>happened</span>
  <span m=''822280''>now?</span> <span m=''826830''>Are</span> <span m=''827010''>we</span>
  <span m=''827100''>happy?</span> </p><p><span m=''827530''>AUDIENCE:</span> <span
  m=''828020''>[INAUDIBLE].</span> </p><p><span m=''829980''>PROFESSOR: Yeah.</span>
  <span m=''830230''>At</span> <span m=''830340''>least</span> <span m=''831040''>banks</span>
  <span m=''831540''>realize</span> <span m=''832080''>--</span> <span m=''833800''>bank''s</span>
  <span m=''835000''>book</span> <span m=''835310''>is</span> <span m=''835460''>correct.</span>
  <span m=''835870''>Because</span> <span m=''836260''>it</span> <span m=''836340''>realizes,</span>
  <span m=''836480''>here</span> <span m=''836580''>is</span> <span m=''836860''>more</span>
  <span m=''837040''>money.</span> <span m=''837760''>But</span> <span m=''838020''>actually</span>
  <span m=''838440''>it</span> <span m=''839220''>let</span> <span m=''839510''>you</span>
  <span m=''840250''>take</span> <span m=''840530''>more</span> <span m=''840670''>money</span>
  <span m=''840880''>than</span> <span m=''841120''>your</span> <span m=''841250''>account
  had.</span> <span m=''841450''>So</span> <span m=''841640''>at</span> <span m=''841730''>least</span>
  <span m=''841940''>it</span> <span m=''842190''>got</span> <span m=''842530''>that</span>
  <span m=''842910''>value</span> <span m=''843230''>right.</span> <span m=''843820''>But</span>
  <span m=''844220''>what</span> <span m=''844370''>happened</span> <span m=''844760''>was,</span>
  <span m=''844980''>why</span> <span m=''845540''>is this</span> <span m=''845650''>happening</span>
  <span m=''846010''>now?</span> </p><p><span m=''846250''>AUDIENCE:</span> <span
  m=''847710''>You</span> <span m=''848196''>want the check</span> <span m=''848683''>covered.</span>
  </p><p><span m=''849170''>PROFESSOR:</span> <span m=''849530''>OK,</span> <span
  m=''849750''>you</span> <span m=''849840''>want</span> <span m=''849990''>to</span>
  <span m=''850050''>check</span> <span m=''850390''>also.</span> <span m=''851900''>Good.</span>
  <span m=''852420''>So</span> <span m=''853720''>the</span> <span m=''853830''>key</span>
  <span m=''853930''>thing</span> <span m=''854140''>is,</span> <span m=''855210''>here</span>
  <span m=''855340''>we</span> <span m=''855400''>didn''t</span> <span m=''855550''>check.</span>
  <span m=''856820''>So</span> <span m=''857090''>you</span> <span m=''857220''>have</span>
  <span m=''857340''>a</span> <span m=''857530''>negative</span> <span m=''857630''>bank</span>
  <span m=''857910''>balance</span> <span m=''858150''>happening.</span> <span m=''859100''>So</span>
  <span m=''859350''>this</span> <span m=''859520''>is</span> <span m=''859630''>a</span>
  <span m=''859720''>problem</span> <span m=''860090''>with</span> <span m=''860200''>atomacity.</span>
  <span m=''862490''>Because</span> <span m=''863030''>synchronized</span> <span m=''863570''>methods</span>
  <span m=''863890''>execute</span> <span m=''864620''>the</span> <span m=''864760''>body</span>
  <span m=''865060''>at</span> <span m=''865320''>atomic</span> <span m=''865430''>units.</span>
  <span m=''865860''>So</span> <span m=''866060''>when</span> <span m=''866290''>that</span>
  <span m=''866460''>happens,</span> <span m=''866890''>the</span> <span m=''867100''>entire</span>
  <span m=''867370''>thing</span> <span m=''867540''>of body</span> <span m=''868010''>happens</span>
  <span m=''868860''>without</span> <span m=''869360''>anybody</span> <span m=''869970''>else</span>
  <span m=''870580''>[? modifying. ?]</span> <span m=''870880''>That''s</span> <span
  m=''871110''>the</span> <span m=''871170''>only</span> <span m=''871340''>thing</span>
  <span m=''871460''>that''s</span> <span m=''871620''>happening</span> <span m=''871890''>at</span>
  <span m=''872020''>any</span> <span m=''872150''>given</span> <span m=''872270''>time.</span>
  <span m=''875170''>The</span> <span m=''875390''>code</span> <span m=''875740''>read</span>
  <span m=''876060''>[UNINTELLIGIBLE]</span> <span m=''877540''>you</span> <span m=''877740''>chose
  is</span> <span m=''878220''>probably</span> <span m=''878470''>too</span> <span
  m=''878620''>small</span> <span m=''878940''>in</span> <span m=''879050''>this</span>
  <span m=''879220''>case.</span> <span m=''881550''>What</span> <span m=''881780''>we</span>
  <span m=''881880''>need</span> <span m=''882050''>to</span> <span m=''882130''>do</span>
  <span m=''882430''>is,</span> <span m=''883890''>we</span> <span m=''884020''>need</span>
  <span m=''884170''>to</span> <span m=''884410''>basically</span> <span m=''884910''>have</span>
  <span m=''885140''>synchronizing</span> <span m=''886620''>not</span> <span m=''886920''>on
  the</span> <span m=''887120''>method</span> <span m=''887300''>but</span> <span
  m=''887460''>a lot</span> <span m=''887690''>more</span> <span m=''888090''>[UNINTELLIGIBLE]</span>
  <span m=''888340''>in</span> <span m=''888480''>there,</span> <span m=''888660''>so</span>
  <span m=''888740''>you</span> <span m=''888850''>have</span> <span m=''888980''>to
  do</span> <span m=''889080''>block</span> <span m=''889330''>synchronization.</span>
  <span m=''890920''>So</span> <span m=''891100''>synchronized</span> <span m=''891600''>keywords</span>
  <span m=''891950''>actually</span> <span m=''892280''>work</span> <span m=''892540''>like</span>
  <span m=''892780''>this</span> <span m=''892990''>too.</span> <span m=''893470''>You</span>
  <span m=''893610''>can</span> <span m=''893840''>say</span> <span m=''894150''>instead</span>
  <span m=''894360''>of</span> <span m=''894490''>doing a</span> <span m=''894780''>method,</span>
  <span m=''895120''>you</span> <span m=''895220''>can</span> <span m=''895380''>just</span>
  <span m=''895510''>synchronize</span> <span m=''896540''>account</span> <span m=''897280''>and</span>
  <span m=''897560''>all</span> <span m=''897760''>those</span> <span m=''898030''>things</span>
  <span m=''898300''>happen</span> <span m=''898800''>synchronously</span> <span m=''899940''>within</span>
  <span m=''900390''>that</span> <span m=''900670''>block.</span> </p><p><span m=''904130''>So,</span>
  <span m=''905280''>now</span> <span m=''905510''>what</span> <span m=''905650''>we
  have</span> <span m=''905840''>done</span> <span m=''906440''>is</span> <span m=''906570''>we</span>
  <span m=''906670''>have</span> <span m=''906820''>built</span> <span m=''906990''>a</span>
  <span m=''907060''>bigger</span> <span m=''907550''>atomic</span> <span m=''907650''>unit.</span>
  <span m=''911580''>So</span> <span m=''911790''>here''s</span> <span m=''912060''>the</span>
  <span m=''912140''>programming</span> <span m=''912660''>here.</span> <span m=''917060''>So</span>
  <span m=''917360''>here''s</span> <span m=''917780''>the</span> <span m=''917890''>synchronized</span>
  <span m=''918630''>unit in</span> <span m=''919000''>here.</span> <span m=''920250''>So</span>
  <span m=''920370''>what</span> <span m=''920810''>we</span> <span m=''920900''>did</span>
  <span m=''921310''>was,</span> <span m=''922080''>we</span> <span m=''922510''>say</span>
  <span m=''922730''>instead</span> <span m=''923240''>of</span> <span m=''923900''>these</span>
  <span m=''924520''>synchronized</span> <span m=''925140''>and these</span> <span
  m=''925300''>synchronize</span> <span m=''925750''>separately,</span> <span m=''926660''>both
  of</span> <span m=''927000''>these</span> <span m=''927270''>computations</span>
  <span m=''927810''>have</span> <span m=''928020''>to</span> <span m=''928400''>happen</span>
  <span m=''928650''>atomically.</span> <span m=''929230''>So</span> <span m=''929530''>when</span>
  <span m=''929750''>I</span> <span m=''929940''>check</span> <span m=''931090''>our
  bank</span> <span m=''931460''>balance,</span> <span m=''931820''>we</span> <span
  m=''932180''>can''t</span> <span m=''932450''>do</span> <span m=''932520''>anything</span>
  <span m=''932900''>else.</span> </p><p><span m=''934350''>So</span> <span m=''934550''>now</span>
  <span m=''934700''>what</span> <span m=''934860''>happens?</span> <span m=''935460''>So</span>
  <span m=''935720''>yeah,</span> <span m=''935930''>in</span> <span m=''936040''>this</span>
  <span m=''936180''>situation</span> <span m=''937510''>you''re</span> <span m=''937890''>reading,</span>
  <span m=''938040''>reading,</span> <span m=''938870''>and</span> <span m=''939610''>you</span>
  <span m=''939700''>get</span> <span m=''939860''>synchronized</span> <span m=''940390''>account
  in</span> <span m=''940880''>here,</span> <span m=''941710''>and</span> <span m=''942520''>I</span>
  <span m=''942640''>do</span> <span m=''942770''>account</span> <span m=''943160''>balance</span>
  <span m=''943550''>plus</span> <span m=''943870''>[? well ?]</span> <span m=''945750''>and</span>
  <span m=''946690''>post</span> <span m=''947070''>the</span> <span m=''947230''>account.</span>
  <span m=''947790''>So</span> <span m=''947980''>in</span> <span m=''948150''>here</span>
  <span m=''948830''>I</span> <span m=''948980''>go</span> <span m=''949130''>to</span>
  <span m=''949260''>10,</span> <span m=''949680''>I</span> <span m=''949820''>do</span>
  <span m=''950000''>that.</span> <span m=''951540''>If</span> <span m=''951780''>I</span>
  <span m=''951930''>start</span> <span m=''952370''>the</span> <span m=''952710''>other</span>
  <span m=''952910''>one</span> <span m=''953150''>here,</span> <span m=''953380''>I</span>
  <span m=''953430''>have</span> <span m=''953600''>to wait</span> <span m=''954250''>till</span>
  <span m=''954500''>that</span> <span m=''954750''>entire</span> <span m=''954810''>synchronization</span>
  <span m=''955160''>is</span> <span m=''955530''>over</span> <span m=''956120''>before</span>
  <span m=''956390''>I</span> <span m=''956450''>do</span> <span m=''956730''>that.</span>
  <span m=''958390''>Of course,</span> <span m=''958620''>I</span> <span m=''958680''>don''t</span>
  <span m=''958810''>have</span> <span m=''958940''>enough</span> <span m=''959160''>balance,</span>
  <span m=''959490''>so</span> <span m=''959720''>I</span> <span m=''959820''>throw</span>
  <span m=''960010''>exception.</span> </p><p><span m=''962430''>Are we</span> <span
  m=''962600''>still</span> <span m=''962770''>happy?</span> <span m=''965940''>Is</span>
  <span m=''966056''>there</span> <span m=''966173''>issue</span> <span m=''966290''>on</span>
  <span m=''966610''>this</span> <span m=''966810''>one?</span> <span m=''970740''>I</span>
  <span m=''970850''>mean,</span> <span m=''971030''>I</span> <span m=''971080''>guess</span>
  <span m=''971670''>--</span> <span m=''971760''>assume</span> <span m=''972840''>you</span>
  <span m=''972980''>can</span> <span m=''973130''>do</span> <span m=''973210''>something</span>
  <span m=''974510''>clever,</span> <span m=''974810''>but</span> <span m=''974970''>I</span>
  <span m=''975030''>haven''t</span> <span m=''975330''>done</span> <span m=''975510''>that.</span>
  <span m=''975940''>But</span> <span m=''976110''>there''s</span> <span m=''976290''>one</span>
  <span m=''976560''>issue</span> <span m=''976750''>in</span> <span m=''976900''>here.</span>
  <span m=''978150''>Which,</span> <span m=''979210''>when you</span> <span m=''979580''>start</span>
  <span m=''979940''>it''s</span> <span m=''980060''>just,</span> <span m=''980270''>balance</span>
  <span m=''980500''>is</span> <span m=''980740''>100.</span> <span m=''982260''>So</span>
  <span m=''982430''>in</span> <span m=''982530''>this</span> <span m=''982630''>one,</span>
  <span m=''982790''>say</span> <span m=''982950''>balance</span> <span m=''983270''>is</span>
  <span m=''983390''>100.</span> <span m=''983620''>You</span> <span m=''983770''>go</span>
  <span m=''983940''>type</span> <span m=''984280''>it</span> <span m=''984420''>and</span>
  <span m=''984580''>then</span> <span m=''985020''>voila,</span> <span m=''985260''>you</span>
  <span m=''985390''>type</span> <span m=''985640''>it</span> <span m=''985880''>and</span>
  <span m=''986220''>then,</span> <span m=''986990''>sorry,</span> <span m=''987280''>I</span>
  <span m=''987320''>don''t</span> <span m=''987460''>have</span> <span m=''987560''>money.</span>
  <span m=''988590''>So</span> <span m=''988680''>that''s</span> <span m=''988880''>not</span>
  <span m=''989040''>nice,</span> <span m=''989380''>because</span> <span m=''989640''>if</span>
  <span m=''989800''>you''ve</span> <span m=''989940''>got the</span> <span m=''990280''>balance</span>
  <span m=''990570''>you</span> <span m=''990640''>should</span> <span m=''990780''>be</span>
  <span m=''990850''>able</span> <span m=''990990''>to</span> <span m=''991050''>get</span>
  <span m=''991220''>that.</span> <span m=''991840''>So how we</span> <span m=''992330''>deal
  with</span> <span m=''992480''>that?</span> </p><p><span m=''992740''>AUDIENCE:</span>
  <span m=''999672''>[INAUDIBLE PHRASE].</span> </p><p><span m=''1007100''>PROFESSOR:</span>
  <span m=''1007350''>So</span> <span m=''1007550''>that''s</span> <span m=''1008820''>probably</span>
  <span m=''1009090''>the</span> <span m=''1009180''>best</span> <span m=''1009640''>solution</span>
  <span m=''1010200''>to</span> <span m=''1010310''>that</span> <span m=''1010490''>because</span>
  <span m=''1010960''>we</span> <span m=''1011220''>can</span> <span m=''1011330''>only</span>
  <span m=''1011420''>log into</span> <span m=''1011640''>one.</span> <span m=''1011900''>But</span>
  <span m=''1012840''>in</span> <span m=''1013010''>this</span> <span m=''1013160''>example</span>
  <span m=''1013620''>I</span> <span m=''1013740''>assume</span> <span m=''1014120''>what</span>
  <span m=''1014360''>we are</span> <span m=''1014540''>doing.</span> <span m=''1015330''>How</span>
  <span m=''1015480''>can</span> <span m=''1015660''>we</span> <span m=''1015750''>deal</span>
  <span m=''1016160''>with</span> <span m=''1016350''>this</span> <span m=''1016530''>one?</span>
  </p><p><span m=''1017253''>AUDIENCE:</span> <span m=''1017737''>There</span> <span
  m=''1018220''>are two</span> <span m=''1018704''>ways of doing it.</span> <span
  m=''1019188''>One is to put the</span> <span m=''1019671''>whole</span> <span m=''1020155''>thing</span>
  <span m=''1020639''>[INAUDIBLE PHRASE]</span> <span m=''1021122''>section.</span>
  <span m=''1021283''>The</span> <span m=''1021444''>other</span> <span m=''1021606''>way
  is to</span> <span m=''1022090''>notify</span> <span m=''1022360''>somebody</span>
  <span m=''1022850''>that the</span> <span m=''1023250''>[UNINTELLIGIBLE PHRASE].</span>
  </p><p><span m=''1026720''>PROFESSOR:</span> <span m=''1027200''>[UNINTELLIGIBLE
  PHRASE].</span> <span m=''1028790''>So</span> <span m=''1028980''>what</span> <span
  m=''1029120''>I</span> <span m=''1029190''>can</span> <span m=''1029390''>do</span>
  <span m=''1029480''>is</span> <span m=''1029620''>I</span> <span m=''1029690''>can</span>
  <span m=''1029920''>say</span> <span m=''1030070''>OK,</span> <span m=''1030240''>wait</span>
  <span m=''1030390''>a</span> <span m=''1030420''>minute.</span> <span m=''1030590''>I
  am</span> <span m=''1030800''>actually</span> <span m=''1031180''>going</span> <span
  m=''1031390''>to</span> <span m=''1031450''>make</span> <span m=''1031680''>the</span>
  <span m=''1031770''>critical</span> <span m=''1032060''>section</span> <span m=''1032260''>even</span>
  <span m=''1032440''>bigger.</span> <span m=''1033520''>So</span> <span m=''1033710''>now</span>
  <span m=''1034300''>I</span> <span m=''1035090''>print</span> <span m=''1035550''>the</span>
  <span m=''1035630''>balance</span> <span m=''1036060''>before</span> <span m=''1036620''>I</span>
  <span m=''1036910''>do</span> <span m=''1037070''>that.</span> <span m=''1038970''>So</span>
  <span m=''1039170''>the</span> <span m=''1039380''>entire</span> <span m=''1039660''>thing</span>
  <span m=''1039840''>is</span> <span m=''1039930''>critical</span> <span m=''1040110''>section.</span>
  <span m=''1040200''>I print</span> <span m=''1040360''>the balance</span> <span
  m=''1041030''>off</span> <span m=''1041800''>and</span> <span m=''1042070''>then</span>
  <span m=''1043680''>go</span> <span m=''1043850''>ahead</span> <span m=''1043955''>and</span>
  <span m=''1044060''>withdraw</span> <span m=''1044165''>that.</span> <span m=''1044270''>So</span>
  <span m=''1044450''>what</span> <span m=''1044720''>might</span> <span m=''1044990''>happen</span>
  <span m=''1045330''>in</span> <span m=''1045450''>this</span> <span m=''1045610''>case?</span>
  </p><p><span m=''1045940''>AUDIENCE:</span> <span m=''1048481''>[INAUDIBLE PHRASE].</span>
  </p><p><span m=''1052040''>PROFESSOR: Yeah.</span> <span m=''1052430''>That''s</span>
  <span m=''1052590''>the</span> <span m=''1052670''>issue</span> <span m=''1052890''>of
  a</span> <span m=''1053010''>little</span> <span m=''1053230''>bit</span> <span
  m=''1053330''>of</span> <span m=''1053460''>waiting.</span> <span m=''1053810''>So</span>
  <span m=''1053930''>what</span> <span m=''1054090''>happens</span> <span m=''1054410''>is,</span>
  <span m=''1054540''>in</span> <span m=''1054710''>here.</span> <span m=''1054840''>You</span>
  <span m=''1055600''>do</span> <span m=''1055740''>this</span> <span m=''1055950''>one,</span>
  <span m=''1056750''>and</span> <span m=''1057340''>you</span> <span m=''1057450''>do</span>
  <span m=''1057620''>synchronized</span> <span m=''1058060''>account.</span> <span
  m=''1058520''>And</span> <span m=''1058690''>you</span> <span m=''1058800''>put</span>
  <span m=''1059010''>the</span> <span m=''1059100''>balance</span> <span m=''1059980''>and</span>
  <span m=''1060195''>other</span> <span m=''1060410''>one</span> <span m=''1060560''>do</span>
  <span m=''1060670''>synchronized</span> <span m=''1061300''>and</span> <span m=''1061590''>you</span>
  <span m=''1061920''>ask the</span> <span m=''1062000''>question.</span> <span m=''1063090''>In</span>
  <span m=''1063230''>here.</span> <span m=''1063770''>And</span> <span m=''1063910''>you</span>
  <span m=''1064060''>start</span> <span m=''1064230''>thinking.</span> <span m=''1066770''>We</span>
  <span m=''1066910''>can</span> <span m=''1067060''>start</span> <span m=''1067360''>thinking</span>
  <span m=''1067710''>that</span> <span m=''1068240''>my</span> <span m=''1068360''>machine</span>
  <span m=''1068640''>is</span> <span m=''1068740''>not</span> <span m=''1068890''>responsive,</span>
  <span m=''1069300''>it''s</span> <span m=''1069700''>just</span> <span m=''1069880''>waiting</span>
  <span m=''1070170''>for</span> <span m=''1070280''>the</span> <span m=''1070360''>critical</span>
  <span m=''1070670''>section</span> <span m=''1070980''>started.</span> <span m=''1071420''>[UNINTELLIGIBLE]</span>
  <span m=''1071780''>and</span> <span m=''1071900''>you</span> <span m=''1071960''>have</span>
  <span m=''1072070''>this</span> <span m=''1072200''>[? IOUN ?]</span> <span m=''1072720''>sitting</span>
  <span m=''1073040''>in</span> <span m=''1073130''>the</span> <span m=''1073200''>middle.</span>
  <span m=''1074040''>That''s</span> <span m=''1074260''>not</span> <span m=''1074420''>good</span>
  <span m=''1074620''>either.</span> <span m=''1075650''>So</span> <span m=''1075720''>he</span>
  <span m=''1075810''>has</span> <span m=''1075920''>a</span> <span m=''1075990''>performance</span>
  <span m=''1076440''>issue.</span> <span m=''1076640''>So</span> <span m=''1077460''>that''s</span>
  <span m=''1077640''>not</span> <span m=''1077780''>a  good</span> <span m=''1077840''>way</span>
  <span m=''1078270''>of</span> <span m=''1078370''>doing</span> <span m=''1078740''>that.</span>
  <span m=''1078940''>So</span> <span m=''1079320''>you</span> <span m=''1079410''>don''t</span>
  <span m=''1079590''>get</span> <span m=''1079940''>any</span> <span m=''1080180''>response</span>
  <span m=''1080370''>in here.</span> <span m=''1080870''>So</span> <span m=''1081530''>you</span>
  <span m=''1081760''>can</span> <span m=''1081990''>make</span> <span m=''1082390''>this</span>
  <span m=''1082580''>atomic</span> <span m=''1082840''>[? radius ?]</span> <span
  m=''1083730''>but</span> <span m=''1084110''>there''s</span> <span m=''1084240''>a</span>
  <span m=''1084290''>price</span> <span m=''1084700''>you''ll</span> <span m=''1084900''>pay</span>
  <span m=''1085700''>by</span> <span m=''1085840''>making</span> <span m=''1086100''>it</span>
  <span m=''1086200''>[UNINTELLIGIBLE PHRASE]</span> <span m=''1086420''>large.</span>
  </p><p><span m=''1090470''>So</span> <span m=''1090660''>here''s</span> <span m=''1090890''>another</span>
  <span m=''1091080''>thing</span> <span m=''1091380''>we</span> <span m=''1091480''>want</span>
  <span m=''1091660''>to</span> <span m=''1091730''>do.</span> <span m=''1092710''>I</span>
  <span m=''1092900''>want</span> <span m=''1093130''>to</span> <span m=''1093320''>do</span>
  <span m=''1093530''>something</span> <span m=''1093860''>that</span> <span m=''1093920''>can</span>
  <span m=''1094100''>transfer</span> <span m=''1094620''>account</span> <span m=''1094850''>balance</span>
  <span m=''1095250''>from</span> <span m=''1095350''>one account</span> <span m=''1095750''>to</span>
  <span m=''1095970''>another.</span> <span m=''1098130''>So</span> <span m=''1098460''>I</span>
  <span m=''1098570''>might</span> <span m=''1098770''>do</span> <span m=''1098990''>that</span>
  <span m=''1099140''>if I</span> <span m=''1099230''>have</span> <span m=''1099450''>a</span>
  <span m=''1099730''>method</span> <span m=''1099990''>in here</span> <span m=''1100130''>to</span>
  <span m=''1100270''>transfer</span> <span m=''1100580''>[UNINTELLIGIBLE]</span>
  <span m=''1101140''>account,</span> <span m=''1101540''>this</span> <span m=''1101690''>amount.</span>
  <span m=''1102080''>So</span> <span m=''1102190''>what I</span> <span m=''1102490''>do</span>
  <span m=''1102650''>is,</span> <span m=''1102880''>I</span> <span m=''1103870''>synchronize</span>
  <span m=''1104810''>from</span> <span m=''1105120''>account.</span> <span m=''1106030''>I</span>
  <span m=''1106310''>say,</span> <span m=''1107630''>I</span> <span m=''1107770''>get</span>
  <span m=''1108050''>balance</span> <span m=''1108250''>in</span> <span m=''1108580''>here.</span>
  <span m=''1112640''>If the</span> <span m=''1112750''>balance</span> <span m=''1112890''>is</span>
  <span m=''1113220''>available,</span> <span m=''1113950''>I</span> <span m=''1114140''>can</span>
  <span m=''1114370''>synchronize</span> <span m=''1114880''>the</span> <span m=''1115160''>two</span>
  <span m=''1115350''>accounts</span> <span m=''1115376''>and</span> <span m=''1115402''>force</span>
  <span m=''1115428''>it</span> <span m=''1115454''>there.</span> <span m=''1121790''>See</span>
  <span m=''1122020''>any</span> <span m=''1122140''>problems?</span> </p><p><span
  m=''1125010''>So</span> <span m=''1125720''>let''s</span> <span m=''1125790''>see</span>
  <span m=''1125920''>what</span> <span m=''1126080''>happenes.</span> <span m=''1126680''>So</span>
  <span m=''1126880''>assume</span> <span m=''1127560''>I</span> <span m=''1127630''>want
  to</span> <span m=''1127890''>transfer</span> <span m=''1129190''>10</span> <span
  m=''1129480''>to</span> <span m=''1129570''>Ben''s</span> <span m=''1129860''>account</span>
  <span m=''1130160''>and</span> <span m=''1130300''>Ben</span> <span m=''1130470''>wants</span>
  <span m=''1130590''>to</span> <span m=''1130710''>transfer</span> <span m=''1130990''>20</span>
  <span m=''1131430''>to</span> <span m=''1131690''>Alyssa''s</span> <span m=''1131930''>account.</span>
  <span m=''1133400''>So</span> <span m=''1133720''>what</span> <span m=''1133910''>happens</span>
  <span m=''1134230''>is,</span> <span m=''1134390''>this</span> <span m=''1134600''>goes</span>
  <span m=''1135150''>--</span> <span m=''1136420''>get</span> <span m=''1136790''>the</span>
  <span m=''1137120''>value</span> <span m=''1137420''>in here,</span> <span m=''1139170''>and</span>
  <span m=''1140540''>you</span> <span m=''1140640''>synchronize</span> <span m=''1141140''>to</span>
  <span m=''1141250''>two</span> <span m=''1142230''>and</span> <span m=''1142390''>say</span>
  <span m=''1142530''>OK,</span> <span m=''1142740''>great.</span> <span m=''1145160''>Now</span>
  <span m=''1145330''>what</span> <span m=''1145530''>happens</span> <span m=''1145850''>is,</span>
  <span m=''1145960''>in</span> <span m=''1146120''>here,</span> <span m=''1147030''>in</span>
  <span m=''1147190''>from,</span> <span m=''1148140''>I</span> <span m=''1148740''>am</span>
  <span m=''1149140''>holding</span> <span m=''1149790''>a</span> <span m=''1151020''>Alyssa''s</span>
  <span m=''1151320''>account.</span> <span m=''1151860''>There</span> <span m=''1152010''>I</span>
  <span m=''1152500''>am</span> <span m=''1152710''>holding</span> <span m=''1152870''>Ben''s</span>
  <span m=''1153030''>account.</span> <span m=''1154030''>Now,</span> <span m=''1154120''>inside</span>
  <span m=''1154490''>I</span> <span m=''1154560''>want</span> <span m=''1154740''>to</span>
  <span m=''1154810''>synchronize</span> <span m=''1155340''>for Alyssa.</span> <span
  m=''1155730''>And</span> <span m=''1155950''>I''m</span> <span m=''1156080''>still</span>
  <span m=''1156220''>[UNINTELLIGIBLE]</span> <span m=''1156490''>when</span> <span
  m=''1156620''>I</span> <span m=''1156760''>--</span> <span m=''1157630''>wait until</span>
  <span m=''1158020''>Alyssa got</span> <span m=''1158190''>released.</span> <span
  m=''1158480''>And</span> <span m=''1158660''>he</span> <span m=''1158770''>says</span>
  <span m=''1158940''>I want</span> <span m=''1159090''>to</span> <span m=''1159220''>wait</span>
  <span m=''1159400''>till</span> <span m=''1159490''>Ben</span> <span m=''1159700''>got</span>
  <span m=''1159840''>released.</span> <span m=''1160400''>And</span> <span m=''1160830''>nobody''s</span>
  <span m=''1161150''>going to</span> <span m=''1161350''>release,</span> <span m=''1161640''>and</span>
  <span m=''1161760''>you''re</span> <span m=''1162060''>hung.</span> <span m=''1163100''>You</span>
  <span m=''1163240''>are</span> <span m=''1163340''>in</span> <span m=''1164310''>what</span>
  <span m=''1164530''>you</span> <span m=''1164600''>call a</span> <span m=''1164930''>deadlock</span>
  <span m=''1165210''>situation.</span> <span m=''1165770''>That''s</span> <span m=''1166110''>a</span>
  <span m=''1166450''>deadlock.</span> <span m=''1170360''>So</span> <span m=''1170580''>you</span>
  <span m=''1170720''>have to be</span> <span m=''1170930''>very</span> <span m=''1171300''>careful</span>
  <span m=''1171930''>when you</span> <span m=''1172290''>do</span> <span m=''1172550''>synchronizing.</span>
  <span m=''1172690''>If</span> <span m=''1172830''>you</span> <span m=''1172900''>do</span>
  <span m=''1172980''>multiple</span> <span m=''1173540''>synchronization,</span>
  <span m=''1176010''>the</span> <span m=''1176600''>easiest</span> <span m=''1176830''>thing</span>
  <span m=''1176950''>you</span> <span m=''1177040''>can</span> <span m=''1177250''>do</span>
  <span m=''1177410''>is,</span> <span m=''1177730''>you</span> <span m=''1177880''>do</span>
  <span m=''1178050''>it in</span> <span m=''1178190''>some</span> <span m=''1178380''>order.</span>
  <span m=''1178820''>And</span> <span m=''1178920''>end</span> <span m=''1179080''>up</span>
  <span m=''1179210''>in</span> <span m=''1179270''>a</span> <span m=''1179530''>a
  deadlock</span> <span m=''1179620''>situation.</span> <span m=''1180100''>This is</span>
  <span m=''1180340''>a</span> <span m=''1180400''>very</span> <span m=''1180750''>common</span>
  <span m=''1181860''>way</span> <span m=''1182390''>of</span> <span m=''1183120''>parallel</span>
  <span m=''1183410''>programs</span> <span m=''1183800''>doing</span> <span m=''1184010''>that.</span>
  </p><p><span m=''1186470''>So</span> <span m=''1188830''>how to</span> <span m=''1189570''>avoid</span>
  <span m=''1189870''>deadlock?</span> <span m=''1190390''>Because</span> <span m=''1190780''>deadlock</span>
  <span m=''1191240''>is,</span> <span m=''1191710''>there''s</span> <span m=''1191960''>a
  cycle</span> <span m=''1192540''>in</span> <span m=''1193070''>locking</span> <span
  m=''1193430''>graph.</span> <span m=''1194460''>So</span> <span m=''1194660''>somebody''s</span>
  <span m=''1195120''>going</span> <span m=''1195290''>to lock</span> <span m=''1195510''>somebody,
  he''s</span> <span m=''1195990''>going to</span> <span m=''1196150''>lock</span>
  <span m=''1196330''>that</span> <span m=''1196520''>person,</span> <span m=''1196830''>and</span>
  <span m=''1196970''>we</span> <span m=''1197230''>have</span> <span m=''1197380''>a</span>
  <span m=''1197420''>cycle.</span> <span m=''1198150''>You</span> <span m=''1198240''>can</span>
  <span m=''1198530''>end up</span> <span m=''1198850''>in</span> <span m=''1198990''>deadlock</span>
  <span m=''1199280''>situation.</span> </p><p><span m=''1201620''>So</span> <span
  m=''1202490''>standard</span> <span m=''1203730''>solution</span> <span m=''1204030''>for</span>
  <span m=''1204200''>that</span> <span m=''1204340''>is,</span> <span m=''1204820''>you</span>
  <span m=''1205280''>take</span> <span m=''1205640''>locks</span> <span m=''1205950''>in</span>
  <span m=''1206050''>some</span> <span m=''1206260''>kind</span> <span m=''1206520''>of</span>
  <span m=''1206620''>canonical</span> <span m=''1206960''>order.</span> <span m=''1208580''>You</span>
  <span m=''1208780''>don''t</span> <span m=''1209040''>take</span> <span m=''1209550''>in</span>
  <span m=''1209780''>arbitary order.</span> <span m=''1210390''>So</span> <span m=''1210520''>it''s</span>
  <span m=''1210840''>some</span> <span m=''1211030''>kind</span> <span m=''1211280''>of</span>
  <span m=''1211370''>a</span> <span m=''1211520''>--</span> <span m=''1211910''>you</span>
  <span m=''1212140''>have</span> <span m=''1212380''>some</span> <span m=''1212840''>base</span>
  <span m=''1213165''>in,</span> <span m=''1213490''>OK,</span> <span m=''1213650''>if
  you</span> <span m=''1214080''>are</span> <span m=''1214390''>taking</span> <span
  m=''1214670''>this</span> <span m=''1214890''>lock,</span> <span m=''1215570''>you</span>
  <span m=''1215700''>have</span> <span m=''1215870''>to</span> <span m=''1215930''>have,</span>
  <span m=''1216870''>after</span> <span m=''1217180''>that,</span> <span m=''1217330''>you</span>
  <span m=''1217460''>can</span> <span m=''1217740''>take</span> <span m=''1218900''>a</span>
  <span m=''1219380''>higher</span> <span m=''1219860''>order</span> <span m=''1220120''>lock.</span>
  <span m=''1220580''>So</span> <span m=''1220690''>you</span> <span m=''1220780''>have</span>
  <span m=''1220890''>to have</span> <span m=''1221000''>some</span> <span m=''1221210''>kind</span>
  <span m=''1221390''>of</span> <span m=''1221450''>order</span> <span m=''1221630''>in</span>
  <span m=''1221810''>here.</span> <span m=''1222390''>Acquire</span> <span m=''1223060''>in</span>
  <span m=''1223620''>increasing</span> <span m=''1224070''>order</span> <span m=''1224440''>and</span>
  <span m=''1224520''>release</span> <span m=''1224600''>in</span> <span m=''1224750''>decreasing</span>
  <span m=''1225380''>order. So</span> <span m=''1225570''>you</span> <span m=''1225640''>have</span>
  <span m=''1225880''>some</span> <span m=''1226540''>kind</span> <span m=''1226750''>of</span>
  <span m=''1226820''>force in</span> <span m=''1227290''>here.</span> </p><p><span
  m=''1229190''>This</span> <span m=''1229410''>ensures</span> <span m=''1229770''>deadlock</span>
  <span m=''1230120''>freedom</span> <span m=''1230610''>most</span> <span m=''1230830''>of
  the</span> <span m=''1230900''>time,</span> <span m=''1231090''>but</span> <span
  m=''1231220''>it''s</span> <span m=''1231410''>not</span> <span m=''1231640''>that</span>
  <span m=''1231790''>easy</span> <span m=''1232090''>to</span> <span m=''1232180''>do</span>
  <span m=''1232380''>a</span> <span m=''1232410''>lot</span> <span m=''1232550''>of
  the</span> <span m=''1232650''>time.</span> <span m=''1232820''>Because</span> <span
  m=''1233170''>your</span> <span m=''1233280''>program</span> <span m=''1233800''>might</span>
  <span m=''1234020''>not</span> <span m=''1234160''>fit into</span> <span m=''1234590''>this</span>
  <span m=''1235290''>nice</span> <span m=''1235560''>ordering</span> <span m=''1236260''>a</span>
  <span m=''1236320''>lot</span> <span m=''1236470''>of</span> <span m=''1236560''>times,</span>
  <span m=''1236790''>and</span> <span m=''1236960''>then</span> <span m=''1237410''>sometimes</span>
  <span m=''1237830''>you</span> <span m=''1239350''>realize</span> <span m=''1239750''>that</span>
  <span m=''1239870''>you</span> <span m=''1239940''>had</span> <span m=''1240050''>locked</span>
  <span m=''1240310''>something</span> <span m=''1240930''>and</span> <span m=''1241160''>at</span>
  <span m=''1241240''>that</span> <span m=''1241430''>time</span> <span m=''1242070''>it''s</span>
  <span m=''1242260''>too</span> <span m=''1242390''>late</span> <span m=''1242660''>when</span>
  <span m=''1242770''>you</span> <span m=''1242880''>realize</span> <span m=''1243250''>it.</span>
  <span m=''1243350''>And then</span> <span m=''1243750''>it</span> <span m=''1244250''>has</span>
  <span m=''1244370''>a</span> <span m=''1244430''>different</span> <span m=''1244740''>order.</span>
  <span m=''1245100''>So</span> <span m=''1245200''>this</span> <span m=''1245490''>is,</span>
  <span m=''1246370''>you</span> <span m=''1246560''>have to</span> <span m=''1246700''>sometime</span>
  <span m=''1247050''>do</span> <span m=''1247160''>some</span> <span m=''1247910''>changes</span>
  <span m=''1248510''>to</span> <span m=''1248630''>basically</span> <span m=''1249090''>make</span>
  <span m=''1249230''>the</span> <span m=''1249310''>program</span> <span m=''1249650''>work</span>
  <span m=''1249880''>like this.</span> </p><p><span m=''1250540''>So</span> <span
  m=''1250690''>in here,</span> <span m=''1251110''>what</span> <span m=''1251300''>you</span>
  <span m=''1251440''>can</span> <span m=''1251920''>do</span> <span m=''1252070''>is,</span>
  <span m=''1252375''>in</span> <span m=''1252680''>the</span> <span m=''1252830''>program</span>
  <span m=''1253700''>you</span> <span m=''1253900''>can</span> <span m=''1254180''>associate</span>
  <span m=''1254820''>some</span> <span m=''1254970''>kind</span> <span m=''1255150''>of</span>
  <span m=''1255230''>a</span> <span m=''1255280''>rank,</span> <span m=''1256790''>and</span>
  <span m=''1256990''>when</span> <span m=''1257110''>you</span> <span m=''1259110''>put
  in</span> <span m=''1259710''>account,</span> <span m=''1260220''>you</span> <span
  m=''1260330''>put</span> <span m=''1260550''>the</span> <span m=''1260670''>rank</span>
  <span m=''1261010''>to the</span> <span m=''1261090''>account</span> <span m=''1261420''>number.</span>
  <span m=''1262200''>So</span> <span m=''1262310''>you have</span> <span m=''1262400''>some</span>
  <span m=''1262600''>kind</span> <span m=''1262770''>of</span> <span m=''1262850''>ordering</span>
  <span m=''1263240''>in</span> <span m=''1263390''>here.</span> <span m=''1264210''>Then</span>
  <span m=''1264510''>what</span> <span m=''1264740''>you</span> <span m=''1264800''>have</span>
  <span m=''1265030''>is,</span> <span m=''1265690''>you</span> <span m=''1266010''>always</span>
  <span m=''1266920''>get</span> <span m=''1267300''>the</span> <span m=''1267860''>first,</span>
  <span m=''1268170''>highest</span> <span m=''1268570''>rank</span> <span m=''1268890''>one</span>
  <span m=''1269060''>before</span> <span m=''1269260''>you</span> <span m=''1269320''>go</span>
  <span m=''1269450''>the</span> <span m=''1269550''>next</span> <span m=''1269800''>one.</span>
  <span m=''1269920''>So</span> <span m=''1270050''>there''s</span> <span m=''1270270''>some</span>
  <span m=''1270450''>ordering</span> <span m=''1270630''>in here.</span> <span m=''1271520''>So</span>
  <span m=''1271660''>at</span> <span m=''1271730''>least</span> <span m=''1272090''>then</span>
  <span m=''1272260''>we''ll</span> <span m=''1273040''>be</span> <span m=''1273710''>at</span>
  <span m=''1273810''>least</span> <span m=''1274010''>forced</span> <span m=''1274480''>into</span>
  <span m=''1274580''>some ordering</span> <span m=''1275410''>in</span> <span m=''1275926''>here.</span>
  </p><p><span m=''1276442''>AUDIENCE:</span> <span m=''1276700''>Is there a way</span>
  <span m=''1276958''>of</span> <span m=''1277474''>[UNINTELLIGIBLE PHRASE]</span>
  <span m=''1279190''>deadlock</span> <span m=''1279550''>[INAUDIBLE PHRASE].</span>
  </p><p><span m=''1283550''>PROFESSOR: Not</span> <span m=''1284140''>statically.</span>
  <span m=''1285470''>Because</span> <span m=''1285800''>most</span> <span m=''1286150''>of
  the</span> <span m=''1286260''>time</span> <span m=''1286900''>that</span> <span
  m=''1287120''>means</span> <span m=''1287280''>you</span> <span m=''1287410''>have</span>
  <span m=''1287530''>to</span> <span m=''1287610''>know</span> <span m=''1287850''>all</span>
  <span m=''1287970''>the</span> <span m=''1288290''>possible</span> <span m=''1289080''>control</span>
  <span m=''1289260''>profile,</span> <span m=''1289690''>to</span> <span m=''1290390''>do</span>
  <span m=''1290610''>that.</span> <span m=''1291710''>And,</span> <span m=''1292910''>for</span>
  <span m=''1293090''>example,</span> <span m=''1293690''>there</span> <span m=''1293840''>are</span>
  <span m=''1293900''>some</span> <span m=''1294230''>tools</span> <span m=''1294680''>that</span>
  <span m=''1294900''>can --</span> <span m=''1295490''>because</span> <span m=''1296130''>you</span>
  <span m=''1296260''>might</span> <span m=''1296670''>know</span> <span m=''1297400''>that,</span>
  <span m=''1297830''>for</span> <span m=''1297980''>example,</span> <span m=''1298550''>assume</span>
  <span m=''1299270''>you</span> <span m=''1299530''>are</span> <span m=''1299850''>trying</span>
  <span m=''1300070''>to</span> <span m=''1300140''>enforce</span> <span m=''1300680''>some</span>
  <span m=''1300820''>ordering</span> <span m=''1301090''>of</span> <span m=''1301410''>locks.</span>
  <span m=''1303040''>But</span> <span m=''1304920''>it''s</span> <span m=''1305060''>not</span>
  <span m=''1305650''>the</span> <span m=''1305770''>software,</span> <span m=''1306370''>it''s</span>
  <span m=''1306570''>the</span> <span m=''1306670''>locking</span> <span m=''1307020''>software,</span>
  <span m=''1307260''>that</span> <span m=''1307400''>doesn''t know</span> <span m=''1307680''>about</span>
  <span m=''1307800''>those.</span> <span m=''1308080''>You</span> <span m=''1308200''>can</span>
  <span m=''1308340''>actually</span> <span m=''1308860''>write</span> <span m=''1309120''>a</span>
  <span m=''1309220''>locking</span> <span m=''1309500''>software</span> <span m=''1310380''>that</span>
  <span m=''1310600''>will</span> <span m=''1310680''>tell</span> <span m=''1311150''>you,</span>
  <span m=''1311700''>like</span> <span m=''1311890''>look,</span> <span m=''1312090''>you</span>
  <span m=''1312180''>are</span> <span m=''1312360''>trying</span> <span m=''1312470''>to</span>
  <span m=''1312670''>acquire</span> <span m=''1313000''>locking</span> <span m=''1313310''>out</span>
  <span m=''1313460''>of</span> <span m=''1313690''>order,</span> <span m=''1314730''>out</span>
  <span m=''1314880''>of</span> <span m=''1315080''>this</span> <span m=''1315280''>locking</span>
  <span m=''1315520''>order.</span> <span m=''1316060''>Most</span> <span m=''1316320''>of</span>
  <span m=''1316380''>the</span> <span m=''1316450''>time</span> <span m=''1316630''>you</span>
  <span m=''1316700''>might</span> <span m=''1316880''>be</span> <span m=''1316970''>OK</span>
  <span m=''1317250''>because it</span> <span m=''1318000''>might</span> <span m=''1318230''>not</span>
  <span m=''1318410''>hit,</span> <span m=''1318820''>but</span> <span m=''1319060''>[?
  we assume ?]</span> <span m=''1319170''>that</span> <span m=''1319300''>if</span>
  <span m=''1319440''>you</span> <span m=''1319590''>are</span> <span m=''1319730''>doing</span>
  <span m=''1319930''>unsafe</span> <span m=''1320230''>thing</span> <span m=''1320640''>that</span>
  <span m=''1320820''>might work, so.</span> </p><p><span m=''1321350''>So</span>
  <span m=''1321690''>you</span> <span m=''1321830''>can</span> <span m=''1322060''>put</span>
  <span m=''1322230''>some</span> <span m=''1322450''>dynamic</span> <span m=''1322970''>checks</span>
  <span m=''1323550''>that</span> <span m=''1323750''>might</span> <span m=''1323940''>warn</span>
  <span m=''1324380''>you</span> <span m=''1325130''>that</span> <span m=''1325330''>you</span>
  <span m=''1325430''>might</span> <span m=''1325630''>be</span> <span m=''1325740''>in
  a</span> <span m=''1325830''>situation,</span> <span m=''1326250''>but</span> <span
  m=''1326430''>it</span> <span m=''1326500''>doesn''t</span> <span m=''1326730''>guarantee</span>
  <span m=''1326880''>you.</span> <span m=''1327520''>So</span> <span m=''1327700''>deadlock</span>
  <span m=''1328200''>is</span> <span m=''1328290''>something,</span> <span m=''1328730''>you</span>
  <span m=''1328830''>have</span> <span m=''1328960''>to</span> <span m=''1329040''>basically</span>
  <span m=''1329320''>--</span> <span m=''1329620''>there''s</span> <span m=''1329800''>no</span>
  <span m=''1329950''>nice</span> <span m=''1330200''>tools</span> <span m=''1331050''>for.</span>
  <span m=''1331360''>Basically,</span> <span m=''1331830''>it''s</span> <span m=''1331940''>almost</span>
  <span m=''1332420''>a</span> <span m=''1332460''>software</span> <span m=''1332750''>[?
  methodology. ?]</span> <span m=''1334030''>So,</span> <span m=''1334190''>for</span>
  <span m=''1334300''>example,</span> <span m=''1334690''>you</span> <span m=''1334770''>can</span>
  <span m=''1334930''>impose</span> <span m=''1335350''>a</span> <span m=''1335590''>software</span>
  <span m=''1335710''>methodology</span> <span m=''1335840''>to</span> <span m=''1336010''>say,</span>
  <span m=''1336640''>I''m</span> <span m=''1336940''>following</span> <span m=''1337450''>this</span>
  <span m=''1337900''>convention</span> <span m=''1338840''>and</span> <span m=''1339030''>that</span>
  <span m=''1339210''>will</span> <span m=''1339370''>guarantee</span> <span m=''1339750''>me</span>
  <span m=''1339870''>deadlock</span> <span m=''1340130''>freedom.</span> <span m=''1340770''>So</span>
  <span m=''1340940''>one</span> <span m=''1341230''>good</span> <span m=''1341360''>convention</span>
  <span m=''1341710''>is</span> <span m=''1341830''>this,</span> <span m=''1342320''>basically</span>
  <span m=''1342470''>some</span> <span m=''1342590''>order</span> <span m=''1342870''>in
  here.</span> </p><p><span m=''1344820''>So, another</span> <span m=''1345270''>interesting</span>
  <span m=''1345710''>thing</span> <span m=''1345950''>and</span> <span m=''1346110''>hard</span>
  <span m=''1346470''>thing</span> <span m=''1346730''>is</span> <span m=''1347350''>race</span>
  <span m=''1347620''>conditions.</span> <span m=''1350390''>These</span> <span m=''1350760''>are</span>
  <span m=''1350960''>non-deterministic</span> <span m=''1351590''>timing</span> <span
  m=''1352230''>dependent,</span> <span m=''1352980''>and</span> <span m=''1353220''>cause</span>
  <span m=''1353570''>data</span> <span m=''1354040''>corruption,</span> <span m=''1354350''>crashes</span>
  <span m=''1354980''>that are</span> <span m=''1355550''>impossible</span> <span
  m=''1356080''>to</span> <span m=''1356140''>detect.</span> <span m=''1357550''>So</span>
  <span m=''1358200''>the</span> <span m=''1358330''>problem</span> <span m=''1358740''>with</span>
  <span m=''1358960''>race</span> <span m=''1359420''>conditions</span> <span m=''1359970''>is</span>
  <span m=''1360640''>the</span> <span m=''1360730''>minute</span> <span m=''1361010''>you</span>
  <span m=''1361100''>put</span> <span m=''1362040''>your</span> <span m=''1362800''>debug,</span>
  <span m=''1363170''>or</span> <span m=''1363300''>put</span> <span m=''1363440''>any</span>
  <span m=''1363670''>debugging</span> <span m=''1363790''>things,</span> <span m=''1363950''>race</span>
  <span m=''1364570''>conditions</span> <span m=''1364940''>goes</span> <span m=''1365130''>away.</span>
  <span m=''1366970''>It</span> <span m=''1367080''>comes</span> <span m=''1367410''>back</span>
  <span m=''1367740''>when</span> <span m=''1367890''>you are</span> <span m=''1368010''>in</span>
  <span m=''1368320''>it</span> <span m=''1368450''>all</span> <span m=''1368740''>and</span>
  <span m=''1368910''>you''re</span> <span m=''1369060''>debugging</span> <span m=''1369490''>[UNINTELLIGIBLE
  PHRASE].</span> <span m=''1369940''>It</span> <span m=''1370130''>happens</span>
  <span m=''1370420''>again</span> <span m=''1370700''>because</span> <span m=''1370880''>it''s</span>
  <span m=''1371060''>basically</span> <span m=''1373300''>an</span> <span m=''1373410''>independent</span>
  <span m=''1373970''>thing.</span> <span m=''1374080''>In</span> <span m=''1374180''>fact,</span>
  <span m=''1374420''>I</span> <span m=''1374480''>have</span> <span m=''1374650''>this</span>
  <span m=''1375550''>interesting</span> <span m=''1377050''>experience</span> <span
  m=''1377520''>with myself.</span> </p><p><span m=''1377650''>A</span> <span m=''1377870''>long</span>
  <span m=''1378100''>time</span> <span m=''1378240''>ago</span> <span m=''1378330''>I</span>
  <span m=''1378380''>was</span> <span m=''1378520''>working</span> <span m=''1378680''>at</span>
  <span m=''1378790''>Microsoft</span> <span m=''1379260''>and</span> <span m=''1379910''>I</span>
  <span m=''1380070''>worked</span> <span m=''1380410''>two</span> <span m=''1380550''>summers.</span>
  <span m=''1381230''>In one</span> <span m=''1381640''>summer</span> <span m=''1381950''>I</span>
  <span m=''1382090''>was</span> <span m=''1382260''>working</span> <span m=''1382480''>on</span>
  <span m=''1383190''>their</span> <span m=''1385400''>LAN</span> <span m=''1385620''>manager</span>
  <span m=''1385900''>and</span> <span m=''1386210''>network</span> <span m=''1386540''>manager,</span>
  <span m=''1387830''>and</span> <span m=''1387970''>there''s</span> <span m=''1388110''>a
  bug</span> <span m=''1388840''>that</span> <span m=''1389450''>after</span> <span
  m=''1389740''>you</span> <span m=''1389890''>run</span> <span m=''1390100''>the</span>
  <span m=''1390430''>network</span> <span m=''1390930''>manager</span> <span m=''1391420''>for</span>
  <span m=''1391550''>some</span> <span m=''1391860''>time</span> <span m=''1392140''>it</span>
  <span m=''1392210''>just</span> <span m=''1392420''>freezes.</span> <span m=''1393410''>That''s</span>
  <span m=''1393550''>not</span> <span m=''1393720''>a</span> <span m=''1393770''>nice</span>
  <span m=''1394040''>behavior</span> <span m=''1394440''>to</span> <span m=''1394550''>have</span>
  <span m=''1395130''>if you</span> <span m=''1395370''>are running</span> <span m=''1395750''>your</span>
  <span m=''1395990''>network.</span> <span m=''1398370''>That</span> <span m=''1398610''>bug</span>
  <span m=''1398980''>lasted the</span> <span m=''1399500''>entire</span> <span m=''1399690''>year.</span>
  <span m=''1400330''>And at</span> <span m=''1400520''>the</span> <span m=''1400670''>end</span>
  <span m=''1400760''>they had,</span> <span m=''1401090''>I</span> <span m=''1401160''>think,
  a</span> <span m=''1401380''>$2,000</span> <span m=''1402550''>bounty</span> <span
  m=''1403020''>on</span> <span m=''1403230''>that</span> <span m=''1403460''>bug.</span>
  <span m=''1403930''>Because</span> <span m=''1404250''>the</span> <span m=''1404350''>minute</span>
  <span m=''1404690''>you</span> <span m=''1405140''>do</span> <span m=''1405320''>any</span>
  <span m=''1405790''>instrumentation,</span> <span m=''1406070''>the</span> <span
  m=''1406590''>[? bug isn''t ?]</span> <span m=''1406930''>[UNINTELLIGIBLE]</span>
  <span m=''1408460''>When</span> <span m=''1408560''>you</span> <span m=''1408680''>have</span>
  <span m=''1408760''>more</span> <span m=''1409080''>instrumentation</span> <span
  m=''1409230''>and</span> <span m=''1409940''>have</span> <span m=''1410280''>100</span>
  <span m=''1410730''>machines</span> <span m=''1411160''>running,</span> <span m=''1412400''>heavily,</span>
  <span m=''1412780''>hitting another</span> <span m=''1413040''>machine.</span> <span
  m=''1413840''>Once</span> <span m=''1414070''>in a</span> <span m=''1414240''>while</span>
  <span m=''1414350''>voila.</span> <span m=''1415310''>It</span> <span m=''1415700''>freezes.</span>
  <span m=''1416200''>And</span> <span m=''1416300''>you have</span> <span m=''1416490''>no</span>
  <span m=''1416740''>idea</span> <span m=''1416990''>why</span> <span m=''1417123''>it</span>
  <span m=''1417256''>happened.</span> <span m=''1418670''>That</span> <span m=''1419000''>was</span>
  <span m=''1419200''>so</span> <span m=''1419310''>hard</span> <span m=''1419480''>to</span>
  <span m=''1419560''>debug</span> <span m=''1419820''>because</span> <span m=''1420590''>there''s</span>
  <span m=''1420910''>nothing</span> <span m=''1421260''>you could</span> <span m=''1421470''>do,</span>
  <span m=''1421570''>because</span> <span m=''1421890''>any</span> <span m=''1422050''>time</span>
  <span m=''1422270''>you</span> <span m=''1422370''>do</span> <span m=''1422460''>any</span>
  <span m=''1422660''>changes,</span> <span m=''1423400''>the bug</span> <span m=''1423650''>goes</span>
  <span m=''1423950''>away.</span> <span m=''1429510''>You</span> <span m=''1429650''>had</span>
  <span m=''1429770''>to</span> <span m=''1429840''>be</span> <span m=''1429910''>very</span>
  <span m=''1430150''>careful</span> <span m=''1430550''>because</span> <span m=''1430720''>these</span>
  <span m=''1430960''>things</span> <span m=''1432050''>are not</span> <span m=''1432390''>easy
  to</span> <span m=''1432670''>find,</span> <span m=''1433310''>and</span> <span
  m=''1433900''>happen</span> <span m=''1435230''>intermittently.</span> <span m=''1436160''>And</span>
  <span m=''1436520''>very</span> <span m=''1436730''>hard to</span> <span m=''1437020''>debug.</span>
  <span m=''1437390''>So</span> <span m=''1437660''>having</span> <span m=''1437990''>good</span>
  <span m=''1438210''>discipline</span> <span m=''1438790''>and</span> <span m=''1439270''>good</span>
  <span m=''1439910''>design</span> <span m=''1440530''>really</span> <span m=''1440830''>helps</span>
  <span m=''1441180''>to</span> <span m=''1441270''>get</span> <span m=''1441410''>rid</span>
  <span m=''1441520''>of it.</span> <span m=''1442000''>These</span> <span m=''1442200''>are</span>
  <span m=''1442280''>not</span> <span m=''1442430''>something</span> <span m=''1442770''>you</span>
  <span m=''1442850''>can</span> <span m=''1443040''>go</span> <span m=''1443260''>through</span>
  <span m=''1443510''>like</span> <span m=''1443710''>program</span> <span m=''1444280''>debugs,</span>
  <span m=''1445690''>it</span> <span m=''1445880''>[UNINTELLIGIBLE]</span> <span
  m=''1446090''>cycle.</span> <span m=''1446580''>If</span> <span m=''1446830''>you
  read</span> <span m=''1447130''>that</span> <span m=''1447360''>cycle,</span> <span
  m=''1447670''>it''s a</span> <span m=''1447980''>very slow</span> <span m=''1448230''>cycle.</span>
  <span m=''1450110''>The</span> <span m=''1450250''>best way</span> <span m=''1450490''>to</span>
  <span m=''1450630''>do</span> <span m=''1450750''>that</span> <span m=''1451030''>is</span>
  <span m=''1451130''>get</span> <span m=''1451300''>the</span> <span m=''1451380''>design</span>
  <span m=''1451700''>right</span> <span m=''1451930''>first.</span> </p><p><span
  m=''1453230''>So</span> <span m=''1453820''>what''s</span> <span m=''1454040''>a</span>
  <span m=''1454110''>data race?</span> <span m=''1455040''>So I</span> <span m=''1455400''>assume</span>
  <span m=''1455560''>I had</span> <span m=''1455730''>this</span> <span m=''1455800''>program</span>
  <span m=''1456160''>like</span> <span m=''1456350''>that.</span> <span m=''1456630''>So</span>
  <span m=''1457500''>I</span> <span m=''1458090''>read</span> <span m=''1460260''>[?
  hit ?]</span> <span m=''1460590''>in</span> <span m=''1460780''>there,</span> <span
  m=''1461080''>and</span> <span m=''1461530''>then</span> <span m=''1461720''>I</span>
  <span m=''1462020''>modify</span> <span m=''1462500''>and</span> <span m=''1462780''>write</span>
  <span m=''1463060''>in this.</span> <span m=''1463710''>This</span> <span m=''1464090''>doesn''t</span>
  <span m=''1464300''>have</span> <span m=''1464370''>to</span> <span m=''1464630''>be
  in</span> <span m=''1464800''>two</span> <span m=''1465000''>statements.</span>
  <span m=''1465590''>If</span> <span m=''1465730''>we</span> <span m=''1465810''>[UNINTELLIGIBLE]</span>
  <span m=''1465990''>same</span> <span m=''1466640''>statement,</span> <span m=''1466990''>the</span>
  <span m=''1467070''>compiler</span> <span m=''1467600''>might</span> <span m=''1468110''>put</span>
  <span m=''1468270''>it</span> <span m=''1468360''>in</span> <span m=''1468440''>register,</span>
  <span m=''1468790''>read,</span> <span m=''1469700''>update</span> <span m=''1470170''>and</span>
  <span m=''1470320''>modify</span> <span m=''1470630''>and</span> <span m=''1470750''>write.</span>
  <span m=''1471000''>So</span> <span m=''1471120''>it</span> <span m=''1471560''>might</span>
  <span m=''1472460''>just</span> <span m=''1472640''>look</span> <span m=''1472940''>hits</span>
  <span m=''1473170''>equals</span> <span m=''1473440''>hits</span> <span m=''1473810''>plus</span>
  <span m=''1474050''>1</span> <span m=''1474310''>and</span> <span m=''1474450''>hits</span>
  <span m=''1474540''>equals</span> <span m=''1474890''>hits</span> <span m=''1475000''>plus</span>
  <span m=''1475320''>1</span> <span m=''1475480''>on</span> <span m=''1475570''>the</span>
  <span m=''1475710''>cycle.</span> <span m=''1476340''>Doesn''t</span> <span m=''1476503''>have</span>
  <span m=''1476666''>to</span> <span m=''1476830''>[? have temporary. ?]</span> <span
  m=''1477640''>and</span> <span m=''1477830''>in your</span> <span m=''1477980''>call.</span>
  <span m=''1478590''>Because</span> <span m=''1478970''>the compiler</span> <span
  m=''1479190''>puts</span> <span m=''1479440''>a</span> <span m=''1479580''>[? temporary
  ?]</span> <span m=''1479950''>in there.</span> </p><p><span m=''1481020''>And if</span>
  <span m=''1481140''>you</span> <span m=''1481250''>execute</span> <span m=''1481640''>like</span>
  <span m=''1481830''>this</span> <span m=''1481950''>you''re</span> <span m=''1482090''>happy.</span>
  <span m=''1484840''>But</span> <span m=''1485430''>if</span> <span m=''1485590''>you</span>
  <span m=''1485670''>get</span> <span m=''1485820''>excluded</span> <span m=''1486270''>in</span>
  <span m=''1486355''>this</span> <span m=''1486440''>order,</span> <span m=''1487430''>I</span>
  <span m=''1487590''>don''t</span> <span m=''1487820''>get</span> <span m=''1487960''>at</span>
  <span m=''1488070''>it</span> <span m=''1488480''>two</span> <span m=''1488640''>times,</span>
  <span m=''1488900''>I only</span> <span m=''1488980''>get</span> <span m=''1489220''>it</span>
  <span m=''1489410''>because</span> <span m=''1489670''>I</span> <span m=''1489770''>read</span>
  <span m=''1490730''>hit</span> <span m=''1490880''>the order</span> <span m=''1491170''>given</span>
  <span m=''1491490''>values.</span> <span m=''1492010''>This adds</span> <span m=''1492460''>once</span>
  <span m=''1492720''>and</span> <span m=''1492920''>writes.</span> <span m=''1493210''>And</span>
  <span m=''1493400''>this</span> <span m=''1493520''>also</span> <span m=''1493760''>adds</span>
  <span m=''1494055''>one</span> <span m=''1494350''>to</span> <span m=''1494430''>[?
  the ordinary value ?]</span> <span m=''1494820''>and</span> <span m=''1494970''>write.</span>
  <span m=''1495630''>So</span> <span m=''1495780''>I</span> <span m=''1495870''>only</span>
  <span m=''1496150''>get</span> <span m=''1496610''>it</span> <span m=''1496790''>increased</span>
  <span m=''1497120''>by</span> <span m=''1497270''>one</span> <span m=''1497510''>and</span>
  <span m=''1497630''>you are</span> <span m=''1497760''>in</span> <span m=''1498450''>a</span>
  <span m=''1498560''>bad</span> <span m=''1498790''>situation.</span> </p><p><span
  m=''1503930''>The</span> <span m=''1504090''>problems</span> <span m=''1504510''>with</span>
  <span m=''1504680''>data</span> <span m=''1504860''>races</span> <span m=''1504980''>is</span>
  <span m=''1505110''>this</span> <span m=''1505860''>non-determinism.</span> <span
  m=''1510410''>We</span> <span m=''1510720''>ensured</span> <span m=''1510900''>[UNINTELLIGIBLE]</span>
  <span m=''1511470''>that</span> <span m=''1511580''>this</span> <span m=''1511810''>mutual</span>
  <span m=''1512010''>exclusion.</span> <span m=''1512430''>So</span> <span m=''1512560''>if</span>
  <span m=''1513030''>you</span> <span m=''1513330''>have</span> <span m=''1513740''>same</span>
  <span m=''1514310''>data</span> <span m=''1514500''>access,</span> <span m=''1515110''>make</span>
  <span m=''1515360''>sure</span> <span m=''1515820''>that</span> <span m=''1516310''>they</span>
  <span m=''1516660''>are</span> <span m=''1516760''>in</span> <span m=''1517670''>the</span>
  <span m=''1517920''>mutual</span> <span m=''1518200''>exclude</span> <span m=''1518520''>region.</span>
  <span m=''1520560''>You</span> <span m=''1520630''>can</span> <span m=''1520830''>basically</span>
  <span m=''1521960''>see</span> <span m=''1522060''>that</span> <span m=''1522130''>it
  has</span> <span m=''1522360''>access</span> <span m=''1522710''>to</span> <span
  m=''1522910''>old</span> <span m=''1523610''>objects.</span> </p><p><span m=''1525150''>Before</span>
  <span m=''1525410''>you go</span> <span m=''1525640''>there,</span> <span m=''1527890''>one</span>
  <span m=''1528090''>interesting</span> <span m=''1528540''>thing</span> <span m=''1529230''>is</span>
  <span m=''1529790''>this is</span> <span m=''1530470''>just a</span> <span m=''1530590''>problem</span>
  <span m=''1531080''>with</span> <span m=''1531190''>all</span> <span m=''1531390''>parallel</span>
  <span m=''1531690''>programs.</span> <span m=''1532070''>So at</span> <span m=''1532240''>the</span>
  <span m=''1532320''>beginning you say</span> <span m=''1532810''>OK,</span> <span
  m=''1533030''>I''m</span> <span m=''1533280''>going</span> <span m=''1533450''>to</span>
  <span m=''1533520''>have</span> <span m=''1533670''>this</span> <span m=''1533800''>nice</span>
  <span m=''1534180''>mutual</span> <span m=''1534990''>excluded,</span> <span m=''1535860''>lock</span>
  <span m=''1536240''>ordered</span> <span m=''1536690''>program.</span> <span m=''1537060''>You</span>
  <span m=''1537130''>write</span> <span m=''1537410''>this.</span> <span m=''1538500''>It</span>
  <span m=''1540010''>worked</span> <span m=''1540530''>correctly,</span> <span m=''1541030''>beautifully,</span>
  <span m=''1541730''>but</span> <span m=''1541970''>run</span> <span m=''1542260''>dog</span>
  <span m=''1542620''>slow</span> <span m=''1542890''>because</span> <span m=''1543130''>now
  we</span> <span m=''1543350''>are</span> <span m=''1543570''>huge</span> <span m=''1544270''>critical</span>
  <span m=''1544650''>sections.</span> <span m=''1545150''>Everybody''s</span> <span
  m=''1545600''>waiting</span> <span m=''1545900''>in</span> <span m=''1546040''>data</span>
  <span m=''1546660''>and</span> <span m=''1546900''>then</span> <span m=''1546980''>someone</span>
  <span m=''1547180''>says</span> <span m=''1547250''>I want</span> <span m=''1547560''>to</span>
  <span m=''1547680''>run</span> <span m=''1547830''>fast.</span> <span m=''1548140''>I
  think</span> <span m=''1548640''>I</span> <span m=''1548800''>don''t</span> <span
  m=''1549060''>need</span> <span m=''1549300''>this</span> <span m=''1549520''>lock.</span>
  </p><p><span m=''1549810''>It</span> <span m=''1549920''>doesn''t</span> <span m=''1550190''>seem</span>
  <span m=''1550360''>to</span> <span m=''1550450''>be,</span> <span m=''1550610''>so</span>
  <span m=''1550780''>keep</span> <span m=''1551060''>removing</span> <span m=''1551480''>locks,</span>
  <span m=''1551720''>making</span> <span m=''1551980''>critical</span> <span m=''1552390''>sections</span>
  <span m=''1552750''>smaller</span> <span m=''1552970''>and</span> <span m=''1553160''>stuff</span>
  <span m=''1553420''>like</span> <span m=''1553610''>that.</span> <span m=''1554560''>That''s</span>
  <span m=''1554830''>where</span> <span m=''1555360''>all the</span> <span m=''1555440''>problems</span>
  <span m=''1555770''>start</span> <span m=''1556090''>cropping</span> <span m=''1556390''>up,</span>
  <span m=''1556490''>because</span> <span m=''1556730''>all</span> <span m=''1556920''>this</span>
  <span m=''1557080''>nice</span> <span m=''1557380''>design</span> <span m=''1557690''>goes</span>
  <span m=''1558030''>to</span> <span m=''1558150''>the</span> <span m=''1558260''>dogs</span>
  <span m=''1558530''>when</span> <span m=''1558710''>you</span> <span m=''1558780''>have</span>
  <span m=''1558950''>performance</span> <span m=''1559510''>issues.</span> <span
  m=''1559840''>So when</span> <span m=''1560070''>you</span> <span m=''1560350''>realize</span>
  <span m=''1561050''>that,</span> <span m=''1561410''>you</span> <span m=''1561620''>want
  to</span> <span m=''1561760''>write</span> <span m=''1562030''>this</span> <span
  m=''1562160''>nice</span> <span m=''1562520''>program,</span> <span m=''1563370''>nice</span>
  <span m=''1563760''>large</span> <span m=''1564290''>critical</span> <span m=''1564400''>sections,</span>
  <span m=''1565320''>stuff</span> <span m=''1565670''>like</span> <span m=''1565820''>that.</span>
  <span m=''1565980''>The programs</span> <span m=''1566320''>will</span> <span m=''1566410''>work</span>
  <span m=''1567040''>correctly.</span> <span m=''1568020''>But</span> <span m=''1568270''>run</span>
  <span m=''1568420''>like</span> <span m=''1568590''>a</span> <span m=''1568660''>dog</span>
  <span m=''1568960''>because</span> <span m=''1569110''>now it''s</span> <span m=''1569280''>sequential</span>
  <span m=''1569750''>in</span> <span m=''1569910''>many cases because you are doing
  this.</span> <span m=''1571520''>Then</span> <span m=''1571600''>you</span> <span
  m=''1571710''>go and</span> <span m=''1571960''>say</span> <span m=''1572100''>OK,</span>
  <span m=''1572610''>I</span> <span m=''1572690''>want to</span> <span m=''1572830''>run</span>
  <span m=''1572970''>parallel.</span> <span m=''1573500''>Eh,</span> <span m=''1573830''>this
  is</span> <span m=''1574080''>OK.</span> <span m=''1575320''>That''s</span> <span
  m=''1575620''>when</span> <span m=''1576180''>problems</span> <span m=''1576530''>start</span>
  <span m=''1576780''>creeping</span> <span m=''1577130''>up.</span> <span m=''1577400''>So</span>
  <span m=''1577950''>make</span> <span m=''1578160''>sure</span> <span m=''1578520''>that</span>
  <span m=''1579210''>when</span> <span m=''1579590''>you</span> <span m=''1579750''>get</span>
  <span m=''1579950''>a</span> <span m=''1579990''>discipline,</span> <span m=''1581200''>as</span>
  <span m=''1581620''>you</span> <span m=''1581840''>can</span> <span m=''1581990''>go</span>
  <span m=''1582140''>into</span> <span m=''1582340''>the</span> <span m=''1582430''>performance</span>
  <span m=''1583240''>improvement</span> <span m=''1583440''>but you</span> <span
  m=''1583910''>still</span> <span m=''1584160''>maintain</span> <span m=''1584590''>at
  least</span> <span m=''1584850''>some</span> <span m=''1585110''>part</span> <span
  m=''1585320''>of</span> <span m=''1585440''>discipline.</span> <span m=''1586090''>That''s</span>
  <span m=''1586300''>the</span> <span m=''1586390''>hard</span> <span m=''1586660''>thing.</span>
  </p><p><span m=''1588740''>So</span> <span m=''1588920''>I</span> <span m=''1588970''>want</span>
  <span m=''1589320''>to</span> <span m=''1589400''>switch gears</span> <span m=''1589470''>a</span>
  <span m=''1589550''>little</span> <span m=''1589800''>bit</span> <span m=''1590830''>to</span>
  <span m=''1591010''>talk</span> <span m=''1591260''>about</span> <span m=''1591460''>a</span>
  <span m=''1591550''>classic</span> <span m=''1591910''>problem.</span> <span m=''1592630''>It''s</span>
  <span m=''1592950''>called</span> <span m=''1593105''>dining</span> <span m=''1593260''>philosophers</span>
  <span m=''1593730''>problem.</span> <span m=''1594960''>So,</span> <span m=''1596320''>there</span>
  <span m=''1596460''>are</span> <span m=''1596500''>five</span> <span m=''1596820''>philosophers</span>
  <span m=''1597270''>sitting</span> <span m=''1597550''>around</span> <span m=''1597790''>a</span>
  <span m=''1597880''>table.</span> <span m=''1598890''>Between</span> <span m=''1599260''>each</span>
  <span m=''1599590''>of the</span> <span m=''1599710''>philosophers</span> <span
  m=''1600230''>there''s</span> <span m=''1600400''>a</span> <span m=''1600470''>chopstick.</span>
  <span m=''1603650''>So</span> <span m=''1603830''>each</span> <span m=''1603880''>philosopher</span>
  <span m=''1604620''>do</span> <span m=''1604830''>two</span> <span m=''1605040''>things.</span>
  <span m=''1605780''>He</span> <span m=''1605860''>thinks</span> <span m=''1606300''>--</span>
  <span m=''1607450''>he or</span> <span m=''1607590''>she</span> <span m=''1607840''>thinks</span>
  <span m=''1608270''>or he or</span> <span m=''1608460''>she</span> <span m=''1608590''>eats.</span>
  <span m=''1610690''>So</span> <span m=''1610850''>the</span> <span m=''1610940''>philosopher</span>
  <span m=''1611410''>thinks</span> <span m=''1611620''>for a</span> <span m=''1611760''>while.</span>
  <span m=''1612760''>And</span> <span m=''1613730''>then</span> <span m=''1613940''>the</span>
  <span m=''1614040''>philosopher</span> <span m=''1614550''>is hungry.</span> <span
  m=''1615480''>She</span> <span m=''1615680''>stops</span> <span m=''1615990''>thinking</span>
  <span m=''1616380''>and she</span> <span m=''1616920''>picks</span> <span m=''1617160''>up</span>
  <span m=''1618710''>a</span> <span m=''1619010''>left</span> <span m=''1619150''>and</span>
  <span m=''1619290''>right</span> <span m=''1619530''>chopstick,</span> <span m=''1620680''>eats,</span>
  <span m=''1621370''>and</span> <span m=''1621510''>puts</span> <span m=''1621630''>the</span>
  <span m=''1621720''>chopsticks</span> <span m=''1622100''>down.</span> <span m=''1624260''>He</span>
  <span m=''1624410''>cannot</span> <span m=''1624900''>eat</span> <span m=''1625410''>until</span>
  <span m=''1626240''>they</span> <span m=''1626510''>have</span> <span m=''1626730''>both</span>
  <span m=''1626980''>chopsticks</span> <span m=''1627330''>right in</span> <span
  m=''1627520''>hand</span> <span m=''1627910''>because you</span> <span m=''1627990''>can''t</span>
  <span m=''1628340''>eat with one</span> <span m=''1628780''>chopstick.</span> <span
  m=''1630370''>So</span> <span m=''1630550''>you</span> <span m=''1630690''>have</span>
  <span m=''1630820''>to</span> <span m=''1630950''>wait</span> <span m=''1631080''>until</span>
  <span m=''1631260''>you get</span> <span m=''1631570''>both</span> <span m=''1631860''>chopsticks.</span>
  <span m=''1632330''>When</span> <span m=''1632420''>you are</span> <span m=''1632520''>done,</span>
  <span m=''1634520''>you</span> <span m=''1634700''>put</span> <span m=''1634860''>the</span>
  <span m=''1634940''>chopsticks</span> <span m=''1635190''>down.</span> <span m=''1639200''>Then</span>
  <span m=''1639400''>after</span> <span m=''1639560''>you''re</span> <span m=''1640000''>done,
  you</span> <span m=''1640210''>go</span> <span m=''1640340''>back</span> <span m=''1640490''>to
  thinking</span> <span m=''1640840''>again</span> <span m=''1641060''>for</span>
  <span m=''1641200''>a</span> <span m=''1641240''>while</span> <span m=''1641510''>and</span>
  <span m=''1641870''>come</span> <span m=''1642000''>back</span> <span m=''1642710''>to</span>
  <span m=''1643000''>eating.</span> </p><p><span m=''1643730''>That''s</span> <span
  m=''1644047''>the</span> <span m=''1644365''>classic</span> <span m=''1644682''>problem.</span>
  <span m=''1645000''>So</span> <span m=''1645140''>how</span> <span m=''1645250''>to</span>
  <span m=''1645410''>write that,</span> <span m=''1646100''>record</span> <span m=''1646550''>that?</span>
  <span m=''1646890''>You</span> <span m=''1646980''>can</span> <span m=''1647130''>have</span>
  <span m=''1648280''>philosopher</span> <span m=''1648950''>extend</span> <span m=''1649470''>thread,</span>
  <span m=''1650050''>and</span> <span m=''1650280''>[UNINTELLIGIBLE PHRASE]</span>
  <span m=''1650590''>philosopher</span> <span m=''1651500''>you</span> <span m=''1651580''>have</span>
  <span m=''1651740''>a</span> <span m=''1651790''>chopstick</span> <span m=''1652020''>in</span>
  <span m=''1652350''>here,</span> <span m=''1652890''>and</span> <span m=''1656980''>instead</span>
  <span m=''1657490''>of</span> <span m=''1657580''>philosopher</span> <span m=''1658050''>buy</span>
  <span m=''1658430''>left and right</span> <span m=''1658810''>chopstick.</span>
  <span m=''1660200''>Then</span> <span m=''1660670''>what</span> <span m=''1660850''>you</span>
  <span m=''1660960''>do</span> <span m=''1661070''>is</span> <span m=''1661300''>you</span>
  <span m=''1661450''>create</span> <span m=''1661630''>a</span> <span m=''1661690''>number</span>
  <span m=''1661980''>of</span> <span m=''1662110''>philosophers</span> <span m=''1663380''>and</span>
  <span m=''1663880''>you</span> <span m=''1663960''>get</span> <span m=''1664070''>a</span>
  <span m=''1664100''>new</span> <span m=''1664290''>chopstick</span> <span m=''1664930''>and</span>
  <span m=''1665700''>start</span> <span m=''1665970''>to</span> <span m=''1666040''>the</span>
  <span m=''1666160''>left</span> <span m=''1666470''>and</span> <span m=''1666620''>you</span>
  <span m=''1666710''>go</span> <span m=''1666850''>to the</span> <span m=''1666950''>other</span>
  <span m=''1667250''>philosophers</span> <span m=''1667790''>assigning</span> <span
  m=''1668370''>left and</span> <span m=''1668670''>right</span> <span m=''1668960''>chopsticks</span>
  <span m=''1669500''>in</span> <span m=''1669650''>here,</span> <span m=''1670080''>and</span>
  <span m=''1670370''>then</span> <span m=''1670480''>you</span> <span m=''1670720''>start</span>
  <span m=''1671280''>the</span> <span m=''1671430''>philosophers</span> <span m=''1671920''>going.</span>
  <span m=''1672160''>So</span> <span m=''1672340''>you</span> <span m=''1672480''>just</span>
  <span m=''1672790''>set</span> <span m=''1672940''>up</span> <span m=''1674420''>a</span>
  <span m=''1674640''>chopstick</span> <span m=''1674890''>[? on it, ?]</span> <span
  m=''1675230''>and</span> <span m=''1675380''>then</span> <span m=''1675490''>you</span>
  <span m=''1675790''>share the</span> <span m=''1676190''>chopstick</span> <span
  m=''1677020''>and</span> <span m=''1677730''>do</span> <span m=''1677880''>that.</span>
  </p><p><span m=''1681200''>So</span> <span m=''1681330''>here</span> <span m=''1681900''>is</span>
  <span m=''1682200''>what</span> <span m=''1682340''>a</span> <span m=''1682540''>[UNINTELLIGIBLE]</span>
  <span m=''1682790''>philosopher</span> <span m=''1683030''>does.</span> <span m=''1683790''>So</span>
  <span m=''1684050''>I</span> <span m=''1684210''>am</span> <span m=''1684710''>here,</span>
  <span m=''1685550''>I''m</span> <span m=''1685790''>taking</span> <span m=''1686050''>my</span>
  <span m=''1686160''>left</span> <span m=''1686380''>chopstick,</span> <span m=''1687320''>I''m</span>
  <span m=''1687510''>taking</span> <span m=''1687760''>my</span> <span m=''1687900''>right</span>
  <span m=''1688040''>chopstick</span> <span m=''1689360''>and</span> <span m=''1690640''>I''m</span>
  <span m=''1690730''>going</span> <span m=''1690920''>to</span> <span m=''1691190''>eat
  and</span> <span m=''1691360''>I''m</span> <span m=''1691490''>done</span> <span
  m=''1691740''>eating</span> <span m=''1692050''>and</span> <span m=''1692150''>I''m
  putting</span> <span m=''1692570''>down there.</span> <span m=''1693260''>What will</span>
  <span m=''1693540''>happen in</span> <span m=''1693890''>this one?</span> </p><p><span
  m=''1694120''>AUDIENCE:</span> <span m=''1698062''>[INAUDIBLE PHRASE].</span> </p><p><span
  m=''1702990''>PROFESSOR:</span> <span m=''1703110''>In</span> <span m=''1704060''>what</span>
  <span m=''1704260''>situation,</span> <span m=''1704360''>[UNINTELLIGIBLE PHRASE].</span>
  <span m=''1708160''>[UNINTELLIGIBLE PHRASE],</span> <span m=''1709060''>but</span>
  <span m=''1709920''>right</span> <span m=''1710280''>technical</span> <span m=''1710450''>though</span>
  <span m=''1710870''>is</span> <span m=''1710980''>different.</span> </p><p><span
  m=''1711440''>AUDIENCE:</span> <span m=''1714400''>[INAUDIBLE PHRASE].</span> </p><p><span
  m=''1715880''>PROFESSOR: You</span> <span m=''1716050''>end</span> <span m=''1716180''>up</span>
  <span m=''1716280''>in</span> <span m=''1716380''>a</span> <span m=''1716440''>deadlock</span>
  <span m=''1716610''>because</span> <span m=''1716960''>[UNINTELLIGIBLE PHRASE]</span>
  <span m=''1717270''>we will</span> <span m=''1717390''>pick</span> <span m=''1717550''>up</span>
  <span m=''1717650''>the</span> <span m=''1717740''>left</span> <span m=''1718020''>chopstick</span>
  <span m=''1720240''>suddenly,</span> <span m=''1720710''>and</span> <span m=''1720890''>they
  all</span> <span m=''1721160''>try</span> <span m=''1721280''>to</span> <span m=''1721390''>take
  the</span> <span m=''1721870''>right chopstick.</span> <span m=''1722010''>There''s</span>
  <span m=''1722230''>no</span> <span m=''1722350''>right</span> <span m=''1722640''>chopstick</span>
  <span m=''1722840''>and</span> <span m=''1723070''>nobody</span> <span m=''1723500''>has</span>
  <span m=''1723660''>right</span> <span m=''1723750''>chopstick</span> <span m=''1724110''>and</span>
  <span m=''1724170''>everybody</span> <span m=''1724720''>waiting</span> <span m=''1724760''>for</span>
  <span m=''1725230''>somebody</span> <span m=''1725330''>to</span> <span m=''1725500''>drop</span>
  <span m=''1725700''>the</span> <span m=''1725810''>chopstick,</span> <span m=''1726120''>that''s</span>
  <span m=''1726300''>not</span> <span m=''1726440''>going</span> <span m=''1726600''>to</span>
  <span m=''1726660''>happen.</span> <span m=''1727830''>So</span> <span m=''1728730''>you
  have</span> <span m=''1728870''>a</span> <span m=''1728990''>problem.</span> <span
  m=''1730320''>Second</span> <span m=''1730690''>way</span> <span m=''1730820''>to</span>
  <span m=''1730850''>solve</span> <span m=''1731120''>that</span> <span m=''1731400''>is</span>
  <span m=''1732520''>this, and you  say</span> <span m=''1732750''>OK.</span> <span
  m=''1733640''>The</span> <span m=''1733750''>problem</span> <span m=''1734100''>is</span>
  <span m=''1734200''>everybody</span> <span m=''1734420''>trying</span> <span m=''1734610''>to</span>
  <span m=''1734780''>pick up this</span> <span m=''1734880''>chopstick.</span> <span
  m=''1736150''>I</span> <span m=''1736350''>will</span> <span m=''1736570''>put</span>
  <span m=''1737690''>unique</span> <span m=''1738060''>variable</span> <span m=''1738480''>table,</span>
  <span m=''1738670''>unique</span> <span m=''1739640''>object</span> <span m=''1740000''>table.</span>
  <span m=''1741670''>If</span> <span m=''1741760''>anybody</span> <span m=''1741830''>want</span>
  <span m=''1742100''>to eat,</span> <span m=''1742890''>I</span> <span m=''1743040''>need</span>
  <span m=''1743210''>to</span> <span m=''1743290''>own the</span> <span m=''1743470''>table.</span>
  <span m=''1745750''>What</span> <span m=''1745950''>will</span> <span m=''1746080''>this</span>
  <span m=''1746280''>do?</span> </p><p><span m=''1746480''>AUDIENCE:</span> <span
  m=''1747997''>[INAUDIBLE PHRASE].</span> </p><p><span m=''1750300''>AUDIENCE:</span>
  <span m=''1751384''>It</span> <span m=''1751926''>prevents</span> <span m=''1753010''>two
  people</span> <span m=''1753760''>who wouldn''t</span> <span m=''1754295''>normally</span>
  <span m=''1754830''>interact</span> <span m=''1755365''>from eating</span> <span
  m=''1756435''>at the same table.</span> </p><p><span m=''1756970''>PROFESSOR: Yes.</span>
  <span m=''1757540''>So what</span> <span m=''1757770''>happens</span> <span m=''1758060''>is</span>
  <span m=''1758160''>only</span> <span m=''1758370''>one</span> <span m=''1758590''>person</span>
  <span m=''1758850''>can</span> <span m=''1759000''>eat</span> <span m=''1759150''>at</span>
  <span m=''1759250''>a</span> <span m=''1759300''>time.</span> <span m=''1760220''>Which</span>
  <span m=''1760440''>works</span> <span m=''1760790''>perfectly,</span> <span m=''1760920''>beautifully,</span>
  <span m=''1761780''>sequential.</span> <span m=''1763430''>So,</span> <span m=''1764610''>you</span>
  <span m=''1765050''>wonder</span> <span m=''1765390''>if</span> <span m=''1765860''>one</span>
  <span m=''1766750''>philosopher</span> <span m=''1767080''>eating,</span> <span
  m=''1767710''>the</span> <span m=''1768150''>person or</span> <span m=''1768600''>[?
  posit ?]</span> <span m=''1768990''>can</span> <span m=''1769060''>eat.</span> <span
  m=''1770290''>But</span> <span m=''1770580''>you''re</span> <span m=''1770740''>not</span>
  <span m=''1770880''>allowed</span> <span m=''1771160''>to</span> <span m=''1771260''>because</span>
  <span m=''1771610''>the</span> <span m=''1772230''>chopstick</span> <span m=''1772510''>in</span>
  <span m=''1772680''>there.</span> <span m=''1773050''>So</span> <span m=''1773140''>one</span>
  <span m=''1773390''>way</span> <span m=''1773640''>of</span> <span m=''1773810''>doing</span>
  <span m=''1774100''>that</span> <span m=''1774240''>is</span> <span m=''1774680''>sequentialized</span>
  <span m=''1775400''>large regions,</span> <span m=''1776200''>with</span> <span
  m=''1776610''>putting</span> <span m=''1777010''>these</span> <span m=''1777120''>critical</span>
  <span m=''1777420''>sections  in there.</span> <span m=''1778440''>This</span> <span
  m=''1778670''>works.</span> <span m=''1780050''>Not</span> <span m=''1780340''>greatly,</span>
  <span m=''1780670''>but</span> <span m=''1781240''>it will</span> <span m=''1781530''>work.</span>
  </p><p><span m=''1782420''>Another</span> <span m=''1782820''>thing</span> <span
  m=''1783000''>is,</span> <span m=''1783100''>of course,</span> <span m=''1783410''>what</span>
  <span m=''1783570''>I</span> <span m=''1783640''>point</span> <span m=''1784010''>out</span>
  <span m=''1784370''>to</span> <span m=''1784570''>have</span> <span m=''1784830''>some</span>
  <span m=''1785030''>kind</span> <span m=''1785260''>of</span> <span m=''1785350''>ordering.</span>
  <span m=''1786550''>So</span> <span m=''1787420''>you</span> <span m=''1787520''>put</span>
  <span m=''1787730''>some</span> <span m=''1787950''>position</span> <span m=''1788440''>ordering</span>
  <span m=''1788800''>and</span> <span m=''1788910''>saying</span> <span m=''1789150''>if</span>
  <span m=''1789300''>you</span> <span m=''1789410''>are</span> <span m=''1791120''>sitting</span>
  <span m=''1791490''>in</span> <span m=''1793970''>even</span> <span m=''1794300''>position,</span>
  <span m=''1795320''>you''re the first</span> <span m=''1795480''>to pick</span>
  <span m=''1795820''>the</span> <span m=''1795910''>left</span> <span m=''1796200''>one,</span>
  <span m=''1796400''>if you are</span> <span m=''1796810''>putting an</span> <span
  m=''1796890''>odd</span> <span m=''1797080''>position,</span> <span m=''1797370''>you''re</span>
  <span m=''1797490''>supposed</span> <span m=''1797770''>to</span> <span m=''1797850''>pick</span>
  <span m=''1797970''>the right</span> <span m=''1798210''>one.</span> <span m=''1798350''>So</span>
  <span m=''1798710''>in</span> <span m=''1798900''>some sense,</span> <span m=''1800390''>it</span>
  <span m=''1800590''>got</span> <span m=''1800730''>[UNINTELLIGIBLE PHRASE]</span>
  <span m=''1801640''>go</span> <span m=''1801880''>here,</span> <span m=''1802030''>the</span>
  <span m=''1802190''>person</span> <span m=''1802430''>go</span> <span m=''1802570''>here,</span>
  <span m=''1802830''>so</span> <span m=''1803270''>only</span> <span m=''1803500''>one</span>
  <span m=''1803780''>can</span> <span m=''1803980''>get</span> <span m=''1804170''>that</span>
  <span m=''1804360''>so</span> <span m=''1804460''>you</span> <span m=''1804520''>don''t</span>
  <span m=''1804680''>have</span> <span m=''1804810''>ordering.</span> <span m=''1805240''>At
  least</span> <span m=''1805680''>between</span> <span m=''1805960''>those</span>
  <span m=''1806220''>two</span> <span m=''1806700''>you</span> <span m=''1807220''>can</span>
  <span m=''1807400''>maintain</span> <span m=''1807770''>that.</span> <span m=''1807900''>So</span>
  <span m=''1808170''>you</span> <span m=''1808290''>can</span> <span m=''1808500''>do</span>
  <span m=''1808630''>something</span> <span m=''1808980''>but</span> <span m=''1809110''>you</span>
  <span m=''1809210''>have</span> <span m=''1809330''>to</span> <span m=''1809400''>figure</span>
  <span m=''1809630''>out</span> <span m=''1809860''>what the</span> <span m=''1809930''>right</span>
  <span m=''1810160''>ordering</span> <span m=''1810730''>in here.</span> <span m=''1811250''>This
  is</span> <span m=''1811490''>not</span> <span m=''1812140''>a</span> <span m=''1812180''>linear</span>
  <span m=''1812550''>list,</span> <span m=''1812950''>linear</span> <span m=''1813170''>ordering</span>
  <span m=''1813570''>for</span> <span m=''1813800''>this</span> <span m=''1813890''>circuit.</span>
  <span m=''1814500''>But</span> <span m=''1814680''>you</span> <span m=''1814740''>can</span>
  <span m=''1814850''>copy</span> <span m=''1815170''>ordering</span> <span m=''1815520''>and</span>
  <span m=''1815650''>say OK, look,</span> <span m=''1816220''>if</span> <span m=''1816380''>you</span>
  <span m=''1816480''>do</span> <span m=''1816650''>that</span> <span m=''1817160''>this</span>
  <span m=''1817340''>new</span> <span m=''1817520''>way,</span> <span m=''1817720''>you</span>
  <span m=''1817840''>can</span> <span m=''1818000''>run</span> <span m=''1818730''>into</span>
  <span m=''1819440''>a</span> <span m=''1820410''>deadlock</span> <span m=''1820810''>situation.</span>
  </p><p><span m=''1823380''>There are</span> <span m=''1823600''>a</span> <span m=''1823650''>lot</span>
  <span m=''1823900''>of</span> <span m=''1823990''>types</span> <span m=''1824220''>of</span>
  <span m=''1824320''>synchronizations</span> <span m=''1824550''>in</span> <span
  m=''1825230''>Java,</span> <span m=''1825530''>and</span> <span m=''1825780''>then</span>
  <span m=''1825990''>tomorrow</span> <span m=''1826510''>you</span> <span m=''1827010''>learn</span>
  <span m=''1827470''>more</span> <span m=''1827820''>different</span> <span m=''1828150''>type</span>
  <span m=''1828310''>of</span> <span m=''1828410''>synchronization</span> <span m=''1829090''>with</span>
  <span m=''1829330''>available</span> <span m=''1833350''>using</span> <span m=''1833670''>[UNINTELLIGIBLE
  PHRASE],</span> <span m=''1834520''>so</span> <span m=''1834640''>using</span> <span
  m=''1835030''>MPI.</span> <span m=''1838060''>But</span> <span m=''1838270''>there
  are</span> <span m=''1838420''>a</span> <span m=''1838490''>lot</span> <span m=''1838650''>of</span>
  <span m=''1838810''>potential</span> <span m=''1839170''>problems</span> <span m=''1839460''>you
  are</span> <span m=''1839620''>worried</span> <span m=''1839760''>about.</span>
  <span m=''1840370''>Deadlock</span> <span m=''1841120''>you</span> <span m=''1841260''>have
  to</span> <span m=''1841340''>worry</span> <span m=''1841580''>about.</span> <span
  m=''1841780''>Two</span> <span m=''1841980''>or more</span> <span m=''1842150''>threads</span>
  <span m=''1842710''>stop,</span> <span m=''1843090''>wait</span> <span m=''1843320''>for</span>
  <span m=''1843450''>each</span> <span m=''1843650''>other</span> <span m=''1843840''>forever.</span>
  <span m=''1845480''>Livelock.</span> <span m=''1848090''>What</span> <span m=''1848270''>livelock</span>
  <span m=''1848770''>means</span> <span m=''1849060''>is</span> <span m=''1849360''>two</span>
  <span m=''1849510''>or more</span> <span m=''1849810''>threads</span> <span m=''1850300''>basically</span>
  <span m=''1851900''>trying</span> <span m=''1852230''>to</span> <span m=''1852330''>do</span>
  <span m=''1852450''>something</span> <span m=''1852730''>but</span> <span m=''1852880''>never</span>
  <span m=''1853140''>made</span> <span m=''1853370''>progress.</span> <span m=''1854700''>So
  good</span> <span m=''1855000''>example.</span> </p><p><span m=''1855560''>So</span>
  <span m=''1855950''>assume</span> <span m=''1857160''>I</span> <span m=''1857340''>go</span>
  <span m=''1857560''>--</span> <span m=''1858120''>it''s</span> <span m=''1858480''>like</span>
  <span m=''1858890''>sometimes</span> <span m=''1859420''>you</span> <span m=''1859550''>try
  to</span> <span m=''1859690''>cross</span> <span m=''1860960''>each</span> <span
  m=''1861570''>other</span> <span m=''1861730''>on</span> <span m=''1861860''>the</span>
  <span m=''1861940''>road</span> <span m=''1862220''>and</span> <span m=''1862360''>you</span>
  <span m=''1862510''>go</span> <span m=''1862670''>into</span> <span m=''1862910''>them</span>
  <span m=''1863020''>and</span> <span m=''1863120''>say</span> <span m=''1863190''>oops,</span>
  <span m=''1863550''>or you</span> <span m=''1863940''>both</span> <span m=''1864270''>say</span>
  <span m=''1864760''>oops,</span> <span m=''1864940''>sorry,</span> <span m=''1865060''>[UNINTELLIGIBLE]</span>
  <span m=''1866490''>You</span> <span m=''1866560''>get</span> <span m=''1866720''>into</span>
  <span m=''1867290''>a</span> <span m=''1867530''>situation</span> <span m=''1867930''>that</span>
  <span m=''1868070''>you</span> <span m=''1868310''>try</span> <span m=''1868480''>to</span>
  <span m=''1868550''>go</span> <span m=''1868670''>something,</span> <span m=''1869290''>both</span>
  <span m=''1869480''>you</span> <span m=''1869770''>start</span> <span m=''1870130''>to
  move a</span> <span m=''1870200''>little</span> <span m=''1870500''>bit</span> <span
  m=''1870630''>and</span> <span m=''1870790''>then</span> <span m=''1870910''>do</span>
  <span m=''1871060''>that</span> <span m=''1871250''>and you</span> <span m=''1871390''>keep</span>
  <span m=''1871620''>doing</span> <span m=''1871840''>that</span> <span m=''1871980''>forever</span>
  <span m=''1872300''>and</span> <span m=''1872420''>ever,</span> <span m=''1873570''>doing</span>
  <span m=''1873800''>it,</span> <span m=''1873950''>right.</span> <span m=''1874340''>So</span>
  <span m=''1874540''>that</span> <span m=''1875220''>can</span> <span m=''1875390''>happen.</span>
  <span m=''1875650''>If you</span> <span m=''1875900''>program</span> <span m=''1876290''>right,</span>
  <span m=''1876510''>you</span> <span m=''1876590''>can</span> <span m=''1876740''>actually</span>
  <span m=''1877400''>try</span> <span m=''1877680''>to</span> <span m=''1877740''>avoid</span>
  <span m=''1877980''>deadlock</span> <span m=''1878360''>by</span> <span m=''1878990''>doing</span>
  <span m=''1879330''>that,</span> <span m=''1879520''>but</span> <span m=''1879860''>both</span>
  <span m=''1880440''>no one</span> <span m=''1880880''>making</span> <span m=''1881130''>forward</span>
  <span m=''1881350''>progress,</span> <span m=''1881640''>so</span> <span m=''1881800''>that''s</span>
  <span m=''1882010''>called</span> <span m=''1882230''>livelock.</span> </p><p><span
  m=''1885630''>So</span> <span m=''1886090''>another</span> <span m=''1886400''>thing</span>
  <span m=''1886570''>that''s</span> <span m=''1886700''>called</span> <span m=''1886890''>starvation.</span>
  <span m=''1889440''>So</span> <span m=''1889940''>the</span> <span m=''1890090''>ordering</span>
  <span m=''1890730''>is a very good</span> <span m=''1891010''>example.</span> <span
  m=''1891550''>So</span> <span m=''1892010''>ordering says</span> <span m=''1892350''>the</span>
  <span m=''1892440''>higher</span> <span m=''1892750''>order</span> <span m=''1893130''>guy</span>
  <span m=''1894220''>always</span> <span m=''1895140''>gets</span> <span m=''1895550''>the</span>
  <span m=''1895760''>lock</span> <span m=''1896230''>for</span> <span m=''1896520''>the</span>
  <span m=''1896600''>lower</span> <span m=''1896980''>guy.</span> <span m=''1898080''>So</span>
  <span m=''1898170''>assume</span> <span m=''1898720''>you</span> <span m=''1899270''>have</span>
  <span m=''1899590''>thousands</span> <span m=''1900030''>of</span> <span m=''1900140''>things</span>
  <span m=''1900400''>and</span> <span m=''1900490''>everybody''s</span> <span m=''1900920''>trying</span>
  <span m=''1901090''>to</span> <span m=''1901150''>do</span> <span m=''1901270''>something.</span>
  <span m=''1902240''>If</span> <span m=''1902380''>you</span> <span m=''1902440''>have</span>
  <span m=''1902660''>an</span> <span m=''1902800''>lower</span> <span m=''1903210''>number,</span>
  <span m=''1904390''>you</span> <span m=''1905140''>probably</span> <span m=''1905440''>never</span>
  <span m=''1906050''>get</span> <span m=''1906290''>to</span> <span m=''1906790''>around</span>
  <span m=''1907090''>to</span> <span m=''1907590''>get</span> <span m=''1907850''>picked</span>
  <span m=''1908100''>up</span> <span m=''1908220''>because</span> <span m=''1908480''>always</span>
  <span m=''1908710''>if</span> <span m=''1908970''>higher</span> <span m=''1909420''>order</span>
  <span m=''1909530''>person</span> <span m=''1909860''>has,</span> <span m=''1910310''>that</span>
  <span m=''1910570''>person</span> <span m=''1910740''>will</span> <span m=''1910830''>get</span>
  <span m=''1910970''>the</span> <span m=''1911120''>lock.</span> <span m=''1911490''>So</span>
  <span m=''1911680''>if</span> <span m=''1911860''>they''re</span> <span m=''1912050''>ordering</span>
  <span m=''1912490''>constraint</span> <span m=''1912840''>in</span> <span m=''1913120''>there,</span>
  <span m=''1913550''>you</span> <span m=''1913730''>can</span> <span m=''1913890''>be
  in</span> <span m=''1914030''>situation</span> <span m=''1914540''>that</span> <span
  m=''1915000''>some</span> <span m=''1915220''>people</span> <span m=''1915530''>always</span>
  <span m=''1915950''>get</span> <span m=''1916500''>and others</span> <span m=''1916870''>never</span>
  <span m=''1917360''>get --</span> <span m=''1917630''>there''s</span> <span m=''1917840''>no</span>
  <span m=''1918610''>fairness</span> <span m=''1919170''>in that,</span> <span m=''1920000''>because</span>
  <span m=''1920230''>when</span> <span m=''1920350''>you</span> <span m=''1920810''>some</span>
  <span m=''1921150''>ordering</span> <span m=''1921510''>constraints.</span> <span
  m=''1924100''>So</span> <span m=''1924310''>again,</span> <span m=''1924560''>lack
  of</span> <span m=''1924780''>fairness.</span> </p><p><span m=''1928740''>Of</span>
  <span m=''1928850''>course,</span> <span m=''1929060''>race</span> <span m=''1929280''>conditions.</span>
  <span m=''1931060''>So</span> <span m=''1931260''>you</span> <span m=''1933870''>didn''t</span>
  <span m=''1934060''>realize</span> <span m=''1934550''>that</span> <span m=''1934730''>the</span>
  <span m=''1934820''>same</span> <span m=''1935210''>object</span> <span m=''1936230''>is</span>
  <span m=''1936420''>accessed</span> <span m=''1936800''>by</span> <span m=''1937000''>multiple</span>
  <span m=''1937180''>people</span> <span m=''1937890''>without</span> <span m=''1938530''>being</span>
  <span m=''1939130''>in a</span> <span m=''1939360''>particular</span> <span m=''1940270''>section.</span>
  <span m=''1940650''>That''s</span> <span m=''1940990''>the</span> <span m=''1941550''>key
  --</span> <span m=''1942190''>I mean</span> <span m=''1942270''>don''t</span> <span
  m=''1942480''>try</span> <span m=''1942700''>to</span> <span m=''1942770''>do</span>
  <span m=''1943110''>fancy</span> <span m=''1943510''>things</span> <span m=''1943880''>by</span>
  <span m=''1944960''>letting</span> <span m=''1945860''>multiple</span> <span m=''1946350''>people</span>
  <span m=''1946600''>have</span> <span m=''1946720''>access</span> <span m=''1947010''>to</span>
  <span m=''1947100''>same thing.</span> <span m=''1947680''>This</span> <span m=''1947870''>is</span>
  <span m=''1948000''>not</span> <span m=''1948240''>much</span> <span m=''1948440''>of</span>
  <span m=''1948540''>issue</span> <span m=''1948980''>on</span> <span m=''1949520''>distributed</span>
  <span m=''1950130''>memory</span> <span m=''1950330''>machines</span> <span m=''1950760''>because</span>
  <span m=''1951690''>there''s</span> <span m=''1952600''>only</span> <span m=''1952840''>you</span>
  <span m=''1953370''>access</span> <span m=''1953500''>to</span> <span m=''1953640''>your</span>
  <span m=''1953860''>memory.</span> <span m=''1954580''>But</span> <span m=''1954780''>the</span>
  <span m=''1954850''>problem</span> <span m=''1955270''>there</span> <span m=''1955570''>is</span>
  <span m=''1956030''>if</span> <span m=''1956230''>you</span> <span m=''1956360''>keep</span>
  <span m=''1956640''>values,</span> <span m=''1957020''>you</span> <span m=''1957110''>suddenly</span>
  <span m=''1957420''>start</span> <span m=''1957710''>giving it</span> <span m=''1957920''>to
  everybody</span> <span m=''1958260''>and</span> <span m=''1958500''>say</span> <span
  m=''1958710''>go</span> <span m=''1958830''>play,</span> <span m=''1959700''>assuming</span>
  <span m=''1960260''>that</span> <span m=''1960810''>only</span> <span m=''1961010''>one</span>
  <span m=''1961200''>person</span> <span m=''1961510''>have</span> <span m=''1961620''>access</span>
  <span m=''1961940''>to</span> <span m=''1962060''>it.</span> <span m=''1962160''>So</span>
  <span m=''1963460''>multiple</span> <span m=''1963870''>people</span> <span m=''1964150''>might</span>
  <span m=''1964320''>be</span> <span m=''1964410''>modifying</span> <span m=''1964940''>it</span>
  <span m=''1965110''>and</span> <span m=''1965290''>then</span> <span m=''1966210''>what</span>
  <span m=''1966390''>are</span> <span m=''1966530''>you</span> <span m=''1966640''>going
  to</span> <span m=''1966720''>do.</span> <span m=''1967060''>So</span> <span m=''1967260''>that</span>
  <span m=''1967380''>issue</span> <span m=''1967640''>is there.</span> <span m=''1968190''>So</span>
  <span m=''1969410''>when you are</span> <span m=''1969470''>doing,</span> <span
  m=''1969730''>using</span> <span m=''1970020''>data,</span> <span m=''1970250''>you</span>
  <span m=''1970340''>got to</span> <span m=''1970490''>be very</span> <span m=''1970720''>careful</span>
  <span m=''1971420''>who</span> <span m=''1971870''>holds</span> <span m=''1972140''>it
  and</span> <span m=''1972370''>at</span> <span m=''1972560''>what</span> <span m=''1972760''>time.</span>
  </p><p><span m=''1976040''>So,</span> <span m=''1978350''>concurrency</span> <span
  m=''1978540''>and</span> <span m=''1978920''>parallelism</span> <span m=''1979220''>are</span>
  <span m=''1979330''>important</span> <span m=''1979740''>concepts</span> <span m=''1980450''>in
  comparison</span> <span m=''1981190''>beyond</span> <span m=''1983180''>what</span>
  <span m=''1983370''>we are</span> <span m=''1983520''>doing</span> <span m=''1983910''>in
  here.</span> <span m=''1985310''>Concurrency</span> <span m=''1985520''>can</span>
  <span m=''1985820''>simplify</span> <span m=''1986530''>programming</span> <span
  m=''1987230''>beyond</span> <span m=''1987470''>anything.</span> <span m=''1991560''>It''s</span>
  <span m=''1991770''>very</span> <span m=''1992080''>hard</span> <span m=''1992510''>to</span>
  <span m=''1992630''>understand</span> <span m=''1993120''>and debug</span> <span
  m=''1993520''>concurrent</span> <span m=''1993940''>programs.</span> <span m=''1994310''>That''s</span>
  <span m=''1994540''>the</span> <span m=''1994700''>entire</span> <span m=''1995000''>reason</span>
  <span m=''1995410''>that</span> <span m=''1996170''>we</span> <span m=''1996460''>are</span>
  <span m=''1996580''>still</span> <span m=''1997010''>doing</span> <span m=''1997470''>sequential</span>
  <span m=''1997950''>programming</span> <span m=''1998500''>and</span> <span m=''1998670''>this</span>
  <span m=''1998830''>is</span> <span m=''1998960''>entire</span> <span m=''1999110''>reason</span>
  <span m=''1999720''>that</span> <span m=''1999860''>multiple</span> <span m=''2000130''>people</span>
  <span m=''2000670''>are</span> <span m=''2000800''>looking</span> <span m=''2001150''>at</span>
  <span m=''2001270''>it</span> <span m=''2001380''>in</span> <span m=''2001470''>a</span>
  <span m=''2001580''>very</span> <span m=''2001980''>--</span> <span m=''2002970''>people</span>
  <span m=''2003200''>are</span> <span m=''2003380''>scared</span> <span m=''2004040''>because</span>
  <span m=''2004380''>writing</span> <span m=''2004710''>and</span> <span m=''2004830''>getting</span>
  <span m=''2005040''>concurrent</span> <span m=''2005420''>program</span> <span m=''2005770''>right</span>
  <span m=''2006050''>is</span> <span m=''2006210''>probably an</span> <span m=''2006350''>order</span>
  <span m=''2006690''>of</span> <span m=''2006880''>magnitude</span> <span m=''2007040''>harder</span>
  <span m=''2007700''>than</span> <span m=''2007860''>trying</span> <span m=''2008040''>to</span>
  <span m=''2008100''>get</span> <span m=''2008210''>sequential</span> <span m=''2008630''>programs</span>
  <span m=''2009010''>right.</span> <span m=''2009660''>This</span> <span m=''2009810''>is</span>
  <span m=''2010010''>issue.</span> </p><p><span m=''2012660''>Parallelism</span>
  <span m=''2013150''>is</span> <span m=''2013270''>critical</span> <span m=''2013590''>for</span>
  <span m=''2014010''>high</span> <span m=''2014760''>performance.</span> <span m=''2015630''>I</span>
  <span m=''2015780''>mean,</span> <span m=''2015990''>it was</span> <span m=''2016150''>huge</span>
  <span m=''2016250''>for</span> <span m=''2016820''>supercomputers</span> <span m=''2017540''>in</span>
  <span m=''2017660''>national</span> <span m=''2018060''>labs</span> <span m=''2018450''>and</span>
  <span m=''2018640''>now</span> <span m=''2018810''>it''s</span> <span m=''2018920''>becoming</span>
  <span m=''2019510''>everybody''s</span> <span m=''2020050''>issue</span> <span m=''2020250''>because</span>
  <span m=''2020520''>of</span> <span m=''2020620''>multicore.</span> <span m=''2024090''>Basically,</span>
  <span m=''2025100''>you need</span> <span m=''2025370''>to</span> <span m=''2025530''>understand</span>
  <span m=''2026030''>concurrent</span> <span m=''2026470''>and</span> <span m=''2026610''>concurrence</span>
  <span m=''2026960''>issues,</span> <span m=''2027240''>it''s</span> <span m=''2027400''>the</span>
  <span m=''2027470''>basis</span> <span m=''2027900''>of</span> <span m=''2028020''>writing</span>
  <span m=''2028270''>parallel</span> <span m=''2028510''>programs.</span> <span m=''2029480''>So,</span>
  <span m=''2030550''>you</span> <span m=''2030710''>will run</span> <span m=''2031180''>into</span>
  <span m=''2031260''>all</span> <span m=''2031390''>these</span> <span m=''2031580''>issues,</span>
  <span m=''2032670''>deadlock,</span> <span m=''2033060''>you</span> <span m=''2033200''>can</span>
  <span m=''2033410''>deadlock</span> <span m=''2034500''>on</span> <span m=''2035220''>limited</span>
  <span m=''2035530''>access</span> <span m=''2035870''>on</span> <span m=''2036130''>Cell,</span>
  <span m=''2036440''>you can</span> <span m=''2037100''>deadlock</span> <span m=''2037420''>on</span>
  <span m=''2037650''>messages.</span> <span m=''2038720''>So everybody</span> <span
  m=''2039160''>is</span> <span m=''2039300''>waiting for</span> <span m=''2039700''>somebody</span>
  <span m=''2040030''>else to</span> <span m=''2040180''>send</span> <span m=''2040400''>you</span>
  <span m=''2040470''>a</span> <span m=''2040510''>message</span> <span m=''2040980''>and</span>
  <span m=''2041690''>nobody''s</span> <span m=''2042000''>sending</span> <span m=''2042280''>a</span>
  <span m=''2042340''>message</span> <span m=''2042630''>because</span> <span m=''2043940''>that</span>
  <span m=''2044180''>other</span> <span m=''2044370''>guy</span> <span m=''2044670''>will
  send</span> <span m=''2044800''>you a</span> <span m=''2044920''>message.</span>
  <span m=''2045230''>You</span> <span m=''2045310''>can</span> <span m=''2045460''>[?
  easier ?]</span> <span m=''2045730''>do</span> <span m=''2045860''>that</span> <span
  m=''2046030''>in</span> <span m=''2046130''>a</span> <span m=''2046200''>message</span>
  <span m=''2046550''>in</span> <span m=''2047250''>there,</span> <span m=''2047590''>and</span>
  <span m=''2047790''>a lot of</span> <span m=''2048190''>times</span> <span m=''2048330''>you</span>
  <span m=''2048450''>can deadlock</span> <span m=''2048750''>in that.</span> </p><p><span
  m=''2051270''>So</span> <span m=''2051460''>this</span> <span m=''2051690''>lecture</span>
  <span m=''2051750''>we</span> <span m=''2052150''>kind</span> <span m=''2052390''>of</span>
  <span m=''2052500''>did</span> <span m=''2053120''>concurrent</span> <span m=''2053540''>programming,</span>
  <span m=''2053930''>how</span> <span m=''2054070''>to write a</span> <span m=''2054300''>concurrent</span>
  <span m=''2054680''>program.</span> <span m=''2055380''>We</span> <span m=''2055560''>are</span>
  <span m=''2055700''>going</span> <span m=''2055910''>to</span> <span m=''2056100''>switch</span>
  <span m=''2056380''>gears</span> <span m=''2056740''>and</span> <span m=''2057030''>start</span>
  <span m=''2057320''>going</span> <span m=''2057500''>into</span> <span m=''2057640''>parallelism</span>
  <span m=''2058160''>next.</span> <span m=''2059700''>But</span> <span m=''2060720''>keep</span>
  <span m=''2061140''>these</span> <span m=''2061340''>issues</span> <span m=''2061600''>in</span>
  <span m=''2061730''>my</span> <span m=''2061900''>mind</span> <span m=''2062280''>when</span>
  <span m=''2062370''>you are</span> <span m=''2062470''>writing</span> <span m=''2062590''>parallel</span>
  <span m=''2062980''>programs.</span> <span m=''2063760''>Have</span> <span m=''2065290''>things</span>
  <span m=''2065880''>like</span> <span m=''2066110''>617</span> <span m=''2066290''>we</span>
  <span m=''2066790''>had</span> <span m=''2067020''>very</span> <span m=''2067450''>good</span>
  <span m=''2067620''>discipline</span> <span m=''2068480''>on</span> <span m=''2069160''>testing</span>
  <span m=''2069920''>and</span> <span m=''2070930''>methodology</span> <span m=''2071470''>of</span>
  <span m=''2071530''>development.</span> <span m=''2072340''>You</span> <span m=''2072590''>probably</span>
  <span m=''2072970''>won''t</span> <span m=''2073220''>have</span> <span m=''2073610''>kind</span>
  <span m=''2073800''>of</span> <span m=''2073880''>discipline</span> <span m=''2074390''>on</span>
  <span m=''2074770''>how</span> <span m=''2074940''>to do</span> <span m=''2075180''>parallelism.</span>
  <span m=''2076260''>So</span> <span m=''2076480''>there</span> <span m=''2076690''>are</span>
  <span m=''2076810''>many</span> <span m=''2077080''>ways --</span> <span m=''2078810''>next</span>
  <span m=''2079030''>few</span> <span m=''2079130''>lectures</span> <span m=''2079430''>we''ll</span>
  <span m=''2079550''>cover</span> <span m=''2079830''>many</span> <span m=''2080070''>different</span>
  <span m=''2080390''>ways</span> <span m=''2080580''>of</span> <span m=''2080680''>doing</span>
  <span m=''2080810''>parallelism.</span> <span m=''2083010''>Parallelism''s</span>
  <span m=''2083320''>a</span> <span m=''2083420''>very</span> <span m=''2083520''>powerful</span>
  <span m=''2084370''>tool,</span> <span m=''2084720''>but</span> <span m=''2085540''>if</span>
  <span m=''2085630''>you</span> <span m=''2085720''>don''t</span> <span m=''2085940''>use</span>
  <span m=''2086130''>it</span> <span m=''2086210''>in a</span> <span m=''2086390''>disciplined</span>
  <span m=''2086490''>way,</span> <span m=''2088380''>you</span> <span m=''2088540''>will</span>
  <span m=''2088670''>not</span> <span m=''2088890''>be</span> <span m=''2088970''>able</span>
  <span m=''2089110''>to</span> <span m=''2089180''>debug</span> <span m=''2089530''>these</span>
  <span m=''2089650''>[UNINTELLIGIBLE]</span> <span m=''2090620''>I</span> <span m=''2090680''>mean</span>
  <span m=''2091070''>you</span> <span m=''2091550''>run</span> <span m=''2091990''>into</span>
  <span m=''2092490''>bugs that</span> <span m=''2092660''>are so</span> <span m=''2092980''>subtle,</span>
  <span m=''2093760''>so</span> <span m=''2093900''>difficult</span> <span m=''2094300''>it''s</span>
  <span m=''2094400''>very</span> <span m=''2094580''>hard</span> <span m=''2094740''>to</span>
  <span m=''2094910''>find.</span> <span m=''2097410''>You</span> <span m=''2097580''>don''t</span>
  <span m=''2097860''>want in that</span> <span m=''2098060''>situation.</span> <span
  m=''2098530''>So</span> <span m=''2098680''>having</span> <span m=''2099030''>a
  good</span> <span m=''2099170''>design,</span> <span m=''2100240''>good</span> <span
  m=''2100390''>disciplining</span> <span m=''2100990''>programming</span> <span m=''2101680''>will</span>
  <span m=''2101820''>actually</span> <span m=''2102010''>get</span> <span m=''2102260''>you</span>
  <span m=''2103740''>working</span> <span m=''2103900''>correct</span> <span m=''2104120''>program.</span>
  <span m=''2106250''>Good.</span> <span m=''2106960''>That''s</span> <span m=''2107160''>all</span>
  <span m=''2107330''>I</span> <span m=''2107380''>have</span> <span m=''2107880''>for</span>
  <span m=''2108090''>today.</span> <span m=''2109630''>You</span> <span m=''2109700''>can</span>
  <span m=''2109850''>spend</span> <span m=''2110070''>some time</span> <span m=''2111300''>filling</span>
  <span m=''2111640''>out</span> <span m=''2112120''>this</span> <span m=''2112340''>one.</span>
  <span m=''2112520''>Just</span> <span m=''2112740''>put</span> <span m=''2112870''>your</span>
  <span m=''2112990''>name</span> <span m=''2113300''>down</span> <span m=''2113590''>and</span>
  <span m=''2115910''>you''re</span> <span m=''2116000''>done.</span> </p>'
type: course
uid: 5bb0a95608e37ec6dc17e8a9b44d408a

---
None