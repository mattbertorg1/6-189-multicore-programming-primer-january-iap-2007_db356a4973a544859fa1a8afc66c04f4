---
about_this_resource_text: <p><strong>Topics covered:</strong> Performance monitoring
  and optimizations</p><p><strong>Instructor:</strong> Rodric Rabbah, IBM</p><p>Subtitles
  are provided through the generous assistance of Rohan Pai.</p>
course_id: 6-189-multicore-programming-primer-january-iap-2007
embedded_media:
- id: l10.jpg
  parent_uid: e12a04aff77fb12a74bf0285fef61fae
  technical_location: https://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-189-multicore-programming-primer-january-iap-2007/lecture-notes-and-video/l10-performance-monitoring-and-optimizations/l10.jpg
  title: 'L10: Performance Monitoring and Optimizations'
  type: null
  uid: 82a8ab0b55f6f40433d26f31be81b711
- id: Video-YouTube-Stream
  media_location: ZD2sKqPxPIk
  parent_uid: e12a04aff77fb12a74bf0285fef61fae
  title: Video-YouTube-Stream
  type: Video
  uid: 2edf38ea73f61b668deeec14e504e005
- id: Thumbnail-YouTube-JPG
  media_location: https://img.youtube.com/vi/ZD2sKqPxPIk/default.jpg
  parent_uid: e12a04aff77fb12a74bf0285fef61fae
  title: Thumbnail-YouTube-JPG
  type: Thumbnail
  uid: b5b44291f59e97f167f7f3456c70c758
- id: Video-iTunesU-MP4
  media_location: https://itunes.apple.com/us/itunes-u/id341597759
  parent_uid: e12a04aff77fb12a74bf0285fef61fae
  title: Video-iTunes U-MP4
  type: Video
  uid: 7087a456886f27b0c61417609fc9d14f
- id: Video-InternetArchive-MP4
  media_location: http://www.archive.org/download/MIT6.189IAP07/ocw-6.189-iap07-lec10_300k.mp4
  parent_uid: e12a04aff77fb12a74bf0285fef61fae
  title: Video-Internet Archive-MP4
  type: Video
  uid: bcac892b33d1bfde2ac22e1d71f50528
- id: Thumbnail-OCW-JPG
  parent_uid: e12a04aff77fb12a74bf0285fef61fae
  title: Thumbnail-OCW-JPG
  type: Thumbnail
  uid: ce87a315e749e70b25d5fa0cd1722dc1
- id: 3Play-3PlayYouTubeid-MP4
  media_location: ZD2sKqPxPIk
  parent_uid: e12a04aff77fb12a74bf0285fef61fae
  title: 3Play-3Play YouTube id
  type: 3Play
  uid: 881d5cf278215bb7d560535b7175bda7
- id: ZD2sKqPxPIk.srt
  parent_uid: e12a04aff77fb12a74bf0285fef61fae
  technical_location: https://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-189-multicore-programming-primer-january-iap-2007/lecture-notes-and-video/l10-performance-monitoring-and-optimizations/ZD2sKqPxPIk.srt
  title: 3play caption file
  type: null
  uid: db4ba0f4ea476af3fecc3ca132b9a9ca
- id: ZD2sKqPxPIk.pdf
  parent_uid: e12a04aff77fb12a74bf0285fef61fae
  technical_location: https://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-189-multicore-programming-primer-january-iap-2007/lecture-notes-and-video/l10-performance-monitoring-and-optimizations/ZD2sKqPxPIk.pdf
  title: 3play pdf file
  type: null
  uid: 7ef8e04d24194ce3f24617ddcc6640f3
- id: Caption-3Play YouTube id-SRT
  parent_uid: e12a04aff77fb12a74bf0285fef61fae
  title: Caption-3Play YouTube id-SRT-English - US
  type: Caption
  uid: 2a867d7056fc84e41bd7ec8a11d90d50
- id: Transcript-3Play YouTube id-PDF
  parent_uid: e12a04aff77fb12a74bf0285fef61fae
  title: Transcript-3Play YouTube id-PDF-English - US
  type: Transcript
  uid: 4097eaeffbd26e371c05c7133fe138f5
inline_embed_id: 57023889l10:performancemonitoringandoptimizations86269709
layout: video
order_index: null
parent_uid: 69885f30bae5c69316fc5492e4404278
related_resources_text: <p>Lecture Notes (<a title="Open in a new window." target="_blank"
  href="./resolveuid/16195522ad3c3c16aaa3a8025d14f9c0">PDF - 1.1 MB</a>)</p>
short_url: l10-performance-monitoring-and-optimizations
technical_location: https://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-189-multicore-programming-primer-january-iap-2007/lecture-notes-and-video/l10-performance-monitoring-and-optimizations
template_type: Tabbed
title: 'L10: Performance Monitoring and Optimizations'
transcript: '<p><span m=''30''>The</span> <span m=''130''>following</span> <span m=''540''>content</span>
  <span m=''1130''>is</span> <span m=''1240''>provided</span> <span m=''1710''>under
  a</span> <span m=''2020''>Creative</span> <span m=''2430''>Commons license.</span>
  <span m=''3850''>Your</span> <span m=''4110''>support</span> <span m=''4660''>will</span>
  <span m=''4790''>help</span> <span m=''5040''>MIT</span> <span m=''5470''>OpenCourseWare</span>
  <span m=''6300''>continue</span> <span m=''6790''>to</span> <span m=''6930''>offer</span>
  <span m=''7360''>high</span> <span m=''7540''>quality</span> <span m=''8050''>educational</span>
  <span m=''8660''>resources</span> <span m=''9260''>for</span> <span m=''9450''>free.</span>
  <span m=''10560''>To</span> <span m=''10660''>make</span> <span m=''10860''>a</span>
  <span m=''10920''>donation</span> <span m=''11660''>or</span> <span m=''11840''>view</span>
  <span m=''12330''>additional</span> <span m=''12740''>materials</span> <span m=''13260''>from</span>
  <span m=''13410''>hundreds</span> <span m=''13940''>of</span> <span m=''14070''>MIT</span>
  <span m=''14430''>courses,</span> <span m=''15360''>visit</span> <span m=''15700''>MIT</span>
  <span m=''16210''>OpenCourseWare</span> <span m=''17210''>at</span> <span m=''17510''>ocw.mit.edu.</span>
  </p><p><span m=''21650''>PROFESSOR: So,</span> <span m=''22950''>what I''ll</span>
  <span m=''23090''>talk</span> <span m=''23300''>about</span> <span m=''23510''>here</span>
  <span m=''23960''>is</span> <span m=''24490''>how to</span> <span m=''24680''>actually</span>
  <span m=''25100''>understand</span> <span m=''25750''>the</span> <span m=''25880''>performance</span>
  <span m=''26460''>of</span> <span m=''26560''>your</span> <span m=''26650''>application,</span>
  <span m=''27790''>and</span> <span m=''28440''>what</span> <span m=''28590''>are</span>
  <span m=''29120''>some</span> <span m=''29290''>of</span> <span m=''29350''>the</span>
  <span m=''29410''>things</span> <span m=''29630''>you</span> <span m=''29710''>can</span>
  <span m=''29840''>do</span> <span m=''30040''>to</span> <span m=''30130''>actually</span>
  <span m=''30410''>improve</span> <span m=''30750''>your</span> <span m=''30860''>performance.</span>
  <span m=''31850''>You''re</span> <span m=''31970''>going to</span> <span m=''32110''>hear</span>
  <span m=''32330''>more</span> <span m=''32640''>about</span> <span m=''33380''>automated</span>
  <span m=''34240''>optimizations,</span> <span m=''35690''>compile the</span> <span
  m=''36060''>optimizations</span> <span m=''37240''>on</span> <span m=''38100''>Monday.</span>
  <span m=''38810''>There will</span> <span m=''38950''>be</span> <span m=''39070''>two</span>
  <span m=''39210''>talks</span> <span m=''39500''>on</span> <span m=''39600''>that.</span>
  <span m=''40370''>You''ll</span> <span m=''40540''>get</span> <span m=''41150''>some</span>
  <span m=''41970''>cell-specific</span> <span m=''42640''>optimizations</span> <span
  m=''43300''>that</span> <span m=''43430''>you</span> <span m=''43540''>can</span>
  <span m=''43660''>do,</span> <span m=''43770''>so some</span> <span m=''43990''>cell-specific</span>
  <span m=''44940''>tricks</span> <span m=''46130''>on</span> <span m=''46400''>Tuesday</span>
  <span m=''46810''>in the</span> <span m=''46970''>recitation.</span> </p><p><span
  m=''49010''>So</span> <span m=''49190''>here,</span> <span m=''49500''>this</span>
  <span m=''49650''>is</span> <span m=''49780''>meant</span> <span m=''49980''>to</span>
  <span m=''50060''>be</span> <span m=''50410''>a</span> <span m=''50670''>more</span>
  <span m=''50920''>general</span> <span m=''51230''>purpose</span> <span m=''51580''>talk</span>
  <span m=''51930''>on</span> <span m=''52460''>how</span> <span m=''52590''>can</span>
  <span m=''52720''>you</span> <span m=''52840''>debug</span> <span m=''53330''>performance</span>
  <span m=''53810''>anomalies</span> <span m=''54290''>and</span> <span m=''54390''>performance</span>
  <span m=''54810''>problems.</span> <span m=''55830''>Then</span> <span m=''56390''>what</span>
  <span m=''56550''>are</span> <span m=''56670''>some</span> <span m=''56860''>way</span>
  <span m=''57050''>that</span> <span m=''57230''>you</span> <span m=''57360''>can</span>
  <span m=''57480''>actually</span> <span m=''57920''>improve</span> <span m=''58280''>the</span>
  <span m=''58370''>performance.</span> <span m=''58840''>Where</span> <span m=''59020''>do</span>
  <span m=''59080''>you</span> <span m=''59210''>look</span> <span m=''59510''>after</span>
  <span m=''59860''>you''ve</span> <span m=''60020''>done</span> <span m=''60180''>your</span>
  <span m=''60270''>parallelization.</span> </p><p><span m=''62410''>So</span> <span
  m=''62730''>just</span> <span m=''62930''>to</span> <span m=''63010''>review</span>
  <span m=''63670''>the</span> <span m=''63810''>key</span> <span m=''64020''>concepts</span>
  <span m=''64520''>to</span> <span m=''65360''>parallelism.</span> <span m=''67680''>Coverage
  --</span> <span m=''68140''>how</span> <span m=''68290''>much</span> <span m=''68450''>parallelism</span>
  <span m=''68750''>do</span> <span m=''68850''>you</span> <span m=''68990''>have</span>
  <span m=''69210''>in your</span> <span m=''69360''>application.</span> <span m=''71000''>All</span>
  <span m=''71200''>of</span> <span m=''71300''>you</span> <span m=''71390''>know,</span>
  <span m=''71540''>because</span> <span m=''71710''>you</span> <span m=''71820''>all</span>
  <span m=''73430''>had</span> <span m=''73610''>perfect</span> <span m=''73900''>scores</span>
  <span m=''74200''>on</span> <span m=''74350''>the</span> <span m=''74430''>last</span>
  <span m=''74690''>quiz.</span> <span m=''75450''>So</span> <span m=''76240''>that</span>
  <span m=''76340''>means</span> <span m=''76590''>if</span> <span m=''76670''>you</span>
  <span m=''77190''>take</span> <span m=''77440''>a</span> <span m=''77520''>look</span>
  <span m=''77730''>at</span> <span m=''77790''>your</span> <span m=''77900''>program,</span>
  <span m=''78300''>you</span> <span m=''78400''>find the</span> <span m=''78700''>parallel</span>
  <span m=''79070''>parts</span> <span m=''79790''>and</span> <span m=''79950''>that</span>
  <span m=''80090''>tells</span> <span m=''80350''>you</span> <span m=''80450''>how</span>
  <span m=''80550''>much</span> <span m=''80740''>parallelism</span> <span m=''81200''>that</span>
  <span m=''81300''>you</span> <span m=''81370''>have.</span> <span m=''82030''>If</span>
  <span m=''82180''>you  don''t</span> <span m=''82270''>have</span> <span m=''82940''>more
  than a</span> <span m=''83430''>certain</span> <span m=''83670''>fraction,</span>
  <span m=''84180''>there''s</span> <span m=''84400''>really</span> <span m=''84600''>nothing</span>
  <span m=''84840''>else</span> <span m=''85050''>you</span> <span m=''85150''>can</span>
  <span m=''85290''>do</span> <span m=''85410''>with</span> <span m=''85760''>parallelism.</span>
  <span m=''86240''>So</span> <span m=''87150''>the</span> <span m=''87320''>rest</span>
  <span m=''87510''>of the</span> <span m=''87600''>talk</span> <span m=''87860''>will</span>
  <span m=''88120''>help</span> <span m=''88470''>you</span> <span m=''88570''>address</span>
  <span m=''88920''>the</span> <span m=''89040''>question</span> <span m=''89420''>of</span>
  <span m=''89590''>well,</span> <span m=''89860''>where</span> <span m=''90110''>do
  you</span> <span m=''90200''>go</span> <span m=''90300''>for</span> <span m=''90460''>last</span>
  <span m=''90750''>frontier.</span> </p><p><span m=''91980''>The</span> <span m=''92090''>granularity.</span>
  <span m=''93260''>We</span> <span m=''93390''>talked</span> <span m=''93680''>about</span>
  <span m=''94030''>how</span> <span m=''94380''>the</span> <span m=''94830''>granularity</span>
  <span m=''95400''>of</span> <span m=''95530''>your</span> <span m=''96250''>work
  and</span> <span m=''96920''>how</span> <span m=''97110''>much</span> <span m=''97260''>work</span>
  <span m=''97490''>are you</span> <span m=''97620''>doing on</span> <span m=''97970''>each</span>
  <span m=''98120''>processor</span> <span m=''98910''>affects</span> <span m=''99240''>your</span>
  <span m=''99360''>load</span> <span m=''99570''>balancing,</span> <span m=''100450''>and</span>
  <span m=''100780''>how</span> <span m=''100910''>it</span> <span m=''100970''>actually</span>
  <span m=''101340''>affects</span> <span m=''101760''>your</span> <span m=''101910''>communication</span>
  <span m=''102470''>costs.</span> <span m=''103580''>If</span> <span m=''103780''>you</span>
  <span m=''103890''>have</span> <span m=''104100''>a</span> <span m=''104140''>lot</span>
  <span m=''104310''>of</span> <span m=''104400''>things</span> <span m=''104670''>colocate</span>
  <span m=''105120''>on a single</span> <span m=''105510''>processor,</span> <span
  m=''106860''>then</span> <span m=''107110''>you</span> <span m=''107220''>don''t</span>
  <span m=''107370''>have</span> <span m=''107500''>to</span> <span m=''107600''>do</span>
  <span m=''107740''>a</span> <span m=''107770''>whole</span> <span m=''107920''>lot</span>
  <span m=''108080''>of</span> <span m=''108170''>communication</span> <span m=''108810''>across</span>
  <span m=''109180''>processors,</span> <span m=''110680''>but</span> <span m=''110780''>if</span>
  <span m=''110890''>you</span> <span m=''110960''>distribute</span> <span m=''111420''>things</span>
  <span m=''112050''>at a</span> <span m=''112740''>finer</span> <span m=''112990''>level,</span>
  <span m=''113220''>then</span> <span m=''113350''>you''re</span> <span m=''113470''>doing</span>
  <span m=''113660''>a</span> <span m=''113690''>whole</span> <span m=''113830''>lot</span>
  <span m=''113980''>of</span> <span m=''114080''>communication.</span> <span m=''114980''>So</span>
  <span m=''115270''>we''ll</span> <span m=''115410''>look</span> <span m=''115550''>at</span>
  <span m=''115630''>the</span> <span m=''115710''>communication</span> <span m=''116300''>costs</span>
  <span m=''116570''>again</span> <span m=''116860''>and</span> <span m=''116990''>some</span>
  <span m=''117170''>tricks</span> <span m=''117920''>that</span> <span m=''118090''>you</span>
  <span m=''118360''>can</span> <span m=''118490''>apply</span> <span m=''118820''>to</span>
  <span m=''119020''>optimize</span> <span m=''119510''>that.</span> </p><p><span
  m=''120450''>Then</span> <span m=''120730''>the</span> <span m=''121150''>last</span>
  <span m=''121370''>thing</span> <span m=''121570''>that</span> <span m=''121730''>we</span>
  <span m=''121830''>had</span> <span m=''121950''>talked</span> <span m=''122230''>about</span>
  <span m=''123740''>in</span> <span m=''124080''>one</span> <span m=''124210''>of</span>
  <span m=''124290''>the</span> <span m=''124360''>previous</span> <span m=''124660''>lectures</span>
  <span m=''125320''>is</span> <span m=''125570''>locality,</span> <span m=''126240''>in</span>
  <span m=''126410''>locality</span> <span m=''126960''>of</span> <span m=''127200''>communication</span>
  <span m=''127940''>versus</span> <span m=''128340''>computation,</span> <span m=''129240''>and</span>
  <span m=''129590''>both</span> <span m=''129800''>of</span> <span m=''129880''>those</span>
  <span m=''130080''>are</span> <span m=''130150''>critical.</span> <span m=''131570''>So</span>
  <span m=''131820''>we''ll</span> <span m=''132470''>have</span> <span m=''132640''>some</span>
  <span m=''132790''>examples</span> <span m=''133330''>of</span> <span m=''133620''>that.</span>
  </p><p><span m=''135720''>So</span> <span m=''135850''>just</span> <span m=''136090''>to</span>
  <span m=''136210''>review the</span> <span m=''136740''>communication</span> <span
  m=''137360''>cost</span> <span m=''137700''>model,</span> <span m=''138120''>so
  I had</span> <span m=''138380''>flashed</span> <span m=''138990''>up</span> <span
  m=''139230''>on</span> <span m=''140010''>the</span> <span m=''140070''>screen a</span>
  <span m=''140530''>while</span> <span m=''140780''>ago</span> <span m=''141530''>this</span>
  <span m=''142600''>equation</span> <span m=''143110''>that</span> <span m=''143250''>captures</span>
  <span m=''144200''>all</span> <span m=''144410''>the</span> <span m=''144490''>factors</span>
  <span m=''145050''>that</span> <span m=''145160''>go</span> <span m=''145360''>into</span>
  <span m=''146120''>figuring</span> <span m=''146440''>out</span> <span m=''146720''>how</span>
  <span m=''147650''>expensive</span> <span m=''148120''>is</span> <span m=''148270''>it
  to</span> <span m=''148400''>actually</span> <span m=''148880''>send</span> <span
  m=''149640''>data</span> <span m=''149920''>from</span> <span m=''150100''>one</span>
  <span m=''150270''>processor</span> <span m=''150770''>to</span> <span m=''150880''>the</span>
  <span m=''151000''>other.</span> <span m=''151670''>Or</span> <span m=''152760''>this</span>
  <span m=''153330''>could</span> <span m=''153590''>even</span> <span m=''153810''>apply</span>
  <span m=''154240''>on a</span> <span m=''154690''>single</span> <span m=''155030''>machine</span>
  <span m=''155470''>where a</span> <span m=''155640''>processor is</span> <span m=''156240''>talking</span>
  <span m=''156570''>to</span> <span m=''156680''>the</span> <span m=''156740''>memory</span>
  <span m=''157070''>--</span> <span m=''157760''>you</span> <span m=''157880''>know,</span>
  <span m=''157980''>loads</span> <span m=''158260''>and</span> <span m=''158340''>stores.</span>
  <span m=''159330''>The</span> <span m=''159410''>same</span> <span m=''159600''>cost</span>
  <span m=''159870''>model</span> <span m=''160160''>really</span> <span m=''160470''>applies</span>
  <span m=''160880''>there.</span> <span m=''161690''>If</span> <span m=''161780''>you</span>
  <span m=''161850''>look</span> <span m=''162030''>at</span> <span m=''162190''>how</span>
  <span m=''162530''>processors --</span> <span m=''163490''>a uniprocessor</span>
  <span m=''164570''>tries</span> <span m=''164860''>to</span> <span m=''164930''>improve</span>
  <span m=''165220''>communication,</span> <span m=''166280''>and</span> <span m=''166580''>some</span>
  <span m=''166690''>of</span> <span m=''166760''>the</span> <span m=''166830''>things</span>
  <span m=''167110''>we''ve</span> <span m=''167220''>mentioned</span> <span m=''167600''>really</span>
  <span m=''167810''>early</span> <span m=''168060''>on</span> <span m=''168210''>in
  the</span> <span m=''168340''>course</span> <span m=''168620''>for</span> <span
  m=''168760''>improving</span> <span m=''169220''>communication</span> <span m=''169800''>costs,</span>
  <span m=''170870''>what</span> <span m=''171040''>we</span> <span m=''171160''>focused</span>
  <span m=''171500''>on</span> <span m=''171690''>is</span> <span m=''171780''>this</span>
  <span m=''171940''>overlap.</span> </p><p><span m=''173210''>There are</span> <span
  m=''173410''>things</span> <span m=''173620''>you</span> <span m=''173720''>can</span>
  <span m=''173870''>do,</span> <span m=''174000''>for</span> <span m=''174120''>example,</span>
  <span m=''174470''>sending</span> <span m=''174700''>fewer</span> <span m=''175010''>messages,</span>
  <span m=''176010''>optimizing</span> <span m=''177240''>how</span> <span m=''177800''>you''re</span>
  <span m=''177950''>packing</span> <span m=''178320''>data</span> <span m=''178560''>into</span>
  <span m=''178770''>your</span> <span m=''178880''>messages,</span> <span m=''179890''>reducing</span>
  <span m=''180380''>the</span> <span m=''180450''>cost</span> <span m=''180880''>of</span>
  <span m=''181340''>the</span> <span m=''181570''>network</span> <span m=''182000''>in</span>
  <span m=''182070''>terms</span> <span m=''182300''>of the</span> <span m=''182450''>latency,</span>
  <span m=''183620''>using</span> <span m=''183910''>architecture</span> <span m=''184570''>support,</span>
  <span m=''186170''>increasing the</span> <span m=''186710''>bandwidth</span> <span
  m=''187090''>and</span> <span m=''187200''>so</span> <span m=''187350''>on.</span>
  <span m=''188620''>But</span> <span m=''188790''>really</span> <span m=''189420''>the</span>
  <span m=''189500''>biggest</span> <span m=''189860''>impact</span> <span m=''190230''>that</span>
  <span m=''190330''>you</span> <span m=''190460''>can</span> <span m=''190670''>get</span>
  <span m=''190950''>is</span> <span m=''191080''>really</span> <span m=''191300''>just</span>
  <span m=''191490''>from</span> <span m=''191720''>overlap</span> <span m=''191960''>because</span>
  <span m=''192140''>you</span> <span m=''192220''>have</span> <span m=''192310''>direct</span>
  <span m=''192590''>control</span> <span m=''192940''>over</span> <span m=''193140''>that,</span>
  <span m=''193610''>especially</span> <span m=''194100''>in</span> <span m=''194400''>parallel</span>
  <span m=''194750''>programming.</span> </p><p><span m=''196490''>So</span> <span
  m=''196590''>let''s</span> <span m=''196780''>look</span> <span m=''196940''>at</span>
  <span m=''198260''>a</span> <span m=''198750''>small</span> <span m=''199030''>review</span>
  <span m=''199690''>--</span> <span m=''199990''>you</span> <span m=''200150''>know,</span>
  <span m=''200230''>what</span> <span m=''200500''>did</span> <span m=''200690''>it
  mean</span> <span m=''200860''>to</span> <span m=''200960''>overlap.</span> <span
  m=''202510''>So</span> <span m=''202670''>we</span> <span m=''202770''>had</span>
  <span m=''203020''>some</span> <span m=''203220''>synchronization</span> <span m=''203860''>point
  or</span> <span m=''204360''>some</span> <span m=''204550''>point in the</span>
  <span m=''204880''>execution</span> <span m=''205890''>and</span> <span m=''206050''>then</span>
  <span m=''206210''>we</span> <span m=''206850''>get</span> <span m=''207070''>data.</span>
  <span m=''208300''>Then</span> <span m=''208840''>once</span> <span m=''209060''>the</span>
  <span m=''209130''>data''s</span> <span m=''209560''>arrived,</span> <span m=''210630''>we</span>
  <span m=''210770''>compute</span> <span m=''211100''>on</span> <span m=''211190''>that</span>
  <span m=''211250''>data. So</span> <span m=''211660''>this</span> <span m=''211860''>could</span>
  <span m=''212000''>be</span> <span m=''212240''>a</span> <span m=''212340''>uniprocessor.</span>
  <span m=''213710''>A</span> <span m=''214040''>CPU</span> <span m=''214920''>issues</span>
  <span m=''215240''>a</span> <span m=''215310''>load,</span> <span m=''215920''>it</span>
  <span m=''216080''>goes</span> <span m=''216310''>out</span> <span m=''216490''>to</span>
  <span m=''216570''>memory,</span> <span m=''217220''>memory</span> <span m=''217480''>sends</span>
  <span m=''217720''>back the</span> <span m=''217960''>data,</span> <span m=''218720''>and</span>
  <span m=''218880''>then</span> <span m=''219270''>the</span> <span m=''219790''>CU</span>
  <span m=''219950''>can</span> <span m=''220160''>continue</span> <span m=''221100''>operating.</span>
  <span m=''222100''>But</span> <span m=''222430''>the</span> <span m=''222520''>uniprocessors</span>
  <span m=''223330''>can</span> <span m=''223570''>pipeline.</span> <span m=''224160''>They
  allow you to</span> <span m=''224690''>have</span> <span m=''224890''>multiple</span>
  <span m=''225240''>loads</span> <span m=''225510''>going</span> <span m=''225790''>out</span>
  <span m=''225900''>to</span> <span m=''225990''>memory.</span> <span m=''227180''>So</span>
  <span m=''227280''>you</span> <span m=''227420''>can</span> <span m=''227540''>get</span>
  <span m=''227680''>the</span> <span m=''227770''>effect of</span> <span m=''228580''>hiding</span>
  <span m=''229080''>over</span> <span m=''229430''>overlapping</span> <span m=''230020''>a</span>
  <span m=''230100''>lot</span> <span m=''230330''>of</span> <span m=''230840''>that</span>
  <span m=''231120''>communication</span> <span m=''231730''>latency.</span> </p><p><span
  m=''233730''>But</span> <span m=''233870''>there</span> <span m=''233980''>are</span>
  <span m=''234080''>limits</span> <span m=''234410''>to</span> <span m=''234530''>the</span>
  <span m=''234690''>communication,</span> <span m=''236370''>to</span> <span m=''236730''>the</span>
  <span m=''236800''>pipelining</span> <span m=''237240''>effects.</span> <span m=''238200''>If</span>
  <span m=''239180''>the</span> <span m=''239280''>work</span> <span m=''239530''>that</span>
  <span m=''239640''>you''re</span> <span m=''239810''>doing</span> <span m=''240320''>is</span>
  <span m=''240500''>really</span> <span m=''241930''>equal</span> <span m=''242730''>to</span>
  <span m=''243160''>the</span> <span m=''243290''>amount of</span> <span m=''243580''>data</span>
  <span m=''243780''>that</span> <span m=''243920''>you''re</span> <span m=''244050''>fetching,</span>
  <span m=''244720''>then</span> <span m=''244840''>you</span> <span m=''244910''>have</span>
  <span m=''245040''>really</span> <span m=''245260''>good</span> <span m=''245400''>overlap.</span>
  <span m=''245930''>So</span> <span m=''246090''>we</span> <span m=''246200''>went</span>
  <span m=''246360''>over</span> <span m=''246530''>this</span> <span m=''246640''>in
  the</span> <span m=''246840''>recitation</span> <span m=''247730''>and</span> <span
  m=''248310''>we</span> <span m=''248430''>showed you</span> <span m=''248610''>an</span>
  <span m=''248760''>example</span> <span m=''249210''>of</span> <span m=''249340''>where</span>
  <span m=''249550''>pipelining</span> <span m=''250060''>doesn''t</span> <span m=''250330''>have</span>
  <span m=''251090''>any</span> <span m=''251280''>performance</span> <span m=''251720''>effects</span>
  <span m=''252090''>and so</span> <span m=''252330''>you</span> <span m=''252420''>might</span>
  <span m=''252560''>not</span> <span m=''252690''>want</span> <span m=''252860''>to</span>
  <span m=''252920''>do</span> <span m=''253040''>it</span> <span m=''253210''>because</span>
  <span m=''253490''>it</span> <span m=''253560''>doesn''t</span> <span m=''253830''>give</span>
  <span m=''253970''>you</span> <span m=''254050''>the</span> <span m=''254120''>performance</span>
  <span m=''254550''>bang</span> <span m=''255490''>for</span> <span m=''255650''>the</span>
  <span m=''255730''>complexity you</span> <span m=''256300''>invest in it.</span>
  <span m=''257540''>So,</span> <span m=''258140''>if</span> <span m=''258570''>things</span>
  <span m=''258810''>are</span> <span m=''258970''>really</span> <span m=''259670''>nicely</span>
  <span m=''260060''>matched</span> <span m=''260400''>you</span> <span m=''260520''>get</span>
  <span m=''260670''>good</span> <span m=''260830''>overlap,</span> <span m=''261320''>here</span>
  <span m=''261550''>you</span> <span m=''261640''>only</span> <span m=''261800''>get</span>
  <span m=''261970''>god</span> <span m=''262090''>overlap</span> <span m=''262150''>--</span>
  <span m=''262910''>sorry,</span> <span m=''263250''>these,</span> <span m=''263490''>for</span>
  <span m=''263630''>some</span> <span m=''263780''>reason,</span> <span m=''264330''>should</span>
  <span m=''264520''>be</span> <span m=''264610''>shifted</span> <span m=''264940''>over</span>
  <span m=''265130''>one.</span> <span m=''266370''>So</span> <span m=''266540''>where</span>
  <span m=''266740''>else</span> <span m=''266970''>do you</span> <span m=''267110''>look</span>
  <span m=''267260''>for</span> <span m=''267380''>performance?</span> </p><p><span
  m=''270010''>So there are</span> <span m=''270320''>two</span> <span m=''270550''>kinds</span>
  <span m=''270980''>of</span> <span m=''271250''>communication.</span> <span m=''275070''>There''s</span>
  <span m=''275410''>inherent</span> <span m=''275770''>communication and</span> <span
  m=''276460''>your</span> <span m=''276630''>algorithm,</span> <span m=''277050''>and</span>
  <span m=''277140''>this</span> <span m=''277280''>is</span> <span m=''279170''>a</span>
  <span m=''279360''>result</span> <span m=''279750''>of</span> <span m=''279920''>how</span>
  <span m=''280040''>you</span> <span m=''280160''>actually</span> <span m=''280450''>partition</span>
  <span m=''280910''>your</span> <span m=''281060''>data</span> <span m=''281650''>and</span>
  <span m=''281820''>how</span> <span m=''281920''>you</span> <span m=''282090''>partitioned</span>
  <span m=''282540''>your</span> <span m=''282660''>computation.</span> <span m=''283790''>Then</span>
  <span m=''283920''>there''s</span> <span m=''284910''>artifacts</span> <span m=''286090''>that</span>
  <span m=''286270''>come</span> <span m=''286470''>up</span> <span m=''286610''>because</span>
  <span m=''286970''>of</span> <span m=''287110''>the</span> <span m=''287220''>way</span>
  <span m=''287400''>you</span> <span m=''288170''>actually</span> <span m=''288800''>do</span>
  <span m=''288980''>the</span> <span m=''289050''>implementation and</span> <span
  m=''289700''>how</span> <span m=''290060''>you</span> <span m=''290200''>map it
  to the</span> <span m=''290660''>architecture.</span> <span m=''292330''>So,</span>
  <span m=''292620''>if</span> <span m=''292800''>you</span> <span m=''292900''>have</span>
  <span m=''293440''>poor</span> <span m=''293680''>distribution</span> <span m=''294260''>of</span>
  <span m=''294410''>data</span> <span m=''294680''>across</span> <span m=''295120''>memory,</span>
  <span m=''296000''>then</span> <span m=''296570''>you</span> <span m=''296690''>might</span>
  <span m=''296960''>unnecessarily</span> <span m=''297570''>end</span> <span m=''297740''>up</span>
  <span m=''297900''>fetching</span> <span m=''299150''>data</span> <span m=''302240''>that</span>
  <span m=''302420''>you</span> <span m=''302540''>don''t</span> <span m=''302700''>need.</span>
  <span m=''305370''>So,</span> <span m=''305660''>you</span> <span m=''305790''>might</span>
  <span m=''305940''>also</span> <span m=''306140''>have</span> <span m=''306340''>redundant</span>
  <span m=''306650''>data</span> <span m=''306860''>fetchers.</span> <span m=''307370''>So</span>
  <span m=''307800''>let''s</span> <span m=''308140''>talk</span> <span m=''308380''>about</span>
  <span m=''308580''>that</span> <span m=''308730''>in</span> <span m=''308830''>more</span>
  <span m=''309000''>detail.</span> </p><p><span m=''311820''>The</span> <span m=''311910''>way</span>
  <span m=''312030''>I''m</span> <span m=''312130''>going to</span> <span m=''312290''>do</span>
  <span m=''312420''>this</span> <span m=''312600''>is</span> <span m=''312870''>to</span>
  <span m=''314200''>draw</span> <span m=''314570''>from</span> <span m=''314970''>wisdom</span>
  <span m=''315720''>in</span> <span m=''315930''>uniprocessors.</span> <span m=''316340''>So</span>
  <span m=''317120''>in</span> <span m=''317250''>uniprocessors,</span> <span m=''317940''>CPUs</span>
  <span m=''318440''>communicate</span> <span m=''318870''>with</span> <span m=''318990''>memory,</span>
  <span m=''319530''>and</span> <span m=''319970''>really</span> <span m=''320340''>conceptually,</span>
  <span m=''320690''>I</span> <span m=''320970''>think</span> <span m=''321170''>that''s</span>
  <span m=''321330''>no</span> <span m=''321450''>different</span> <span m=''321870''>than</span>
  <span m=''322290''>multiple</span> <span m=''322650''>processors</span> <span m=''323260''>talking</span>
  <span m=''323590''>to</span> <span m=''323690''>multiple</span> <span m=''324010''>processors.</span>
  <span m=''324880''>It''s</span> <span m=''325040''>really</span> <span m=''325280''>all</span>
  <span m=''325470''>about</span> <span m=''326050''>where</span> <span m=''326210''>the</span>
  <span m=''326320''>data is</span> <span m=''326650''>flowing</span> <span m=''327860''>and</span>
  <span m=''328050''>how</span> <span m=''328190''>the</span> <span m=''328260''>memories</span>
  <span m=''328550''>are</span> <span m=''328620''>structured.</span> <span m=''329710''>So,</span>
  <span m=''330120''>loads and</span> <span m=''330550''>stores</span> <span m=''330940''>are</span>
  <span m=''331110''>the</span> <span m=''331290''>uniprocessor</span> <span m=''331950''>as</span>
  <span m=''332750''>what</span> <span m=''333480''>and</span> <span m=''333630''>what</span>
  <span m=''334190''>are</span> <span m=''334350''>to</span> <span m=''334440''>distributed</span>
  <span m=''334900''>memory.</span> <span m=''335500''>So if</span> <span m=''335640''>you</span>
  <span m=''335710''>think</span> <span m=''335910''>of</span> <span m=''335970''>Cell,</span>
  <span m=''336760''>what</span> <span m=''336920''>would</span> <span m=''337080''>go</span>
  <span m=''337270''>in</span> <span m=''337380''>those</span> <span m=''337480''>two</span>
  <span m=''337660''>blanks?</span> <span m=''342820''>Can</span> <span m=''342960''>you</span>
  <span m=''343040''>get</span> <span m=''343170''>this?</span> <span m=''348360''>I
  heard</span> <span m=''348870''>the</span> <span m=''349010''>answer</span> <span
  m=''349250''>there.</span> <span m=''350950''>You</span> <span m=''351270''>get</span>
  <span m=''351440''>input.</span> <span m=''351780''>So,</span> <span m=''352040''>DMA</span>
  <span m=''352420''>get</span> <span m=''352730''>and</span> <span m=''352900''>DMA</span>
  <span m=''353010''>put.</span> <span m=''353400''>That''s</span> <span m=''353580''>really</span>
  <span m=''353800''>just</span> <span m=''353970''>the</span> <span m=''354050''>load</span>
  <span m=''354390''>and</span> <span m=''354470''>a</span> <span m=''354530''>store.</span>
  <span m=''355300''>It''s</span> <span m=''355440''>just</span> <span m=''355640''>doing,</span>
  <span m=''356550''>instead</span> <span m=''356810''>of</span> <span m=''356940''>loading</span>
  <span m=''357230''>one</span> <span m=''357430''>particular</span> <span m=''357760''>data</span>
  <span m=''357960''>element,</span> <span m=''358350''>you''re</span> <span m=''358480''>loading
  a</span> <span m=''358770''>whole</span> <span m=''358930''>chunk</span> <span m=''359160''>of</span>
  <span m=''359270''>memory.</span> </p><p><span m=''361460''>So,</span> <span m=''361850''>on</span>
  <span m=''362080''>a</span> <span m=''362230''>uniprocessor,</span> <span m=''363460''>how</span>
  <span m=''363610''>do</span> <span m=''363700''>you</span> <span m=''363820''>overlap</span>
  <span m=''364190''>communication?</span> <span m=''364950''>Well,</span> <span m=''365120''>architecture,</span>
  <span m=''366120''>the</span> <span m=''366290''>memory</span> <span m=''366540''>system</span>
  <span m=''366910''>is</span> <span m=''367020''>designed</span> <span m=''367700''>in</span>
  <span m=''367860''>a</span> <span m=''367910''>way</span> <span m=''368100''>to</span>
  <span m=''368210''>exploit</span> <span m=''368840''>two</span> <span m=''369020''>properties</span>
  <span m=''369670''>that</span> <span m=''369790''>have</span> <span m=''369890''>been</span>
  <span m=''370090''>observed</span> <span m=''370420''>in</span> <span m=''370630''>computation.</span>
  <span m=''371600''>Spacial</span> <span m=''372050''>locality</span> <span m=''372680''>and</span>
  <span m=''372840''>temporal</span> <span m=''373190''>locality,</span> <span m=''373650''>and
  I''ll</span> <span m=''373810''>look</span> <span m=''373960''>at</span> <span m=''374030''>each</span>
  <span m=''374200''>one</span> <span m=''374400''>separately.</span> </p><p><span
  m=''375640''>So in spacial</span> <span m=''376200''>locality,</span> <span m=''378080''>CPU</span>
  <span m=''378610''>asks</span> <span m=''378850''>for</span> <span m=''378950''>a</span>
  <span m=''379640''>data</span> <span m=''380220''>address  of</span> <span m=''380710''>1,000.</span>
  <span m=''381840''>What</span> <span m=''382010''>the</span> <span m=''382080''>memory</span>
  <span m=''382370''>does,</span> <span m=''382640''>it''ll</span> <span m=''382870''>send</span>
  <span m=''383230''>data</span> <span m=''383530''>address</span> <span m=''383880''>of</span>
  <span m=''383960''>1,000,</span> <span m=''384650''>plus</span> <span m=''384890''>a</span>
  <span m=''384950''>whole</span> <span m=''385110''>bunch</span> <span m=''385340''>of</span>
  <span m=''385440''>other</span> <span m=''385620''>data</span> <span m=''385880''>that''s</span>
  <span m=''386780''>neighboring</span> <span m=''387040''>to</span> <span m=''387260''>it,</span>
  <span m=''387440''>so</span> <span m=''387720''>1,000</span> <span m=''388240''>to</span>
  <span m=''388380''>1,064.</span> <span m=''390290''>Really,</span> <span m=''390520''>how</span>
  <span m=''390620''>much</span> <span m=''390830''>data</span> <span m=''391060''>you</span>
  <span m=''391180''>actually</span> <span m=''391480''>send,</span> <span m=''392390''>you</span>
  <span m=''392500''>know,</span> <span m=''392600''>what</span> <span m=''393010''>is</span>
  <span m=''393100''>the</span> <span m=''393170''>granularity</span> <span m=''393730''>of</span>
  <span m=''401120''>communication</span> <span m=''401500''>depends</span> <span
  m=''401890''>on</span> <span m=''402290''>architectural</span> <span m=''402880''>parameters.</span>
  <span m=''403430''>So</span> <span m=''403770''>in</span> <span m=''404290''>common</span>
  <span m=''404660''>architecture</span> <span m=''405280''>it''s</span> <span m=''405470''>really</span>
  <span m=''405690''>the</span> <span m=''405790''>block</span> <span m=''406030''>side.</span>
  <span m=''406610''>So</span> <span m=''406850''>if</span> <span m=''406960''>you</span>
  <span m=''407030''>have</span> <span m=''407150''>a</span> <span m=''407210''>cache</span>
  <span m=''407720''>where the</span> <span m=''408010''>organization</span> <span
  m=''408820''>says</span> <span m=''409020''>you</span> <span m=''409140''>have</span>
  <span m=''409260''>a</span> <span m=''409320''>block</span> <span m=''409630''>side</span>
  <span m=''409760''>to</span> <span m=''409870''>32</span> <span m=''410330''>words,</span>
  <span m=''411290''>32</span> <span m=''411660''>bytes,</span> <span m=''412270''>then</span>
  <span m=''412500''>this</span> <span m=''412680''>is</span> <span m=''413290''>how</span>
  <span m=''413450''>much</span> <span m=''413690''>you</span> <span m=''413870''>transfer</span>
  <span m=''414290''>from</span> <span m=''414540''>main</span> <span m=''414740''>memory</span>
  <span m=''415610''>to</span> <span m=''415760''>the</span> <span m=''415820''>caches.</span>
  <span m=''417210''>So</span> <span m=''417480''>this</span> <span m=''417710''>works</span>
  <span m=''417970''>well</span> <span m=''418240''>when</span> <span m=''418610''>the</span>
  <span m=''418710''>CPU</span> <span m=''419040''>actually</span> <span m=''419380''>uses</span>
  <span m=''419690''>that</span> <span m=''419800''>data.</span> <span m=''421250''>If</span>
  <span m=''421450''>I</span> <span m=''421550''>send</span> <span m=''422150''>you</span>
  <span m=''422280''>64</span> <span m=''422830''>data</span> <span m=''423080''>bytes</span>
  <span m=''423880''>and</span> <span m=''424340''>I</span> <span m=''424410''>only</span>
  <span m=''424630''>use</span> <span m=''424820''>one</span> <span m=''424980''>of</span>
  <span m=''425100''>them,</span> <span m=''425530''>then</span> <span m=''425800''>what</span>
  <span m=''425960''>have</span> <span m=''426110''>I</span> <span m=''426210''>done?
  I''ve</span> <span m=''426770''>wasted</span> <span m=''427170''>bandwidth.</span>
  <span m=''427880''>Plus,</span> <span m=''428310''>I</span> <span m=''428380''>need</span>
  <span m=''428540''>to</span> <span m=''428630''>store</span> <span m=''428950''>all</span>
  <span m=''429110''>that</span> <span m=''429250''>extra</span> <span m=''429510''>data</span>
  <span m=''429750''>in</span> <span m=''429850''>the</span> <span m=''429910''>cache</span>
  <span m=''430400''>so I''ve</span> <span m=''430520''>wasted</span> <span m=''430840''>my</span>
  <span m=''430960''>cache</span> <span m=''431280''>capacity.</span> <span m=''432240''>So</span>
  <span m=''432500''>that''s</span> <span m=''432840''>bad and</span> <span m=''433100''>you</span>
  <span m=''433190''>want to</span> <span m=''433360''>avoid</span> <span m=''433620''>it.</span>
  </p><p><span m=''435650''>Temporal</span> <span m=''436170''>locality</span> <span
  m=''437250''>is</span> <span m=''437750''>a</span> <span m=''438430''>clustering</span>
  <span m=''439020''>of</span> <span m=''439290''>references</span> <span m=''439760''>in</span>
  <span m=''439850''>time.</span> <span m=''440650''>So</span> <span m=''440890''>if</span>
  <span m=''442100''>you</span> <span m=''442300''>access</span> <span m=''442730''>some</span>
  <span m=''442870''>particular</span> <span m=''443240''>data</span> <span m=''443460''>element,</span>
  <span m=''444230''>then</span> <span m=''444470''>what</span> <span m=''444630''>the</span>
  <span m=''444700''>memory</span> <span m=''444990''>assumes</span> <span m=''445490''>is</span>
  <span m=''445610''>you''re</span> <span m=''445760''>going</span> <span m=''446360''>reuse</span>
  <span m=''446660''>that</span> <span m=''446830''>data</span> <span m=''446960''>over</span>
  <span m=''447260''>and</span> <span m=''447350''>over</span> <span m=''447560''>and</span>
  <span m=''447690''>over</span> <span m=''447940''>again,</span> <span m=''448220''>so</span>
  <span m=''448430''>it</span> <span m=''448520''>stores</span> <span m=''448890''>it
  in</span> <span m=''449040''>the</span> <span m=''449120''>cache.</span> <span m=''449840''>So</span>
  <span m=''450170''>your</span> <span m=''450300''>memory</span> <span m=''450580''>hierarchy</span>
  <span m=''450950''>has</span> <span m=''451550''>the</span> <span m=''451640''>main</span>
  <span m=''451860''>memory</span> <span m=''452140''>at</span> <span m=''452240''>the</span>
  <span m=''452320''>top</span> <span m=''452620''>level,</span> <span m=''453190''>and</span>
  <span m=''453400''>that''s</span> <span m=''453960''>your</span> <span m=''454070''>slowest</span>
  <span m=''454550''>memory</span> <span m=''454780''>but</span> <span m=''454950''>the</span>
  <span m=''455050''>biggest</span> <span m=''455290''>capacity.</span> <span m=''456410''>Then</span>
  <span m=''456560''>as</span> <span m=''456760''>you</span> <span m=''456820''>get</span>
  <span m=''456940''>closer</span> <span m=''457260''>and</span> <span m=''457360''>closer</span>
  <span m=''457620''>to</span> <span m=''457720''>the</span> <span m=''457800''>processor,</span>
  <span m=''458630''>you</span> <span m=''458790''>end</span> <span m=''458940''>up</span>
  <span m=''459150''>with</span> <span m=''459450''>smaller</span> <span m=''459850''>caches
  --</span> <span m=''460390''>these are</span> <span m=''460650''>local,</span> <span
  m=''461470''>smaller</span> <span m=''462460''>storage,</span> <span m=''463140''>but</span>
  <span m=''463350''>they''re</span> <span m=''463520''>faster.</span> <span m=''465380''>So,</span>
  <span m=''465680''>if</span> <span m=''465950''>you</span> <span m=''466690''>reuse
  a</span> <span m=''467100''>data</span> <span m=''467310''>element</span> <span
  m=''467670''>then</span> <span m=''467810''>it gets</span> <span m=''467990''>cached</span>
  <span m=''468400''>at</span> <span m=''468470''>the</span> <span m=''468570''>lowest</span>
  <span m=''468850''>data</span> <span m=''468960''>level,</span> <span m=''469630''>and</span>
  <span m=''469800''>so</span> <span m=''469890''>the</span> <span m=''469990''>assumption</span>
  <span m=''470400''>there is</span> <span m=''470630''>that</span> <span m=''470770''>you''re</span>
  <span m=''470830''>gonna</span> <span m=''470960''>reuse</span> <span m=''471300''>it</span>
  <span m=''471450''>over</span> <span m=''471920''>and</span> <span m=''472080''>over</span>
  <span m=''472390''>and</span> <span m=''472610''>over</span> <span m=''472820''>again.</span>
  <span m=''473580''>If</span> <span m=''473670''>you</span> <span m=''473750''>do</span>
  <span m=''473900''>that,</span> <span m=''474260''>then</span> <span m=''474420''>what</span>
  <span m=''474580''>you''ve</span> <span m=''474740''>done</span> <span m=''474940''>is</span>
  <span m=''475060''>you''ve</span> <span m=''475300''>amortized</span> <span m=''475870''>the</span>
  <span m=''475940''>cost</span> <span m=''476300''>of</span> <span m=''476380''>bringing</span>
  <span m=''476680''>in</span> <span m=''476780''>that</span> <span m=''476960''>data</span>
  <span m=''477500''>over</span> <span m=''477770''>many,</span> <span m=''478000''>many</span>
  <span m=''478210''>references.</span> </p><p><span m=''478990''>So</span> <span
  m=''479090''>that</span> <span m=''479460''>works</span> <span m=''479670''>out</span>
  <span m=''479800''>really</span> <span m=''480040''>well.</span> <span m=''480930''>But</span>
  <span m=''481040''>if</span> <span m=''481150''>you</span> <span m=''481250''>don''t</span>
  <span m=''481500''>reuse</span> <span m=''481790''>that</span> <span m=''481970''>particular</span>
  <span m=''482340''>data</span> <span m=''482570''>elements</span> <span m=''482920''>over</span>
  <span m=''483160''>and</span> <span m=''483260''>over</span> <span m=''483480''>again,</span>
  <span m=''483810''>then</span> <span m=''484350''>you''ve</span> <span m=''484480''>wasted</span>
  <span m=''485630''>cache</span> <span m=''485970''>capacity.</span> <span m=''486770''>You</span>
  <span m=''486920''>still</span> <span m=''487120''>need</span> <span m=''487250''>to</span>
  <span m=''487330''>fetch the</span> <span m=''487580''>data</span> <span m=''487990''>because</span>
  <span m=''488350''>the</span> <span m=''488410''>CPU</span> <span m=''488800''>asks</span>
  <span m=''489080''>for</span> <span m=''489280''>it,</span> <span m=''489690''>but</span>
  <span m=''489880''>you</span> <span m=''490040''>might</span> <span m=''490180''>not</span>
  <span m=''490330''>have</span> <span m=''490440''>had</span> <span m=''490610''>the</span>
  <span m=''490690''>cache,</span> <span m=''491030''>so</span> <span m=''491720''>that</span>
  <span m=''491880''>would</span> <span m=''491990''>have</span> <span m=''492080''>created</span>
  <span m=''492450''>more</span> <span m=''492620''>space</span> <span m=''492920''>in</span>
  <span m=''493010''>your</span> <span m=''493130''>cache</span> <span m=''493460''>to</span>
  <span m=''493570''>have</span> <span m=''493750''>something</span> <span m=''494060''>else</span>
  <span m=''494250''>in</span> <span m=''494350''>there that</span> <span m=''494600''>might</span>
  <span m=''494790''>have</span> <span m=''494890''>been</span> <span m=''494990''>more</span>
  <span m=''495160''>useful.</span> </p><p><span m=''497350''>So</span> <span m=''497790''>in</span>
  <span m=''498110''>the</span> <span m=''498200''>multiprocessor</span> <span m=''498980''>case,</span>
  <span m=''500020''>how</span> <span m=''500160''>do</span> <span m=''500230''>you</span>
  <span m=''500430''>reduce</span> <span m=''500590''>these</span> <span m=''500880''>artifactual</span>
  <span m=''501510''>costs</span> <span m=''502240''>in</span> <span m=''502420''>communication.</span>
  <span m=''504180''>So,</span> <span m=''507530''>DCMA</span> <span m=''508070''>gets</span>
  <span m=''508290''>inputs</span> <span m=''508710''>on</span> <span m=''508850''>the</span>
  <span m=''508930''>cell,</span> <span m=''509860''>or</span> <span m=''510150''>just</span>
  <span m=''510470''>in</span> <span m=''512270''>just</span> <span m=''512430''>message</span>
  <span m=''512750''>passing,</span> <span m=''513210''>you''re</span> <span m=''513550''>exchanging</span>
  <span m=''513970''>messages.</span> <span m=''515320''>Typically,</span> <span m=''515770''>you''re</span>
  <span m=''516380''>communicating</span> <span m=''517030''>over</span> <span m=''517250''>a</span>
  <span m=''517370''>course</span> <span m=''518640''>or</span> <span m=''519460''>large</span>
  <span m=''519740''>blocks</span> <span m=''520070''>of</span> <span m=''520150''>data.</span>
  <span m=''521820''>What</span> <span m=''521940''>you''re</span> <span m=''522050''>usually</span>
  <span m=''522480''>getting</span> <span m=''522810''>is</span> <span m=''522910''>a</span>
  <span m=''522970''>continuous</span> <span m=''523530''>chunk</span> <span m=''523800''>of</span>
  <span m=''523930''>memory,</span> <span m=''524490''>although</span> <span m=''524830''>you</span>
  <span m=''524990''>could</span> <span m=''525220''>do</span> <span m=''525490''>some</span>
  <span m=''525750''>things</span> <span m=''526070''>in</span> <span m=''526230''>software</span>
  <span m=''526840''>or in</span> <span m=''526930''>hardware</span> <span m=''527280''>to</span>
  <span m=''528620''>gather</span> <span m=''529150''>data</span> <span m=''529410''>from</span>
  <span m=''529600''>different</span> <span m=''529860''>memory</span> <span m=''530050''>locations</span>
  <span m=''530760''>and pack</span> <span m=''531240''>them</span> <span m=''531360''>into</span>
  <span m=''531610''>contiguous</span> <span m=''531910''>locations.</span> <span
  m=''532880''>The</span> <span m=''533110''>reason</span> <span m=''533370''>you</span>
  <span m=''533510''>pack</span> <span m=''533880''>them</span> <span m=''533970''>into</span>
  <span m=''534080''>contiguous</span> <span m=''534570''>locations</span> <span m=''535050''>again</span>
  <span m=''535330''>to</span> <span m=''535910''>export</span> <span m=''536300''>spatial</span>
  <span m=''536660''>locality</span> <span m=''537130''>when</span> <span m=''537280''>you</span>
  <span m=''537380''>store</span> <span m=''537640''>the</span> <span m=''537700''>data</span>
  <span m=''537870''>locally.</span> </p><p><span m=''539610''>So</span> <span m=''540130''>to</span>
  <span m=''540940''>exploit</span> <span m=''541440''>the</span> <span m=''541520''>spatial</span>
  <span m=''541880''>locality</span> <span m=''542300''>characteristics,</span> <span
  m=''543260''>what</span> <span m=''543440''>you</span> <span m=''543510''>want</span>
  <span m=''543700''>to</span> <span m=''543790''>make</span> <span m=''543950''>sure
  is</span> <span m=''544270''>that</span> <span m=''544430''>you</span> <span m=''544520''>actually
  are</span> <span m=''544930''>going</span> <span m=''545180''>to</span> <span m=''545310''>have</span>
  <span m=''545890''>good</span> <span m=''546080''>spatial</span> <span m=''546400''>locality</span>
  <span m=''546930''>in</span> <span m=''547040''>your</span> <span m=''547140''>actual</span>
  <span m=''547430''>computation.</span> <span m=''548320''>So</span> <span m=''548540''>you</span>
  <span m=''548670''>want</span> <span m=''549010''>things</span> <span m=''549520''>that</span>
  <span m=''549630''>are</span> <span m=''549690''>iterating</span> <span m=''550130''>over</span>
  <span m=''550370''>loops</span> <span m=''550850''>with</span> <span m=''551130''>well-defined</span>
  <span m=''551660''>indices</span> <span m=''552620''>with</span> <span m=''553070''>indices</span>
  <span m=''553500''>that</span> <span m=''553730''>go</span> <span m=''553870''>over</span>
  <span m=''554540''>very</span> <span m=''554710''>short</span> <span m=''554950''>ranges,</span>
  <span m=''555490''>or</span> <span m=''556340''>they''re</span> <span m=''556650''>very</span>
  <span m=''556890''>sequential</span> <span m=''557440''>or</span> <span m=''557590''>have</span>
  <span m=''557790''>fixed</span> <span m=''558010''>striped</span> <span m=''558340''>patterns</span>
  <span m=''558890''>where you''re</span> <span m=''559120''>not</span> <span m=''559300''>wasting</span>
  <span m=''559790''>a</span> <span m=''559860''>lot</span> <span m=''560040''>of</span>
  <span m=''560120''>the</span> <span m=''560210''>data</span> <span m=''560340''>that</span>
  <span m=''560520''>you have</span> <span m=''560650''>brought</span> <span m=''561000''>in.</span>
  <span m=''561870''>Otherwise,</span> <span m=''562330''>you</span> <span m=''562430''>have</span>
  <span m=''562590''>to</span> <span m=''562730''>essentially</span> <span m=''563090''>just</span>
  <span m=''563280''>increase</span> <span m=''563430''>your</span> <span m=''563730''>communication</span>
  <span m=''564450''>because</span> <span m=''564820''>every</span> <span m=''565130''>fetch</span>
  <span m=''565720''>is</span> <span m=''565890''>getting</span> <span m=''566120''>you</span>
  <span m=''566230''>only</span> <span m=''566470''>a</span> <span m=''566540''>small</span>
  <span m=''566790''>fraction of</span> <span m=''567230''>what</span> <span m=''567370''>you</span>
  <span m=''567460''>actually</span> <span m=''567840''>need.</span> <span m=''568400''>So,</span>
  <span m=''568910''>intuitively</span> <span m=''569260''>this</span> <span m=''569520''>should</span>
  <span m=''569690''>make</span> <span m=''569840''>sense.</span> </p><p><span m=''571520''>Temporal</span>
  <span m=''571900''>locality</span> <span m=''572390''>just</span> <span m=''572500''>says</span>
  <span m=''572760''>I</span> <span m=''572860''>brought</span> <span m=''573140''>in</span>
  <span m=''573240''>some</span> <span m=''573420''>data</span> <span m=''574120''>and</span>
  <span m=''574280''>so</span> <span m=''574410''>I</span> <span m=''574470''>want</span>
  <span m=''574670''>to</span> <span m=''574760''>maximize</span> <span m=''575410''>this</span>
  <span m=''575500''>utility.</span> <span m=''576350''>So</span> <span m=''576590''>if</span>
  <span m=''576720''>I</span> <span m=''576780''>have</span> <span m=''577000''>any</span>
  <span m=''577210''>computation</span> <span m=''578330''>in a</span> <span m=''578640''>parallel</span>
  <span m=''578930''>system,</span> <span m=''579240''>I</span> <span m=''579320''>might</span>
  <span m=''579520''>be</span> <span m=''579660''>able</span> <span m=''579880''>to</span>
  <span m=''580010''>reorder</span> <span m=''580460''>my</span> <span m=''580590''>tasks</span>
  <span m=''581030''>in</span> <span m=''581120''>a</span> <span m=''581180''>way</span>
  <span m=''581380''>that</span> <span m=''582170''>I</span> <span m=''582280''>have</span>
  <span m=''582500''>explicit</span> <span m=''582910''>control</span> <span m=''583280''>over</span>
  <span m=''583450''>the</span> <span m=''583560''>scheduling --</span> <span m=''584330''>which</span>
  <span m=''584520''>stripe</span> <span m=''584770''>executes</span> <span m=''585280''>when.</span>
  <span m=''585930''>Then</span> <span m=''586220''>you</span> <span m=''586300''>want</span>
  <span m=''586530''>to</span> <span m=''586740''>make</span> <span m=''586940''>sure
  that</span> <span m=''587240''>all</span> <span m=''587390''>the</span> <span m=''587460''>computation</span>
  <span m=''588120''>that</span> <span m=''588270''>needs</span> <span m=''588460''>that</span>
  <span m=''588610''>particular</span> <span m=''588970''>data</span> <span m=''589570''>happens</span>
  <span m=''590630''>adjacent in</span> <span m=''591230''>time</span> <span m=''591650''>or</span>
  <span m=''592310''>in</span> <span m=''592470''>some</span> <span m=''593710''>short</span>
  <span m=''594090''>time</span> <span m=''594360''>window so</span> <span m=''594720''>that</span>
  <span m=''594930''>you</span> <span m=''595250''>can</span> <span m=''595420''>amortize</span>
  <span m=''595950''>the</span> <span m=''596040''>cost.</span> </p><p><span m=''596830''>Are</span>
  <span m=''596960''>those</span> <span m=''597060''>two</span> <span m=''597230''>concepts</span>
  <span m=''597600''>clear?</span> <span m=''598860''>Any</span> <span m=''599040''>questions</span>
  <span m=''599400''>on</span> <span m=''599510''>this?</span> </p><p><span m=''603920''>So,</span>
  <span m=''604720''>you''ve</span> <span m=''604930''>done</span> <span m=''605140''>all</span>
  <span m=''605300''>of</span> <span m=''605410''>that.</span> <span m=''605880''>You''ve</span>
  <span m=''606240''>parallelized</span> <span m=''606750''>your</span> <span m=''606860''>code,</span>
  <span m=''607270''>you''ve</span> <span m=''607410''>taken</span> <span m=''607670''>care</span>
  <span m=''608000''>of</span> <span m=''608430''>your</span> <span m=''608600''>communication</span>
  <span m=''609320''>costs,</span> <span m=''609700''>you''ve</span> <span m=''609830''>tried</span>
  <span m=''610050''>to</span> <span m=''610120''>reduce it</span> <span m=''610420''>as</span>
  <span m=''610540''>much</span> <span m=''610750''>as</span> <span m=''610850''>possible.</span>
  <span m=''612360''>Where</span> <span m=''612650''>else</span> <span m=''612920''>can</span>
  <span m=''613050''>you</span> <span m=''613160''>look</span> <span m=''613310''>for</span>
  <span m=''613420''>performance --</span> <span m=''613910''>things</span> <span
  m=''614320''>just</span> <span m=''614560''>don''t</span> <span m=''614760''>look</span>
  <span m=''614960''>like</span> <span m=''615430''>they''re</span> <span m=''615540''>performing</span>
  <span m=''615980''>as</span> <span m=''616140''>well</span> <span m=''616340''>as</span>
  <span m=''616810''>they</span> <span m=''616930''>could?</span> <span m=''617690''>So,
  the</span> <span m=''618300''>last</span> <span m=''618670''>frontier</span> <span
  m=''619740''>is</span> <span m=''619850''>perhaps</span> <span m=''620180''>single</span>
  <span m=''620420''>thread</span> <span m=''620550''>performance, so</span> <span
  m=''621110''>I''m</span> <span m=''621200''>going to</span> <span m=''621350''>talk</span>
  <span m=''621550''>about</span> <span m=''621740''>that.</span> </p><p><span m=''623380''>So</span>
  <span m=''623610''>what</span> <span m=''623900''>is</span> <span m=''624160''>really
  a</span> <span m=''624490''>single</span> <span m=''624870''>thread.</span> <span
  m=''625160''>So</span> <span m=''625280''>if</span> <span m=''625370''>you</span>
  <span m=''625450''>think</span> <span m=''625670''>of</span> <span m=''625780''>what</span>
  <span m=''625920''>you''re</span> <span m=''626060''>doing</span> <span m=''626330''>with</span>
  <span m=''626470''>parallel</span> <span m=''626770''>programming,</span> <span
  m=''627570''>you''re</span> <span m=''627770''>taking</span> <span m=''628060''>a</span>
  <span m=''628130''>bunch</span> <span m=''628340''>of</span> <span m=''628440''>tasks
  --</span> <span m=''628950''>this</span> <span m=''629160''>is</span> <span m=''629270''>the</span>
  <span m=''629340''>work</span> <span m=''629530''>that</span> <span m=''629630''>you</span>
  <span m=''629720''>have</span> <span m=''629880''>to</span> <span m=''629970''>do
  --</span> <span m=''630520''>and</span> <span m=''630870''>you</span> <span m=''630960''>group</span>
  <span m=''631180''>them</span> <span m=''631320''>together</span> <span m=''631750''>into</span>
  <span m=''632190''>threads</span> <span m=''633070''>or the</span> <span m=''633280''>equivalent</span>
  <span m=''633630''>of</span> <span m=''633850''>threads,</span> <span m=''634450''>and</span>
  <span m=''635130''>some</span> <span m=''635480''>threads</span> <span m=''635800''>will</span>
  <span m=''635950''>run</span> <span m=''636160''>on</span> <span m=''636280''>individual</span>
  <span m=''636710''>cores.</span> <span m=''637340''>So</span> <span m=''637560''>essentially</span>
  <span m=''637720''>you</span> <span m=''637990''>have</span> <span m=''638130''>one</span>
  <span m=''638370''>thread</span> <span m=''638630''>running</span> <span m=''638890''>on</span>
  <span m=''638970''>a</span> <span m=''639010''>core,</span> <span m=''639660''>and</span>
  <span m=''639790''>if</span> <span m=''639970''>that</span> <span m=''640300''>performance</span>
  <span m=''640750''>goes</span> <span m=''640920''>fast,</span> <span m=''641420''>then</span>
  <span m=''641640''>your</span> <span m=''641750''>overall</span> <span m=''642070''>execution</span>
  <span m=''642570''>can</span> <span m=''642720''>also</span> <span m=''642990''>benefit</span>
  <span m=''643360''>from</span> <span m=''643510''>that.</span> <span m=''643960''>So,</span>
  <span m=''644170''>that''s</span> <span m=''644380''>single</span> <span m=''644690''>thread</span>
  <span m=''644850''>performance.</span> </p><p><span m=''646310''>So</span> <span
  m=''646440''>if</span> <span m=''646530''>you</span> <span m=''646630''>look</span>
  <span m=''646810''>at</span> <span m=''647570''>a</span> <span m=''647800''>timeline,</span>
  <span m=''648150''>here</span> <span m=''648750''>you</span> <span m=''649020''>have</span>
  <span m=''649210''>sequential</span> <span m=''649680''>code</span> <span m=''649920''>going</span>
  <span m=''650160''>on,</span> <span m=''650450''>then</span> <span m=''650610''>we</span>
  <span m=''650710''>hit</span> <span m=''650870''>some</span> <span m=''651020''>parallel</span>
  <span m=''651450''>part</span> <span m=''652090''>of</span> <span m=''652290''>the</span>
  <span m=''652360''>computation.</span> <span m=''653350''>We</span> <span m=''653910''>have</span>
  <span m=''654250''>multiple</span> <span m=''654720''>executions</span> <span m=''655350''>going</span>
  <span m=''655630''>on.</span> <span m=''656260''>Each</span> <span m=''656420''>one</span>
  <span m=''656600''>of</span> <span m=''656710''>these</span> <span m=''656920''>is</span>
  <span m=''656980''>a</span> <span m=''657120''>thread</span> <span m=''657610''>of</span>
  <span m=''657710''>execution.</span> <span m=''659430''>Really,</span> <span m=''659650''>my</span>
  <span m=''659760''>finish</span> <span m=''660130''>line</span> <span m=''660620''>depends</span>
  <span m=''661070''>on</span> <span m=''661580''>who''s</span> <span m=''661830''>the</span>
  <span m=''661910''>longest</span> <span m=''662800''>thread,</span> <span m=''663380''>who''s</span>
  <span m=''663650''>the</span> <span m=''664020''>slowest</span> <span m=''664300''>one</span>
  <span m=''664470''>to</span> <span m=''664560''>complete,</span> <span m=''665360''>and</span>
  <span m=''665550''>that''s</span> <span m=''666310''>going</span> <span m=''666500''>to</span>
  <span m=''666640''>essentially</span> <span m=''666990''>control</span> <span m=''667460''>my</span>
  <span m=''667760''>speed</span> <span m=''668050''>up.</span> <span m=''670300''>So</span>
  <span m=''670420''>I</span> <span m=''670480''>can</span> <span m=''670650''>improve</span>
  <span m=''671040''>this</span> <span m=''671270''>by</span> <span m=''671550''>doing</span>
  <span m=''671960''>better</span> <span m=''672170''>load</span> <span m=''672390''>balancing.</span>
  <span m=''674620''>If</span> <span m=''675870''>I</span> <span m=''675940''>distribute</span>
  <span m=''676360''>the</span> <span m=''676440''>work</span> <span m=''676650''>[?
  so that ?]</span> <span m=''677250''>everybody''s</span> <span m=''678140''>doing</span>
  <span m=''678430''>equivalent</span> <span m=''678880''>amount</span> <span m=''679080''>of</span>
  <span m=''679150''>work,</span> <span m=''679340''>then</span> <span m=''679460''>I</span>
  <span m=''679500''>can</span> <span m=''679980''>shift</span> <span m=''680240''>that</span>
  <span m=''680680''>finish</span> <span m=''680970''>line</span> <span m=''681220''>earlier</span>
  <span m=''681590''>in</span> <span m=''681680''>time.</span> <span m=''682630''>That</span>
  <span m=''682790''>can</span> <span m=''682910''>work</span> <span m=''683160''>reasonably</span>
  <span m=''683560''>well.</span> <span m=''683990''>So</span> <span m=''684070''>we</span>
  <span m=''684200''>talked</span> <span m=''684460''>about</span> <span m=''684620''>load</span>
  <span m=''684810''>balancing</span> <span m=''685230''>before.</span> <span m=''686920''>We</span>
  <span m=''687080''>can</span> <span m=''687210''>also</span> <span m=''687460''>make</span>
  <span m=''687650''>execution</span> <span m=''688220''>on</span> <span m=''688340''>each</span>
  <span m=''688520''>processor</span> <span m=''688930''>faster.</span> <span m=''690620''>If</span>
  <span m=''690850''>each</span> <span m=''691070''>one</span> <span m=''691230''>of</span>
  <span m=''691300''>these</span> <span m=''691380''>threads</span> <span m=''691710''>finishes</span>
  <span m=''692100''>faster</span> <span m=''692560''>or</span> <span m=''693250''>I''ve</span>
  <span m=''693450''>done</span> <span m=''693630''>the</span> <span m=''693700''>load</span>
  <span m=''693880''>balancing</span> <span m=''694310''>and</span> <span m=''694450''>now
  I</span> <span m=''694510''>can</span> <span m=''694890''>even</span> <span m=''695220''>squeeze</span>
  <span m=''695530''>out</span> <span m=''695650''>more</span> <span m=''695800''>performance</span>
  <span m=''696240''>by</span> <span m=''697150''>shrinking</span> <span m=''697600''>each</span>
  <span m=''697720''>one</span> <span m=''697910''>of</span> <span m=''697990''>those</span>
  <span m=''698170''>lines,</span> <span m=''698890''>then</span> <span m=''699200''>I</span>
  <span m=''699250''>can</span> <span m=''699410''>get</span> <span m=''699590''>performance</span>
  <span m=''699960''>improvement</span> <span m=''700430''>there</span> <span m=''700620''>as</span>
  <span m=''700720''>well.</span> <span m=''701460''>So</span> <span m=''701620''>that''s</span>
  <span m=''701800''>improving</span> <span m=''702180''>single</span> <span m=''702410''>thread</span>
  <span m=''702600''>performance.</span> </p><p><span m=''704280''>But</span> <span
  m=''704400''>how</span> <span m=''704570''>do</span> <span m=''704640''>we</span>
  <span m=''704740''>actually</span> <span m=''705110''>understand</span> <span m=''705580''>what''s</span>
  <span m=''705730''>going</span> <span m=''705960''>on?</span> <span m=''706140''>How</span>
  <span m=''706280''>do</span> <span m=''706360''>I</span> <span m=''706450''>know</span>
  <span m=''707470''>where to</span> <span m=''707730''>optimize?</span> <span m=''708360''>How</span>
  <span m=''708480''>do</span> <span m=''708560''>I</span> <span m=''708650''>know</span>
  <span m=''708740''>how</span> <span m=''708930''>long</span> <span m=''709220''>each</span>
  <span m=''709370''>thread</span> <span m=''709550''>is</span> <span m=''709740''>taking?</span>
  <span m=''710800''>How do I know</span> <span m=''710970''>how long</span> <span
  m=''711170''>my</span> <span m=''711270''>program is</span> <span m=''711710''>taking?</span>
  <span m=''712020''>Where are</span> <span m=''712200''>the</span> <span m=''712260''>problems?</span>
  <span m=''714090''>So,</span> <span m=''714980''>there are</span> <span m=''715180''>performance</span>
  <span m=''715600''>monitoring</span> <span m=''716020''>tools</span> <span m=''716360''>that</span>
  <span m=''716510''>hard</span> <span m=''716750''>designed</span> <span m=''717010''>to</span>
  <span m=''717360''>help</span> <span m=''717570''>you</span> <span m=''717680''>do</span>
  <span m=''717820''>that.</span> <span m=''718840''>So</span> <span m=''718990''>what''s</span>
  <span m=''719210''>the</span> <span m=''720750''>most</span> <span m=''721120''>coarse-grained</span>
  <span m=''721630''>way</span> <span m=''721850''>of</span> <span m=''721920''>figuring</span>
  <span m=''722290''>out</span> <span m=''722420''>how</span> <span m=''722580''>long
  your</span> <span m=''722830''>program</span> <span m=''723210''>took?</span> <span
  m=''724020''>You</span> <span m=''724210''>have</span> <span m=''724380''>some</span>
  <span m=''724950''>sample</span> <span m=''725250''>piece of</span> <span m=''725580''>code</span>
  <span m=''726730''>shown</span> <span m=''727030''>over</span> <span m=''727160''>here,</span>
  <span m=''728000''>you</span> <span m=''728090''>might</span> <span m=''728250''>compile
  it,</span> <span m=''729090''>and</span> <span m=''729250''>then</span> <span m=''729340''>you</span>
  <span m=''729420''>might</span> <span m=''729590''>just</span> <span m=''729780''>use</span>
  <span m=''729960''>time --</span> <span m=''730790''>standard</span> <span m=''731390''>units</span>
  <span m=''731710''>command</span> <span m=''732710''>say</span> <span m=''733070''>run</span>
  <span m=''733350''>this</span> <span m=''734540''>program</span> <span m=''735240''>and</span>
  <span m=''735370''>tell</span> <span m=''735520''>me</span> <span m=''735650''>how</span>
  <span m=''735790''>much</span> <span m=''736030''>time</span> <span m=''736300''>it</span>
  <span m=''736400''>took</span> <span m=''736580''>to</span> <span m=''736670''>run.</span>
  </p><p><span m=''737320''>So</span> <span m=''737470''>you</span> <span m=''737550''>get</span>
  <span m=''737700''>some</span> <span m=''737850''>alpha</span> <span m=''738050''>back</span>
  <span m=''738310''>from</span> <span m=''738460''>time</span> <span m=''738730''>that</span>
  <span m=''738830''>said</span> <span m=''739420''>you</span> <span m=''739500''>took</span>
  <span m=''739670''>about</span> <span m=''739880''>two</span> <span m=''740060''>seconds</span>
  <span m=''740470''>of</span> <span m=''740560''>user</span> <span m=''740840''>time,</span>
  <span m=''741130''>this</span> <span m=''741230''>is</span> <span m=''741360''>actual</span>
  <span m=''741760''>code,</span> <span m=''743050''>you</span> <span m=''743210''>took</span>
  <span m=''743680''>some</span> <span m=''743980''>small</span> <span m=''744330''>amount</span>
  <span m=''744570''>of</span> <span m=''744670''>time in</span> <span m=''745090''>system</span>
  <span m=''745460''>code,</span> <span m=''747200''>and</span> <span m=''747490''>this</span>
  <span m=''747600''>is</span> <span m=''747700''>your</span> <span m=''747820''>overall</span>
  <span m=''748240''>execution,</span> <span m=''748810''>this</span> <span m=''748940''>is</span>
  <span m=''749030''>how</span> <span m=''749130''>much</span> <span m=''749320''>of</span>
  <span m=''749390''>the</span> <span m=''749460''>processor</span> <span m=''749910''>you</span>
  <span m=''750020''>actually</span> <span m=''750370''>use.</span> <span m=''750610''>So,
  a</span> <span m=''750820''>95%</span> <span m=''751610''>utilization.</span> <span
  m=''752870''>Then</span> <span m=''753050''>you</span> <span m=''753140''>might</span>
  <span m=''753300''>apply</span> <span m=''753550''>some</span> <span m=''753710''>optimization.</span>
  <span m=''754600''>So</span> <span m=''754820''>here</span> <span m=''755130''>we''ll</span>
  <span m=''755280''>use the</span> <span m=''755470''>compiler,</span> <span m=''756000''>we''ll</span>
  <span m=''756120''>change the</span> <span m=''756430''>optimization</span> <span
  m=''757050''>level,</span> <span m=''757690''>compile</span> <span m=''758010''>the</span>
  <span m=''758100''>same</span> <span m=''758320''>code,</span> <span m=''758670''>run
  it, and</span> <span m=''759290''>we''ll</span> <span m=''759450''>see</span> <span
  m=''759820''>wow,</span> <span m=''760260''>performance</span> <span m=''760680''>improved.</span>
  <span m=''761270''>So</span> <span m=''761670''>we</span> <span m=''761820''>increased</span>
  <span m=''762160''>99%</span> <span m=''762800''>utilization,</span> <span m=''763720''>my</span>
  <span m=''763860''>running</span> <span m=''764130''>time</span> <span m=''764420''>went</span>
  <span m=''764570''>down</span> <span m=''766060''>by a</span> <span m=''766260''>small</span>
  <span m=''766510''>chunk.</span> </p><p><span m=''767180''>But</span> <span m=''767380''>did
  we</span> <span m=''767470''>really</span> <span m=''768130''>learn</span> <span
  m=''768440''>anything</span> <span m=''768780''>about</span> <span m=''768940''>what''s</span>
  <span m=''769120''>going</span> <span m=''769360''>on</span> <span m=''769520''>here?</span>
  <span m=''771100''>There''s</span> <span m=''771290''>some</span> <span m=''771480''>code</span>
  <span m=''771790''>going</span> <span m=''772050''>on,</span> <span m=''772260''>there''s
  a</span> <span m=''772630''>loop</span> <span m=''772960''>here,</span> <span m=''773360''>there''s
  a</span> <span m=''773600''>loop</span> <span m=''773810''>here,</span> <span m=''774520''>there''s</span>
  <span m=''774670''>some</span> <span m=''774850''>functions</span> <span m=''775570''>with</span>
  <span m=''775840''>more</span> <span m=''776160''>loops.</span> <span m=''776650''>So</span>
  <span m=''776870''>where</span> <span m=''777190''>is the</span> <span m=''777290''>actual</span>
  <span m=''777580''>computation</span> <span m=''778200''>time</span> <span m=''778570''>going?</span>
  <span m=''779300''>So</span> <span m=''779430''>how</span> <span m=''779540''>would</span>
  <span m=''779670''>I</span> <span m=''779720''>actually</span> <span m=''780090''>go</span>
  <span m=''780250''>about</span> <span m=''780500''>understanding this?</span> <span
  m=''781550''>So</span> <span m=''782180''>what are</span> <span m=''782370''>some</span>
  <span m=''782540''>tricks</span> <span m=''782780''>you</span> <span m=''782870''>might</span>
  <span m=''783050''>have used in</span> <span m=''783760''>trying</span> <span m=''784000''>to</span>
  <span m=''784060''>figure</span> <span m=''784310''>out</span> <span m=''784420''>how</span>
  <span m=''784580''>long</span> <span m=''784790''>something</span> <span m=''785100''>took</span>
  <span m=''785430''>in</span> <span m=''785560''>your</span> <span m=''785660''>computation?</span>
  </p><p><span m=''786200''>AUDIENCE:</span> <span m=''787694''>[INAUDIBLE PHRASE].</span>
  </p><p><span m=''797010''>PROFESSOR: Right.</span> <span m=''797690''>So</span>
  <span m=''798950''>you</span> <span m=''799090''>might</span> <span m=''799300''>have</span>
  <span m=''799760''>a</span> <span m=''800130''>timer,</span> <span m=''800500''>you</span>
  <span m=''800620''>record the</span> <span m=''800970''>time</span> <span m=''801280''>here,</span>
  <span m=''802070''>you</span> <span m=''802700''>compute and</span> <span m=''803200''>then</span>
  <span m=''803320''>you</span> <span m=''803420''>stop</span> <span m=''803650''>the</span>
  <span m=''803720''>timer</span> <span m=''804100''>and</span> <span m=''804190''>then</span>
  <span m=''804290''>you</span> <span m=''804360''>might</span> <span m=''804590''>printout</span>
  <span m=''805000''>or</span> <span m=''805160''>record</span> <span m=''806160''>how</span>
  <span m=''806350''>long</span> <span m=''806670''>that</span> <span m=''806840''>particular</span>
  <span m=''807230''>block</span> <span m=''807510''>of</span> <span m=''807640''>code</span>
  <span m=''807920''>took.</span> <span m=''808960''>Then you</span> <span m=''809020''>might</span>
  <span m=''809190''>have</span> <span m=''809360''>a</span> <span m=''809560''>histogram</span>
  <span m=''809660''>of</span> <span m=''809950''>them</span> <span m=''810120''>and</span>
  <span m=''810210''>then</span> <span m=''810300''>you</span> <span m=''810370''>might</span>
  <span m=''810500''>analyze</span> <span m=''810900''>the histogram</span> <span
  m=''811380''>to</span> <span m=''811480''>find</span> <span m=''811710''>out</span>
  <span m=''811800''>the</span> <span m=''811880''>distribution.</span> <span m=''813350''>You</span>
  <span m=''813420''>might</span> <span m=''813600''>repeat</span> <span m=''813910''>this</span>
  <span m=''814090''>over</span> <span m=''814340''>and</span> <span m=''814430''>over</span>
  <span m=''814700''>again</span> <span m=''815020''>for</span> <span m=''815260''>many</span>
  <span m=''815500''>different</span> <span m=''815810''>loops</span> <span m=''815990''>or</span>
  <span m=''816090''>many</span> <span m=''816270''>different</span> <span m=''816530''>parts</span>
  <span m=''816820''>that</span> <span m=''816880''>are</span> <span m=''816960''>code.</span>
  <span m=''819180''>If</span> <span m=''819360''>you</span> <span m=''820530''>have
  a</span> <span m=''820700''>preconceived</span> <span m=''821200''>notion</span>
  <span m=''821500''>of</span> <span m=''821580''>where</span> <span m=''821720''>the</span>
  <span m=''821790''>problem</span> <span m=''822170''>is</span> <span m=''822320''>then</span>
  <span m=''822420''>you</span> <span m=''822510''>instrument</span> <span m=''822920''>that</span>
  <span m=''823390''>and</span> <span m=''823620''>see</span> <span m=''823810''>if</span>
  <span m=''823990''>your</span> <span m=''824160''>hypothesis</span> <span m=''824810''>is</span>
  <span m=''824930''>correct.</span> <span m=''825540''>That</span> <span m=''825690''>can</span>
  <span m=''825850''>help</span> <span m=''826070''>you</span> <span m=''826400''>identify</span>
  <span m=''827010''>the</span> <span m=''827110''>problems.</span> <span m=''828540''>But</span>
  <span m=''829050''>increasingly</span> <span m=''829780''>you</span> <span m=''829880''>can</span>
  <span m=''830000''>actually</span> <span m=''830400''>get</span> <span m=''830630''>more</span>
  <span m=''831100''>accurate</span> <span m=''831490''>measurements.</span> <span
  m=''832340''>So,</span> <span m=''832620''>in</span> <span m=''832700''>the</span>
  <span m=''832770''>previous</span> <span m=''833090''>routine,</span> <span m=''833710''>you''re</span>
  <span m=''833920''>using</span> <span m=''834200''>the</span> <span m=''834280''>time,</span>
  <span m=''834710''>you</span> <span m=''834770''>were</span> <span m=''834860''>looking</span>
  <span m=''835120''>at</span> <span m=''838060''>how</span> <span m=''838510''>much</span>
  <span m=''839160''>time</span> <span m=''839480''>has</span> <span m=''839610''>elapsed</span>
  <span m=''839960''>in</span> <span m=''840100''>seconds</span> <span m=''840500''>or</span>
  <span m=''841350''>in</span> <span m=''841490''>small</span> <span m=''841740''>increments.</span>
  <span m=''842760''>But</span> <span m=''843040''>you</span> <span m=''843200''>can</span>
  <span m=''843320''>actually</span> <span m=''843640''>use</span> <span m=''843910''>hardware</span>
  <span m=''844240''>counters</span> <span m=''844640''>today</span> <span m=''844820''>to</span>
  <span m=''844920''>actually</span> <span m=''845220''>measure</span> <span m=''845440''>clock</span>
  <span m=''845780''>cycles,</span> <span m=''846400''>clock</span> <span m=''846710''>ticks.</span>
  <span m=''847620''>That</span> <span m=''847730''>might</span> <span m=''847970''>be</span>
  <span m=''848300''>more</span> <span m=''848590''>useful.</span> <span m=''849710''>Actually,</span>
  <span m=''849990''>it''s</span> <span m=''850090''>more</span> <span m=''850290''>useful</span>
  <span m=''850520''>because</span> <span m=''850850''>you</span> <span m=''850950''>can</span>
  <span m=''851100''>measure</span> <span m=''851340''>a</span> <span m=''851430''>lot</span>
  <span m=''851630''>more</span> <span m=''851830''>events</span> <span m=''852270''>than
  just</span> <span m=''852430''>clock</span> <span m=''852720''>ticks.</span> </p><p><span
  m=''855610''>The</span> <span m=''855750''>counters</span> <span m=''856550''>in</span>
  <span m=''857270''>modern</span> <span m=''857560''>architectures</span> <span m=''858030''>are</span>
  <span m=''858170''>really</span> <span m=''858840''>specialized</span> <span m=''859420''>registers</span>
  <span m=''860200''>that</span> <span m=''860380''>count</span> <span m=''860670''>up</span>
  <span m=''860810''>events</span> <span m=''861510''>and</span> <span m=''861670''>then</span>
  <span m=''861770''>you</span> <span m=''861890''>can</span> <span m=''862070''>go</span>
  <span m=''862250''>in</span> <span m=''862390''>there</span> <span m=''862570''>and</span>
  <span m=''862930''>probe</span> <span m=''863530''>and</span> <span m=''863800''>ask</span>
  <span m=''864100''>what</span> <span m=''864250''>is</span> <span m=''864350''>the</span>
  <span m=''864420''>value</span> <span m=''864700''>in</span> <span m=''864760''>this</span>
  <span m=''864890''>register,</span> <span m=''865570''>and</span> <span m=''865730''>you</span>
  <span m=''865810''>can</span> <span m=''865960''>use</span> <span m=''866120''>that</span>
  <span m=''866280''>as</span> <span m=''866380''>part</span> <span m=''866630''>of</span>
  <span m=''867400''>your</span> <span m=''867560''>performance</span> <span m=''868010''>tuning.</span>
  <span m=''869160''>You</span> <span m=''869270''>use</span> <span m=''869530''>them</span>
  <span m=''869780''>much</span> <span m=''870010''>in</span> <span m=''870080''>the</span>
  <span m=''870170''>same</span> <span m=''870400''>way</span> <span m=''870560''>as</span>
  <span m=''870990''>you</span> <span m=''871130''>would</span> <span m=''871260''>have</span>
  <span m=''871370''>done</span> <span m=''871630''>to</span> <span m=''872070''>start</span>
  <span m=''872420''>a</span> <span m=''872480''>regular</span> <span m=''872800''>timer</span>
  <span m=''873430''>or</span> <span m=''873540''>stop</span> <span m=''875010''>a</span>
  <span m=''875060''>regular</span> <span m=''875340''>timer.</span> <span m=''877260''>There</span>
  <span m=''877430''>are</span> <span m=''877540''>specialized</span> <span m=''878110''>libraries</span>
  <span m=''878530''>that</span> <span m=''878770''>run.</span> <span m=''879340''>Unfortunately,</span>
  <span m=''879890''>these are</span> <span m=''880080''>very</span> <span m=''880330''>architecture-specific</span>
  <span m=''881150''>at</span> <span m=''881220''>this</span> <span m=''881390''>point.</span>
  <span m=''881760''>There''s</span> <span m=''881990''>not</span> <span m=''882150''>really</span>
  <span m=''882420''>a</span> <span m=''882480''>common</span> <span m=''882800''>standard</span>
  <span m=''884100''>that</span> <span m=''884310''>says</span> <span m=''884620''>grab</span>
  <span m=''884870''>a</span> <span m=''884940''>timer at</span> <span m=''885360''>each</span>
  <span m=''885590''>different</span> <span m=''885860''>architecture</span> <span
  m=''886420''>in</span> <span m=''886900''>a</span> <span m=''887120''>uniform</span>
  <span m=''887550''>way,</span> <span m=''887990''>although</span> <span m=''888200''>that''s</span>
  <span m=''888400''>getting</span> <span m=''888630''>better</span> <span m=''889300''>with</span>
  <span m=''889610''>some</span> <span m=''889760''>standards</span> <span m=''890140''>coming</span>
  <span m=''890440''>out</span> <span m=''890590''>from--.</span> <span m=''892570''>I''ll</span>
  <span m=''892670''>talk</span> <span m=''892880''>about</span> <span m=''893070''>that</span>
  <span m=''893380''>in</span> <span m=''893690''>just</span> <span m=''893940''>a
  few</span> <span m=''894130''>slides.</span> <span m=''894870''>You</span> <span
  m=''894960''>can</span> <span m=''895090''>use</span> <span m=''895290''>this</span>
  <span m=''895380''>to,</span> <span m=''895520''>for</span> <span m=''895710''>example,</span>
  <span m=''896110''>measure</span> <span m=''896470''>your</span> <span m=''896650''>communication</span>
  <span m=''897400''>to</span> <span m=''897460''>computation</span> <span m=''897990''>cost.</span>
  <span m=''898660''>So</span> <span m=''899030''>you</span> <span m=''899170''>can</span>
  <span m=''899350''>wrap</span> <span m=''899660''>your</span> <span m=''899850''>DMA</span>
  <span m=''900360''>get</span> <span m=''900670''>and</span> <span m=''900920''>DMA</span>
  <span m=''901230''>put</span> <span m=''901510''>by</span> <span m=''901730''>timer</span>
  <span m=''901990''>calls,</span> <span m=''903100''>and</span> <span m=''903240''>you</span>
  <span m=''903320''>can</span> <span m=''903460''>measure</span> <span m=''903710''>your</span>
  <span m=''903840''>actual</span> <span m=''904240''>work</span> <span m=''905600''>by</span>
  <span m=''905890''>timer</span> <span m=''906190''>calls,</span> <span m=''906690''>and</span>
  <span m=''906880''>figuring</span> <span m=''907270''>out</span> <span m=''907670''>how</span>
  <span m=''907880''>much</span> <span m=''908140''>overlap</span> <span m=''908580''>can</span>
  <span m=''908750''>you</span> <span m=''908840''>get</span> <span m=''909050''>from</span>
  <span m=''909600''>overlap</span> <span m=''910010''>in</span> <span m=''910100''>communication</span>
  <span m=''910950''>and</span> <span m=''912320''>communication</span> <span m=''912980''>computation</span>
  <span m=''913780''>and</span> <span m=''914000''>is</span> <span m=''914130''>that</span>
  <span m=''914260''>really</span> <span m=''914460''>worthwhile</span> <span m=''914850''>to</span>
  <span m=''914960''>do</span> <span m=''915090''>pipelining.</span> </p><p><span
  m=''917850''>But</span> <span m=''918010''>this</span> <span m=''918210''>really</span>
  <span m=''918440''>requires</span> <span m=''918970''>manual</span> <span m=''919300''>changes</span>
  <span m=''919610''>to</span> <span m=''919820''>code.</span> <span m=''920120''>You</span>
  <span m=''920430''>have</span> <span m=''920600''>to</span> <span m=''920710''>go</span>
  <span m=''920870''>in</span> <span m=''920990''>there</span> <span m=''921160''>and</span>
  <span m=''921480''>start the</span> <span m=''921750''>timers.</span> <span m=''922490''>You</span>
  <span m=''922630''>have</span> <span m=''922830''>to</span> <span m=''922920''>have</span>
  <span m=''923270''>maybe</span> <span m=''923520''>an</span> <span m=''923610''>idea
  of</span> <span m=''923990''>where</span> <span m=''924240''>the</span> <span m=''924320''>problem</span>
  <span m=''924740''>is,</span> <span m=''926100''>and</span> <span m=''926320''>you</span>
  <span m=''926380''>have</span> <span m=''926500''>the</span> <span m=''926830''>Heisenberg</span>
  <span m=''927300''>effect.</span> <span m=''927780''>If</span> <span m=''927960''>you</span>
  <span m=''928030''>have</span> <span m=''928150''>a</span> <span m=''928220''>loop</span>
  <span m=''928860''>and</span> <span m=''929090''>you</span> <span m=''929150''>want</span>
  <span m=''929320''>to</span> <span m=''929380''>measure</span> <span m=''929600''>code</span>
  <span m=''930060''>within</span> <span m=''930370''>the</span> <span m=''930450''>loop</span>
  <span m=''930640''>because</span> <span m=''930860''>you</span> <span m=''930930''>have</span>
  <span m=''931330''>a</span> <span m=''931450''>nested</span> <span m=''931690''>loop</span>
  <span m=''931940''>inside</span> <span m=''932270''>of</span> <span m=''932350''>that,</span>
  <span m=''932910''>then</span> <span m=''933050''>now</span> <span m=''933200''>you''re</span>
  <span m=''933360''>effecting</span> <span m=''933730''>the</span> <span m=''933800''>performance</span>
  <span m=''934370''>of the</span> <span m=''934670''>outer</span> <span m=''934920''>loop.</span>
  <span m=''935420''>That</span> <span m=''935590''>can</span> <span m=''935690''>be</span>
  <span m=''935780''>problematic.</span> <span m=''937100''>So</span> <span m=''937240''>it</span>
  <span m=''937440''>has a</span> <span m=''937530''>better</span> <span m=''937790''>effect</span>
  <span m=''938240''>because</span> <span m=''938470''>you</span> <span m=''938550''>can''t</span>
  <span m=''938750''>really</span> <span m=''938940''>make</span> <span m=''939110''>an</span>
  <span m=''939190''>accurate</span> <span m=''939550''>measurement</span> <span m=''939920''>on</span>
  <span m=''940030''>the</span> <span m=''940130''>thing you''re</span> <span m=''940320''>inspecting.</span>
  </p><p><span m=''942320''>So</span> <span m=''944220''>there''s</span> <span m=''944420''>a</span>
  <span m=''944580''>slightly</span> <span m=''944900''>better</span> <span m=''945140''>approach,</span>
  <span m=''945660''>dynamic</span> <span m=''946110''>profiling.</span> <span m=''947100''>Dynamic</span>
  <span m=''947510''>profiling</span> <span m=''948040''>is</span> <span m=''948160''>really</span>
  <span m=''949110''>there''s</span> <span m=''949380''>an</span> <span m=''949490''>event-based</span>
  <span m=''950030''>profiling</span> <span m=''950430''>and</span> <span m=''950520''>time-based</span>
  <span m=''951080''>profiling.</span> <span m=''951750''>Conceptually</span> <span
  m=''952030''>they</span> <span m=''952170''>do</span> <span m=''952290''>the</span>
  <span m=''952380''>same</span> <span m=''952600''>thing.</span> <span m=''953530''>What''s</span>
  <span m=''954070''>going</span> <span m=''954330''>on</span> <span m=''954530''>here
  is</span> <span m=''955200''>your</span> <span m=''955390''>program</span> <span
  m=''955760''>is</span> <span m=''955870''>running</span> <span m=''956440''>and</span>
  <span m=''956730''>you''re</span> <span m=''956840''>going</span> <span m=''957060''>to</span>
  <span m=''957180''>say</span> <span m=''957780''>I''m</span> <span m=''957980''>interested</span>
  <span m=''958490''>in</span> <span m=''958620''>events</span> <span m=''959010''>such</span>
  <span m=''959410''>as</span> <span m=''959860''>cache</span> <span m=''960210''>misses.</span>
  <span m=''961050''>Whenever</span> <span m=''962160''>n</span> <span m=''962470''>number</span>
  <span m=''962740''>of</span> <span m=''962830''>cache</span> <span m=''963140''>misses</span>
  <span m=''963380''>happen, let''s</span> <span m=''963990''>say</span> <span m=''964160''>1,000,</span>
  <span m=''965000''>let</span> <span m=''965160''>me</span> <span m=''965240''>know.</span>
  <span m=''965830''>So</span> <span m=''966250''>you</span> <span m=''966310''>get
  an</span> <span m=''966460''>interrupt</span> <span m=''966990''>whenever</span>
  <span m=''967350''>1,000</span> <span m=''967800''>cache</span> <span m=''968040''>misses</span>
  <span m=''968280''>happen.</span> <span m=''968860''>Then</span> <span m=''968980''>you</span>
  <span m=''969100''>can</span> <span m=''969380''>update</span> <span m=''969620''>a</span>
  <span m=''969690''>counter</span> <span m=''970100''>or</span> <span m=''971980''>use</span>
  <span m=''972250''>that</span> <span m=''972450''>to</span> <span m=''972780''>trigger</span>
  <span m=''973080''>some</span> <span m=''973290''>optimizations</span> <span m=''973970''>or</span>
  <span m=''974080''>analysis.</span> <span m=''975940''>This</span> <span m=''976160''>works</span>
  <span m=''976780''>really</span> <span m=''977070''>nicely</span> <span m=''977400''>because</span>
  <span m=''977650''>you</span> <span m=''977730''>don''t</span> <span m=''977880''>have</span>
  <span m=''978020''>to</span> <span m=''978120''>touch</span> <span m=''978270''>your</span>
  <span m=''978410''>code.</span> </p><p><span m=''979820''>You</span> <span m=''980310''>essentially</span>
  <span m=''980800''>run</span> <span m=''980980''>your</span> <span m=''981060''>program</span>
  <span m=''981740''>as you</span> <span m=''982000''>normally</span> <span m=''982410''>do</span>
  <span m=''982680''>with</span> <span m=''982820''>just</span> <span m=''983000''>one</span>
  <span m=''983160''>modification</span> <span m=''983840''>that</span> <span m=''983940''>includes</span>
  <span m=''984930''>running</span> <span m=''985650''>the</span> <span m=''986380''>dynamic</span>
  <span m=''986770''>profiler,</span> <span m=''987500''>as</span> <span m=''987650''>well</span>
  <span m=''987840''>as</span> <span m=''988840''>your</span> <span m=''989040''>actual</span>
  <span m=''989330''>computation.</span> <span m=''991070''>As far as</span> <span
  m=''991400''>multiple</span> <span m=''991750''>languages</span> <span m=''992670''>because</span>
  <span m=''992820''>all</span> <span m=''992980''>it</span> <span m=''993090''>does</span>
  <span m=''993310''>is</span> <span m=''993410''>just</span> <span m=''993610''>takes</span>
  <span m=''993850''>your</span> <span m=''993910''>binary</span> <span m=''994760''>so</span>
  <span m=''995040''>you can</span> <span m=''995280''>program</span> <span m=''995650''>in</span>
  <span m=''995780''>any</span> <span m=''996060''>language,</span> <span m=''997560''>any</span>
  <span m=''997750''>programming</span> <span m=''998210''>model.</span> <span m=''998940''>It''s</span>
  <span m=''999880''>quite</span> <span m=''1000110''>efficient to</span> <span m=''1000470''>actually</span>
  <span m=''1000850''>use these</span> <span m=''1001180''>dynamic</span> <span m=''1001520''>profiling</span>
  <span m=''1001960''>tools.</span> <span m=''1002990''>The</span> <span m=''1003190''>sampling</span>
  <span m=''1003620''>frequencies</span> <span m=''1005050''>are</span> <span m=''1005180''>reasonably</span>
  <span m=''1005710''>small,</span> <span m=''1006390''>you</span> <span m=''1006500''>can</span>
  <span m=''1006600''>make</span> <span m=''1006770''>them</span> <span m=''1006870''>reasonably</span>
  <span m=''1007270''>small and</span> <span m=''1007630''>still</span> <span m=''1007810''>have</span>
  <span m=''1008040''>it</span> <span m=''1008110''>be</span> <span m=''1008250''>efficient.</span>
  </p><p><span m=''1009950''>So</span> <span m=''1010100''>some</span> <span m=''1010270''>counter</span>
  <span m=''1010560''>examples.</span> <span m=''1012010''>Clock</span> <span m=''1012300''>cycles,</span>
  <span m=''1013040''>so you can measure</span> <span m=''1013460''>clock</span> <span
  m=''1013780''>ticks.</span> <span m=''1014350''>Pipeline</span> <span m=''1014810''>stalls.</span>
  <span m=''1015190''>This</span> <span m=''1015290''>might</span> <span m=''1015490''>be</span>
  <span m=''1015570''>interesting</span> <span m=''1016030''>if</span> <span m=''1017580''>you</span>
  <span m=''1017820''>want</span> <span m=''1018030''>to</span> <span m=''1018230''>optimize</span>
  <span m=''1018400''>your instruction</span> <span m=''1018920''>schedule -- you''ll</span>
  <span m=''1019420''>actually</span> <span m=''1019810''>see</span> <span m=''1019990''>this
  in the</span> <span m=''1020310''>recitation</span> <span m=''1021250''>next</span>
  <span m=''1021500''>week.</span> <span m=''1022340''>Cache</span> <span m=''1022680''>hits,</span>
  <span m=''1022960''>cache</span> <span m=''1023240''>misses --</span> <span m=''1023530''>you</span>
  <span m=''1023620''>can</span> <span m=''1023760''>get</span> <span m=''1023900''>an</span>
  <span m=''1023980''>idea</span> <span m=''1024380''>of</span> <span m=''1024610''>how</span>
  <span m=''1024800''>bad</span> <span m=''1025560''>your</span> <span m=''1025770''>cache</span>
  <span m=''1026030''>performance is</span> <span m=''1026680''>and</span> <span m=''1026790''>how</span>
  <span m=''1026900''>much</span> <span m=''1027130''>time</span> <span m=''1027390''>you''re</span>
  <span m=''1027510''>spending</span> <span m=''1027820''>in the</span> <span m=''1027900''>memory</span>
  <span m=''1028190''>system.</span> <span m=''1028970''>Number</span> <span m=''1029230''>of</span>
  <span m=''1029320''>instructions,</span> <span m=''1030050''>loads,</span> <span
  m=''1030330''>stores,</span> <span m=''1031100''>floating</span> <span m=''1031420''>point</span>
  <span m=''1031660''>ops</span> <span m=''1031890''>and</span> <span m=''1032000''>so</span>
  <span m=''1032100''>on.</span> <span m=''1034230''>Then</span> <span m=''1034320''>you</span>
  <span m=''1034410''>can</span> <span m=''1034520''>derive</span> <span m=''1035250''>some</span>
  <span m=''1035450''>useful</span> <span m=''1035790''>measures</span> <span m=''1036110''>from</span>
  <span m=''1036240''>that.</span> <span m=''1036670''>So</span> <span m=''1036900''>I</span>
  <span m=''1037010''>can</span> <span m=''1037420''>get</span> <span m=''1037600''>an</span>
  <span m=''1037670''>idea</span> <span m=''1037930''>of</span> <span m=''1038030''>processor</span>
  <span m=''1038450''>utilization --</span> <span m=''1039730''>divide</span> <span
  m=''1040010''>cycles</span> <span m=''1040450''>by</span> <span m=''1040570''>time</span>
  <span m=''1040910''>and</span> <span m=''1041280''>that</span> <span m=''1041420''>gives</span>
  <span m=''1041580''>me</span> <span m=''1041660''>utilization.</span> <span m=''1042850''>I</span>
  <span m=''1042950''>can</span> <span m=''1043410''>derive</span> <span m=''1044210''>some</span>
  <span m=''1044440''>other</span> <span m=''1044600''>things and</span> <span m=''1045010''>maybe</span>
  <span m=''1045370''>some</span> <span m=''1045920''>of the</span> <span m=''1046000''>more</span>
  <span m=''1046200''>interesting</span> <span m=''1046540''>things</span> <span m=''1046750''>like</span>
  <span m=''1046990''>memory of</span> <span m=''1047370''>traffic.</span> <span m=''1048350''>So</span>
  <span m=''1048500''>how</span> <span m=''1048600''>much</span> <span m=''1048770''>data</span>
  <span m=''1048970''>am</span> <span m=''1049070''>I</span> <span m=''1049170''>actually</span>
  <span m=''1049510''>sending</span> <span m=''1049870''>between a</span> <span m=''1050250''>CPU</span>
  <span m=''1050730''>and</span> <span m=''1050830''>a</span> <span m=''1050900''>processor,</span>
  <span m=''1051240''>or</span> <span m=''1051740''>how</span> <span m=''1051850''>much</span>
  <span m=''1052110''>data</span> <span m=''1052330''>am</span> <span m=''1052430''>I</span>
  <span m=''1052520''>communicating</span> <span m=''1053140''>from</span> <span m=''1053310''>one</span>
  <span m=''1053480''>processor</span> <span m=''1053950''>to</span> <span m=''1054080''>the</span>
  <span m=''1054190''>other.</span> <span m=''1055560''>So</span> <span m=''1055770''>I</span>
  <span m=''1055820''>can</span> <span m=''1056000''>just</span> <span m=''1056330''>grab</span>
  <span m=''1056700''>the counters</span> <span m=''1057090''>for</span> <span m=''1057320''>number</span>
  <span m=''1057580''>of</span> <span m=''1057690''>loads</span> <span m=''1058000''>and
  number of</span> <span m=''1058310''>stores,</span> <span m=''1059090''>figure</span>
  <span m=''1059330''>out</span> <span m=''1059440''>what</span> <span m=''1059570''>the</span>
  <span m=''1059660''>cache</span> <span m=''1059980''>line</span> <span m=''1060200''>size</span>
  <span m=''1060500''>is --</span> <span m=''1060770''>usually</span> <span m=''1061150''>those</span>
  <span m=''1061320''>are</span> <span m=''1061400''>documented</span> <span m=''1062020''>or
  there are</span> <span m=''1062440''>calibration</span> <span m=''1063000''>tools</span>
  <span m=''1063240''>you</span> <span m=''1063340''>can</span> <span m=''1063470''>run</span>
  <span m=''1064060''>to</span> <span m=''1064180''>get</span> <span m=''1064310''>that</span>
  <span m=''1064480''>value,</span> <span m=''1064930''>and</span> <span m=''1065120''>you
  figure out memory of</span> <span m=''1065590''>traffic.</span> </p><p><span m=''1066860''>Another</span>
  <span m=''1067140''>one</span> <span m=''1067280''>would</span> <span m=''1067440''>be</span>
  <span m=''1067620''>bandwidth</span> <span m=''1067990''>consumed.</span> <span
  m=''1068740''>So</span> <span m=''1068940''>bandwidth</span> <span m=''1069460''>is</span>
  <span m=''1070080''>memory of</span> <span m=''1070340''>traffic</span> <span m=''1070990''>per</span>
  <span m=''1071300''>second.</span> <span m=''1071860''>So</span> <span m=''1072000''>how</span>
  <span m=''1072100''>would</span> <span m=''1072220''>you</span> <span m=''1072320''>measure</span>
  <span m=''1072570''>that?</span> <span m=''1075460''>It''s</span> <span m=''1075650''>just</span>
  <span m=''1075960''>the</span> <span m=''1076040''>traffic</span> <span m=''1076490''>divided</span>
  <span m=''1076850''>by</span> <span m=''1076990''>the</span> <span m=''1077070''>wall</span>
  <span m=''1077240''>clock</span> <span m=''1077420''>time.</span> <span m=''1079770''>There''s</span>
  <span m=''1080040''>some</span> <span m=''1080230''>others</span> <span m=''1080550''>that</span>
  <span m=''1080650''>you</span> <span m=''1080770''>can</span> <span m=''1080890''>calculate.</span>
  <span m=''1081480''>So</span> <span m=''1081600''>these</span> <span m=''1081720''>can</span>
  <span m=''1081860''>be</span> <span m=''1081980''>really</span> <span m=''1082240''>useful</span>
  <span m=''1082600''>in</span> <span m=''1082730''>helping</span> <span m=''1083000''>you</span>
  <span m=''1083090''>figure</span> <span m=''1083340''>out</span> <span m=''1084200''>where</span>
  <span m=''1084450''>are</span> <span m=''1084620''>the</span> <span m=''1084680''>things</span>
  <span m=''1084980''>you</span> <span m=''1085050''>should</span> <span m=''1085200''>go</span>
  <span m=''1085320''>focus</span> <span m=''1086700''>in on.</span> <span m=''1086890''>I''m
  going to</span> <span m=''1087080''>show you some</span> <span m=''1087380''>examples.</span>
  </p><p><span m=''1089220''>The</span> <span m=''1089320''>way</span> <span m=''1089490''>these</span>
  <span m=''1089660''>tools</span> <span m=''1090040''>work</span> <span m=''1090670''>is</span>
  <span m=''1090920''>you</span> <span m=''1091020''>have</span> <span m=''1091160''>your</span>
  <span m=''1091230''>application</span> <span m=''1091810''>source</span> <span m=''1092120''>code,</span>
  <span m=''1092400''>you</span> <span m=''1092490''>compile it</span> <span m=''1092950''>down</span>
  <span m=''1093220''>to</span> <span m=''1093310''>a</span> <span m=''1093380''>binary.</span>
  <span m=''1094320''>You</span> <span m=''1094440''>take your</span> <span m=''1094720''>binary</span>
  <span m=''1095290''>and</span> <span m=''1095450''>you</span> <span m=''1095570''>run</span>
  <span m=''1095780''>it,</span> <span m=''1096170''>and</span> <span m=''1096460''>then</span>
  <span m=''1097000''>that can</span> <span m=''1097290''>generate some</span> <span
  m=''1097850''>profile</span> <span m=''1099030''>that</span> <span m=''1099360''>stores</span>
  <span m=''1100020''>locally</span> <span m=''1100400''>on</span> <span m=''1100600''>your</span>
  <span m=''1100740''>disk.</span> <span m=''1102200''>Then</span> <span m=''1102320''>you</span>
  <span m=''1102450''>can</span> <span m=''1102640''>take</span> <span m=''1102950''>that</span>
  <span m=''1103100''>profile</span> <span m=''1103600''>and</span> <span m=''1103730''>analyze
  it</span> <span m=''1104190''>by</span> <span m=''1104330''>some</span> <span m=''1104500''>sort</span>
  <span m=''1104720''>of</span> <span m=''1104800''>interpreter,</span> <span m=''1106700''>and</span>
  <span m=''1107130''>some</span> <span m=''1107270''>cases</span> <span m=''1107600''>you
  can</span> <span m=''1107760''>actually</span> <span m=''1108410''>analyze the</span>
  <span m=''1108920''>binary</span> <span m=''1109470''>as</span> <span m=''1109600''>well,</span>
  <span m=''1110060''>and</span> <span m=''1110530''>reannotate</span> <span m=''1111010''>your</span>
  <span m=''1111140''>source</span> <span m=''1111420''>code.</span> <span m=''1112340''>That</span>
  <span m=''1112480''>can</span> <span m=''1112630''>actually</span> <span m=''1113000''>be</span>
  <span m=''1113150''>very</span> <span m=''1113450''>useful</span> <span m=''1113630''>because</span>
  <span m=''1113930''>it''ll</span> <span m=''1114070''>tell</span> <span m=''1114280''>you</span>
  <span m=''1114390''>this</span> <span m=''1114550''>particular</span> <span m=''1115000''>line</span>
  <span m=''1115220''>of</span> <span m=''1115330''>your</span> <span m=''1115420''>code</span>
  <span m=''1115980''>is</span> <span m=''1116190''>the</span> <span m=''1116260''>one</span>
  <span m=''1116400''>where</span> <span m=''1116530''>you''re</span> <span m=''1116640''>spending</span>
  <span m=''1116950''>most</span> <span m=''1117150''>of</span> <span m=''1117250''>your</span>
  <span m=''1117370''>time</span> <span m=''1117640''>computing.</span> </p><p><span
  m=''1119780''>So</span> <span m=''1119940''>some</span> <span m=''1120200''>tools
  --</span> <span m=''1120460''>have</span> <span m=''1120560''>any</span> <span m=''1120700''>of
  you</span> <span m=''1121090''>used</span> <span m=''1121310''>these</span> <span
  m=''1121460''>tools?</span> <span m=''1121860''>Anybody use</span> <span m=''1122440''>Gprof,</span>
  <span m=''1122600''>for</span> <span m=''1122970''>example?</span> <span m=''1125320''>Good.</span>
  <span m=''1125520''>So,</span> <span m=''1126340''>you</span> <span m=''1126480''>might</span>
  <span m=''1126620''>have</span> <span m=''1126790''>an</span> <span m=''1126870''>idea</span>
  <span m=''1127240''>of</span> <span m=''1127790''>how</span> <span m=''1127980''>these</span>
  <span m=''1128180''>could</span> <span m=''1128320''>be</span> <span m=''1128870''>used.</span>
  <span m=''1129790''>There</span> <span m=''1129990''>are</span> <span m=''1130050''>others.</span>
  <span m=''1130870''>HPCToolkit,</span> <span m=''1131900''>which</span> <span m=''1132200''>I</span>
  <span m=''1132390''>commonly</span> <span m=''1132760''>use</span> <span m=''1133040''>from</span>
  <span m=''1133390''>Rice.</span> <span m=''1134740''>Pappy</span> <span m=''1135190''>is</span>
  <span m=''1135410''>very</span> <span m=''1135740''>common</span> <span m=''1136510''>because</span>
  <span m=''1136730''>it</span> <span m=''1136800''>has</span> <span m=''1136940''>a</span>
  <span m=''1136970''>very</span> <span m=''1137170''>nice</span> <span m=''1137370''>interface</span>
  <span m=''1137820''>for</span> <span m=''1137940''>grabbing</span> <span m=''1138260''>all</span>
  <span m=''1138370''>kinds</span> <span m=''1138600''>of</span> <span m=''1138660''>counters.</span>
  <span m=''1139430''>VTune</span> <span m=''1139900''>from</span> <span m=''1140070''>Intel,</span>
  <span m=''1140690''>and</span> <span m=''1141350''>there''s</span> <span m=''1141770''>others</span>
  <span m=''1142150''>that</span> <span m=''1142280''>work</span> <span m=''1142530''>in</span>
  <span m=''1142730''>different</span> <span m=''1143010''>ways</span> <span m=''1143360''>and</span>
  <span m=''1143570''>so</span> <span m=''1143930''>there are</span> <span m=''1144110''>binary</span>
  <span m=''1144580''>instrumenters</span> <span m=''1145480''>that</span> <span m=''1145610''>do</span>
  <span m=''1145760''>the</span> <span m=''1145820''>same</span> <span m=''1146070''>things</span>
  <span m=''1146390''>and</span> <span m=''1146520''>do</span> <span m=''1146630''>it</span>
  <span m=''1147000''>slightly</span> <span m=''1147270''>more</span> <span m=''1147440''>efficiently</span>
  <span m=''1147940''>and</span> <span m=''1148390''>actually</span> <span m=''1148730''>give</span>
  <span m=''1148900''>you</span> <span m=''1148980''>the</span> <span m=''1149080''>ability</span>
  <span m=''1149510''>to</span> <span m=''1149700''>compile</span> <span m=''1150290''>your</span>
  <span m=''1150430''>code</span> <span m=''1150730''>at</span> <span m=''1150820''>run</span>
  <span m=''1150980''>time and</span> <span m=''1151350''>optimize</span> <span m=''1151820''>it,</span>
  <span m=''1152260''>taking</span> <span m=''1152520''>advantage</span> <span m=''1153040''>of</span>
  <span m=''1153190''>the</span> <span m=''1153300''>profiling</span> <span m=''1153780''>information</span>
  <span m=''1154230''>you''ve</span> <span m=''1154370''>collected.</span> </p><p><span
  m=''1156570''>So</span> <span m=''1156710''>here''s</span> <span m=''1157010''>a</span>
  <span m=''1157260''>sample</span> <span m=''1157740''>of</span> <span m=''1158410''>running</span>
  <span m=''1159070''>Gprof.</span> <span m=''1160670''>Gprof</span> <span m=''1161180''>should</span>
  <span m=''1161290''>be</span> <span m=''1161380''>available</span> <span m=''1161770''>on</span>
  <span m=''1161930''>any</span> <span m=''1162360''>Linux</span> <span m=''1162570''>system,</span>
  <span m=''1163110''>it''s</span> <span m=''1163290''>even</span> <span m=''1163670''>available</span>
  <span m=''1164100''>on</span> <span m=''1164220''>Cygwin,</span> <span m=''1164600''>if</span>
  <span m=''1164700''>you</span> <span m=''1164850''>see</span> <span m=''1165060''>Cygwin.</span>
  <span m=''1167080''>I''ve</span> <span m=''1167250''>compiled</span> <span m=''1167650''>some</span>
  <span m=''1167780''>code --</span> <span m=''1168220''>this</span> <span m=''1168390''>is</span>
  <span m=''1168480''>MPEG</span> <span m=''1168910''>2D</span> <span m=''1169070''>code,
  a</span> <span m=''1169350''>reference</span> <span m=''1169730''>implementation.</span>
  <span m=''1171530''>I</span> <span m=''1171650''>specify</span> <span m=''1172150''>some</span>
  <span m=''1172330''>parameters</span> <span m=''1172760''>to</span> <span m=''1172860''>run</span>
  <span m=''1173060''>it.</span> <span m=''1173950''>Here</span> <span m=''1174530''>I</span>
  <span m=''1174850''>add this</span> <span m=''1175140''>dash</span> <span m=''1175480''>Rflag</span>
  <span m=''1176110''>which</span> <span m=''1176280''>says</span> <span m=''1177670''>use</span>
  <span m=''1177970''>a</span> <span m=''1178030''>particular</span> <span m=''1178830''>kind</span>
  <span m=''1179140''>of</span> <span m=''1179250''>inverse</span> <span m=''1179700''>DCDT</span>
  <span m=''1180290''>that''s</span> <span m=''1180930''>a</span> <span m=''1181060''>floating</span>
  <span m=''1181120''>point</span> <span m=''1181410''>precise</span> <span m=''1181850''>that</span>
  <span m=''1182010''>uses</span> <span m=''1182290''>double</span> <span m=''1182500''>precision</span>
  <span m=''1183260''>for</span> <span m=''1183570''>the</span> <span m=''1183790''>floating
  point</span> <span m=''1183920''>computations</span> <span m=''1184620''>in</span>
  <span m=''1184970''>DCT</span> <span m=''1185120''>--</span> <span m=''1186640''>inverse</span>
  <span m=''1186970''>DCT</span> <span m=''1187390''>rather.</span> <span m=''1188210''>So</span>
  <span m=''1188270''>you</span> <span m=''1188380''>can</span> <span m=''1188520''>see</span>
  <span m=''1188860''>actually</span> <span m=''1189710''>where</span> <span m=''1189900''>most</span>
  <span m=''1190160''>of</span> <span m=''1190220''>the</span> <span m=''1190280''>time</span>
  <span m=''1190570''>is</span> <span m=''1190670''>being</span> <span m=''1190890''>spent</span>
  <span m=''1191150''>in</span> <span m=''1191240''>the</span> <span m=''1191320''>computation.</span>
  <span m=''1192380''>So</span> <span m=''1192680''>here''s</span> <span m=''1192960''>a</span>
  <span m=''1193030''>time</span> <span m=''1193800''>per</span> <span m=''1194000''>function,</span>
  <span m=''1194740''>so</span> <span m=''1194900''>each</span> <span m=''1195120''>row</span>
  <span m=''1195270''>represents</span> <span m=''1195650''>a</span> <span m=''1195730''>function.</span>
  <span m=''1199020''>So</span> <span m=''1199250''>this</span> <span m=''1199440''>is</span>
  <span m=''1199660''>the</span> <span m=''1203870''>percent</span> <span m=''1204200''>of</span>
  <span m=''1204270''>the</span> <span m=''1204350''>time,</span> <span m=''1204950''>this</span>
  <span m=''1205100''>is</span> <span m=''1205190''>the</span> <span m=''1205270''>actual</span>
  <span m=''1205600''>time</span> <span m=''1205860''>in</span> <span m=''1206000''>seconds,</span>
  <span m=''1206700''>how</span> <span m=''1206820''>many</span> <span m=''1206940''>times</span>
  <span m=''1207220''>I</span> <span m=''1207300''>actually</span> <span m=''1207650''>called</span>
  <span m=''1207990''>this function,</span> <span m=''1209450''>and</span> <span m=''1209620''>some</span>
  <span m=''1209770''>other</span> <span m=''1209970''>useful</span> <span m=''1210290''>things.</span>
  <span m=''1210800''>So</span> <span m=''1211040''>the</span> <span m=''1211140''>second</span>
  <span m=''1212000''>function</span> <span m=''1212520''>that''s</span> <span m=''1213030''>used</span>
  <span m=''1213400''>here</span> <span m=''1213700''>that</span> <span m=''1213840''>happens</span>
  <span m=''1215040''>is</span> <span m=''1215460''>MPEG</span> <span m=''1215920''>intrablock</span>
  <span m=''1217090''>decoding</span> <span m=''1217560''>and</span> <span m=''1217730''>here</span>
  <span m=''1217920''>you''re</span> <span m=''1218060''>doing</span> <span m=''1218230''>some</span>
  <span m=''1218410''>spatial</span> <span m=''1218770''>decomposition,</span> <span
  m=''1220030''>restoring</span> <span m=''1220520''>spatial</span> <span m=''1220850''>pictures</span>
  <span m=''1221510''>by</span> <span m=''1221760''>5%.</span> <span m=''1222730''>So</span>
  <span m=''1222860''>if</span> <span m=''1222950''>you</span> <span m=''1223040''>were</span>
  <span m=''1223200''>optimize</span> <span m=''1223790''>this</span> <span m=''1224460''>particular</span>
  <span m=''1224800''>code,</span> <span m=''1225090''>where</span> <span m=''1225230''>would</span>
  <span m=''1225340''>you</span> <span m=''1225420''>go</span> <span m=''1225570''>look?</span>
  <span m=''1229520''>You would</span> <span m=''1229700''>look</span> <span m=''1229920''>in</span>
  <span m=''1230060''>the</span> <span m=''1230430''>reference</span> <span m=''1230850''>DCT.</span>
  </p><p><span m=''1231950''>So,</span> <span m=''1232810''>MPEG</span> <span m=''1233300''>has</span>
  <span m=''1233750''>two</span> <span m=''1233870''>versions</span> <span m=''1234240''>of</span>
  <span m=''1234340''>DCT --</span> <span m=''1234900''>one</span> <span m=''1235610''>that</span>
  <span m=''1235760''>uses</span> <span m=''1236040''>floating</span> <span m=''1236360''>point,</span>
  <span m=''1236890''>another</span> <span m=''1237220''>that</span> <span m=''1237350''>just</span>
  <span m=''1237570''>uses</span> <span m=''1237810''>some</span> <span m=''1238450''>numerical</span>
  <span m=''1239110''>tricks</span> <span m=''1239800''>to</span> <span m=''1240060''>operate</span>
  <span m=''1240460''>over</span> <span m=''1240660''>integers</span> <span m=''1241700''>for
  a</span> <span m=''1241970''>loss</span> <span m=''1242160''>of</span> <span m=''1242240''>precision,</span>
  <span m=''1242810''>but</span> <span m=''1242950''>they</span> <span m=''1243070''>find</span>
  <span m=''1243350''>that</span> <span m=''1243460''>acceptable</span> <span m=''1244260''>as</span>
  <span m=''1244580''>part</span> <span m=''1244860''>of</span> <span m=''1246640''>this</span>
  <span m=''1246780''>application.</span> <span m=''1247670''>So</span> <span m=''1248770''>you</span>
  <span m=''1248940''>omit</span> <span m=''1249220''>the</span> <span m=''1249410''>Rflag,
  it</span> <span m=''1249750''>actually</span> <span m=''1250090''>uses</span> <span
  m=''1250200''>a</span> <span m=''1250270''>different</span> <span m=''1250640''>function</span>
  <span m=''1251600''>for</span> <span m=''1251810''>doing</span> <span m=''1252470''>the</span>
  <span m=''1252690''>DCT.</span> <span m=''1253760''>Now</span> <span m=''1253900''>you</span>
  <span m=''1254070''>see</span> <span m=''1254230''>the</span> <span m=''1254310''>distribution</span>
  <span m=''1254940''>of</span> <span m=''1255260''>where</span> <span m=''1255530''>the</span>
  <span m=''1255630''>time is</span> <span m=''1255930''>spent</span> <span m=''1256270''>in</span>
  <span m=''1256330''>your</span> <span m=''1256460''>computation</span> <span m=''1256970''>changes.</span>
  <span m=''1257780''>Now</span> <span m=''1258030''>there''s</span> <span m=''1258240''>a</span>
  <span m=''1258280''>new</span> <span m=''1258390''>function</span> <span m=''1258780''>that''s</span>
  <span m=''1259370''>become</span> <span m=''1259650''>the</span> <span m=''1259720''>bottleneck</span>
  <span m=''1260100''>and</span> <span m=''1260660''>it''s</span> <span m=''1260760''>called</span>
  <span m=''1261090''>Form</span> <span m=''1261360''>Component</span> <span m=''1261740''>Prediction.</span>
  <span m=''1262810''>Then</span> <span m=''1263640''>IDCT</span> <span m=''1264230''>column,</span>
  <span m=''1264770''>which</span> <span m=''1265010''>actually</span> <span m=''1265430''>is</span>
  <span m=''1265630''>the</span> <span m=''1265710''>main</span> <span m=''1266550''>replacement</span>
  <span m=''1267240''>of</span> <span m=''1267450''>the</span> <span m=''1267530''>previous</span>
  <span m=''1267880''>code,</span> <span m=''1269020''>this</span> <span m=''1269310''>one,</span>
  <span m=''1269700''>is</span> <span m=''1269890''>now</span> <span m=''1270130''>about</span>
  <span m=''1270390''>1/3</span> <span m=''1270750''>of</span> <span m=''1270860''>the</span>
  <span m=''1270930''>actual</span> <span m=''1271200''>computation.</span> </p><p><span
  m=''1272250''>So,</span> <span m=''1272860''>this</span> <span m=''1272980''>could</span>
  <span m=''1273220''>be</span> <span m=''1273320''>useful</span> <span m=''1273520''>because</span>
  <span m=''1273920''>you</span> <span m=''1274070''>can</span> <span m=''1274440''>Gprof</span>
  <span m=''1274980''>your</span> <span m=''1275090''>application,</span> <span m=''1275780''>figure</span>
  <span m=''1276080''>out</span> <span m=''1276210''>where</span> <span m=''1276680''>the</span>
  <span m=''1276760''>bottlenecks</span> <span m=''1277240''>are in</span> <span m=''1277510''>terms</span>
  <span m=''1277700''>of</span> <span m=''1277770''>performance,</span> <span m=''1278680''>and
  you</span> <span m=''1278850''>might</span> <span m=''1279010''>go</span> <span
  m=''1279270''>in</span> <span m=''1279390''>there</span> <span m=''1279610''>and</span>
  <span m=''1280230''>tweak</span> <span m=''1280560''>the</span> <span m=''1280680''>algorithm</span>
  <span m=''1280980''>completely.</span> <span m=''1282030''>You</span> <span m=''1282190''>might</span>
  <span m=''1282300''>go</span> <span m=''1282490''>in</span> <span m=''1282620''>there</span>
  <span m=''1282780''>and</span> <span m=''1282930''>sort</span> <span m=''1283080''>of</span>
  <span m=''1283210''>look</span> <span m=''1283440''>at</span> <span m=''1283570''>some</span>
  <span m=''1283720''>problems</span> <span m=''1284140''>that</span> <span m=''1284260''>might</span>
  <span m=''1284550''>be</span> <span m=''1285360''>implementation</span> <span m=''1286080''>bugs</span>
  <span m=''1286380''>or</span> <span m=''1286460''>performance</span> <span m=''1286940''>bugs</span>
  <span m=''1287610''>and</span> <span m=''1288020''>be</span> <span m=''1288120''>able</span>
  <span m=''1288290''>to</span> <span m=''1288390''>fix</span> <span m=''1288610''>those.</span>
  </p><p><span m=''1290580''>Any</span> <span m=''1290730''>questions</span> <span
  m=''1291110''>on</span> <span m=''1291660''>that?</span> </p><p><span m=''1294150''>You</span>
  <span m=''1294280''>can</span> <span m=''1294660''>do</span> <span m=''1295040''>sort
  of</span> <span m=''1295540''>more</span> <span m=''1295780''>accurate</span> <span
  m=''1296100''>things.</span> <span m=''1296340''>So,</span> <span m=''1296500''>Gprof</span>
  <span m=''1297120''>largely</span> <span m=''1297520''>uses</span> <span m=''1300150''>one</span>
  <span m=''1300310''>mechanism,</span> <span m=''1300780''>HPCToolkit</span> <span
  m=''1301930''>uses</span> <span m=''1302300''>the</span> <span m=''1302420''>performance</span>
  <span m=''1302880''>counters to</span> <span m=''1303560''>actually</span> <span
  m=''1303910''>give</span> <span m=''1304090''>you</span> <span m=''1304270''>more</span>
  <span m=''1304590''>finer</span> <span m=''1304950''>grade</span> <span m=''1307140''>measurements</span>
  <span m=''1307650''>if</span> <span m=''1307790''>you</span> <span m=''1307870''>want</span>
  <span m=''1308100''>them.</span> <span m=''1308810''>So,</span> <span m=''1309250''>in</span>
  <span m=''1309410''>the</span> <span m=''1309510''>HPCToolkit,</span> <span m=''1310890''>you</span>
  <span m=''1311210''>run</span> <span m=''1311390''>your</span> <span m=''1311500''>program</span>
  <span m=''1312340''>in</span> <span m=''1312460''>the</span> <span m=''1312540''>same</span>
  <span m=''1312760''>way.</span> <span m=''1313340''>You</span> <span m=''1313440''>have</span>
  <span m=''1313600''>MPEG</span> <span m=''1313970''>2D</span> <span m=''1314210''>code,</span>
  <span m=''1315240''>dash</span> <span m=''1315570''>dash</span> <span m=''1315800''>just</span>
  <span m=''1315970''>says</span> <span m=''1316300''>this</span> <span m=''1316460''>is</span>
  <span m=''1316560''>where</span> <span m=''1317130''>the parameters</span> <span
  m=''1317770''>are</span> <span m=''1318330''>to</span> <span m=''1318510''>impact</span>
  <span m=''1318790''>2D code</span> <span m=''1319900''>following</span> <span m=''1320340''>that</span>
  <span m=''1320520''>dash</span> <span m=''1320740''>dash,</span> <span m=''1321270''>and</span>
  <span m=''1321400''>you</span> <span m=''1321480''>can</span> <span m=''1321620''>add</span>
  <span m=''1321880''>some</span> <span m=''1322060''>parameters</span> <span m=''1322630''>in</span>
  <span m=''1322770''>there</span> <span m=''1322940''>that</span> <span m=''1323090''>say</span>
  <span m=''1323290''>these are</span> <span m=''1323550''>counters</span> <span m=''1323930''>I''m</span>
  <span m=''1324060''>interested</span> <span m=''1324420''>in</span> <span m=''1324510''>measuring.</span>
  <span m=''1325450''>So</span> <span m=''1325670''>the</span> <span m=''1325770''>first</span>
  <span m=''1326080''>one</span> <span m=''1326330''>is</span> <span m=''1326510''>total</span>
  <span m=''1326820''>cycles.</span> <span m=''1328160''>The</span> <span m=''1328280''>second</span>
  <span m=''1328580''>one</span> <span m=''1328750''>is the</span> <span m=''1329200''>L1,</span>
  <span m=''1330010''>so</span> <span m=''1330090''>primary</span> <span m=''1330540''>cache</span>
  <span m=''1331620''>load</span> <span m=''1332100''>misses.</span> <span m=''1333180''>Then</span>
  <span m=''1333530''>you</span> <span m=''1333630''>might</span> <span m=''1333800''>want</span>
  <span m=''1333990''>to count the</span> <span m=''1334330''>floating</span> <span
  m=''1334610''>point</span> <span m=''1334850''>instructions</span> <span m=''1335650''>and</span>
  <span m=''1335800''>the</span> <span m=''1335840''>total</span> <span m=''1336140''>instructions.</span>
  <span m=''1337110''>As</span> <span m=''1337390''>you</span> <span m=''1337460''>run</span>
  <span m=''1337620''>your</span> <span m=''1337710''>program</span> <span m=''1338250''>you</span>
  <span m=''1338350''>actually</span> <span m=''1338680''>get</span> <span m=''1338850''>a</span>
  <span m=''1338900''>profiling</span> <span m=''1339490''>output,</span> <span m=''1340560''>and</span>
  <span m=''1340790''>then</span> <span m=''1340930''>you</span> <span m=''1341080''>can</span>
  <span m=''1341250''>process</span> <span m=''1341760''>that</span> <span m=''1341970''>file</span>
  <span m=''1342570''>and</span> <span m=''1343060''>it''ll</span> <span m=''1343290''>spit</span>
  <span m=''1343550''>out</span> <span m=''1343760''>some</span> <span m=''1344260''>summaries</span>
  <span m=''1344670''>for</span> <span m=''1344840''>you.</span> <span m=''1345220''>So
  it''ll</span> <span m=''1345380''>tell</span> <span m=''1345580''>you</span> <span
  m=''1346400''>this</span> <span m=''1346550''>is</span> <span m=''1346710''>the</span>
  <span m=''1346780''>total</span> <span m=''1347050''>number</span> <span m=''1347290''>of</span>
  <span m=''1347400''>cycles,</span> <span m=''1348100''>698</span> <span m=''1348920''>samples</span>
  <span m=''1349720''>with</span> <span m=''1349900''>this</span> <span m=''1350010''>frequency.</span>
  <span m=''1350580''>So</span> <span m=''1350700''>if</span> <span m=''1350800''>you</span>
  <span m=''1350890''>multiply</span> <span m=''1351290''>the</span> <span m=''1351400''>two</span>
  <span m=''1351550''>together,</span> <span m=''1352200''>you</span> <span m=''1352360''>an</span>
  <span m=''1352470''>idea</span> <span m=''1352710''>of</span> <span m=''1352820''>how</span>
  <span m=''1352930''>many</span> <span m=''1353080''>cycles</span> <span m=''1353500''>your</span>
  <span m=''1353610''>computation</span> <span m=''1354150''>took.</span> <span m=''1356590''>How</span>
  <span m=''1356710''>many</span> <span m=''1357200''>load</span> <span m=''1357410''>misses?</span>
  <span m=''1358230''>So it''s</span> <span m=''1358460''>27</span> <span m=''1358990''>samples</span>
  <span m=''1359900''>at</span> <span m=''1360050''>this</span> <span m=''1360250''>frequency.</span>
  </p><p><span m=''1360910''>So</span> <span m=''1361040''>remember</span> <span m=''1361340''>what''s</span>
  <span m=''1361510''>going</span> <span m=''1361740''>on</span> <span m=''1361900''>here</span>
  <span m=''1362210''>is</span> <span m=''1362390''>the</span> <span m=''1362480''>counter</span>
  <span m=''1362840''>is</span> <span m=''1363040''>measuring</span> <span m=''1364330''>events,</span>
  <span m=''1364900''>and</span> <span m=''1365300''>when</span> <span m=''1365430''>the</span>
  <span m=''1365610''>event</span> <span m=''1365760''>reaches</span> <span m=''1366080''>a</span>
  <span m=''1366140''>particular</span> <span m=''1366510''>threshold</span> <span
  m=''1366920''>it</span> <span m=''1367090''>let''s</span> <span m=''1367250''>you</span>
  <span m=''1367400''>know.</span> <span m=''1367980''>So</span> <span m=''1369050''>here
  the</span> <span m=''1369320''>sampling</span> <span m=''1369700''>threshold</span>
  <span m=''1370410''>is</span> <span m=''1370800''>32,000.</span> <span m=''1372170''>So</span>
  <span m=''1372280''>whenever</span> <span m=''1372660''>32,000</span> <span m=''1373660''>floating</span>
  <span m=''1373930''>point</span> <span m=''1374150''>instructions</span> <span m=''1374580''>occur</span>
  <span m=''1374890''>you</span> <span m=''1374960''>get</span> <span m=''1375080''>a</span>
  <span m=''1375130''>sample.</span> <span m=''1375880''>So you''re</span> <span m=''1376090''>just</span>
  <span m=''1376250''>counting</span> <span m=''1376820''>how</span> <span m=''1377030''>many</span>
  <span m=''1377190''>interrupts</span> <span m=''1377510''>you''re</span> <span m=''1377620''>getting
  or</span> <span m=''1377870''>how</span> <span m=''1378020''>many</span> <span m=''1378150''>samples.</span>
  <span m=''1378810''>So</span> <span m=''1378920''>you</span> <span m=''1379010''>multiply</span>
  <span m=''1379370''>the</span> <span m=''1379450''>two</span> <span m=''1379600''>together</span>
  <span m=''1379890''>you</span> <span m=''1380020''>can</span> <span m=''1380140''>get</span>
  <span m=''1380650''>the</span> <span m=''1380750''>final</span> <span m=''1381060''>counts.</span>
  </p><p><span m=''1382770''>It</span> <span m=''1382850''>can</span> <span m=''1382990''>do</span>
  <span m=''1383170''>things</span> <span m=''1383430''>like</span> <span m=''1383650''>Gprof,</span>
  <span m=''1384110''>it''ll</span> <span m=''1384300''>tell</span> <span m=''1384490''>you</span>
  <span m=''1385620''>where</span> <span m=''1385820''>your</span> <span m=''1385920''>time</span>
  <span m=''1386270''>is</span> <span m=''1386510''>and</span> <span m=''1387990''>where</span>
  <span m=''1388260''>you</span> <span m=''1388380''>spent</span> <span m=''1388560''>most</span>
  <span m=''1388760''>of</span> <span m=''1388840''>your</span> <span m=''1388970''>time.</span>
  <span m=''1389580''>Actually</span> <span m=''1389880''>breaks</span> <span m=''1390120''>it</span>
  <span m=''1390210''>down</span> <span m=''1390520''>into</span> <span m=''1391260''>your</span>
  <span m=''1391340''>module.</span> <span m=''1392230''>So,</span> <span m=''1392700''>MPEG</span>
  <span m=''1393220''>calls</span> <span m=''1393690''>some</span> <span m=''1393910''>standard</span>
  <span m=''1394230''>libraries,</span> <span m=''1394740''>libsi.</span> <span m=''1395620''>I</span>
  <span m=''1395850''>could</span> <span m=''1396020''>break</span> <span m=''1396220''>it</span>
  <span m=''1396300''>down</span> <span m=''1396480''>by</span> <span m=''1396610''>functions,</span>
  <span m=''1397880''>break</span> <span m=''1398060''>it</span> <span m=''1398120''>down</span>
  <span m=''1398270''>by</span> <span m=''1398400''>line</span> <span m=''1398660''>number.</span>
  <span m=''1399920''>You</span> <span m=''1399980''>can</span> <span m=''1400100''>even</span>
  <span m=''1400320''>annotate</span> <span m=''1400710''>your</span> <span m=''1400840''>source</span>
  <span m=''1401130''>code.</span> <span m=''1401800''>So</span> <span m=''1401960''>here''s</span>
  <span m=''1402290''>just</span> <span m=''1402500''>a</span> <span m=''1402650''>simple</span>
  <span m=''1402960''>example</span> <span m=''1404050''>that</span> <span m=''1404240''>I</span>
  <span m=''1404290''>used</span> <span m=''1404610''>earlier,</span> <span m=''1405510''>and</span>
  <span m=''1406810''>each</span> <span m=''1407010''>one</span> <span m=''1407170''>of</span>
  <span m=''1407260''>these</span> <span m=''1407410''>columns</span> <span m=''1407810''>represent</span>
  <span m=''1408310''>one</span> <span m=''1408460''>of</span> <span m=''1408530''>the</span>
  <span m=''1408600''>metrics</span> <span m=''1408960''>that</span> <span m=''1409090''>we</span>
  <span m=''1409190''>measured,</span> <span m=''1409940''>and</span> <span m=''1410120''>you</span>
  <span m=''1410190''>can</span> <span m=''1410320''>see</span> <span m=''1410700''>most</span>
  <span m=''1410940''>of</span> <span m=''1411010''>my</span> <span m=''1411120''>time</span>
  <span m=''1411380''>is</span> <span m=''1411480''>spent</span> <span m=''1412110''>here,</span>
  <span m=''1412630''>36%</span> <span m=''1413800''>at</span> <span m=''1413970''>this</span>
  <span m=''1414150''>particular</span> <span m=''1414600''>statement.</span> <span
  m=''1415460''>So that can be</span> <span m=''1415770''>very</span> <span m=''1415970''>useful.</span>
  <span m=''1417640''>You</span> <span m=''1417750''>can</span> <span m=''1417890''>go</span>
  <span m=''1418020''>in</span> <span m=''1418130''>there</span> <span m=''1418280''>and</span>
  <span m=''1418390''>say,</span> <span m=''1419570''>I</span> <span m=''1419670''>want</span>
  <span m=''1419890''>to</span> <span m=''1419970''>do</span> <span m=''1420110''>some</span>
  <span m=''1420280''>[? dization ?],</span> <span m=''1420820''>I</span> <span m=''1420890''>can</span>
  <span m=''1421360''>maybe</span> <span m=''1421620''>reduce</span> <span m=''1422040''>this</span>
  <span m=''1422400''>overhead</span> <span m=''1423410''>in</span> <span m=''1423540''>some</span>
  <span m=''1423710''>way</span> <span m=''1423850''>to</span> <span m=''1423990''>get</span>
  <span m=''1424740''>better</span> <span m=''1424960''>performance.</span> </p><p><span
  m=''1426330''>Any</span> <span m=''1426480''>questions</span> <span m=''1426800''>on</span>
  <span m=''1426900''>that?</span> <span m=''1428210''>Yup.</span> </p><p><span m=''1428520''>AUDIENCE:</span>
  <span m=''1428990''>[INAUDIBLE PHRASE]?</span> </p><p><span m=''1431210''>PROFESSOR:
  I</span> <span m=''1431730''>don''t</span> <span m=''1431980''>know.</span> <span
  m=''1434820''>Unfortunately, I</span> <span m=''1435290''>don''t know the</span>
  <span m=''1435540''>answer to that.</span> </p><p><span m=''1439600''>There''s</span>
  <span m=''1440030''>some</span> <span m=''1440260''>nice</span> <span m=''1440520''>gooies</span>
  <span m=''1440800''>for</span> <span m=''1440940''>some of these</span> <span m=''1441280''>tools.</span>
  <span m=''1441450''>So</span> <span m=''1441690''>VTune</span> <span m=''1442120''>has</span>
  <span m=''1442270''>a</span> <span m=''1442320''>nice</span> <span m=''1442540''>interface.</span>
  <span m=''1443620''>I</span> <span m=''1443740''>use</span> <span m=''1443940''>HPCViewer.</span>
  <span m=''1446530''>I</span> <span m=''1446770''>use</span> <span m=''1446930''>HPCToolkit,</span>
  <span m=''1447890''>which</span> <span m=''1448080''>provides</span> <span m=''1448420''>HPCViewer,</span>
  <span m=''1449210''>so</span> <span m=''1449370''>I</span> <span m=''1449410''>just</span>
  <span m=''1449670''>grab the</span> <span m=''1450020''>screenshot</span> <span
  m=''1451300''>from</span> <span m=''1451500''>one of the</span> <span m=''1451840''>tutorials</span>
  <span m=''1452290''>on</span> <span m=''1452450''>this.</span> <span m=''1454200''>You</span>
  <span m=''1454380''>have</span> <span m=''1454500''>your</span> <span m=''1454600''>source</span>
  <span m=''1454870''>code.</span> <span m=''1455960''>It</span> <span m=''1456090''>shows</span>
  <span m=''1456400''>you</span> <span m=''1456510''>some</span> <span m=''1456680''>of</span>
  <span m=''1456740''>the</span> <span m=''1456800''>same</span> <span m=''1456980''>information</span>
  <span m=''1457470''>I</span> <span m=''1457520''>had on a</span> <span m=''1457830''>previous</span>
  <span m=''1458130''>slide,</span> <span m=''1458750''>but in a</span> <span m=''1458960''>nicer</span>
  <span m=''1459320''>graphical</span> <span m=''1459740''>format.</span> </p><p><span
  m=''1461950''>So,</span> <span m=''1463500''>now</span> <span m=''1463650''>I</span>
  <span m=''1463720''>have</span> <span m=''1464010''>all</span> <span m=''1464140''>this</span>
  <span m=''1464250''>information,</span> <span m=''1467110''>how</span> <span m=''1467220''>do</span>
  <span m=''1467320''>I</span> <span m=''1467380''>actually</span> <span m=''1467710''>improve
  the</span> <span m=''1468090''>performance?</span> <span m=''1469460''>Well,</span>
  <span m=''1469660''>if</span> <span m=''1469760''>you</span> <span m=''1469840''>look</span>
  <span m=''1470000''>at</span> <span m=''1470900''>what</span> <span m=''1471060''>is</span>
  <span m=''1471200''>the</span> <span m=''1471300''>performance</span> <span m=''1471770''>time</span>
  <span m=''1472090''>on</span> <span m=''1472250''>a uniprocessor,</span> <span m=''1473550''>it''s</span>
  <span m=''1473780''>time</span> <span m=''1474040''>spent</span> <span m=''1474270''>computing</span>
  <span m=''1475170''>plus</span> <span m=''1475430''>the</span> <span m=''1475520''>time</span>
  <span m=''1475790''>spent</span> <span m=''1476120''>waiting</span> <span m=''1476410''>for</span>
  <span m=''1476560''>data</span> <span m=''1477020''>or</span> <span m=''1477330''>waiting</span>
  <span m=''1477640''>for</span> <span m=''1477780''>some</span> <span m=''1478090''>other</span>
  <span m=''1478340''>things</span> <span m=''1478670''>to</span> <span m=''1478770''>complete.</span>
  <span m=''1480580''>You</span> <span m=''1480640''>have</span> <span m=''1480790''>instructional</span>
  <span m=''1481210''>level</span> <span m=''1481430''>parallels,</span> <span m=''1481810''>which</span>
  <span m=''1482020''>is</span> <span m=''1482130''>really</span> <span m=''1482360''>critical</span>
  <span m=''1482790''>for</span> <span m=''1482910''>uniprocessors,</span> <span m=''1484060''>and</span>
  <span m=''1484270''>architect</span> <span m=''1484740''>that</span> <span m=''1484830''>sort</span>
  <span m=''1485000''>of</span> <span m=''1485100''>spent</span> <span m=''1486800''>massive</span>
  <span m=''1487160''>amounts</span> <span m=''1487480''>of</span> <span m=''1487640''>effort</span>
  <span m=''1488100''>in</span> <span m=''1488320''>providing</span> <span m=''1488740''>multiple</span>
  <span m=''1489060''>functional</span> <span m=''1489500''>units,</span> <span m=''1490380''>deeply</span>
  <span m=''1490980''>pipeline</span> <span m=''1491570''>the</span> <span m=''1492220''>instruction</span>
  <span m=''1492610''>pipeline.</span> <span m=''1493900''>Doing</span> <span m=''1494130''>things</span>
  <span m=''1494330''>like</span> <span m=''1494460''>speculation,</span> <span m=''1495280''>prediction</span>
  <span m=''1496020''>to</span> <span m=''1496280''>keep that</span> <span m=''1496440''>instructional</span>
  <span m=''1496870''>level of</span> <span m=''1497080''>parallelism</span> <span
  m=''1498270''>number</span> <span m=''1498540''>high</span> <span m=''1498820''>so</span>
  <span m=''1498950''>you</span> <span m=''1499070''>can</span> <span m=''1499200''>get</span>
  <span m=''1499380''>really</span> <span m=''1499620''>good</span> <span m=''1499760''>performance.</span>
  </p><p><span m=''1501260''>You</span> <span m=''1501350''>can</span> <span m=''1501480''>do</span>
  <span m=''1501640''>things</span> <span m=''1501930''>like</span> <span m=''1502350''>looking</span>
  <span m=''1502610''>at</span> <span m=''1502710''>the</span> <span m=''1502790''>assembly</span>
  <span m=''1503140''>code</span> <span m=''1503490''>and</span> <span m=''1503630''>re-ordering</span>
  <span m=''1504060''>instructions</span> <span m=''1504700''>to</span> <span m=''1504800''>avoid</span>
  <span m=''1505440''>instruction</span> <span m=''1506000''>hazards</span> <span
  m=''1507080''>in</span> <span m=''1507230''>the</span> <span m=''1507300''>pipeline.</span>
  <span m=''1508360''>You</span> <span m=''1508540''>might</span> <span m=''1509520''>look</span>
  <span m=''1509720''>at</span> <span m=''1509900''>a</span> <span m=''1510040''>register</span>
  <span m=''1510410''>allocation.</span> <span m=''1511500''>But</span> <span m=''1511760''>that''s</span>
  <span m=''1512070''>really</span> <span m=''1512320''>very</span> <span m=''1512890''>low-hanging</span>
  <span m=''1513390''>fruit.</span> <span m=''1515510''>You</span> <span m=''1515620''>have</span>
  <span m=''1515710''>to</span> <span m=''1515790''>reach</span> <span m=''1516030''>really</span>
  <span m=''1516210''>high</span> <span m=''1516420''>to</span> <span m=''1516510''>grab</span>
  <span m=''1516750''>that</span> <span m=''1516870''>kind</span> <span m=''1517050''>of</span>
  <span m=''1517120''>fruit.</span> <span m=''1517910''>You''ll</span> <span m=''1518030''>actually,</span>
  <span m=''1518370''>unfortunately,</span> <span m=''1519270''>get</span> <span m=''1519430''>the</span>
  <span m=''1519520''>experience</span> <span m=''1519960''>that is</span> <span m=''1520200''>part</span>
  <span m=''1520380''>of</span> <span m=''1520480''>the</span> <span m=''1520560''>next</span>
  <span m=''1520780''>recitation.</span> <span m=''1521670''>So</span> <span m=''1521840''>apologies
  in</span> <span m=''1522410''>advance.</span> <span m=''1524020''>But</span> <span
  m=''1524140''>you''ll</span> <span m=''1524310''>see</span> <span m=''1524980''>that
  --</span> <span m=''1525300''>well</span> <span m=''1525440''>I''m</span> <span
  m=''1525520''>not</span> <span m=''1525640''>going to</span> <span m=''1525780''>talk</span>
  <span m=''1526000''>about</span> <span m=''1526180''>that.</span> <span m=''1526550''>Instead</span>
  <span m=''1526670''>I''m</span> <span m=''1526880''>going to</span> <span m=''1527020''>focus</span>
  <span m=''1527290''>about</span> <span m=''1527500''>some</span> <span m=''1527660''>things</span>
  <span m=''1527930''>that</span> <span m=''1528040''>are</span> <span m=''1528460''>perhaps</span>
  <span m=''1529010''>lower-hanging</span> <span m=''1529500''>fruit.</span> </p><p><span
  m=''1530220''>So</span> <span m=''1530400''>data</span> <span m=''1530690''>level</span>
  <span m=''1530900''>parallelism.</span> <span m=''1531430''>So</span> <span m=''1531720''>we''ve</span>
  <span m=''1531880''>used</span> <span m=''1532170''>SIMD</span> <span m=''1533590''>in</span>
  <span m=''1535390''>some</span> <span m=''1535520''>of</span> <span m=''1535590''>recitations.
  I''m</span> <span m=''1536510''>giving</span> <span m=''1536710''>you a</span> <span
  m=''1536850''>short</span> <span m=''1537120''>example</span> <span m=''1537530''>of</span>
  <span m=''1537640''>that.</span> <span m=''1538080''>Here,</span> <span m=''1538910''>I''m</span>
  <span m=''1539010''>going</span> <span m=''1539190''>to</span> <span m=''1539250''>talk</span>
  <span m=''1539490''>about</span> <span m=''1539700''>how</span> <span m=''1539800''>you</span>
  <span m=''1539920''>actually</span> <span m=''1540450''>get</span> <span m=''1541030''>data</span>
  <span m=''1541190''>level</span> <span m=''1541360''>parallelism</span> <span m=''1542000''>or</span>
  <span m=''1542080''>how</span> <span m=''1542220''>do</span> <span m=''1542300''>you</span>
  <span m=''1542380''>actually</span> <span m=''1542690''>find</span> <span m=''1543460''>the</span>
  <span m=''1543560''>SIMD</span> <span m=''1544510''>in</span> <span m=''1544670''>your</span>
  <span m=''1544770''>computation</span> <span m=''1545780''>so you</span> <span m=''1545910''>can</span>
  <span m=''1546110''>get</span> <span m=''1546320''>that</span> <span m=''1546720''>added</span>
  <span m=''1547180''>advantage.</span> <span m=''1548520''>Some</span> <span m=''1548780''>nice</span>
  <span m=''1549030''>things</span> <span m=''1549290''>about</span> <span m=''1550310''>data</span>
  <span m=''1550730''>level</span> <span m=''1551110''>parallelism</span> <span m=''1551280''>in</span>
  <span m=''1551350''>the</span> <span m=''1551420''>form</span> <span m=''1551650''>of</span>
  <span m=''1551730''>short</span> <span m=''1551980''>vector</span> <span m=''1552330''>instructions</span>
  <span m=''1553450''>is</span> <span m=''1553590''>that</span> <span m=''1553670''>the</span>
  <span m=''1553740''>harder</span> <span m=''1554040''>really</span> <span m=''1554290''>becomes</span>
  <span m=''1554560''>simpler.</span> <span m=''1555080''>You issue</span> <span m=''1555390''>one</span>
  <span m=''1555600''>instruction</span> <span m=''1556450''>and</span> <span m=''1557020''>that</span>
  <span m=''1557230''>same</span> <span m=''1557410''>instruction</span> <span m=''1558240''>operates</span>
  <span m=''1558660''>over</span> <span m=''1558860''>multiple</span> <span m=''1559260''>data</span>
  <span m=''1559470''>elements</span> <span m=''1560360''>and</span> <span m=''1561200''>you</span>
  <span m=''1561280''>get</span> <span m=''1561520''>better</span> <span m=''1561710''>instruction</span>
  <span m=''1562090''>bandwidth.</span> <span m=''1562620''>I</span> <span m=''1562740''>just</span>
  <span m=''1562880''>have</span> <span m=''1563000''>to</span> <span m=''1563120''>fetch</span>
  <span m=''1563350''>one</span> <span m=''1563530''>instruction</span> <span m=''1564280''>and</span>
  <span m=''1564440''>if</span> <span m=''1564510''>my</span> <span m=''1564670''>vector</span>
  <span m=''1564960''>lens</span> <span m=''1565140''>is</span> <span m=''1565300''>10,</span>
  <span m=''1565770''>than</span> <span m=''1565940''>that</span> <span m=''1566130''>effectively</span>
  <span m=''1566620''>does</span> <span m=''1566830''>10</span> <span m=''1567000''>instructions</span>
  <span m=''1567420''>for</span> <span m=''1567590''>me.</span> <span m=''1568280''>The</span>
  <span m=''1568600''>architecture</span> <span m=''1568820''>can</span> <span m=''1568940''>get</span>
  <span m=''1569080''>simpler,</span> <span m=''1569560''>reduces</span> <span m=''1569930''>the</span>
  <span m=''1570000''>complexity.</span> <span m=''1570880''>So it has</span> <span
  m=''1571120''>some</span> <span m=''1571180''>nice</span> <span m=''1571940''>advantages.</span>
  </p><p><span m=''1573880''>The</span> <span m=''1573980''>thing</span> <span m=''1574160''>to</span>
  <span m=''1574260''>go</span> <span m=''1574390''>after</span> <span m=''1574760''>is</span>
  <span m=''1575120''>the</span> <span m=''1575220''>memory</span> <span m=''1575470''>hierarchy.</span>
  <span m=''1576470''>This</span> <span m=''1576600''>is</span> <span m=''1576800''>because</span>
  <span m=''1577220''>of</span> <span m=''1577650''>that</span> <span m=''1578030''>speed</span>
  <span m=''1578450''>gap</span> <span m=''1579030''>that</span> <span m=''1579180''>we</span>
  <span m=''1579320''>showed</span> <span m=''1579690''>earlier</span> <span m=''1580040''>on</span>
  <span m=''1580270''>in the</span> <span m=''1580350''>course</span> <span m=''1581040''>between</span>
  <span m=''1581730''>memory</span> <span m=''1582020''>speed</span> <span m=''1582440''>and</span>
  <span m=''1582590''>processor</span> <span m=''1583030''>speed,</span> <span m=''1583740''>and</span>
  <span m=''1584020''>if</span> <span m=''1584130''>you</span> <span m=''1584220''>optimize</span>
  <span m=''1584670''>a</span> <span m=''1584720''>performance</span> <span m=''1585350''>usually</span>
  <span m=''1586260''>it''s</span> <span m=''1586400''>like</span> <span m=''1586540''>1%</span>
  <span m=''1587180''>performance</span> <span m=''1587680''>and</span> <span m=''1587780''>your</span>
  <span m=''1587870''>cache</span> <span m=''1588170''>registry </span> <span m=''1588840''>gives</span>
  <span m=''1589070''>you</span> <span m=''1591340''>some</span> <span m=''1591610''>significant</span>
  <span m=''1592200''>performance</span> <span m=''1592800''>improvement</span> <span
  m=''1593380''>in</span> <span m=''1593590''>your</span> <span m=''1594580''>overall</span>
  <span m=''1594960''>execution.</span> <span m=''1596600''>So</span> <span m=''1596750''>you</span>
  <span m=''1596870''>want</span> <span m=''1597080''>to</span> <span m=''1597520''>go</span>
  <span m=''1597640''>after</span> <span m=''1597880''>that</span> <span m=''1598080''>because</span>
  <span m=''1598400''>that''s</span> <span m=''1598710''>the</span> <span m=''1598880''>biggest</span>
  <span m=''1599230''>beast</span> <span m=''1599550''>in the room.</span> </p><p><span
  m=''1603540''>A brief overview</span> <span m=''1604070''>of</span> <span m=''1604300''>SIMD</span>
  <span m=''1604710''>and</span> <span m=''1604890''>then</span> <span m=''1605490''>some</span>
  <span m=''1605730''>detailed</span> <span m=''1606480''>examples</span> <span m=''1607070''>as</span>
  <span m=''1607230''>to</span> <span m=''1607350''>how</span> <span m=''1607450''>you</span>
  <span m=''1607610''>actually</span> <span m=''1607980''>go</span> <span m=''1608140''>about</span>
  <span m=''1608370''>extracting</span> <span m=''1609220''>short</span> <span m=''1609480''>vector</span>
  <span m=''1609740''>instructions.</span> </p><p><span m=''1611520''>So,</span> <span
  m=''1612190''>here</span> <span m=''1612360''>we</span> <span m=''1612450''>have</span>
  <span m=''1612710''>an</span> <span m=''1612780''>example of</span> <span m=''1613230''>scaleacode.</span>
  <span m=''1614700''>We''re</span> <span m=''1614910''>iterating</span> <span m=''1615450''>in</span>
  <span m=''1615580''>a</span> <span m=''1615630''>loop</span> <span m=''1615870''>from</span>
  <span m=''1616490''>zero</span> <span m=''1616640''>to</span> <span m=''1617070''>n,</span>
  <span m=''1617690''>and</span> <span m=''1617780''>we''re</span> <span m=''1617900''>just</span>
  <span m=''1618920''>adding</span> <span m=''1619290''>some</span> <span m=''1619660''>array</span>
  <span m=''1619920''>elements</span> <span m=''1620290''>a</span> <span m=''1620930''>to
  b</span> <span m=''1621570''>and storing</span> <span m=''1622110''>results</span>
  <span m=''1622260''>in</span> <span m=''1622500''>c.</span> <span m=''1623330''>So
  in</span> <span m=''1623550''>the</span> <span m=''1623640''>scaler</span> <span
  m=''1624900''>mode,</span> <span m=''1625600''>we</span> <span m=''1625690''>just</span>
  <span m=''1625810''>have</span> <span m=''1626000''>one</span> <span m=''1626180''>add,</span>
  <span m=''1627330''>each</span> <span m=''1627570''>value</span> <span m=''1628050''>of
  a and</span> <span m=''1628370''>b is</span> <span m=''1628670''>one</span> <span
  m=''1628840''>register.</span> <span m=''1629610''>We add</span> <span m=''1629790''>those</span>
  <span m=''1630040''>together,</span> <span m=''1630380''>we</span> <span m=''1630490''>write</span>
  <span m=''1630680''>the</span> <span m=''1630760''>value</span> <span m=''1631090''>to</span>
  <span m=''1631560''>a</span> <span m=''1631740''>separate</span> <span m=''1632050''>register.</span>
  <span m=''1633090''>In</span> <span m=''1633280''>the</span> <span m=''1633340''>vector</span>
  <span m=''1633610''>mode,</span> <span m=''1635260''>we</span> <span m=''1635410''>can</span>
  <span m=''1635560''>pack</span> <span m=''1636320''>multiple</span> <span m=''1636780''>data</span>
  <span m=''1636960''>elements,</span> <span m=''1637420''>so</span> <span m=''1637540''>here</span>
  <span m=''1637850''>let''s</span> <span m=''1638000''>assume</span> <span m=''1638280''>our</span>
  <span m=''1638370''>vector</span> <span m=''1638660''>lens</span> <span m=''1638810''>is</span>
  <span m=''1638980''>four,</span> <span m=''1639700''>I</span> <span m=''1639820''>can
  pack</span> <span m=''1640380''>four</span> <span m=''1640740''>of these</span>
  <span m=''1640970''>data</span> <span m=''1641200''>values</span> <span m=''1641520''>into</span>
  <span m=''1641720''>one</span> <span m=''1641990''>vector</span> <span m=''1642250''>register.</span>
  <span m=''1643420''>You can</span> <span m=''1643500''>pack</span> <span m=''1643820''>four</span>
  <span m=''1644100''>of</span> <span m=''1644190''>these</span> <span m=''1644380''>data</span>
  <span m=''1644570''>elements</span> <span m=''1644970''>into</span> <span m=''1645230''>another</span>
  <span m=''1645510''>vector</span> <span m=''1645770''>register,</span> <span m=''1646460''>and</span>
  <span m=''1646640''>now</span> <span m=''1646810''>my</span> <span m=''1647270''>single</span>
  <span m=''1647650''>vector</span> <span m=''1647940''>instruction</span> <span m=''1648790''>has</span>
  <span m=''1649010''>the</span> <span m=''1649100''>effect</span> <span m=''1649460''>of</span>
  <span m=''1649680''>doing</span> <span m=''1650060''>four</span> <span m=''1650430''>ads</span>
  <span m=''1650680''>at th</span> <span m=''1650780''>same</span> <span m=''1651070''>time,</span>
  <span m=''1652010''>and</span> <span m=''1652220''>it</span> <span m=''1652290''>can</span>
  <span m=''1652380''>store</span> <span m=''1652630''>results</span> <span m=''1653290''>into</span>
  <span m=''1653690''>four</span> <span m=''1654050''>elements</span> <span m=''1654380''>of</span>
  <span m=''1654490''>c.</span> </p><p><span m=''1656940''>Any</span> <span m=''1657060''>questions</span>
  <span m=''1657390''>on</span> <span m=''1657480''>that?</span> </p><p><span m=''1657660''>AUDIENCE:</span>
  <span m=''1659616''>[UNINTELLIGIBLE]</span> </p><p><span m=''1664820''>PROFESSOR:
  No.</span> <span m=''1665310''>We''ll</span> <span m=''1665430''>get to</span> <span
  m=''1665590''>that.</span> </p><p><span m=''1669850''>So,</span> <span m=''1671630''>let''s</span>
  <span m=''1671860''>look</span> <span m=''1672050''>at</span> <span m=''1672170''>those
  to</span> <span m=''1672370''>sort</span> <span m=''1672520''>of</span> <span m=''1672750''>give</span>
  <span m=''1672920''>you a</span> <span m=''1673240''>more</span> <span m=''1674100''>lower</span>
  <span m=''1674390''>level</span> <span m=''1675010''>feel</span> <span m=''1675330''>for</span>
  <span m=''1675430''>this.</span> <span m=''1676030''>Same</span> <span m=''1676310''>code,</span>
  <span m=''1676870''>I''ve</span> <span m=''1677170''>just</span> <span m=''1677680''>shown</span>
  <span m=''1678960''>data</span> <span m=''1679160''>dependence</span> <span m=''1679700''>graph.</span>
  <span m=''1680270''>I''ve</span> <span m=''1680940''>omitted</span> <span m=''1681260''>things</span>
  <span m=''1681560''>like</span> <span m=''1682460''>the</span> <span m=''1683510''>increment</span>
  <span m=''1683960''>of</span> <span m=''1684100''>the</span> <span m=''1684180''>loop</span>
  <span m=''1684450''>and</span> <span m=''1684530''>the</span> <span m=''1684610''>branch,</span>
  <span m=''1685280''>just</span> <span m=''1685430''>focusing</span> <span m=''1685870''>on</span>
  <span m=''1686090''>the</span> <span m=''1686160''>main</span> <span m=''1686320''>computation.</span>
  <span m=''1687300''>So I</span> <span m=''1687470''>have</span> <span m=''1688030''>two</span>
  <span m=''1688220''>loads,</span> <span m=''1688630''>one</span> <span m=''1688860''>brings</span>
  <span m=''1689100''>a sub</span> <span m=''1689230''>i,</span> <span m=''1689650''>the</span>
  <span m=''1689730''>other</span> <span m=''1689890''>brings</span> <span m=''1690160''>b
  sub</span> <span m=''1690450''>i.</span> <span m=''1691040''>I</span> <span m=''1691170''>do</span>
  <span m=''1691320''>the</span> <span m=''1691460''>add</span> <span m=''1692010''>and</span>
  <span m=''1692190''>I</span> <span m=''1692240''>get</span> <span m=''1692440''>c</span>
  <span m=''1692590''>sub i</span> <span m=''1693120''>and</span> <span m=''1693250''>then</span>
  <span m=''1693370''>I</span> <span m=''1693420''>can</span> <span m=''1693570''>store</span>
  <span m=''1693860''>that.</span> <span m=''1694860''>So</span> <span m=''1694980''>that</span>
  <span m=''1695110''>might</span> <span m=''1695280''>be</span> <span m=''1695450''>sort</span>
  <span m=''1695630''>of a</span> <span m=''1695780''>generic</span> <span m=''1696420''>op</span>
  <span m=''1696820''>code</span> <span m=''1696920''>sequence</span> <span m=''1697390''>that</span>
  <span m=''1697490''>you</span> <span m=''1697600''>have.</span> <span m=''1698590''>If</span>
  <span m=''1698690''>you''re</span> <span m=''1698850''>scheduling</span> <span m=''1699470''>that,</span>
  <span m=''1700340''>then</span> <span m=''1700880''>in</span> <span m=''1700940''>the</span>
  <span m=''1701000''>first</span> <span m=''1701260''>slot</span> <span m=''1701480''>I</span>
  <span m=''1701540''>can</span> <span m=''1701700''>do</span> <span m=''1701830''>those</span>
  <span m=''1702050''>two</span> <span m=''1702180''>loads</span> <span m=''1702400''>in</span>
  <span m=''1702490''>parallel,</span> <span m=''1704130''>second</span> <span m=''1704420''>cycle</span>
  <span m=''1704670''>I</span> <span m=''1704730''>can</span> <span m=''1704840''>do</span>
  <span m=''1704920''>the</span> <span m=''1705040''>add,</span> <span m=''1705290''>third</span>
  <span m=''1705640''>cycle</span> <span m=''1705840''>I</span> <span m=''1706030''>can</span>
  <span m=''1706080''>do</span> <span m=''1706190''>the</span> <span m=''1706260''>store.</span>
  <span m=''1707160''>I</span> <span m=''1707290''>can</span> <span m=''1707970''>further</span>
  <span m=''1708360''>improve</span> <span m=''1708660''>this</span> <span m=''1708840''>performance.</span>
  <span m=''1709320''>If</span> <span m=''1709450''>you</span> <span m=''1709510''>took</span>
  <span m=''1709720''>6.035</span> <span m=''1710600''>you</span> <span m=''1710690''>might</span>
  <span m=''1710880''>see</span> <span m=''1711030''>software</span> <span m=''1711340''>pipelining,</span>
  <span m=''1712170''>you</span> <span m=''1712410''>can</span> <span m=''1712470''>actually</span>
  <span m=''1713320''>overlap</span> <span m=''1713900''>some</span> <span m=''1714060''>of</span>
  <span m=''1714180''>these</span> <span m=''1714340''>operations.</span> <span m=''1715280''>Not</span>
  <span m=''1715490''>really</span> <span m=''1715710''>that</span> <span m=''1715870''>important</span>
  <span m=''1716220''>here.</span> </p><p><span m=''1717750''>So,</span> <span m=''1718300''>what</span>
  <span m=''1718420''>would</span> <span m=''1718570''>the</span> <span m=''1719480''>cycle</span>
  <span m=''1720250''>or the</span> <span m=''1720470''>schedule</span> <span m=''1720820''>look</span>
  <span m=''1721020''>like</span> <span m=''1721720''>on</span> <span m=''1721900''>a</span>
  <span m=''1721970''>cycle-by-cycle</span> <span m=''1722680''>basis</span> <span
  m=''1723380''>if</span> <span m=''1723620''>this</span> <span m=''1723810''>was</span>
  <span m=''1724400''>defector</span> <span m=''1724780''>output?</span> <span m=''1728970''>In</span>
  <span m=''1729110''>the</span> <span m=''1729220''>scaler</span> <span m=''1729440''>case,</span>
  <span m=''1729750''>you</span> <span m=''1729870''>have</span> <span m=''1730400''>n</span>
  <span m=''1730620''>iterations,</span> <span m=''1731330''>right?</span> <span m=''1731600''>Each</span>
  <span m=''1731780''>iteration''s</span> <span m=''1732210''>taking</span> <span
  m=''1732490''>three</span> <span m=''1732670''>cycles</span> <span m=''1733420''>so</span>
  <span m=''1733550''>that''s</span> <span m=''1733690''>your</span> <span m=''1733800''>overall</span>
  <span m=''1734570''>execution</span> <span m=''1735170''>on</span> <span m=''1735270''>time
  --</span> <span m=''1735940''>n</span> <span m=''1736130''>times</span> <span m=''1736370''>3</span>
  <span m=''1736980''>cycles.</span> <span m=''1738770''>In the</span> <span m=''1738950''>vector</span>
  <span m=''1739210''>case,</span> <span m=''1740120''>each</span> <span m=''1740510''>load</span>
  <span m=''1741030''>is</span> <span m=''1741350''>bringing</span> <span m=''1741590''>you</span>
  <span m=''1741810''>four</span> <span m=''1742140''>data elements,</span> <span
  m=''1742980''>so</span> <span m=''1744570''>a</span> <span m=''1744720''>sub i</span>
  <span m=''1745290''>to</span> <span m=''1745440''>a sub i</span> <span m=''1745840''>plus</span>
  <span m=''1746040''>3.</span> <span m=''1747550''>Similarly</span> <span m=''1747950''>for</span>
  <span m=''1748210''>b.</span> <span m=''1749000''>Then</span> <span m=''1749090''>you</span>
  <span m=''1749400''>add those</span> <span m=''1749810''>together.</span> <span
  m=''1751470''>So</span> <span m=''1751630''>the</span> <span m=''1751700''>schedule
  would</span> <span m=''1752340''>look</span> <span m=''1752660''>essentially</span>
  <span m=''1753100''>the</span> <span m=''1753180''>same.</span> <span m=''1754060''>The</span>
  <span m=''1754160''>op</span> <span m=''1754380''>codes</span> <span m=''1754600''>are</span>
  <span m=''1754670''>different,</span> <span m=''1757020''>and</span> <span m=''1757480''>here</span>
  <span m=''1757790''>what</span> <span m=''1757970''>your</span> <span m=''1758850''>overall</span>
  <span m=''1759210''>execution</span> <span m=''1759650''>time</span> <span m=''1759930''>be?</span>
  </p><p><span m=''1760310''>Well,</span> <span m=''1760910''>what</span> <span m=''1761040''>I''ve</span>
  <span m=''1761170''>done</span> <span m=''1761400''>is</span> <span m=''1761810''>each</span>
  <span m=''1762250''>iteration is</span> <span m=''1762890''>now</span> <span m=''1763030''>doing</span>
  <span m=''1763400''>four</span> <span m=''1764530''>additions</span> <span m=''1764950''>for</span>
  <span m=''1765110''>me.</span> <span m=''1765700''>So</span> <span m=''1765870''>if</span>
  <span m=''1765970''>you</span> <span m=''1766060''>notice,</span> <span m=''1766420''>the</span>
  <span m=''1766510''>loop</span> <span m=''1766710''>bounds</span> <span m=''1767010''>have</span>
  <span m=''1767130''>changed.</span> <span m=''1767630''>Instead</span> <span m=''1767940''>of</span>
  <span m=''1768090''>going</span> <span m=''1768320''>from</span> <span m=''1768530''>i</span>
  <span m=''1769200''>to n</span> <span m=''1769880''>by</span> <span m=''1769970''>increments</span>
  <span m=''1770410''>of</span> <span m=''1770550''>1, now</span> <span m=''1771160''>I''m</span>
  <span m=''1771400''>going</span> <span m=''1771610''>by</span> <span m=''1771900''>increments</span>
  <span m=''1772060''>of</span> <span m=''1772160''>4.</span> <span m=''1774300''>So,</span>
  <span m=''1775290''>overall,</span> <span m=''1775860''>instead</span> <span m=''1776110''>of</span>
  <span m=''1776210''>having</span> <span m=''1776520''>n</span> <span m=''1776720''>iterations,</span>
  <span m=''1777340''>I</span> <span m=''1777480''>can</span> <span m=''1777630''>get</span>
  <span m=''1777750''>by</span> <span m=''1777940''>with</span> <span m=''1778140''>n</span>
  <span m=''1778320''>over</span> <span m=''1778520''>4</span> <span m=''1778890''>iterations.</span>
  <span m=''1779810''>That</span> <span m=''1779970''>make</span> <span m=''1780080''>sense?</span>
  <span m=''1782300''>So,</span> <span m=''1782570''>what</span> <span m=''1782750''>would</span>
  <span m=''1782960''>my</span> <span m=''1783100''>speed</span> <span m=''1783360''>up</span>
  <span m=''1783460''>be in</span> <span m=''1783680''>this</span> <span m=''1783770''>case?</span>
  <span m=''1792830''>4.</span> <span m=''1794230''>So</span> <span m=''1794620''>you</span>
  <span m=''1794790''>can</span> <span m=''1794910''>get</span> <span m=''1795230''>more
  and</span> <span m=''1795590''>more</span> <span m=''1795820''>speed</span> <span
  m=''1796120''>up</span> <span m=''1797010''>if</span> <span m=''1797430''>your</span>
  <span m=''1797560''>vector</span> <span m=''1797840''>lens is</span> <span m=''1798140''>longer,</span>
  <span m=''1799170''>because</span> <span m=''1799440''>then</span> <span m=''1799590''>I</span>
  <span m=''1799630''>can</span> <span m=''1799790''>cut</span> <span m=''1800040''>down</span>
  <span m=''1800230''>on the</span> <span m=''1800530''>number</span> <span m=''1800780''>of</span>
  <span m=''1800860''>iterations</span> <span m=''1801310''>that</span> <span m=''1801430''>I</span>
  <span m=''1801480''>need.</span> </p><p><span m=''1804310''>Depending</span> <span
  m=''1804800''>on the</span> <span m=''1805440''>length</span> <span m=''1805730''>of</span>
  <span m=''1805810''>my</span> <span m=''1805930''>vector</span> <span m=''1806230''>register</span>
  <span m=''1806820''>and</span> <span m=''1806930''>the</span> <span m=''1807010''>data</span>
  <span m=''1807270''>types</span> <span m=''1807500''>that</span> <span m=''1807620''>I</span>
  <span m=''1807690''>have,</span> <span m=''1808380''>that</span> <span m=''1808500''>effectively</span>
  <span m=''1809030''>gives</span> <span m=''1809400''>me</span> <span m=''1809560''>different</span>
  <span m=''1809920''>kinds</span> <span m=''1810200''>of</span> <span m=''1810280''>vector</span>
  <span m=''1810560''>lens</span> <span m=''1810810''>for</span> <span m=''1810950''>different</span>
  <span m=''1811250''>data</span> <span m=''1811440''>types.</span> <span m=''1812380''>So</span>
  <span m=''1812670''>you</span> <span m=''1812810''>saw</span> <span m=''1812990''>on</span>
  <span m=''1813200''>Cell</span> <span m=''1813510''>you</span> <span m=''1813650''>have</span>
  <span m=''1813810''>128</span> <span m=''1814450''>bit</span> <span m=''1814630''>registers</span>
  <span m=''1815380''>and</span> <span m=''1815620''>you</span> <span m=''1815700''>can</span>
  <span m=''1815860''>pack</span> <span m=''1816220''>those</span> <span m=''1816480''>with</span>
  <span m=''1816790''>bytes,</span> <span m=''1817520''>characters,</span> <span m=''1818650''>bytes,</span>
  <span m=''1819650''>shorts,</span> <span m=''1820110''>integers,</span> <span m=''1821720''>floats</span>
  <span m=''1822050''>or</span> <span m=''1822180''>doubles.</span> <span m=''1822700''>So</span>
  <span m=''1822900''>each</span> <span m=''1823060''>one</span> <span m=''1823230''>of</span>
  <span m=''1823340''>those</span> <span m=''1823910''>gives</span> <span m=''1824080''>you</span>
  <span m=''1824190''>different</span> <span m=''1824540''>kinds</span> <span m=''1824870''>of</span>
  <span m=''1825080''>a</span> <span m=''1825210''>different</span> <span m=''1825890''>vector</span>
  <span m=''1826190''>lens.</span> </p><p><span m=''1829750''>SIMD</span> <span m=''1830340''>is</span>
  <span m=''1830580''>really</span> <span m=''1830930''>now,</span> <span m=''1831430''>SIMD</span>
  <span m=''1831780''>extensions</span> <span m=''1832820''>are</span> <span m=''1832990''>increasingly</span>
  <span m=''1833480''>popular. They''re</span> <span m=''1833900''>available on</span>
  <span m=''1834320''>a</span> <span m=''1834380''>lot</span> <span m=''1834580''>of</span>
  <span m=''1834690''>ISAs.</span> <span m=''1837510''>Alt</span> <span m=''1837580''>of</span>
  <span m=''1837680''>x,</span> <span m=''1837990''>MMX,</span> <span m=''1839130''>SSE
  are</span> <span m=''1839880''>available on</span> <span m=''1840280''>a</span>
  <span m=''1840330''>lot</span> <span m=''1840500''>x86</span> <span m=''1841170''>machines.</span>
  <span m=''1841900''>And,</span> <span m=''1842150''>of</span> <span m=''1842270''>course,</span>
  <span m=''1842580''>in</span> <span m=''1842710''>Cell,</span> <span m=''1843600''>in</span>
  <span m=''1843670''>fact,</span> <span m=''1843920''>on the</span> <span m=''1844090''>SPU,</span>
  <span m=''1844590''>all</span> <span m=''1844790''>your</span> <span m=''1844930''>instructions</span>
  <span m=''1845400''>are</span> <span m=''1845490''>SIMD</span> <span m=''1845740''>instruction,</span>
  <span m=''1846500''>and</span> <span m=''1846710''>when</span> <span m=''1846880''>you''re</span>
  <span m=''1847000''>doing</span> <span m=''1847300''>a</span> <span m=''1847560''>scaler</span>
  <span m=''1847900''>instruction,</span> <span m=''1848340''>you''re</span> <span
  m=''1848460''>actually</span> <span m=''1848730''>using</span> <span m=''1849350''>just</span>
  <span m=''1849620''>one</span> <span m=''1850930''>chunk</span> <span m=''1851220''>of</span>
  <span m=''1851330''>your</span> <span m=''1851500''>vector</span> <span m=''1851780''>register</span>
  <span m=''1852850''>and</span> <span m=''1853020''>your</span> <span m=''1853120''>vector</span>
  <span m=''1853320''>pipeline.</span> </p><p><span m=''1856310''>So</span> <span
  m=''1856520''>how</span> <span m=''1856650''>do</span> <span m=''1856720''>you</span>
  <span m=''1856820''>actually</span> <span m=''1857210''>use</span> <span m=''1857600''>these</span>
  <span m=''1857840''>SIMD</span> <span m=''1858050''>instructions?</span> <span m=''1860000''>Unfortunately,</span>
  <span m=''1861650''>it''s</span> <span m=''1861890''>library</span> <span m=''1862250''>calls</span>
  <span m=''1863010''>or</span> <span m=''1863820''>using</span> <span m=''1864310''>inline</span>
  <span m=''1864720''>assembly</span> <span m=''1865190''>or</span> <span m=''1865520''>using</span>
  <span m=''1865810''>intrinsics.</span> <span m=''1867760''>You''ll</span> <span
  m=''1868000''>get</span> <span m=''1868170''>hands-on</span> <span m=''1868700''>experience</span>
  <span m=''1869160''>with</span> <span m=''1869300''>this</span> <span m=''1869470''>with</span>
  <span m=''1869620''>Cell,</span> <span m=''1869900''>so</span> <span m=''1870100''>you</span>
  <span m=''1870240''>might</span> <span m=''1872270''>complain</span> <span m=''1872690''>about</span>
  <span m=''1872890''>that</span> <span m=''1873130''>when</span> <span m=''1873660''>you</span>
  <span m=''1873720''>actually</span> <span m=''1873980''>do</span> <span m=''1874110''>it.</span>
  <span m=''1875090''>Compile</span> <span m=''1875430''>technology</span> <span m=''1875890''>is</span>
  <span m=''1876040''>actually</span> <span m=''1876370''>getting</span> <span m=''1876590''>better,</span>
  <span m=''1877140''>and</span> <span m=''1877520''>you''ll</span> <span m=''1877660''>see</span>
  <span m=''1877860''>that</span> <span m=''1878340''>one of the</span> <span m=''1878590''>reasons</span>
  <span m=''1878990''>we''re</span> <span m=''1879090''>using an</span> <span m=''1879650''>XLC</span>
  <span m=''1879950''>compiler</span> <span m=''1880790''>is</span> <span m=''1881050''>because</span>
  <span m=''1881480''>it</span> <span m=''1881670''>has</span> <span m=''1881980''>these</span>
  <span m=''1882190''>vector</span> <span m=''1882440''>data</span> <span m=''1882660''>types,</span>
  <span m=''1883690''>which</span> <span m=''1884050''>also</span> <span m=''1885000''>latest</span>
  <span m=''1885320''>versions</span> <span m=''1885630''>of</span> <span m=''1885690''>GCC</span>
  <span m=''1886200''>have</span> <span m=''1886760''>that</span> <span m=''1887420''>allow</span>
  <span m=''1887790''>you</span> <span m=''1887980''>to</span> <span m=''1888430''>express</span>
  <span m=''1888930''>data</span> <span m=''1889170''>types</span> <span m=''1889450''>as</span>
  <span m=''1889570''>vector data</span> <span m=''1890050''>types,</span> <span m=''1890340''>and</span>
  <span m=''1890400''>the</span> <span m=''1890470''>compiler</span> <span m=''1891350''>can</span>
  <span m=''1891510''>more</span> <span m=''1891740''>easily</span> <span m=''1892140''>or</span>
  <span m=''1892240''>more</span> <span m=''1892400''>naturally</span> <span m=''1893170''>get</span>
  <span m=''1893350''>the</span> <span m=''1893450''>parallelism</span> <span m=''1893910''>for</span>
  <span m=''1894140''>you,</span> <span m=''1894490''>SIMD</span> <span m=''1894580''>parallelism</span>
  <span m=''1895310''>with</span> <span m=''1895510''>you</span> <span m=''1895610''>having</span>
  <span m=''1895840''>to</span> <span m=''1895930''>go</span> <span m=''1896140''>in</span>
  <span m=''1896280''>there</span> <span m=''1896420''>and</span> <span m=''1896840''>do</span>
  <span m=''1896960''>it</span> <span m=''1897080''>by</span> <span m=''1897200''>hand.</span>
  </p><p><span m=''1898640''>But</span> <span m=''1898790''>if</span> <span m=''1898890''>you</span>
  <span m=''1898970''>were to</span> <span m=''1899210''>do</span> <span m=''1899320''>it</span>
  <span m=''1899430''>by</span> <span m=''1899540''>hand,</span> <span m=''1899950''>or,</span>
  <span m=''1900490''>in fact,</span> <span m=''1900880''>what</span> <span m=''1901030''>the</span>
  <span m=''1901110''>compilers</span> <span m=''1901650''>are trying</span> <span
  m=''1901970''>to automate</span> <span m=''1902960''>are</span> <span m=''1903190''>different</span>
  <span m=''1903600''>techniques</span> <span m=''1904110''>for</span> <span m=''1905570''>looking</span>
  <span m=''1905910''>for where the</span> <span m=''1906480''>SIMD</span> <span m=''1906720''>parallelism</span>
  <span m=''1907320''>is.</span> <span m=''1908730''>There was</span> <span m=''1908860''>some</span>
  <span m=''1909080''>work</span> <span m=''1909360''>done</span> <span m=''1909530''>here</span>
  <span m=''1910010''>about</span> <span m=''1910380''>six</span> <span m=''1910570''>years</span>
  <span m=''1910810''>ago</span> <span m=''1911450''>by</span> <span m=''1911710''>Sam</span>
  <span m=''1912000''>Larson,</span> <span m=''1912790''>who is</span> <span m=''1913050''>now</span>
  <span m=''1913260''>graduated,</span> <span m=''1916240''>on</span> <span m=''1916590''>super</span>
  <span m=''1916840''>word</span> <span m=''1917040''>level</span> <span m=''1917300''>parallelism.</span>
  <span m=''1917910''>so</span> <span m=''1918030''>I''m</span> <span m=''1918090''>going</span>
  <span m=''1918250''>to</span> <span m=''1918360''>focus the</span> <span m=''1918790''>rest</span>
  <span m=''1919010''>of</span> <span m=''1919090''>this</span> <span m=''1919260''>talk</span>
  <span m=''1919580''>on</span> <span m=''1920260''>this</span> <span m=''1920500''>concept</span>
  <span m=''1920970''>of</span> <span m=''1921290''>SIMDization</span> <span m=''1921880''>because</span>
  <span m=''1922080''>I</span> <span m=''1922160''>think</span> <span m=''1922340''>it''s</span>
  <span m=''1922430''>probably</span> <span m=''1922760''>the</span> <span m=''1922820''>one</span>
  <span m=''1923010''>that''s</span> <span m=''1923170''>most</span> <span m=''1923390''>useful</span>
  <span m=''1924050''>for</span> <span m=''1924190''>extracting</span> <span m=''1924790''>parallelism</span>
  <span m=''1925300''>in</span> <span m=''1925440''>some</span> <span m=''1925590''>of</span>
  <span m=''1925660''>the</span> <span m=''1925720''>codes</span> <span m=''1925950''>that</span>
  <span m=''1926080''>you''re</span> <span m=''1926240''>doing.</span> </p><p><span
  m=''1927680''>So</span> <span m=''1927840''>this</span> <span m=''1927990''>is</span>
  <span m=''1928080''>really</span> <span m=''1928960''>ideal</span> <span m=''1929470''>for</span>
  <span m=''1930090''>SIMD</span> <span m=''1930490''>where</span> <span m=''1930660''>you</span>
  <span m=''1930730''>have</span> <span m=''1930940''>really</span> <span m=''1931150''>short</span>
  <span m=''1931440''>vector</span> <span m=''1931710''>lens,</span> <span m=''1932650''>2</span>
  <span m=''1932870''>to</span> <span m=''1933010''>8.</span> <span m=''1934210''>What</span>
  <span m=''1934440''>you''re</span> <span m=''1934570''>looking</span> <span m=''1934830''>for</span>
  <span m=''1935260''>is</span> <span m=''1935450''>SIMDization</span> <span m=''1935820''>that</span>
  <span m=''1936190''>exists</span> <span m=''1936550''>within</span> <span m=''1936750''>a</span>
  <span m=''1936810''>basic</span> <span m=''1937070''>block.</span> <span m=''1937550''>So</span>
  <span m=''1937740''>within</span> <span m=''1938140''>a</span> <span m=''1938250''>code</span>
  <span m=''1938530''>block,</span> <span m=''1938870''>within</span> <span m=''1939810''>a</span>
  <span m=''1939970''>body</span> <span m=''1940290''>of</span> <span m=''1940400''>a
  loop</span> <span m=''1941090''>or</span> <span m=''1941370''>within</span> <span
  m=''1941780''>some</span> <span m=''1941970''>control</span> <span m=''1942260''>flow</span>
  <span m=''1942490''>even.</span> <span m=''1944790''>You</span> <span m=''1944860''>can</span>
  <span m=''1944980''>uncover</span> <span m=''1945070''>this</span> <span m=''1945440''>with</span>
  <span m=''1945570''>simple</span> <span m=''1945800''>analysis,</span> <span m=''1946510''>and</span>
  <span m=''1946700''>this</span> <span m=''1946910''>really</span> <span m=''1947940''>has</span>
  <span m=''1948290''>pushed</span> <span m=''1949220''>the</span> <span m=''1949930''>boundary</span>
  <span m=''1950280''>on</span> <span m=''1950590''>what</span> <span m=''1951080''>automatic</span>
  <span m=''1951470''>compilers</span> <span m=''1952000''>can</span> <span m=''1952190''>do.</span>
  <span m=''1953280''>Some</span> <span m=''1953470''>of</span> <span m=''1953530''>work</span>
  <span m=''1953700''>that''s</span> <span m=''1953870''>gone</span> <span m=''1954110''>on
  at</span> <span m=''1954310''>IMB,</span> <span m=''1955330''>what</span> <span
  m=''1955490''>they</span> <span m=''1955570''>call the</span> <span m=''1955870''>octipiler,</span>
  <span m=''1956890''>has</span> <span m=''1957390''>eventually</span> <span m=''1957800''>been</span>
  <span m=''1957940''>transferred</span> <span m=''1958330''>to</span> <span m=''1958430''>the</span>
  <span m=''1958490''>XLC</span> <span m=''1958980''>compiler</span> <span m=''1960100''>do</span>
  <span m=''1960290''>a</span> <span m=''1960350''>lot</span> <span m=''1960520''>of</span>
  <span m=''1960620''>defecniques</span> <span m=''1961930''>that</span> <span m=''1962060''>build</span>
  <span m=''1962420''>on</span> <span m=''1962580''>SLP</span> <span m=''1963170''>and</span>
  <span m=''1963570''>expand</span> <span m=''1963970''>in</span> <span m=''1964080''>various</span>
  <span m=''1964500''>ways</span> <span m=''1964780''>to</span> <span m=''1965090''>broaden</span>
  <span m=''1965380''>the</span> <span m=''1965480''>scope</span> <span m=''1965800''>of</span>
  <span m=''1965900''>what</span> <span m=''1966010''>you</span> <span m=''1966090''>can</span>
  <span m=''1966200''>automatically</span> <span m=''1966670''>parallize.</span> <span
  m=''1968680''>So</span> <span m=''1968820''>here''s</span> <span m=''1969760''>an</span>
  <span m=''1969820''>example</span> <span m=''1970330''>of</span> <span m=''1970610''>how</span>
  <span m=''1970780''>you</span> <span m=''1970870''>might</span> <span m=''1971040''>actually</span>
  <span m=''1971380''>derive</span> <span m=''1972200''>SIMDization</span> <span m=''1973490''>or</span>
  <span m=''1973650''>opportunities</span> <span m=''1974110''>for</span> <span m=''1974440''>SIMDization.</span>
  </p><p><span m=''1975120''>So</span> <span m=''1975260''>you</span> <span m=''1975330''>have</span>
  <span m=''1975490''>some</span> <span m=''1975700''>code,</span> <span m=''1976040''>let''s</span>
  <span m=''1976170''>say</span> <span m=''1976310''>you''re</span> <span m=''1976460''>doing</span>
  <span m=''1976800''>RGB</span> <span m=''1977280''>computations</span> <span m=''1977910''>where</span>
  <span m=''1978030''>you''re</span> <span m=''1978110''>just</span> <span m=''1978290''>adding</span>
  <span m=''1981860''>the</span> <span m=''1982070''>r</span> <span m=''1982310''>elements,</span>
  <span m=''1982960''>that''s</span> <span m=''1983190''>a</span> <span m=''1983340''>red,</span>
  <span m=''1983720''>green and</span> <span m=''1984110''>blue.</span> <span m=''1986820''>So</span>
  <span m=''1986930''>this</span> <span m=''1987100''>might</span> <span m=''1987280''>be</span>
  <span m=''1987370''>in</span> <span m=''1987470''>a</span> <span m=''1987540''>loop,</span>
  <span m=''1988140''>and</span> <span m=''1988320''>what</span> <span m=''1988450''>you</span>
  <span m=''1988520''>might</span> <span m=''1988710''>notice</span> <span m=''1989070''>it</span>
  <span m=''1989630''>well I</span> <span m=''1989890''>can pack the</span> <span
  m=''1990740''>RGB</span> <span m=''1991330''>elements</span> <span m=''1991920''>into</span>
  <span m=''1992220''>one</span> <span m=''1992410''>register.</span> <span m=''1993410''>I</span>
  <span m=''1993560''>can pack these</span> <span m=''1994280''>into</span> <span
  m=''1994460''>another</span> <span m=''1994730''>register,</span> <span m=''1995380''>and
  I</span> <span m=''1995540''>can pack</span> <span m=''1996030''>these</span> <span
  m=''1996190''>literals</span> <span m=''1996690''>into</span> <span m=''1996930''>a</span>
  <span m=''1997000''>third</span> <span m=''1997310''>register.</span> <span m=''1999630''>So</span>
  <span m=''1999750''>that</span> <span m=''1999970''>gives</span> <span m=''2000220''>me</span>
  <span m=''2000690''>a</span> <span m=''2000800''>way</span> <span m=''2001040''>to</span>
  <span m=''2001430''>pack</span> <span m=''2001740''>data</span> <span m=''2001980''>together</span>
  <span m=''2002540''>into</span> <span m=''2002900''>SIMD</span> <span m=''2003220''>registers,</span>
  <span m=''2004100''>and</span> <span m=''2004300''>now</span> <span m=''2004530''>I</span>
  <span m=''2004590''>can</span> <span m=''2004760''>replace</span> <span m=''2005190''>this</span>
  <span m=''2005310''>scaler</span> <span m=''2005720''>code</span> <span m=''2006740''>with</span>
  <span m=''2009150''>instructions</span> <span m=''2009600''>that</span> <span m=''2009670''>pack
  the</span> <span m=''2010100''>vector</span> <span m=''2010330''>register.</span>
  <span m=''2011570''>I</span> <span m=''2011680''>can</span> <span m=''2011840''>do
  the</span> <span m=''2012030''>computations</span> <span m=''2012590''>in</span>
  <span m=''2012680''>parallel</span> <span m=''2013030''>and</span> <span m=''2013160''>I</span>
  <span m=''2013200''>can</span> <span m=''2013370''>unpack</span> <span m=''2013840''>them.</span>
  <span m=''2014420''>We''ll</span> <span m=''2014570''>talk</span> <span m=''2014790''>about</span>
  <span m=''2014970''>that</span> <span m=''2015280''>with</span> <span m=''2015630''>a</span>
  <span m=''2015690''>little</span> <span m=''2015910''>bit</span> <span m=''2016000''>more</span>
  <span m=''2016190''>illustration</span> <span m=''2017050''>in a</span> <span m=''2017170''>second.</span>
  </p><p><span m=''2017730''>Any</span> <span m=''2017890''>questions</span> <span
  m=''2018200''>on</span> <span m=''2018280''>this?</span> </p><p><span m=''2022720''>Perhaps</span>
  <span m=''2023040''>the</span> <span m=''2023150''>biggest</span> <span m=''2023550''>improvement</span>
  <span m=''2024030''>that</span> <span m=''2024100''>you</span> <span m=''2024230''>can</span>
  <span m=''2024360''>get</span> <span m=''2024560''>from</span> <span m=''2024870''>SIMDization</span>
  <span m=''2025930''>is</span> <span m=''2026120''>by</span> <span m=''2026300''>looking</span>
  <span m=''2026600''>at</span> <span m=''2026750''>adjacent</span> <span m=''2027180''>memory</span>
  <span m=''2027420''>references.</span> <span m=''2028520''>Rather</span> <span m=''2028720''>than</span>
  <span m=''2028940''>doing</span> <span m=''2029200''>one</span> <span m=''2029420''>load</span>
  <span m=''2029840''>you</span> <span m=''2029940''>can</span> <span m=''2030100''>do</span>
  <span m=''2030250''>a</span> <span m=''2030380''>vector</span> <span m=''2030670''>load,</span>
  <span m=''2031020''>which</span> <span m=''2031260''>really</span> <span m=''2031470''>gives</span>
  <span m=''2031680''>you a</span> <span m=''2032170''>bigger</span> <span m=''2032550''>bandwidth</span>
  <span m=''2033020''>to</span> <span m=''2033150''>memory.</span> <span m=''2035230''>So</span>
  <span m=''2035440''>in</span> <span m=''2035540''>this</span> <span m=''2035670''>case,</span>
  <span m=''2036370''>I</span> <span m=''2036500''>have</span> <span m=''2037450''>a</span>
  <span m=''2037620''>load</span> <span m=''2037890''>from</span> <span m=''2038650''>I1,</span>
  <span m=''2039150''>I2,</span> <span m=''2039950''>and</span> <span m=''2040210''>since</span>
  <span m=''2040400''>these</span> <span m=''2040580''>memory</span> <span m=''2040810''>locations</span>
  <span m=''2041290''>are</span> <span m=''2041440''>continuous,</span> <span m=''2042380''>I</span>
  <span m=''2042500''>can</span> <span m=''2043180''>replace</span> <span m=''2043580''>them</span>
  <span m=''2043750''>by</span> <span m=''2044220''>one</span> <span m=''2044520''>vector</span>
  <span m=''2044790''>load</span> <span m=''2045820''>that</span> <span m=''2045980''>brings</span>
  <span m=''2046310''>in</span> <span m=''2046890''>all</span> <span m=''2047110''>these</span>
  <span m=''2047310''>data</span> <span m=''2047530''>elements</span> <span m=''2047930''>in</span>
  <span m=''2048070''>one</span> <span m=''2048250''>shot.</span> <span m=''2049320''>That</span>
  <span m=''2049490''>essentially</span> <span m=''2049960''>eliminates</span> <span
  m=''2050690''>three</span> <span m=''2051120''>load</span> <span m=''2051500''>instructions,</span>
  <span m=''2052290''>which</span> <span m=''2052540''>are</span> <span m=''2052660''>potentially</span>
  <span m=''2055160''>most</span> <span m=''2055440''>heavy</span> <span m=''2055630''>weight</span>
  <span m=''2056100''>for</span> <span m=''2056380''>one</span> <span m=''2056680''>ligher
  weight</span> <span m=''2057210''>instruction</span> <span m=''2057670''>because</span>
  <span m=''2057950''>it amortizes</span> <span m=''2058560''>bandwidth</span> <span
  m=''2059170''>and</span> <span m=''2060450''>exploits</span> <span m=''2060820''>things</span>
  <span m=''2061050''>like</span> <span m=''2061190''>spatial</span> <span m=''2061530''>locality.</span>
  </p><p><span m=''2065000''>Another</span> <span m=''2065360''>one,</span> <span
  m=''2066290''>vectorizable</span> <span m=''2066850''>loops.</span> <span m=''2067530''>So</span>
  <span m=''2067720''>this</span> <span m=''2067890''>is</span> <span m=''2068030''>probably</span>
  <span m=''2068680''>one</span> <span m=''2068980''>of</span> <span m=''2069200''>the</span>
  <span m=''2069490''>most</span> <span m=''2069840''>advanced</span> <span m=''2070200''>ways</span>
  <span m=''2070480''>of</span> <span m=''2070870''>exploiting</span> <span m=''2071480''>SIMDization,</span>
  <span m=''2072950''>especially</span> <span m=''2073440''>in</span> <span m=''2073680''>really</span>
  <span m=''2073920''>long</span> <span m=''2074200''>vector</span> <span m=''2074380''>codes,</span>
  <span m=''2074750''>so</span> <span m=''2074820''>traditional</span> <span m=''2075210''>supercomputers</span>
  <span m=''2075880''>like</span> <span m=''2076070''>the</span> <span m=''2076160''>Cray,</span>
  <span m=''2077290''>and</span> <span m=''2077490''>you''ll</span> <span m=''2077730''>probably</span>
  <span m=''2078100''>hear</span> <span m=''2078300''>Simmon</span> <span m=''2078630''>talk</span>
  <span m=''2078850''>about</span> <span m=''2079060''>this</span> <span m=''2079200''>in</span>
  <span m=''2079310''>the</span> <span m=''2079370''>next</span> <span m=''2079630''>lecture.</span>
  <span m=''2080590''>So</span> <span m=''2080800''>I</span> <span m=''2080860''>have</span>
  <span m=''2081110''>some</span> <span m=''2081300''>loop</span> <span m=''2082660''>and
  I</span> <span m=''2082760''>hvae</span> <span m=''2082970''>this</span> <span m=''2083090''>particular</span>
  <span m=''2083480''>statement</span> <span m=''2083840''>here.</span> <span m=''2084540''>So</span>
  <span m=''2084700''>how</span> <span m=''2084790''>can</span> <span m=''2084920''>I</span>
  <span m=''2084970''>get</span> <span m=''2085160''>SIMD</span> <span m=''2085470''>code</span>
  <span m=''2085740''>out</span> <span m=''2085870''>of</span> <span m=''2085930''>this?</span>
  <span m=''2086730''>Anybody</span> <span m=''2087040''>have</span> <span m=''2087190''>any</span>
  <span m=''2087300''>ideas?</span> <span m=''2101750''>Anybody</span> <span m=''2102540''>know</span>
  <span m=''2102650''>about</span> <span m=''2102820''>loop</span> <span m=''2102980''>unrolling?</span>
  <span m=''2105920''>So</span> <span m=''2106050''>if I</span> <span m=''2106350''>unroll</span>
  <span m=''2106720''>this</span> <span m=''2106960''>loop,</span> <span m=''2108680''>I</span>
  <span m=''2108960''>essentially --</span> <span m=''2109480''>that</span> <span
  m=''2109730''>same</span> <span m=''2109950''>trick</span> <span m=''2110170''>that</span>
  <span m=''2110290''>I</span> <span m=''2110330''>had</span> <span m=''2110440''>shown</span>
  <span m=''2110690''>earlier,</span> <span m=''2111260''>although I didn''t</span>
  <span m=''2111900''>quite</span> <span m=''2112110''>do</span> <span m=''2112220''>it</span>
  <span m=''2112300''>this</span> <span m=''2112460''>way.</span> <span m=''2112680''>I</span>
  <span m=''2113390''>change</span> <span m=''2113730''>a</span> <span m=''2113790''>loop</span>
  <span m=''2113980''>bound</span> <span m=''2114300''>from</span> <span m=''2114840''>n</span>
  <span m=''2115180''>to</span> <span m=''2115810''>--</span> <span m=''2116440''>the</span>
  <span m=''2116580''>increment</span> <span m=''2117020''>from --</span> <span m=''2117450''>rather</span>
  <span m=''2117700''>than</span> <span m=''2117820''>stepping</span> <span m=''2118130''>through</span>
  <span m=''2118280''>one</span> <span m=''2118480''>at</span> <span m=''2118540''>a</span>
  <span m=''2118600''>time,</span> <span m=''2118990''>stepping</span> <span m=''2119240''>through</span>
  <span m=''2119370''>four</span> <span m=''2119620''>at a</span> <span m=''2119740''>time.</span>
  </p><p><span m=''2120590''>Now</span> <span m=''2121410''>the</span> <span m=''2121520''>loop</span>
  <span m=''2121700''>body,</span> <span m=''2122020''>rather</span> <span m=''2122260''>than</span>
  <span m=''2122410''>doing</span> <span m=''2123090''>one</span> <span m=''2123890''>addition</span>
  <span m=''2124290''>at</span> <span m=''2124360''>a</span> <span m=''2124450''>time,</span>
  <span m=''2125190''>I''m</span> <span m=''2125320''>doing</span> <span m=''2125520''>four</span>
  <span m=''2125840''>additions</span> <span m=''2126180''>at</span> <span m=''2126250''>a</span>
  <span m=''2126310''>time.</span> <span m=''2127120''>So now</span> <span m=''2127470''>this</span>
  <span m=''2127610''>is</span> <span m=''2127720''>very</span> <span m=''2127940''>natural</span>
  <span m=''2128340''>for a</span> <span m=''2128540''>vectorization,</span> <span
  m=''2129200''>right?</span> <span m=''2129770''>Vector</span> <span m=''2130130''>load,</span>
  <span m=''2130440''>vector</span> <span m=''2130650''>load,</span> <span m=''2130890''>vector</span>
  <span m=''2131120''>store</span> <span m=''2131880''>plus</span> <span m=''2132070''>the</span>
  <span m=''2132160''>vector</span> <span m=''2132410''>add in</span> <span m=''2132650''>the</span>
  <span m=''2132720''>middle.</span> <span m=''2133520''>Is that</span> <span m=''2134540''>intuitive?</span>
  <span m=''2138400''>So</span> <span m=''2138670''>this</span> <span m=''2139000''>gives</span>
  <span m=''2139180''>you</span> <span m=''2139320''>another</span> <span m=''2139600''>way</span>
  <span m=''2139790''>of</span> <span m=''2140180''>extracting</span> <span m=''2140640''>parallelism.</span>
  <span m=''2141320''>Looking</span> <span m=''2141580''>at</span> <span m=''2141620''>traditional</span>
  <span m=''2142060''>loops,</span> <span m=''2142330''>seeing</span> <span m=''2142600''>whether</span>
  <span m=''2142810''>you</span> <span m=''2142910''>can</span> <span m=''2143010''>actually</span>
  <span m=''2143330''>unroll</span> <span m=''2143500''>it</span> <span m=''2143740''>in</span>
  <span m=''2143850''>different</span> <span m=''2144160''>ways,</span> <span m=''2145090''>be</span>
  <span m=''2145320''>able</span> <span m=''2145510''>to</span> <span m=''2146300''>get</span>
  <span m=''2146510''>that</span> <span m=''2146660''>SIMD</span> <span m=''2146920''>parallelization.</span>
  </p><p><span m=''2148920''>The</span> <span m=''2149090''>last</span> <span m=''2149420''>one</span>
  <span m=''2149740''>I''ll</span> <span m=''2149880''>talk</span> <span m=''2150080''>about</span>
  <span m=''2150230''>is</span> <span m=''2150370''>about</span> <span m=''2150750''>partial</span>
  <span m=''2151210''>vectorization.</span> <span m=''2153400''>Either it</span> <span
  m=''2153770''>might</span> <span m=''2153990''>be</span> <span m=''2155500''>some</span>
  <span m=''2155690''>things</span> <span m=''2155960''>where</span> <span m=''2156120''>you</span>
  <span m=''2156230''>have</span> <span m=''2156740''>a</span> <span m=''2157070''>mix</span>
  <span m=''2157310''>of</span> <span m=''2157390''>statements.</span> <span m=''2158130''>So</span>
  <span m=''2158250''>here</span> <span m=''2158520''>I</span> <span m=''2158600''>have</span>
  <span m=''2159030''>a</span> <span m=''2159130''>loop</span> <span m=''2160210''>where</span>
  <span m=''2160420''>I</span> <span m=''2160470''>have</span> <span m=''2161030''>some</span>
  <span m=''2161290''>load</span> <span m=''2161700''>and</span> <span m=''2161800''>then
  I''m</span> <span m=''2161890''>doing</span> <span m=''2162090''>some</span> <span
  m=''2162450''>computation</span> <span m=''2162950''>here.</span> <span m=''2163210''>So</span>
  <span m=''2163410''>what</span> <span m=''2163570''>could</span> <span m=''2163700''>I</span>
  <span m=''2163740''>do</span> <span m=''2163870''>here?</span> <span m=''2169780''>It''s</span>
  <span m=''2169880''>not</span> <span m=''2170090''>as</span> <span m=''2170150''>symmetric</span>
  <span m=''2170610''>as</span> <span m=''2170800''>the</span> <span m=''2170890''>other</span>
  <span m=''2171040''>loop.</span> </p><p><span m=''2171260''>AUDIENCE:</span> <span
  m=''2173738''>There''s</span> <span m=''2174234''>no</span> <span m=''2174730''>vector</span>
  <span m=''2174977''>and</span> <span m=''2175225''>[INAUDIBLE PHRASE].</span> </p><p><span
  m=''2178200''>PROFESSOR: Right.</span> <span m=''2178530''>So</span> <span m=''2178640''>you</span>
  <span m=''2178750''>might</span> <span m=''2178960''>omit</span> <span m=''2179240''>that.</span>
  <span m=''2179600''>But</span> <span m=''2179770''>could</span> <span m=''2179910''>you</span>
  <span m=''2180030''>do</span> <span m=''2180170''>anything</span> <span m=''2180560''>about</span>
  <span m=''2180870''>the</span> <span m=''2181940''>subtraction?</span> </p><p><span
  m=''2182580''>AUDIENCE:</span> <span m=''2183038''>[INAUDIBLE PHRASE].</span> </p><p><span
  m=''2184870''>PROFESSOR: If</span> <span m=''2185050''>I</span> <span m=''2185520''>can</span>
  <span m=''2185660''>unroll</span> <span m=''2185780''>this</span> <span m=''2185900''>again,</span>
  <span m=''2187140''>right?</span> <span m=''2187990''>Now</span> <span m=''2188890''>there''s</span>
  <span m=''2189090''>no</span> <span m=''2189190''>dependencies</span> <span m=''2189670''>between</span>
  <span m=''2190020''>this</span> <span m=''2190190''>instruction and</span> <span
  m=''2190680''>this</span> <span m=''2190840''>instruction,</span> <span m=''2192240''>so</span>
  <span m=''2192360''>I</span> <span m=''2192400''>can</span> <span m=''2192700''>really</span>
  <span m=''2192950''>move these</span> <span m=''2193370''>together,</span> <span
  m=''2194210''>and</span> <span m=''2194390''>once</span> <span m=''2194560''>I''ve</span>
  <span m=''2194650''>moved</span> <span m=''2194880''>these</span> <span m=''2194980''>together</span>
  <span m=''2195390''>then</span> <span m=''2196150''>these</span> <span m=''2196360''>loads</span>
  <span m=''2196580''>become</span> <span m=''2196830''>contiguous.</span> <span m=''2198170''>These</span>
  <span m=''2198420''>loads</span> <span m=''2198620''>are</span> <span m=''2198740''>contiguous</span>
  <span m=''2199430''>so</span> <span m=''2199580''>I</span> <span m=''2199630''>can</span>
  <span m=''2199760''>replace</span> <span m=''2200140''>these</span> <span m=''2200340''>by</span>
  <span m=''2200500''>vector</span> <span m=''2200790''>codes,</span> <span m=''2202030''>vector</span>
  <span m=''2202350''>equivalents.</span> <span m=''2204640''>So</span> <span m=''2204800''>now</span>
  <span m=''2204950''>the vector</span> <span m=''2205340''>load bring</span> <span
  m=''2205740''>in</span> <span m=''2205900''>L0,</span> <span m=''2206560''>L1,</span>
  <span m=''2207820''>I</span> <span m=''2207940''>have</span> <span m=''2208120''>the</span>
  <span m=''2208210''>addition,</span> <span m=''2208560''>that</span> <span m=''2208690''>brings</span>
  <span m=''2208940''>in</span> <span m=''2209300''>those</span> <span m=''2209490''>two</span>
  <span m=''2209610''>elements</span> <span m=''2209990''>in</span> <span m=''2210130''>a</span>
  <span m=''2210240''>vector,</span> <span m=''2211130''>and</span> <span m=''2212800''>then</span>
  <span m=''2212970''>I</span> <span m=''2213050''>can</span> <span m=''2213180''>do</span>
  <span m=''2213320''>my</span> <span m=''2214570''>scaler</span> <span m=''2214960''>additions.</span>
  <span m=''2215960''>But</span> <span m=''2216640''>what</span> <span m=''2216770''>do</span>
  <span m=''2216840''>I</span> <span m=''2216930''>do</span> <span m=''2217180''>about</span>
  <span m=''2217630''>the</span> <span m=''2218280''>value</span> <span m=''2218720''>getting</span>
  <span m=''2218950''>out</span> <span m=''2219080''>of</span> <span m=''2219160''>this</span>
  <span m=''2219300''>vector</span> <span m=''2219570''>register</span> <span m=''2220310''>into</span>
  <span m=''2220560''>this</span> <span m=''2220810''>scaler</span> <span m=''2221130''>register
  that</span> <span m=''2221670''>I</span> <span m=''2221710''>need</span> <span m=''2221890''>for</span>
  <span m=''2222000''>the</span> <span m=''2222080''>absolute</span> <span m=''2222470''>values.</span>
  </p><p><span m=''2223400''>So</span> <span m=''2223590''>this</span> <span m=''2223760''>is</span>
  <span m=''2223890''>where</span> <span m=''2225310''>the</span> <span m=''2225420''>benefits</span>
  <span m=''2225890''>versus</span> <span m=''2226230''>cost</span> <span m=''2226650''>of</span>
  <span m=''2226740''>SIMDization</span> <span m=''2227370''>come</span> <span m=''2227540''>in.</span>
  <span m=''2228210''>So the</span> <span m=''2228320''>benefits</span> <span m=''2228700''>are</span>
  <span m=''2228790''>great</span> <span m=''2229130''>because</span> <span m=''2229540''>you</span>
  <span m=''2229630''>can</span> <span m=''2230950''>replace</span> <span m=''2231330''>multiple</span>
  <span m=''2231800''>instructions</span> <span m=''2232390''>by</span> <span m=''2232690''>one</span>
  <span m=''2232980''>instruction,</span> <span m=''2234710''>or</span> <span m=''2235010''>you</span>
  <span m=''2235090''>can</span> <span m=''2235260''>just</span> <span m=''2235460''>cut</span>
  <span m=''2235670''>down the</span> <span m=''2235870''>number of</span> <span m=''2236120''>instructions</span>
  <span m=''2236590''>by</span> <span m=''2236790''>specific</span> <span m=''2237250''>factor,</span>
  <span m=''2238200''>your</span> <span m=''2238500''>vector</span> <span m=''2238910''>lens.</span>
  <span m=''2239920''>Low</span> <span m=''2240160''>stores</span> <span m=''2240590''>can</span>
  <span m=''2240700''>be</span> <span m=''2240770''>replaced</span> <span m=''2241120''>by</span>
  <span m=''2241290''>one</span> <span m=''2241680''>wide</span> <span m=''2242050''>memory</span>
  <span m=''2242320''>operation,</span> <span m=''2243070''>and</span> <span m=''2243400''>this</span>
  <span m=''2243520''>is</span> <span m=''2243620''>probably</span> <span m=''2244510''>the</span>
  <span m=''2244730''>biggest</span> <span m=''2245070''>opportunity</span> <span
  m=''2245580''>for</span> <span m=''2245740''>performance</span> <span m=''2246210''>improvements.</span>
  <span m=''2247800''>But</span> <span m=''2247940''>the</span> <span m=''2248000''>cost</span>
  <span m=''2248430''>is</span> <span m=''2248900''>that you have to</span> <span
  m=''2249260''>pack</span> <span m=''2249660''>data</span> <span m=''2249770''>into</span>
  <span m=''2249960''>the</span> <span m=''2250040''>data</span> <span m=''2250300''>registers
  an</span> <span m=''2250800''>you</span> <span m=''2250970''>have to</span> <span
  m=''2251190''>unpack</span> <span m=''2251670''>it</span> <span m=''2251750''>out</span>
  <span m=''2252170''>so</span> <span m=''2252420''>that you</span> <span m=''2252600''>can</span>
  <span m=''2252700''>have</span> <span m=''2253020''>those</span> <span m=''2253230''>kinds</span>
  <span m=''2253460''>of</span> <span m=''2253530''>communications</span> <span m=''2254230''>between</span>
  <span m=''2257230''>this vector</span> <span m=''2257690''>register</span> <span
  m=''2258040''>here</span> <span m=''2258300''>and the</span> <span m=''2258400''>value</span>
  <span m=''2258780''>here,</span> <span m=''2259550''>this</span> <span m=''2259710''>value</span>
  <span m=''2260060''>here</span> <span m=''2260430''>and</span> <span m=''2260600''>this</span>
  <span m=''2260780''>value</span> <span m=''2260930''>here.</span> <span m=''2261400''>Often</span>
  <span m=''2261800''>you</span> <span m=''2261890''>can''t</span> <span m=''2262290''>simply</span>
  <span m=''2262690''>access</span> <span m=''2263610''>vector</span> <span m=''2263970''>values</span>
  <span m=''2264580''>without</span> <span m=''2264890''>doing</span> <span m=''2265210''>this</span>
  <span m=''2265420''>packing</span> <span m=''2265830''>and</span> <span m=''2266080''>unpacking.</span>
  </p><p><span m=''2272210''>So</span> <span m=''2272400''>how</span> <span m=''2272520''>do</span>
  <span m=''2272610''>you</span> <span m=''2272700''>actually</span> <span m=''2273080''>do</span>
  <span m=''2273310''>the</span> <span m=''2273950''>packing,</span> <span m=''2274410''>unpacking?</span>
  <span m=''2275450''>This</span> <span m=''2275560''>is</span> <span m=''2275690''>predominantly</span>
  <span m=''2276310''>where</span> <span m=''2276480''>a</span> <span m=''2276550''>lot</span>
  <span m=''2276730''>of</span> <span m=''2276820''>the</span> <span m=''2276900''>complexity</span>
  <span m=''2277470''>goes.</span> <span m=''2283910''>So</span> <span m=''2284040''>the</span>
  <span m=''2284110''>value</span> <span m=''2284470''>of a</span> <span m=''2284600''>here</span>
  <span m=''2284790''>is</span> <span m=''2285110''>initialized</span> <span m=''2285620''>by</span>
  <span m=''2285900''>some</span> <span m=''2286290''>function and the</span> <span
  m=''2286900''>value</span> <span m=''2287410''>of b</span> <span m=''2287640''>here
  is</span> <span m=''2288010''>initialized</span> <span m=''2288400''>by</span> <span
  m=''2288540''>some</span> <span m=''2288710''>function,</span> <span m=''2289140''>and</span>
  <span m=''2289280''>these</span> <span m=''2289400''>might</span> <span m=''2289540''>not</span>
  <span m=''2289690''>be</span> <span m=''2289810''>things</span> <span m=''2290040''>that</span>
  <span m=''2290160''>I</span> <span m=''2290230''>can</span> <span m=''2291200''>SIMdize</span>
  <span m=''2291600''>very</span> <span m=''2291820''>easily.</span> <span m=''2292740''>So</span>
  <span m=''2292970''>what</span> <span m=''2293080''>I</span> <span m=''2293140''>need</span>
  <span m=''2293320''>to</span> <span m=''2293380''>do</span> <span m=''2293490''>is</span>
  <span m=''2293820''>move</span> <span m=''2294990''>that</span> <span m=''2295210''>value</span>
  <span m=''2295590''>into</span> <span m=''2296140''>the</span> <span m=''2296240''>first</span>
  <span m=''2296480''>element</span> <span m=''2296770''>of vector</span> <span m=''2297080''>register,</span>
  <span m=''2297820''>and</span> <span m=''2298120''>move</span> <span m=''2298360''>the</span>
  <span m=''2298430''>second</span> <span m=''2298730''>value</span> <span m=''2299030''>into</span>
  <span m=''2299180''>the</span> <span m=''2299260''>second</span> <span m=''2299530''>element</span>
  <span m=''2299710''>of</span> <span m=''2299800''>the</span> <span m=''2299910''>vector</span>
  <span m=''2300170''>register.</span> <span m=''2300800''>So</span> <span m=''2301060''>if</span>
  <span m=''2301150''>I</span> <span m=''2301260''>have a</span> <span m=''2301800''>four-way</span>
  <span m=''2302320''>vector</span> <span m=''2302570''>register,</span> <span m=''2302940''>then</span>
  <span m=''2303070''>I</span> <span m=''2303110''>have</span> <span m=''2303230''>to</span>
  <span m=''2303350''>do</span> <span m=''2303470''>four of</span> <span m=''2303990''>these</span>
  <span m=''2304190''>moves,</span> <span m=''2304890''>and</span> <span m=''2305360''>that</span>
  <span m=''2305930''>essentially</span> <span m=''2306400''>is</span> <span m=''2306530''>the</span>
  <span m=''2306600''>packing.</span> <span m=''2307790''>Then</span> <span m=''2307920''>I</span>
  <span m=''2307950''>could</span> <span m=''2308110''>do</span> <span m=''2308210''>my</span>
  <span m=''2308370''>vector</span> <span m=''2308660''>computation,</span> <span
  m=''2309310''>which</span> <span m=''2309500''>is</span> <span m=''2309600''>really</span>
  <span m=''2310590''>these</span> <span m=''2310810''>two</span> <span m=''2310920''>statements</span>
  <span m=''2311330''>here.</span> <span m=''2312940''>Then</span> <span m=''2313200''>eventually</span>
  <span m=''2313640''>I</span> <span m=''2313720''>have</span> <span m=''2313840''>to</span>
  <span m=''2313940''>do</span> <span m=''2314040''>my</span> <span m=''2314200''>unpacking</span>
  <span m=''2315110''>because</span> <span m=''2315470''>I</span> <span m=''2315510''>have</span>
  <span m=''2315650''>to</span> <span m=''2315750''>get</span> <span m=''2315880''>the</span>
  <span m=''2315960''>values</span> <span m=''2316360''>out</span> <span m=''2316940''>to</span>
  <span m=''2317060''>do</span> <span m=''2317160''>this</span> <span m=''2317310''>operation</span>
  <span m=''2317980''>and</span> <span m=''2318090''>this</span> <span m=''2318220''>operation.</span>
  </p><p><span m=''2319960''>So</span> <span m=''2320110''>there''s</span> <span m=''2320540''>an</span>
  <span m=''2320680''>extraction</span> <span m=''2321460''>that</span> <span m=''2321610''>has</span>
  <span m=''2321800''>to</span> <span m=''2321900''>happen</span> <span m=''2322180''>out</span>
  <span m=''2322320''>of</span> <span m=''2322400''>my</span> <span m=''2322510''>SIMD</span>
  <span m=''2322840''>register.</span> <span m=''2326310''>But you</span> <span m=''2326500''>can</span>
  <span m=''2326630''>amortize</span> <span m=''2327330''>the</span> <span m=''2327390''>cost</span>
  <span m=''2327790''>of</span> <span m=''2327880''>the</span> <span m=''2327960''>packing</span>
  <span m=''2328450''>and unpacking</span> <span m=''2328980''>by</span> <span m=''2329100''>just</span>
  <span m=''2329300''>reusing</span> <span m=''2329760''>your</span> <span m=''2329870''>vector</span>
  <span m=''2330110''>registers.</span> <span m=''2330560''>So</span> <span m=''2330980''>these</span>
  <span m=''2331200''>are</span> <span m=''2331680''>like</span> <span m=''2331860''>register</span>
  <span m=''2332190''>allocation</span> <span m=''2333680''>techniques.</span> <span
  m=''2334490''>So</span> <span m=''2334630''>if</span> <span m=''2334770''>I</span>
  <span m=''2334860''>pack</span> <span m=''2335230''>things</span> <span m=''2335450''>into
  a</span> <span m=''2335690''>vector</span> <span m=''2335940''>register,</span>
  <span m=''2336330''>I</span> <span m=''2336410''>find</span> <span m=''2336750''>all</span>
  <span m=''2336960''>cases</span> <span m=''2337450''>where</span> <span m=''2337580''>I</span>
  <span m=''2337670''>can</span> <span m=''2337820''>actually</span> <span m=''2338680''>reuse</span>
  <span m=''2338980''>that</span> <span m=''2339120''>vector</span> <span m=''2339340''>register</span>
  <span m=''2339780''>and</span> <span m=''2339890''>I</span> <span m=''2339950''>try</span>
  <span m=''2340160''>to</span> <span m=''2340250''>find</span> <span m=''2340490''>opportunities</span>
  <span m=''2341430''>for</span> <span m=''2342910''>extra</span> <span m=''2343290''>SIMDization.</span>
  <span m=''2344490''>So</span> <span m=''2344630''>in the</span> <span m=''2344850''>other</span>
  <span m=''2345000''>case</span> <span m=''2345360''>then,</span> <span m=''2346640''>I</span>
  <span m=''2346760''>pack</span> <span m=''2347150''>one</span> <span m=''2347350''>then</span>
  <span m=''2347480''>I</span> <span m=''2347540''>can</span> <span m=''2347710''>reuse</span>
  <span m=''2347950''>that</span> <span m=''2348120''>same</span> <span m=''2348340''>vector</span>
  <span m=''2348580''>register.</span> </p><p><span m=''2349320''>So</span> <span
  m=''2349650''>what</span> <span m=''2349850''>are</span> <span m=''2349920''>some</span>
  <span m=''2350110''>ways</span> <span m=''2350390''>I</span> <span m=''2350470''>can</span>
  <span m=''2350640''>look</span> <span m=''2350800''>for</span> <span m=''2352550''>to</span>
  <span m=''2352720''>amortize</span> <span m=''2353270''>the</span> <span m=''2353340''>cost?</span>
  <span m=''2356600''>The</span> <span m=''2356700''>interesting</span> <span m=''2357060''>thing</span>
  <span m=''2357210''>about</span> <span m=''2357390''>memory</span> <span m=''2357660''>operations</span>
  <span m=''2358270''>is</span> <span m=''2358430''>while</span> <span m=''2358700''>there
  are</span> <span m=''2359100''>many</span> <span m=''2359430''>different</span>
  <span m=''2359740''>ways</span> <span m=''2359990''>you</span> <span m=''2360080''>can</span>
  <span m=''2360230''>pack</span> <span m=''2360890''>scaler</span> <span m=''2361250''>values</span>
  <span m=''2361950''>into</span> <span m=''2362410''>a</span> <span m=''2362470''>vector</span>
  <span m=''2362720''>register,</span> <span m=''2363500''>there''s</span> <span m=''2363740''>really</span>
  <span m=''2364050''>only</span> <span m=''2364260''>one</span> <span m=''2364470''>way</span>
  <span m=''2364700''>you</span> <span m=''2364820''>can</span> <span m=''2364990''>pack</span>
  <span m=''2366760''>loads</span> <span m=''2367190''>coming</span> <span m=''2367430''>in</span>
  <span m=''2367510''>from</span> <span m=''2367620''>memory into</span> <span m=''2368060''>a
  vector</span> <span m=''2368380''>register</span> <span m=''2369140''>is</span>
  <span m=''2369340''>because</span> <span m=''2370020''>you</span> <span m=''2370130''>want</span>
  <span m=''2370360''>the</span> <span m=''2370430''>loads</span> <span m=''2370680''>to</span>
  <span m=''2370750''>be</span> <span m=''2370840''>sequential,</span> <span m=''2371290''>you</span>
  <span m=''2371400''>want to</span> <span m=''2371600''>exploit</span> <span m=''2372170''>the</span>
  <span m=''2372280''>spatial</span> <span m=''2372600''>locality.</span> <span m=''2373340''>So</span>
  <span m=''2373550''>one</span> <span m=''2373760''>vector</span> <span m=''2374010''>load</span>
  <span m=''2374270''>really</span> <span m=''2374480''>gives</span> <span m=''2374630''>you</span>
  <span m=''2374740''>specific</span> <span m=''2375210''>ordering.</span> <span m=''2376130''>So,</span>
  <span m=''2377130''>that</span> <span m=''2377420''>really</span> <span m=''2378430''>constrains</span>
  <span m=''2378590''>you</span> <span m=''2379060''>in</span> <span m=''2379140''>various</span>
  <span m=''2379500''>ways.</span> <span m=''2380140''>So</span> <span m=''2380250''>you</span>
  <span m=''2380380''>might</span> <span m=''2380610''>bend</span> <span m=''2380820''>over</span>
  <span m=''2381030''>backwards</span> <span m=''2381540''>in</span> <span m=''2381640''>some</span>
  <span m=''2381810''>cases to</span> <span m=''2382180''>actually</span> <span m=''2382490''>get</span>
  <span m=''2382640''>your</span> <span m=''2382780''>code</span> <span m=''2383430''>to</span>
  <span m=''2383520''>be</span> <span m=''2383620''>able</span> <span m=''2383790''>to</span>
  <span m=''2383940''>you</span> <span m=''2384100''>reuse</span> <span m=''2386160''>the</span>
  <span m=''2386350''>wide-word</span> <span m=''2386990''>load</span> <span m=''2387340''>without</span>
  <span m=''2387600''>having</span> <span m=''2387830''>to</span> <span m=''2387930''>do</span>
  <span m=''2388040''>too</span> <span m=''2388200''>much</span> <span m=''2388400''>packing</span>
  <span m=''2388800''>or</span> <span m=''2389090''>unpacking</span> <span m=''2389740''>because</span>
  <span m=''2389980''>that''ll</span> <span m=''2390190''>start</span> <span m=''2390870''>eating</span>
  <span m=''2391120''>into</span> <span m=''2391320''>your</span> <span m=''2391590''>benefits.</span>
  </p><p><span m=''2393520''>So</span> <span m=''2393710''>simple</span> <span m=''2395290''>example</span>
  <span m=''2395850''>of</span> <span m=''2395970''>how</span> <span m=''2396110''>you</span>
  <span m=''2396230''>might</span> <span m=''2396420''>find</span> <span m=''2398320''>the</span>
  <span m=''2399000''>SLP</span> <span m=''2400900''>parallelism.</span> <span m=''2402740''>So
  the</span> <span m=''2402860''>first</span> <span m=''2403120''>thing</span> <span
  m=''2403250''>you</span> <span m=''2403320''>want</span> <span m=''2403490''>to</span>
  <span m=''2403550''>do</span> <span m=''2403730''>is</span> <span m=''2403940''>start</span>
  <span m=''2404230''>with</span> <span m=''2404440''>are</span> <span m=''2404900''>the</span>
  <span m=''2405850''>instructions</span> <span m=''2406290''>that</span> <span m=''2406370''>give</span>
  <span m=''2406550''>you</span> <span m=''2406630''>the</span> <span m=''2406720''>most</span>
  <span m=''2407490''>benefit,</span> <span m=''2408240''>so it''s</span> <span m=''2408470''>memory</span>
  <span m=''2408740''>references.</span> <span m=''2409860''>So</span> <span m=''2410250''>here</span>
  <span m=''2410590''>there</span> <span m=''2410790''>are two</span> <span m=''2411000''>memory</span>
  <span m=''2411210''>references.</span> <span m=''2411840''>They</span> <span m=''2411990''>happen</span>
  <span m=''2412290''>to</span> <span m=''2412390''>be</span> <span m=''2412580''>adjacent,</span>
  <span m=''2412980''>so</span> <span m=''2413690''>I''m</span> <span m=''2413800''>accessing</span>
  <span m=''2414360''>a</span> <span m=''2414670''>contiguous</span> <span m=''2415680''>memory</span>
  <span m=''2415920''>chunks,</span> <span m=''2416250''>so</span> <span m=''2416470''>I</span>
  <span m=''2416520''>can</span> <span m=''2416670''>parallelized</span> <span m=''2417250''>that.</span>
  <span m=''2417930''>That</span> <span m=''2418040''>would</span> <span m=''2418140''>be</span>
  <span m=''2418500''>my</span> <span m=''2418650''>first</span> <span m=''2418940''>step.</span>
  <span m=''2420540''>I</span> <span m=''2420640''>can</span> <span m=''2420740''>do</span>
  <span m=''2420870''>a</span> <span m=''2420970''>vector</span> <span m=''2421270''>load</span>
  <span m=''2421930''>and</span> <span m=''2422520''>that</span> <span m=''2422830''>assignment</span>
  <span m=''2423400''>can</span> <span m=''2423580''>become</span> <span m=''2424200''>a</span>
  <span m=''2424380''>and</span> <span m=''2424500''>b.</span> <span m=''2425880''>I</span>
  <span m=''2425940''>can</span> <span m=''2426090''>look</span> <span m=''2426240''>for</span>
  <span m=''2426980''>opportunities</span> <span m=''2427600''>where</span> <span
  m=''2427740''>I</span> <span m=''2427800''>can</span> <span m=''2428130''>propagate</span>
  <span m=''2429370''>this</span> <span m=''2429730''>vector</span> <span m=''2432520''>values</span>
  <span m=''2433290''>within the vector</span> <span m=''2433700''>register</span>
  <span m=''2434090''>that''s</span> <span m=''2434250''>holding</span> <span m=''2434540''>a
  and</span> <span m=''2434810''>b.</span> <span m=''2435840''>So</span> <span m=''2435970''>the
  way</span> <span m=''2436130''>I</span> <span m=''2436230''>do</span> <span m=''2436410''>that</span>
  <span m=''2436610''>is</span> <span m=''2436730''>I</span> <span m=''2436810''>look</span>
  <span m=''2436990''>for</span> <span m=''2437150''>uses</span> <span m=''2437580''>of</span>
  <span m=''2437700''>a and</span> <span m=''2437990''>b.</span> <span m=''2438980''>In</span>
  <span m=''2439070''>this</span> <span m=''2439220''>case,</span> <span m=''2439850''>there
  are</span> <span m=''2440140''>these</span> <span m=''2440360''>two</span> <span
  m=''2440470''>statements.</span> <span m=''2445020''>So</span> <span m=''2445220''>I</span>
  <span m=''2445320''>can</span> <span m=''2445490''>look</span> <span m=''2445730''>for</span>
  <span m=''2445820''>opportunities</span> <span m=''2446440''>to</span> <span m=''2446680''>vectorize</span>
  <span m=''2447180''>that.</span> <span m=''2452160''>So</span> <span m=''2452290''>in</span>
  <span m=''2452370''>this</span> <span m=''2452500''>case,</span> <span m=''2452790''>both</span>
  <span m=''2453010''>of</span> <span m=''2453100''>these</span> <span m=''2453290''>instructions</span>
  <span m=''2453720''>are</span> <span m=''2453780''>also</span> <span m=''2454030''>vectorizable.</span>
  <span m=''2454960''>Now</span> <span m=''2455270''>I</span> <span m=''2455360''>have
  a</span> <span m=''2455810''>vector</span> <span m=''2456750''>subtraction,</span>
  <span m=''2458040''>and</span> <span m=''2458240''>I</span> <span m=''2458280''>have</span>
  <span m=''2459750''>a</span> <span m=''2459990''>vector</span> <span m=''2460270''>register</span>
  <span m=''2460750''>holding</span> <span m=''2461190''>new</span> <span m=''2461300''>values</span>
  <span m=''2461750''>h and</span> <span m=''2462050''>j.</span> <span m=''2462680''>So
  I</span> <span m=''2462820''>follow</span> <span m=''2463130''>that</span> <span
  m=''2464790''>chain</span> <span m=''2465030''>again</span> <span m=''2465320''>of</span>
  <span m=''2465770''>where</span> <span m=''2465940''>data''s</span> <span m=''2466510''>flowing.</span>
  <span m=''2468200''>I</span> <span m=''2468290''>find</span> <span m=''2468590''>these</span>
  <span m=''2468760''>operations</span> <span m=''2470150''>and</span> <span m=''2470470''>I</span>
  <span m=''2470590''>can</span> <span m=''2471090''>vectorize</span> <span m=''2471540''>that</span>
  <span m=''2471730''>as</span> <span m=''2471830''>well.</span> </p><p><span m=''2478160''>So,</span>
  <span m=''2478750''>sign</span> <span m=''2479030''>up</span> <span m=''2479190''>with</span>
  <span m=''2479410''>a vectorizable</span> <span m=''2480510''>loop</span> <span
  m=''2481070''>where</span> <span m=''2481570''>all</span> <span m=''2481730''>my</span>
  <span m=''2481860''>instructions,</span> <span m=''2482480''>all</span> <span m=''2482590''>my</span>
  <span m=''2482710''>scale</span> <span m=''2482970''>instructions</span> <span m=''2483790''>are</span>
  <span m=''2483910''>now in</span> <span m=''2484430''>SIMD</span> <span m=''2484520''>instructions.</span>
  <span m=''2485820''>I</span> <span m=''2485870''>can</span> <span m=''2486010''>cut</span>
  <span m=''2486230''>down</span> <span m=''2486530''>on</span> <span m=''2488650''>loop
  iterations of</span> <span m=''2489480''>total</span> <span m=''2489720''>number
  of</span> <span m=''2490000''>instructions</span> <span m=''2490420''>that I</span>
  <span m=''2490530''>issue.</span> <span m=''2491220''>But</span> <span m=''2491370''>I''ve</span>
  <span m=''2491430''>made</span> <span m=''2491700''>some</span> <span m=''2491900''>implicit</span>
  <span m=''2492370''>assumption</span> <span m=''2492820''>here.</span> <span m=''2493650''>Anybody</span>
  <span m=''2494410''>know</span> <span m=''2494580''>what</span> <span m=''2494710''>it</span>
  <span m=''2494800''>is?</span> </p><p><span m=''2495020''>AUDIENCE:</span> <span
  m=''2501050''>Do</span> <span m=''2501298''>you</span> <span m=''2501546''>actually</span>
  <span m=''2501794''>need</span> <span m=''2502042''>that</span> <span m=''2502290''>many</span>
  <span m=''2502538''>iterations</span> <span m=''2502786''>of</span> <span m=''2503034''>the</span>
  <span m=''2503282''>loop?</span> </p><p><span m=''2504580''>PROFESSOR: Well,</span>
  <span m=''2505510''>so</span> <span m=''2505660''>you</span> <span m=''2505810''>can</span>
  <span m=''2506080''>factor</span> <span m=''2506470''>down</span> <span m=''2506730''>the</span>
  <span m=''2506800''>cost.</span> <span m=''2507340''>so</span> <span m=''2507460''>here</span>
  <span m=''2507680''>I''ve</span> <span m=''2507730''>vectorized</span> <span m=''2508210''>by</span>
  <span m=''2508370''>2, so I would</span> <span m=''2508980''>cut</span> <span m=''2509190''>down
  the</span> <span m=''2509440''>number of</span> <span m=''2509830''>iterations</span>
  <span m=''2510200''>by</span> <span m=''2510310''>2.</span> </p><p><span m=''2510590''>AUDIENCE:</span>
  <span m=''2511710''>You could have an odd number of iterations?</span> </p><p><span
  m=''2512830''>PROFESSOR: Right,</span> <span m=''2513130''>so</span> <span m=''2513210''>you
  could</span> <span m=''2513350''>have</span> <span m=''2513620''>an odd</span> <span
  m=''2513870''>number</span> <span m=''2514100''>of</span> <span m=''2514190''>iterations.</span>
  <span m=''2515110''>What</span> <span m=''2515250''>do</span> <span m=''2515320''>you</span>
  <span m=''2515420''>do</span> <span m=''2515600''>about</span> <span m=''2516190''>the</span>
  <span m=''2516290''>remaining</span> <span m=''2516960''>iterations.</span> <span
  m=''2517400''>You</span> <span m=''2517500''>might</span> <span m=''2517660''>have</span>
  <span m=''2517800''>to</span> <span m=''2517900''>do</span> <span m=''2518000''>scaler</span>
  <span m=''2518270''>code</span> <span m=''2518540''>for</span> <span m=''2518670''>that.</span>
  <span m=''2519760''>What</span> <span m=''2519940''>are</span> <span m=''2520000''>some</span>
  <span m=''2520190''>other</span> <span m=''2520420''>assumptions?</span> <span m=''2522260''>Maybe</span>
  <span m=''2522620''>it will</span> <span m=''2522820''>be</span> <span m=''2522950''>clear</span>
  <span m=''2524340''>here.</span> </p><p><span m=''2527380''>So</span> <span m=''2527510''>in
  vectorizing</span> <span m=''2528300''>this,</span> <span m=''2528670''>what</span>
  <span m=''2528820''>have</span> <span m=''2528980''>I</span> <span m=''2529080''>assumed</span>
  <span m=''2529600''>about</span> <span m=''2530160''>relationships</span> <span
  m=''2530820''>between</span> <span m=''2531200''>these</span> <span m=''2531350''>statements?</span>
  <span m=''2533040''>I''ve</span> <span m=''2533120''>essentially</span> <span m=''2533730''>reorganized</span>
  <span m=''2534580''>all</span> <span m=''2534770''>the</span> <span m=''2534850''>statements</span>
  <span m=''2535360''>so</span> <span m=''2535490''>that</span> <span m=''2535690''>assumes</span>
  <span m=''2536550''>I</span> <span m=''2536620''>have</span> <span m=''2536840''>this</span>
  <span m=''2537050''>liberty</span> <span m=''2537530''>to</span> <span m=''2537700''>move</span>
  <span m=''2537900''>instructions</span> <span m=''2538330''>around.</span> <span
  m=''2539520''>Yup?</span> </p><p><span m=''2539810''>AUDIENCE:</span> <span m=''2540308''>[UNINTELLIGIBLE]</span>
  <span m=''2540807''>a</span> <span m=''2541305''>and b</span> <span m=''2541804''>don''t</span>
  <span m=''2542302''>change</span> <span m=''2542801''>[INAUDIBLE PHRASE].</span>
  </p><p><span m=''2543300''>PROFESSOR: Right.</span> <span m=''2543790''>So</span>
  <span m=''2544000''>there''s</span> <span m=''2544370''>nothing</span> <span m=''2544730''>in</span>
  <span m=''2544830''>here</span> <span m=''2545050''>that''s</span> <span m=''2545170''>changing</span>
  <span m=''2545550''>the</span> <span m=''2545630''>values.</span> <span m=''2547830''>There''s</span>
  <span m=''2547980''>no</span> <span m=''2548100''>dependencies</span> <span m=''2548700''>between</span>
  <span m=''2549050''>these</span> <span m=''2549170''>statements --</span> <span
  m=''2549740''>no</span> <span m=''2549930''>flow</span> <span m=''2550070''>dependencies</span>
  <span m=''2551590''>and</span> <span m=''2551830''>no</span> <span m=''2551890''>other</span>
  <span m=''2552080''>kind of</span> <span m=''2552380''>constraints</span> <span
  m=''2552840''>that</span> <span m=''2553300''>limit</span> <span m=''2553910''>this</span>
  <span m=''2554060''>kind</span> <span m=''2554320''>of</span> <span m=''2554430''>movement.</span>
  <span m=''2554930''>So in</span> <span m=''2555210''>real</span> <span m=''2555400''>code</span>
  <span m=''2555710''>it''s</span> <span m=''2555810''>not</span> <span m=''2555990''>actually</span>
  <span m=''2556350''>the</span> <span m=''2556420''>case.</span> <span m=''2556800''>You</span>
  <span m=''2556940''>end</span> <span m=''2557060''>up</span> <span m=''2557190''>with</span>
  <span m=''2557370''>patterns</span> <span m=''2557810''>of</span> <span m=''2558260''>computation</span>
  <span m=''2558960''>where</span> <span m=''2559520''>you</span> <span m=''2559720''>can</span>
  <span m=''2559920''>get</span> <span m=''2560150''>really a</span> <span m=''2560420''>nice</span>
  <span m=''2560700''>case of</span> <span m=''2561120''>classic</span> <span m=''2561480''>cases</span>
  <span m=''2561790''>you</span> <span m=''2561900''>can</span> <span m=''2563240''>vectorize</span>
  <span m=''2563510''>those</span> <span m=''2563710''>really</span> <span m=''2563910''>nicely.</span>
  <span m=''2564840''>In</span> <span m=''2565440''>a</span> <span m=''2565470''>lot</span>
  <span m=''2565650''>of</span> <span m=''2565800''>other</span> <span m=''2565980''>codes</span>
  <span m=''2566380''>you</span> <span m=''2566470''>have</span> <span m=''2566600''>a</span>
  <span m=''2566660''>mix</span> <span m=''2566960''>of</span> <span m=''2567440''>vectorizable</span>
  <span m=''2568020''>code</span> <span m=''2568350''>and</span> <span m=''2568490''>scaler</span>
  <span m=''2568750''>code</span> <span m=''2569390''>and</span> <span m=''2569540''>there''s</span>
  <span m=''2569680''>a</span> <span m=''2569710''>lot</span> <span m=''2569860''>of</span>
  <span m=''2569930''>communication</span> <span m=''2570520''>between</span> <span
  m=''2570830''>the</span> <span m=''2570900''>two.</span> <span m=''2571380''>So</span>
  <span m=''2571540''>the</span> <span m=''2571600''>cost</span> <span m=''2571990''>is</span>
  <span m=''2572160''>really</span> <span m=''2573190''>something</span> <span m=''2573490''>significant</span>
  <span m=''2573990''>that you</span> <span m=''2574090''>have</span> <span m=''2574270''>to</span>
  <span m=''2574370''>consider.</span> </p><p><span m=''2577510''>This</span> <span
  m=''2577710''>was,</span> <span m=''2578530''>as</span> <span m=''2578660''>I</span>
  <span m=''2578710''>mentioned,</span> <span m=''2579200''>done</span> <span m=''2579510''>in</span>
  <span m=''2579670''>somebody''s</span> <span m=''2580020''>Masters</span> <span
  m=''2580380''>thesis</span> <span m=''2580780''>and</span> <span m=''2581480''>eventually</span>
  <span m=''2583160''>led</span> <span m=''2583470''>to</span> <span m=''2583740''>some</span>
  <span m=''2583940''>additional</span> <span m=''2584300''>work</span> <span m=''2584610''>that</span>
  <span m=''2584800''>was his</span> <span m=''2584960''>PhD</span> <span m=''2585360''>thesis.</span>
  <span m=''2586770''>So</span> <span m=''2586980''>in</span> <span m=''2587110''>some</span>
  <span m=''2587260''>of</span> <span m=''2587320''>the</span> <span m=''2587390''>early</span>
  <span m=''2587660''>work,</span> <span m=''2588060''>what</span> <span m=''2588230''>he</span>
  <span m=''2588330''>did</span> <span m=''2588560''>was</span> <span m=''2588730''>he</span>
  <span m=''2588850''>looked</span> <span m=''2589090''>at</span> <span m=''2589260''>a</span>
  <span m=''2589370''>bunch</span> <span m=''2589600''>of</span> <span m=''2589720''>benchmarks</span>
  <span m=''2590640''>and</span> <span m=''2591130''>looked</span> <span m=''2591320''>at</span>
  <span m=''2591400''>how</span> <span m=''2591600''>much</span> <span m=''2592020''>available</span>
  <span m=''2592470''>parallelism</span> <span m=''2593020''>you</span> <span m=''2593090''>have</span>
  <span m=''2593810''>in</span> <span m=''2593960''>terms</span> <span m=''2594210''>of</span>
  <span m=''2594380''>this</span> <span m=''2594630''>kind</span> <span m=''2594910''>of</span>
  <span m=''2595360''>short</span> <span m=''2595700''>vector</span> <span m=''2595960''>parallelism,</span>
  <span m=''2597630''>or</span> <span m=''2597860''>rather</span> <span m=''2598210''>SLP</span>
  <span m=''2598660''>where</span> <span m=''2598840''>you''re</span> <span m=''2598970''>looking</span>
  <span m=''2599240''>for</span> <span m=''2600260''>vectorizable</span> <span m=''2600840''>code</span>
  <span m=''2601130''>within</span> <span m=''2601410''>basic</span> <span m=''2601970''>blocks,</span>
  <span m=''2603050''>which</span> <span m=''2603290''>really</span> <span m=''2603490''>differed</span>
  <span m=''2603830''>from a</span> <span m=''2604230''>classic</span> <span m=''2604600''>way</span>
  <span m=''2604770''>of</span> <span m=''2604850''>people</span> <span m=''2605150''>looking</span>
  <span m=''2605430''>for</span> <span m=''2605570''>vectorization.</span> <span m=''2606100''>[?
  And you ?]</span> <span m=''2606550''>have</span> <span m=''2606830''>well-structured</span>
  <span m=''2607400''>loops and</span> <span m=''2607950''>doing</span> <span m=''2608450''>kinds</span>
  <span m=''2608760''>of</span> <span m=''2608840''>transformations</span> <span m=''2609390''>you''ll</span>
  <span m=''2609520''>hear</span> <span m=''2609680''>about</span> <span m=''2609900''>next</span>
  <span m=''2610130''>week.</span> </p><p><span m=''2612120''>So</span> <span m=''2612560''>for</span>
  <span m=''2612730''>different</span> <span m=''2613080''>kinds</span> <span m=''2613380''>of</span>
  <span m=''2613480''>vector</span> <span m=''2613750''>registers,</span> <span m=''2614860''>so</span>
  <span m=''2614990''>these</span> <span m=''2615150''>are</span> <span m=''2615240''>your</span>
  <span m=''2615370''>vector</span> <span m=''2615670''>lens.</span> <span m=''2616010''>So</span>
  <span m=''2616190''>going</span> <span m=''2616410''>from</span> <span m=''2616560''>128</span>
  <span m=''2617250''>bits</span> <span m=''2617870''>to</span> <span m=''2618080''>1,024</span>
  <span m=''2619310''>bits,</span> <span m=''2620890''>you</span> <span m=''2620990''>can</span>
  <span m=''2621090''>actually</span> <span m=''2621470''>reduce</span> <span m=''2621820''>a</span>
  <span m=''2621870''>whole</span> <span m=''2622070''>lot</span> <span m=''2622270''>of</span>
  <span m=''2622370''>instructions.</span> <span m=''2623330''>So</span> <span m=''2623840''>what</span>
  <span m=''2624020''>I''m</span> <span m=''2624110''>showing</span> <span m=''2624420''>here</span>
  <span m=''2625080''>is</span> <span m=''2625250''>the</span> <span m=''2625340''>percent</span>
  <span m=''2625890''>dynamic</span> <span m=''2626380''>instruction</span> <span
  m=''2626860''>reduction.</span> <span m=''2627420''>So</span> <span m=''2627610''>if</span>
  <span m=''2627730''>I</span> <span m=''2628300''>take</span> <span m=''2628520''>my</span>
  <span m=''2628740''>baseline</span> <span m=''2629280''>application</span> <span
  m=''2630220''>and</span> <span m=''2630510''>just</span> <span m=''2630670''>compile
  it in a</span> <span m=''2631170''>normal</span> <span m=''2631440''>way</span>
  <span m=''2631620''>and</span> <span m=''2631730''>I</span> <span m=''2631820''>run
  it</span> <span m=''2632290''>again an</span> <span m=''2632560''>instruction</span>
  <span m=''2633000''>count.</span> <span m=''2633670''>I</span> <span m=''2633830''>apply</span>
  <span m=''2634400''>this</span> <span m=''2634600''>SLP</span> <span m=''2634900''>technique</span>
  <span m=''2635340''>that</span> <span m=''2635710''>find</span> <span m=''2636030''>the</span>
  <span m=''2636160''>SIMDization</span> <span m=''2637060''>and then</span> <span
  m=''2637290''>run</span> <span m=''2637420''>my</span> <span m=''2637530''>application</span>
  <span m=''2638020''>again,</span> <span m=''2638620''>use</span> <span m=''2638740''>the</span>
  <span m=''2638870''>performance</span> <span m=''2639150''>counters</span> <span
  m=''2639500''>to</span> <span m=''2639670''>count</span> <span m=''2639860''>the</span>
  <span m=''2639940''>number</span> <span m=''2640160''>of</span> <span m=''2640230''>instructions</span>
  <span m=''2641110''>and</span> <span m=''2641480''>compare</span> <span m=''2641850''>the</span>
  <span m=''2641930''>two.</span> <span m=''2643450''>I</span> <span m=''2643490''>can</span>
  <span m=''2643640''>get</span> <span m=''2643850''>60%,</span> <span m=''2644610''>50%,</span>
  <span m=''2645250''>40%.</span> <span m=''2647020''>In some</span> <span m=''2647160''>cases</span>
  <span m=''2647530''>I can</span> <span m=''2647690''>completely</span> <span m=''2648200''>eliminate</span>
  <span m=''2650350''>almost</span> <span m=''2650780''>90%</span> <span m=''2651340''>or</span>
  <span m=''2651430''>more</span> <span m=''2651700''>of</span> <span m=''2651790''>the</span>
  <span m=''2651860''>instructions.</span> <span m=''2652660''>So</span> <span m=''2652850''>it''s</span>
  <span m=''2653230''>a</span> <span m=''2653350''>lot</span> <span m=''2653530''>of</span>
  <span m=''2653620''>opportunity</span> <span m=''2654190''>for</span> <span m=''2655010''>performance</span>
  <span m=''2655510''>improvements</span> <span m=''2656410''>that</span> <span m=''2656550''>might</span>
  <span m=''2656780''>be</span> <span m=''2658460''>apparent.</span> <span m=''2659410''>One</span>
  <span m=''2659620''>because</span> <span m=''2659940''>I''m</span> <span m=''2660050''>reducing
  the</span> <span m=''2660550''>instruction</span> <span m=''2660980''>bandwidth,</span>
  <span m=''2661820''>I''m</span> <span m=''2662130''>reducing</span> <span m=''2662570''>the</span>
  <span m=''2662650''>amount</span> <span m=''2662930''>of</span> <span m=''2663010''>space</span>
  <span m=''2663410''>I</span> <span m=''2663590''>need</span> <span m=''2663680''>in</span>
  <span m=''2663750''>my</span> <span m=''2663910''>instruction</span> <span m=''2664320''>cache,</span>
  <span m=''2665370''>I have</span> <span m=''2665660''>fewer</span> <span m=''2665930''>instructions</span>
  <span m=''2666470''>so I</span> <span m=''2666640''>can</span> <span m=''2666790''>fit</span>
  <span m=''2666890''>more</span> <span m=''2667070''>instructions</span> <span m=''2667490''>into</span>
  <span m=''2667590''>my</span> <span m=''2667750''>instruction</span> <span m=''2668170''>cache,</span>
  <span m=''2669860''>you</span> <span m=''2669970''>reduce the</span> <span m=''2670300''>number
  of</span> <span m=''2670520''>branches.</span> <span m=''2671190''>You</span> <span
  m=''2671330''>get</span> <span m=''2671590''>better</span> <span m=''2672410''>bandwidth</span>
  <span m=''2672670''>to</span> <span m=''2672850''>the</span> <span m=''2672930''>memory,</span>
  <span m=''2673720''>better</span> <span m=''2673930''>use</span> <span m=''2674220''>of</span>
  <span m=''2674580''>the</span> <span m=''2674870''>memory</span> <span m=''2675210''>bandwidth.</span>
  </p><p><span m=''2677080''>Overall,</span> <span m=''2679270''>you''re</span> <span
  m=''2679480''>running</span> <span m=''2679730''>fewer</span> <span m=''2679970''>iterations,</span>
  <span m=''2680680''>so</span> <span m=''2680880''>you''re</span> <span m=''2681010''>getting</span>
  <span m=''2681250''>lots</span> <span m=''2681520''>of</span> <span m=''2682080''>potential</span>
  <span m=''2682410''>for</span> <span m=''2682980''>performance.</span> <span m=''2684050''>So,
  I</span> <span m=''2684590''>actually</span> <span m=''2684960''>ran</span> <span
  m=''2685170''>this</span> <span m=''2685300''>on</span> <span m=''2685490''>the</span>
  <span m=''2685570''>AltiVec.</span> <span m=''2686350''>This</span> <span m=''2686510''>was</span>
  <span m=''2687810''>one of the</span> <span m=''2687950''>earliest</span> <span
  m=''2688600''>generations</span> <span m=''2689170''>of</span> <span m=''2689420''>AltiVec,</span>
  <span m=''2689600''>which</span> <span m=''2690710''>SIMD</span> <span m=''2691010''>instructions</span>
  <span m=''2691500''>didn''t</span> <span m=''2691730''>have</span> <span m=''2692390''>I</span>
  <span m=''2692730''>believe</span> <span m=''2693130''>double</span> <span m=''2696710''>precision</span>
  <span m=''2697100''>floating</span> <span m=''2697400''>point,</span> <span m=''2697960''>so</span>
  <span m=''2698240''>not</span> <span m=''2698470''>all</span> <span m=''2698590''>the</span>
  <span m=''2698650''>benchmarks</span> <span m=''2699040''>you see</span> <span m=''2699220''>on
  the</span> <span m=''2699420''>previsou</span> <span m=''2699750''>slide are</span>
  <span m=''2699990''>here,</span> <span m=''2701390''>only the</span> <span m=''2701640''>ones</span>
  <span m=''2701900''>that</span> <span m=''2702040''>could</span> <span m=''2702190''>run</span>
  <span m=''2702470''>reasonably</span> <span m=''2702940''>accurately</span> <span
  m=''2703480''>with a</span> <span m=''2703880''>single</span> <span m=''2704120''>precision</span>
  <span m=''2704470''>floating</span> <span m=''2704750''>point.</span> <span m=''2705590''>What</span>
  <span m=''2705670''>they</span> <span m=''2705790''>measure is the</span> <span
  m=''2706200''>actual</span> <span m=''2706540''>speed</span> <span m=''2706800''>up.</span>
  <span m=''2708240''>Doing</span> <span m=''2708470''>this</span> <span m=''2708590''>SIMDization</span>
  <span m=''2709140''>versus</span> <span m=''2709420''>not doing</span> <span m=''2709870''>a</span>
  <span m=''2709990''>SIMDization,</span> <span m=''2710690''>how</span> <span m=''2710810''>much</span>
  <span m=''2710960''>performance</span> <span m=''2711370''>you</span> <span m=''2711470''>can</span>
  <span m=''2711610''>get.</span> <span m=''2712470''>The thing to</span> <span m=''2712830''>take</span>
  <span m=''2713060''>away</span> <span m=''2713370''>is</span> <span m=''2713870''>in</span>
  <span m=''2714020''>some</span> <span m=''2714180''>cases</span> <span m=''2714530''>where</span>
  <span m=''2717110''>you</span> <span m=''2717260''>have</span> <span m=''2717550''>nicely</span>
  <span m=''2717920''>structured</span> <span m=''2718300''>loops</span> <span m=''2719000''>and</span>
  <span m=''2719320''>some</span> <span m=''2719420''>nice</span> <span m=''2719660''>patterns,</span>
  <span m=''2720040''>you</span> <span m=''2720140''>can</span> <span m=''2720260''>get</span>
  <span m=''2720600''>up</span> <span m=''2720700''>to</span> <span m=''2720870''>7x</span>
  <span m=''2721390''>speed</span> <span m=''2721570''>up</span> <span m=''2722040''>on</span>
  <span m=''2722950''>some</span> <span m=''2723180''>benchmarks.</span> <span m=''2724250''>What</span>
  <span m=''2724590''>might</span> <span m=''2724820''>be</span> <span m=''2725290''>the</span>
  <span m=''2725370''>maximum</span> <span m=''2725730''>speed</span> <span m=''2726030''>up</span>
  <span m=''2726330''>that</span> <span m=''2726430''>you</span> <span m=''2726530''>can</span>
  <span m=''2726660''>get</span> <span m=''2727020''>depends</span> <span m=''2727410''>on</span>
  <span m=''2727510''>the</span> <span m=''2727580''>vector</span> <span m=''2727820''>lens,</span>
  <span m=''2727980''>so</span> <span m=''2728470''>8,</span> <span m=''2729370''>for</span>
  <span m=''2729520''>example</span> <span m=''2730910''>on</span> <span m=''2731060''>some</span>
  <span m=''2731210''>architectures</span> <span m=''2732430''>depending</span> <span
  m=''2732830''>on</span> <span m=''2732930''>the</span> <span m=''2733010''>data</span>
  <span m=''2733230''>type.</span> </p><p><span m=''2735170''>Is there</span> <span
  m=''2735360''>any</span> <span m=''2735580''>questions</span> <span m=''2735900''>on</span>
  <span m=''2736000''>that?</span> </p><p><span m=''2738500''>So</span> <span m=''2738740''>as</span>
  <span m=''2738810''>part</span> <span m=''2739070''>of</span> <span m=''2739260''>the</span>
  <span m=''2739340''>next</span> <span m=''2739580''>recitation,</span> <span m=''2740120''>you''ll</span>
  <span m=''2740250''>actually</span> <span m=''2740530''>get an</span> <span m=''2740690''>exercise</span>
  <span m=''2741290''>of</span> <span m=''2741670''>going</span> <span m=''2741960''>through</span>
  <span m=''2742220''>and</span> <span m=''2742370''>SIMDizing</span> <span m=''2742850''>for</span>
  <span m=''2743000''>Cell,</span> <span m=''2743660''>and</span> <span m=''2743920''>whether</span>
  <span m=''2744040''>that</span> <span m=''2744140''>actually</span> <span m=''2744480''>means</span>
  <span m=''2744870''>SIMDize</span> <span m=''2745300''>instructions</span> <span
  m=''2745790''>for</span> <span m=''2745900''>Cell</span> <span m=''2746650''>might</span>
  <span m=''2746960''>take</span> <span m=''2747160''>statements</span> <span m=''2747680''>and</span>
  <span m=''2747780''>sort</span> <span m=''2747930''>of</span> <span m=''2747990''>replace</span>
  <span m=''2748370''>them</span> <span m=''2748480''>by</span> <span m=''2748620''>intrinsic</span>
  <span m=''2749020''>functions,</span> <span m=''2749660''>which</span> <span m=''2749910''>eventually</span>
  <span m=''2750320''>map</span> <span m=''2750580''>down</span> <span m=''2750840''>to</span>
  <span m=''2751360''>actually</span> <span m=''2751820''>assembly</span> <span m=''2752150''>op</span>
  <span m=''2752270''>codes</span> <span m=''2752890''>that</span> <span m=''2753080''>you''ll
  need.</span> <span m=''2753630''>So</span> <span m=''2753770''>you</span> <span
  m=''2753900''>don''t</span> <span m=''2754060''>actually</span> <span m=''2754370''>have</span>
  <span m=''2754550''>to</span> <span m=''2754640''>program</span> <span m=''2755070''>at</span>
  <span m=''2755140''>the</span> <span m=''2755240''>assembly</span> <span m=''2755560''>level,</span>
  <span m=''2755940''>although</span> <span m=''2756230''>in effect, you''re</span>
  <span m=''2756720''>probably</span> <span m=''2757020''>doing the</span> <span m=''2757260''>same</span>
  <span m=''2757500''>thing.</span> </p><p><span m=''2760080''>Last</span> <span m=''2760300''>thing</span>
  <span m=''2760400''>we''ll</span> <span m=''2760500''>talk</span> <span m=''2760730''>about</span>
  <span m=''2760960''>today</span> <span m=''2761240''>is</span> <span m=''2762230''>optimizing</span>
  <span m=''2762750''>for the</span> <span m=''2763040''>memeory</span> <span m=''2763260''>hierarchy.</span>
  <span m=''2765110''>In</span> <span m=''2765230''>addition</span> <span m=''2765620''>to</span>
  <span m=''2766100''>data</span> <span m=''2766280''>level</span> <span m=''2766530''>parallelism,</span>
  <span m=''2767080''>looking</span> <span m=''2767330''>for</span> <span m=''2767950''>performance</span>
  <span m=''2768540''>enhancements</span> <span m=''2769220''>in the</span> <span
  m=''2769350''>memory</span> <span m=''2769610''>system</span> <span m=''2770530''>gives</span>
  <span m=''2770800''>you</span> <span m=''2771250''>the</span> <span m=''2771350''>best</span>
  <span m=''2771560''>opportunities</span> <span m=''2772200''>because</span> <span
  m=''2772780''>of</span> <span m=''2774000''>this</span> <span m=''2775750''>big</span>
  <span m=''2775990''>gap</span> <span m=''2776510''>in</span> <span m=''2777250''>performance</span>
  <span m=''2779250''>between</span> <span m=''2779730''>memory</span> <span m=''2779970''>access</span>
  <span m=''2780310''>latencies</span> <span m=''2781060''>and</span> <span m=''2781500''>what</span>
  <span m=''2781670''>the</span> <span m=''2782030''>CPU</span> <span m=''2783800''>efficiency</span>
  <span m=''2784300''>is.</span> <span m=''2784840''>So</span> <span m=''2785280''>exploiting</span>
  <span m=''2785730''>locality</span> <span m=''2786240''>in a</span> <span m=''2786390''>memroy</span>
  <span m=''2786570''>system</span> <span m=''2786930''>is</span> <span m=''2787050''>key.</span>
  <span m=''2787380''>So these</span> <span m=''2787770''>concepts</span> <span m=''2788160''>of</span>
  <span m=''2788280''>temporal</span> <span m=''2788710''>and</span> <span m=''2788840''>spatial</span>
  <span m=''2789180''>locality.</span> <span m=''2790940''>So</span> <span m=''2791110''>let''s</span>
  <span m=''2791310''>look</span> <span m=''2791490''>at an</span> <span m=''2791640''>example.</span>
  </p><p><span m=''2792770''>Let''s</span> <span m=''2792950''>say</span> <span m=''2793080''>I</span>
  <span m=''2793180''>have</span> <span m=''2793370''>a</span> <span m=''2793430''>loop</span>
  <span m=''2794120''>and</span> <span m=''2794520''>in</span> <span m=''2794600''>this</span>
  <span m=''2794810''>loop</span> <span m=''2795340''>I</span> <span m=''2795470''>have</span>
  <span m=''2796990''>some</span> <span m=''2797310''>code</span> <span m=''2797870''>that''s</span>
  <span m=''2798320''>embodied</span> <span m=''2798840''>in</span> <span m=''2799260''>some</span>
  <span m=''2799430''>function</span> <span m=''2799790''>a,</span> <span m=''2801550''>some</span>
  <span m=''2801780''>code</span> <span m=''2802050''>embodied</span> <span m=''2802440''>in
  some</span> <span m=''2802550''>function</span> <span m=''2802880''>b,</span> <span
  m=''2803100''>and</span> <span m=''2803220''>some</span> <span m=''2803360''>code
  in</span> <span m=''2803690''>some</span> <span m=''2803810''>function</span> <span
  m=''2804140''>c.</span> <span m=''2805660''>The</span> <span m=''2805740''>values</span>
  <span m=''2806130''>produced</span> <span m=''2806520''>by</span> <span m=''2806710''>a</span>
  <span m=''2806940''>are</span> <span m=''2807080''>consumed</span> <span m=''2807710''>by</span>
  <span m=''2808880''>the</span> <span m=''2809020''>function</span> <span m=''2809370''>b,</span>
  <span m=''2809720''>and similarly the</span> <span m=''2810200''>values</span> <span
  m=''2810500''>consumed</span> <span m=''2810820''>by</span> <span m=''2810930''>b</span>
  <span m=''2811280''>are</span> <span m=''2811430''>consumed</span> <span m=''2811870''>by</span>
  <span m=''2813280''>c.</span> <span m=''2813880''>So</span> <span m=''2814030''>this</span>
  <span m=''2814210''>is</span> <span m=''2814750''>a</span> <span m=''2814820''>general</span>
  <span m=''2815200''>data</span> <span m=''2815440''>flow</span> <span m=''2815680''>graph
  that</span> <span m=''2816230''>you</span> <span m=''2816530''>might</span> <span
  m=''2816700''>have</span> <span m=''2816900''>for</span> <span m=''2817040''>this</span>
  <span m=''2817170''>function.</span> <span m=''2818590''>Let''s</span> <span m=''2818790''>say</span>
  <span m=''2818920''>that</span> <span m=''2821210''>all the</span> <span m=''2821410''>data</span>
  <span m=''2821690''>could</span> <span m=''2822030''>go</span> <span m=''2822230''>into</span>
  <span m=''2822520''>a small</span> <span m=''2822950''>array</span> <span m=''2823240''>that</span>
  <span m=''2823310''>then</span> <span m=''2823460''>I</span> <span m=''2823550''>can</span>
  <span m=''2824050''>communicate</span> <span m=''2826860''>between</span> <span
  m=''2827220''>functions.</span> <span m=''2828870''>So</span> <span m=''2829040''>if</span>
  <span m=''2829130''>I</span> <span m=''2829200''>look</span> <span m=''2829410''>at</span>
  <span m=''2829650''>my</span> <span m=''2829830''>actual</span> <span m=''2830190''>cache</span>
  <span m=''2830540''>size</span> <span m=''2831460''>and</span> <span m=''2831860''>how</span>
  <span m=''2832060''>the</span> <span m=''2832130''>working</span> <span m=''2832500''>set</span>
  <span m=''2832750''>of</span> <span m=''2833010''>each</span> <span m=''2833210''>of</span>
  <span m=''2833270''>these</span> <span m=''2833430''>functions</span> <span m=''2833810''>is,</span>
  <span m=''2834460''>so</span> <span m=''2834610''>let''s</span> <span m=''2834790''>say</span>
  <span m=''2834970''>this</span> <span m=''2835120''>is</span> <span m=''2835260''>my</span>
  <span m=''2835400''>cache</span> <span m=''2835750''>size --</span> <span m=''2836290''>this
  is</span> <span m=''2836450''>how</span> <span m=''2837370''>many</span> <span m=''2837530''>instructions</span>
  <span m=''2838020''>I</span> <span m=''2838100''>can</span> <span m=''2838260''>pack</span>
  <span m=''2838570''>into</span> <span m=''2838740''>the</span> <span m=''2838820''>cache.</span>
  <span m=''2840390''>Looking</span> <span m=''2840650''>at</span> <span m=''2840760''>the</span>
  <span m=''2840840''>collective</span> <span m=''2841360''>number</span> <span m=''2841620''>of</span>
  <span m=''2841720''>instructions</span> <span m=''2842270''>in</span> <span m=''2842420''>each</span>
  <span m=''2842490''>one of these</span> <span m=''2842880''>functions,</span> <span
  m=''2844790''>I</span> <span m=''2845530''>overflow</span> <span m=''2845740''>that.</span>
  <span m=''2845990''>I</span> <span m=''2846080''>have</span> <span m=''2846280''>more</span>
  <span m=''2846510''>instructions</span> <span m=''2847070''>I</span> <span m=''2847170''>can</span>
  <span m=''2847330''>fit</span> <span m=''2847490''>into</span> <span m=''2847680''>my</span>
  <span m=''2847810''>cache</span> <span m=''2848180''>any</span> <span m=''2848400''>one</span>
  <span m=''2848600''>time.</span> </p><p><span m=''2850130''>So</span> <span m=''2850370''>what</span>
  <span m=''2850530''>does</span> <span m=''2850640''>that</span> <span m=''2850770''>mean</span>
  <span m=''2850920''>for my</span> <span m=''2851060''>actual</span> <span m=''2851450''>cash</span>
  <span m=''2851670''>performance?</span> <span m=''2852890''>So</span> <span m=''2853070''>when</span>
  <span m=''2853220''>I</span> <span m=''2853280''>run</span> <span m=''2853560''>a,</span>
  <span m=''2855110''>what</span> <span m=''2855300''>do</span> <span m=''2855380''>I</span>
  <span m=''2855460''>expect</span> <span m=''2855880''>the</span> <span m=''2857460''>cache</span>
  <span m=''2857900''>hit and miss</span> <span m=''2858490''>rate</span> <span m=''2858780''>behavior</span>
  <span m=''2859170''>to</span> <span m=''2859320''>be</span> <span m=''2859410''>like?</span>
  <span m=''2860670''>So</span> <span m=''2861640''>in the</span> <span m=''2861800''>first</span>
  <span m=''2862030''>iteration,</span> <span m=''2864220''>I</span> <span m=''2864340''>need
  the</span> <span m=''2864580''>instructions</span> <span m=''2865010''>for a.</span>
  <span m=''2865830''>I''ve</span> <span m=''2865970''>never</span> <span m=''2866150''>seen</span>
  <span m=''2866370''>a</span> <span m=''2866550''>before</span> <span m=''2867060''>so</span>
  <span m=''2867330''>I have to</span> <span m=''2867580''>fetch that</span> <span
  m=''2867760''>data</span> <span m=''2868040''>from</span> <span m=''2868210''>memory</span>
  <span m=''2868590''>and</span> <span m=''2868740''>put</span> <span m=''2868900''>in</span>
  <span m=''2869000''>the</span> <span m=''2869080''>cache.</span> <span m=''2869840''>So,</span>
  <span m=''2870030''>the</span> <span m=''2870180''>attachments.</span> <span m=''2873320''>So
  what</span> <span m=''2873570''>about b?</span> <span m=''2878330''>Then</span>
  <span m=''2878380''>c?</span> <span m=''2879310''>Same</span> <span m=''2879490''>thing.</span>
  </p><p><span m=''2880420''>So</span> <span m=''2880870''>now</span> <span m=''2881340''>I''m</span>
  <span m=''2881970''>back</span> <span m=''2882200''>at</span> <span m=''2882270''>the</span>
  <span m=''2882340''>top</span> <span m=''2882580''>of</span> <span m=''2882650''>my</span>
  <span m=''2882750''>loop.</span> <span m=''2883920''>So</span> <span m=''2884110''>if</span>
  <span m=''2884670''>everything</span> <span m=''2885040''>fit</span> <span m=''2885250''>in</span>
  <span m=''2885320''>the</span> <span m=''2885390''>cache</span> <span m=''2885840''>then</span>
  <span m=''2886090''>I</span> <span m=''2886140''>would</span> <span m=''2886250''>expect</span>
  <span m=''2886640''>a</span> <span m=''2886930''>to</span> <span m=''2887000''>be</span>
  <span m=''2887660''>a</span> <span m=''2888010''>what?</span> <span m=''2890230''>You''ll</span>
  <span m=''2890360''>be a</span> <span m=''2890480''>hit.</span> <span m=''2891320''>But</span>
  <span m=''2891490''>since</span> <span m=''2891860''>I''ve</span> <span m=''2893260''>constrained</span>
  <span m=''2893620''>this</span> <span m=''2893740''>problem</span> <span m=''2894070''>such</span>
  <span m=''2894290''>that</span> <span m=''2894690''>the</span> <span m=''2894900''>working</span>
  <span m=''2895050''>set</span> <span m=''2895210''>doesn''t</span> <span m=''2895450''>really</span>
  <span m=''2895670''>fit</span> <span m=''2895870''>in</span> <span m=''2895940''>the</span>
  <span m=''2896010''>cache,</span> <span m=''2896710''>what</span> <span m=''2896850''>that</span>
  <span m=''2897000''>means</span> <span m=''2897220''>is</span> <span m=''2897330''>that
  I</span> <span m=''2897550''>have</span> <span m=''2897710''>to</span> <span m=''2897820''>fetch</span>
  <span m=''2898210''>some</span> <span m=''2898500''>new</span> <span m=''2898620''>instructions</span>
  <span m=''2899140''>for a.</span> <span m=''2899690''>So</span> <span m=''2899930''>let''s</span>
  <span m=''2900070''>say</span> <span m=''2900200''>I have</span> <span m=''2900320''>to</span>
  <span m=''2900410''>fetch</span> <span m=''2900680''>all</span> <span m=''2900880''>the</span>
  <span m=''2900960''>instructions</span> <span m=''2901350''>for</span> <span m=''2901460''>a</span>
  <span m=''2901650''>again.</span> <span m=''2902460''>That</span> <span m=''2902720''>leads</span>
  <span m=''2902960''>me</span> <span m=''2903100''>to</span> <span m=''2903520''>another</span>
  <span m=''2903860''>miss.</span> <span m=''2905590''>Now,</span> <span m=''2906130''>bringing</span>
  <span m=''2906570''>a</span> <span m=''2907130''>again</span> <span m=''2907420''>into</span>
  <span m=''2907570''>my</span> <span m=''2907680''>cache</span> <span m=''2908170''>kicks</span>
  <span m=''2908430''>out</span> <span m=''2908680''>some</span> <span m=''2909320''>extra</span>
  <span m=''2909610''>instructions</span> <span m=''2910050''>because</span> <span
  m=''2910190''>I</span> <span m=''2910240''>need</span> <span m=''2910400''>to</span>
  <span m=''2910480''>make</span> <span m=''2910680''>room</span> <span m=''2910890''>in</span>
  <span m=''2910950''>a</span> <span m=''2911020''>finite</span> <span m=''2911400''>memory</span>
  <span m=''2912100''>so</span> <span m=''2912280''>I kick</span> <span m=''2912330''>out</span>
  <span m=''2912630''>b.</span> <span m=''2915090''>Bring in</span> <span m=''2915550''>b</span>
  <span m=''2915800''>and</span> <span m=''2915980''>I</span> <span m=''2916070''>end</span>
  <span m=''2916200''>up</span> <span m=''2916310''>kicking</span> <span m=''2916600''>out</span>
  <span m=''2916680''>c.</span> <span m=''2918120''>So</span> <span m=''2918450''>you</span>
  <span m=''2918840''>end</span> <span m=''2918970''>up</span> <span m=''2919130''>with</span>
  <span m=''2919260''>a</span> <span m=''2919300''>pattern</span> <span m=''2919640''>where</span>
  <span m=''2919800''>everything is a</span> <span m=''2920410''>miss.</span> <span
  m=''2921530''>This</span> <span m=''2921740''>is</span> <span m=''2921840''>a</span>
  <span m=''2921910''>problem</span> <span m=''2922290''>because</span> <span m=''2923820''>the</span>
  <span m=''2923930''>way</span> <span m=''2924140''>the</span> <span m=''2924260''>loop</span>
  <span m=''2924770''>is</span> <span m=''2924860''>structured,</span> <span m=''2925740''>collectively</span>
  <span m=''2926340''>I</span> <span m=''2926430''>just</span> <span m=''2926610''>can''t</span>
  <span m=''2926870''>pack</span> <span m=''2927160''>all</span> <span m=''2927320''>those</span>
  <span m=''2927420''>instructions</span> <span m=''2927970''>into the</span> <span
  m=''2928080''>cache,</span> <span m=''2928780''>so I end</span> <span m=''2929020''>up</span>
  <span m=''2929120''>taking</span> <span m=''2931710''>a</span> <span m=''2931760''>lot</span>
  <span m=''2931930''>of</span> <span m=''2932020''>cache</span> <span m=''2932300''>misses</span>
  <span m=''2932640''>and</span> <span m=''2932760''>that''s</span> <span m=''2932910''>bad</span>
  <span m=''2933100''>for</span> <span m=''2933240''>performance.</span> </p><p><span
  m=''2935030''>But</span> <span m=''2935140''>I</span> <span m=''2935190''>can</span>
  <span m=''2935320''>look</span> <span m=''2935490''>at</span> <span m=''2935800''>an</span>
  <span m=''2935920''>alternative</span> <span m=''2936400''>way</span> <span m=''2936690''>of</span>
  <span m=''2936880''>doing</span> <span m=''2937130''>this</span> <span m=''2937330''>loop.</span>
  <span m=''2938710''>I</span> <span m=''2938910''>can</span> <span m=''2939100''>split
  up</span> <span m=''2939500''>this</span> <span m=''2939700''>loop</span> <span
  m=''2939900''>into</span> <span m=''2940090''>three</span> <span m=''2941220''>where</span>
  <span m=''2941770''>in</span> <span m=''2941970''>one</span> <span m=''2942350''>loop</span>
  <span m=''2942690''>I</span> <span m=''2942780''>do</span> <span m=''2942960''>all</span>
  <span m=''2943220''>the a</span> <span m=''2943330''>instructions,</span> <span
  m=''2944840''>in</span> <span m=''2945570''>the</span> <span m=''2945660''>second</span>
  <span m=''2945980''>loop</span> <span m=''2946170''>I</span> <span m=''2946210''>do</span>
  <span m=''2946360''>all</span> <span m=''2946560''>the</span> <span m=''2946660''>b''s,</span>
  <span m=''2947300''>and</span> <span m=''2947470''>the</span> <span m=''2947550''>third</span>
  <span m=''2947810''>loop</span> <span m=''2948020''>I</span> <span m=''2948070''>do</span>
  <span m=''2948210''>all</span> <span m=''2948350''>the</span> <span m=''2948430''>c''s.</span>
  <span m=''2949260''>Now</span> <span m=''2949520''>my</span> <span m=''2949620''>working</span>
  <span m=''2950020''>set</span> <span m=''2950690''>is</span> <span m=''2950860''>really</span>
  <span m=''2951090''>small.</span> <span m=''2952830''>So</span> <span m=''2953060''>the</span>
  <span m=''2953150''>instructions</span> <span m=''2954020''>for</span> <span m=''2954170''>a</span>
  <span m=''2954440''>fit in</span> <span m=''2954610''>the</span> <span m=''2954680''>cache,</span>
  <span m=''2955520''>instructions</span> <span m=''2955930''>for</span> <span m=''2956020''>b</span>
  <span m=''2956290''>fit in the</span> <span m=''2956470''>cache, and</span> <span
  m=''2956840''>instructions</span> <span m=''2957340''>for</span> <span m=''2957460''>c</span>
  <span m=''2958030''>fit</span> <span m=''2958330''>in the</span> <span m=''2958430''>cache.</span>
  <span m=''2959670''>So</span> <span m=''2960040''>what</span> <span m=''2960300''>do</span>
  <span m=''2960360''>I</span> <span m=''2960420''>expect</span> <span m=''2960790''>for
  the</span> <span m=''2960900''>first</span> <span m=''2961170''>time</span> <span
  m=''2961310''>I</span> <span m=''2961370''>see</span> <span m=''2961610''>a?</span>
  <span m=''2964330''>Miss.</span> <span m=''2965110''>Then</span> <span m=''2965250''>second</span>
  <span m=''2965520''>time?</span> <span m=''2971270''>It''ll</span> <span m=''2971500''>be</span>
  <span m=''2971650''>hit,</span> <span m=''2973580''>because</span> <span m=''2975000''>I''ve</span>
  <span m=''2975130''>brought</span> <span m=''2975430''>in</span> <span m=''2975540''>a,</span>
  <span m=''2975950''>I</span> <span m=''2976020''>haven''t</span> <span m=''2976280''>run</span>
  <span m=''2976570''>b</span> <span m=''2976730''>or</span> <span m=''2976890''>c</span>
  <span m=''2977100''>yet,</span> <span m=''2978150''>the</span> <span m=''2978250''>number</span>
  <span m=''2978450''>of</span> <span m=''2978530''>instructions</span> <span m=''2978980''>I</span>
  <span m=''2979070''>need</span> <span m=''2979300''>for</span> <span m=''2979410''>a</span>
  <span m=''2979960''>is</span> <span m=''2980150''>smaller</span> <span m=''2980520''>than</span>
  <span m=''2980650''>what</span> <span m=''2980790''>I</span> <span m=''2980820''>can</span>
  <span m=''2980970''>fit</span> <span m=''2981130''>into</span> <span m=''2981300''>the</span>
  <span m=''2981370''>cache,</span> <span m=''2982080''>so</span> <span m=''2982250''>that''s</span>
  <span m=''2982460''>great.</span> <span m=''2982770''>Nothing</span> <span m=''2983060''>gets</span>
  <span m=''2983230''>kicked</span> <span m=''2983520''>out.</span> <span m=''2984170''>So</span>
  <span m=''2984810''>every</span> <span m=''2985190''>one</span> <span m=''2985360''>of</span>
  <span m=''2985470''>those</span> <span m=''2985660''>iterations</span> <span m=''2986200''>for</span>
  <span m=''2986320''>a</span> <span m=''2987020''>becomes</span> <span m=''2987420''>a</span>
  <span m=''2987470''>hit.</span> <span m=''2988450''>So</span> <span m=''2988610''>that''s</span>
  <span m=''2988800''>good.</span> <span m=''2989220''>I''ve</span> <span m=''2989400''>improved</span>
  <span m=''2989830''>performance.</span> </p><p><span m=''2991950''>For</span> <span
  m=''2992110''>b</span> <span m=''2992710''>I</span> <span m=''2992870''>have</span>
  <span m=''2993280''>the</span> <span m=''2993370''>same</span> <span m=''2993570''>pattern.</span>
  <span m=''2994550''>First</span> <span m=''2994810''>time I</span> <span m=''2994910''>see</span>
  <span m=''2995100''>b</span> <span m=''2995330''>it''s a miss,</span> <span m=''2995760''>every</span>
  <span m=''2996020''>time</span> <span m=''2996200''>after</span> <span m=''2996400''>that</span>
  <span m=''2996620''>it''s a</span> <span m=''2996720''>hit.</span> <span m=''2997480''>Similarly</span>
  <span m=''2997770''>for</span> <span m=''2997900''>c.</span> <span m=''2998560''>So</span>
  <span m=''2998730''>my</span> <span m=''2998870''>cache miss</span> <span m=''2999350''>rate</span>
  <span m=''2999890''>goes</span> <span m=''3000140''>from</span> <span m=''3000990''>being</span>
  <span m=''3001490''>one,</span> <span m=''3001970''>everything''s</span> <span m=''3002440''>a</span>
  <span m=''3002490''>miss,</span> <span m=''3003320''>to</span> <span m=''3003610''>decreasing</span>
  <span m=''3004650''>to</span> <span m=''3004790''>1</span> <span m=''3005000''>over</span>
  <span m=''3005200''>n</span> <span m=''3005690''>where</span> <span m=''3005890''>n</span>
  <span m=''3006170''>is</span> <span m=''3006440''>essentially</span> <span m=''3006910''>how</span>
  <span m=''3007050''>much</span> <span m=''3007540''>I</span> <span m=''3007630''>can</span>
  <span m=''3007780''>run</span> <span m=''3007950''>the</span> <span m=''3008030''>loop.</span>
  <span m=''3009500''>So we</span> <span m=''3009750''>call</span> <span m=''3009900''>that</span>
  <span m=''3010030''>full</span> <span m=''3010310''>scaling</span> <span m=''3010710''>because</span>
  <span m=''3010860''>we''ve</span> <span m=''3011030''>taken</span> <span m=''3011680''>the
  loop where we''ve</span> <span m=''3012250''>distributed,</span> <span m=''3013150''>and</span>
  <span m=''3013370''>we''ve</span> <span m=''3013480''>scaled</span> <span m=''3013970''>every</span>
  <span m=''3014240''>one</span> <span m=''3014360''>of</span> <span m=''3014440''>those</span>
  <span m=''3014600''>smaller</span> <span m=''3014880''>loops</span> <span m=''3015410''>to</span>
  <span m=''3015540''>the</span> <span m=''3015610''>maximum</span> <span m=''3016020''>that</span>
  <span m=''3016130''>we could</span> <span m=''3016240''>get.</span> </p><p><span
  m=''3019070''>Now</span> <span m=''3019260''>what</span> <span m=''3019420''>about</span>
  <span m=''3019620''>the</span> <span m=''3019710''>data?</span> <span m=''3021230''>So</span>
  <span m=''3021420''>we</span> <span m=''3021510''>have the</span> <span m=''3021690''>same</span>
  <span m=''3021890''>example.</span> <span m=''3022340''>Here</span> <span m=''3022530''>we</span>
  <span m=''3022640''>saw</span> <span m=''3022860''>that</span> <span m=''3022970''>the</span>
  <span m=''3023050''>instruction</span> <span m=''3026210''>working</span> <span
  m=''3026490''>set</span> <span m=''3026660''>is</span> <span m=''3026820''>big,</span>
  <span m=''3027510''>but</span> <span m=''3027670''>what</span> <span m=''3027840''>about</span>
  <span m=''3028040''>the</span> <span m=''3028120''>data?</span> <span m=''3029420''>So
  let''s</span> <span m=''3029690''>say</span> <span m=''3029980''>in</span> <span
  m=''3030200''>this</span> <span m=''3030350''>case</span> <span m=''3030580''>I''m</span>
  <span m=''3030760''>sending</span> <span m=''3031070''>just</span> <span m=''3031270''>a</span>
  <span m=''3031330''>small</span> <span m=''3031600''>amount</span> <span m=''3031850''>of</span>
  <span m=''3031970''>data.</span> <span m=''3032270''>Then</span> <span m=''3033090''>the</span>
  <span m=''3033170''>behavior</span> <span m=''3033570''>is</span> <span m=''3033700''>really</span>
  <span m=''3033930''>good.</span> <span m=''3035640''>It''s a</span> <span m=''3036340''>small</span>
  <span m=''3036730''>amount</span> <span m=''3036950''>of</span> <span m=''3037040''>data</span>
  <span m=''3037190''>that</span> <span m=''3037360''>I</span> <span m=''3037430''>need</span>
  <span m=''3037590''>to</span> <span m=''3037650''>communicate</span> <span m=''3038070''>from</span>
  <span m=''3038160''>a</span> <span m=''3038330''>to</span> <span m=''3038430''>b.
  A</span> <span m=''3038950''>small</span> <span m=''3039390''>amount</span> <span
  m=''3039640''>of</span> <span m=''3039700''>data</span> <span m=''3039920''>you</span>
  <span m=''3040230''>need to</span> <span m=''3040310''>communicate</span> <span
  m=''3040750''>from</span> <span m=''3040900''>b to</span> <span m=''3041080''>c.</span>
  <span m=''3042040''>So it''s</span> <span m=''3042350''>great.</span> <span m=''3043270''>No</span>
  <span m=''3043390''>problems</span> <span m=''3043690''>with</span> <span m=''3043790''>the</span>
  <span m=''3043890''>data</span> <span m=''3044090''>cache.</span> <span m=''3044990''>What</span>
  <span m=''3045230''>happens</span> <span m=''3045530''>in</span> <span m=''3045630''>full</span>
  <span m=''3045870''>scaling</span> <span m=''3046190''>case?</span> </p><p><span
  m=''3046530''>AUDIENCE:</span> <span m=''3050320''>It''s not correct to communicate
  from a to b.</span> </p><p><span m=''3053330''>PROFESSOR:</span> <span m=''3053410''>What
  do you mean</span> <span m=''3053490''>it''s</span> <span m=''3053967''>not</span>
  <span m=''3054444''>correct?</span> </p><p><span m=''3054921''>AUDIENCE:</span>
  <span m=''3055399''>Oh, it''s not communicating at the same time.</span> </p><p><span
  m=''3058740''>PROFESSOR: Yeah, it''s</span> <span m=''3059050''>not</span> <span
  m=''3059220''>at the</span> <span m=''3059270''>same</span> <span m=''3059500''>time.</span>
  <span m=''3061300''>In</span> <span m=''3061460''>fact,</span> <span m=''3061870''>just</span>
  <span m=''3062030''>assume</span> <span m=''3062360''>this</span> <span m=''3062480''>is</span>
  <span m=''3062590''>sequential.</span> <span m=''3063890''>So</span> <span m=''3064060''>I</span>
  <span m=''3064200''>run</span> <span m=''3064480''>a,</span> <span m=''3064670''>I</span>
  <span m=''3065590''>store</span> <span m=''3065910''>some</span> <span m=''3066110''>data,</span>
  <span m=''3067100''>and</span> <span m=''3067260''>then</span> <span m=''3067370''>when</span>
  <span m=''3067500''>I</span> <span m=''3067540''>run</span> <span m=''3067800''>b</span>
  <span m=''3068060''>I</span> <span m=''3068240''>grab</span> <span m=''3068530''>that</span>
  <span m=''3068670''>data.</span> <span m=''3070680''>This</span> <span m=''3070850''>is</span>
  <span m=''3070970''>in</span> <span m=''3071140''>sequential.</span> </p><p><span
  m=''3072430''>AUDIENCE:</span> <span m=''3074330''>How</span> <span m=''3074805''>do</span>
  <span m=''3075280''>you know that</span> <span m=''3075530''>the transmission''s</span>
  <span m=''3076110''>valid then?</span> <span m=''3076610''>We could use some global
  variable.</span> </p><p><span m=''3079210''>PROFESSOR: Simple case.</span> <span
  m=''3081390''>There''s</span> <span m=''3081750''>no</span> <span m=''3081910''>global</span>
  <span m=''3082170''>variables.</span> <span m=''3082750''>All</span> <span m=''3082920''>the</span>
  <span m=''3083770''>data</span> <span m=''3083970''>that</span> <span m=''3084180''>b</span>
  <span m=''3084330''>needs</span> <span m=''3084710''>comes</span> <span m=''3084960''>from</span>
  <span m=''3085100''>a.</span> <span m=''3086210''>So</span> <span m=''3086380''>if</span>
  <span m=''3086480''>I</span> <span m=''3086560''>run</span> <span m=''3086780''>a</span>
  <span m=''3086890''>I</span> <span m=''3087000''>produce</span> <span m=''3087330''>all</span>
  <span m=''3087460''>the</span> <span m=''3087560''>data</span> <span m=''3088050''>and</span>
  <span m=''3088290''>that''s</span> <span m=''3088430''>all</span> <span m=''3088600''>that</span>
  <span m=''3088690''>b needs.</span> <span m=''3092000''>So in the full</span> <span
  m=''3092420''>scaling</span> <span m=''3092740''>case,</span> <span m=''3093380''>what</span>
  <span m=''3093540''>do</span> <span m=''3093630''>I</span> <span m=''3093710''>expect</span>
  <span m=''3094040''>to</span> <span m=''3094110''>happen</span> <span m=''3095870''>for</span>
  <span m=''3096060''>the</span> <span m=''3096140''>data?</span> <span m=''3097140''>Remember,</span>
  <span m=''3097670''>in</span> <span m=''3097790''>the</span> <span m=''3097860''>full</span>
  <span m=''3098040''>scaling</span> <span m=''3098340''>case,</span> <span m=''3098750''>all</span>
  <span m=''3099020''>the</span> <span m=''3099170''>working</span> <span m=''3099500''>sets</span>
  <span m=''3099680''>for the</span> <span m=''3099780''>instructions</span> <span
  m=''3100400''>are</span> <span m=''3100520''>small</span> <span m=''3100950''>so</span>
  <span m=''3101070''>they</span> <span m=''3101160''>all</span> <span m=''3101390''>fit</span>
  <span m=''3101540''>in</span> <span m=''3101610''>the</span> <span m=''3101680''>cache.</span>
  <span m=''3102810''>But</span> <span m=''3102940''>now</span> <span m=''3103170''>I''m</span>
  <span m=''3103280''>running</span> <span m=''3103740''>a</span> <span m=''3103920''>for</span>
  <span m=''3104140''>a</span> <span m=''3104220''>lot</span> <span m=''3104460''>longer</span>
  <span m=''3105600''>so I</span> <span m=''3105750''>have</span> <span m=''3105860''>to</span>
  <span m=''3105960''>store</span> <span m=''3106260''>a</span> <span m=''3106320''>lot</span>
  <span m=''3106500''>more</span> <span m=''3106690''>data</span> <span m=''3106950''>for</span>
  <span m=''3107090''>b.</span> <span m=''3108180''>Similarly,</span> <span m=''3108550''>I''m</span>
  <span m=''3108650''>running</span> <span m=''3108880''>b for</span> <span m=''3109210''>a</span>
  <span m=''3109270''>lot</span> <span m=''3109440''>longer</span> <span m=''3110430''>so</span>
  <span m=''3110680''>I have to</span> <span m=''3110750''>store</span> <span m=''3110970''>a</span>
  <span m=''3111010''>lot</span> <span m=''3111130''>more</span> <span m=''3111300''>data</span>
  <span m=''3111520''>for</span> <span m=''3111640''>c.</span> <span m=''3112690''>So</span>
  <span m=''3112830''>what do</span> <span m=''3112950''>I</span> <span m=''3113000''>expect</span>
  <span m=''3113330''>to</span> <span m=''3113400''>happen</span> <span m=''3113690''>with</span>
  <span m=''3113820''>the</span> <span m=''3113900''>working</span> <span m=''3114170''>set</span>
  <span m=''3114380''>here?</span> <span m=''3118180''>Instructions</span> <span m=''3118530''>are</span>
  <span m=''3118600''>still</span> <span m=''3118750''>good,</span> <span m=''3119970''>but</span>
  <span m=''3120090''>the</span> <span m=''3120190''>data</span> <span m=''3120450''>might</span>
  <span m=''3120610''>be</span> <span m=''3120720''>bad</span> <span m=''3121430''>because</span>
  <span m=''3121720''>I''ve</span> <span m=''3122840''>run</span> <span m=''3123080''>a</span>
  <span m=''3123270''>for</span> <span m=''3123470''>a</span> <span m=''3123530''>lot</span>
  <span m=''3123770''>more</span> <span m=''3124760''>iterations</span> <span m=''3125360''>at</span>
  <span m=''3125440''>one</span> <span m=''3125620''>shot.</span> <span m=''3126410''>So</span>
  <span m=''3126580''>now</span> <span m=''3126760''>I</span> <span m=''3126810''>have</span>
  <span m=''3126960''>to</span> <span m=''3127060''>buffer</span> <span m=''3127490''>all</span>
  <span m=''3127670''>this</span> <span m=''3127780''>data</span> <span m=''3128130''>for</span>
  <span m=''3128300''>a to</span> <span m=''3128550''>b.</span> <span m=''3129730''>Similarly,</span>
  <span m=''3130120''>I''ve</span> <span m=''3130370''>run</span> <span m=''3130590''>b</span>
  <span m=''3130710''>for</span> <span m=''3130850''>a</span> <span m=''3130920''>long</span>
  <span m=''3131120''>time</span> <span m=''3131330''>so I</span> <span m=''3131520''>have
  to</span> <span m=''3131780''>buffer</span> <span m=''3131960''>a</span> <span m=''3132000''>whole</span>
  <span m=''3132160''>lot</span> <span m=''3132370''>data</span> <span m=''3132600''>for</span>
  <span m=''3132740''>b</span> <span m=''3132900''>to</span> <span m=''3133000''>c.</span>
  <span m=''3133960''>Is that clear?</span> </p><p><span m=''3135570''>AUDIENCE:</span>
  <span m=''3135750''>No.</span> </p><p><span m=''3135930''>PROFESSOR:</span> <span
  m=''3136570''>So</span> <span m=''3136720''>let''s</span> <span m=''3136880''>say</span>
  <span m=''3137360''>every</span> <span m=''3137580''>time</span> <span m=''3137860''>a</span>
  <span m=''3138080''>runs</span> <span m=''3138400''>it</span> <span m=''3138520''>produces</span>
  <span m=''3138880''>one</span> <span m=''3139040''>data</span> <span m=''3139220''>element.</span>
  <span m=''3140830''>So</span> <span m=''3140940''>now</span> <span m=''3141280''>in</span>
  <span m=''3141420''>this</span> <span m=''3141590''>case,</span> <span m=''3142220''>every</span>
  <span m=''3143270''>iteration</span> <span m=''3143770''>produces</span> <span m=''3144100''>one</span>
  <span m=''3144260''>data</span> <span m=''3144330''>element.</span> <span m=''3144970''>That''s</span>
  <span m=''3145170''>fine.</span> <span m=''3145880''>That''s</span> <span m=''3146240''>clear?</span>
  <span m=''3147100''>Here</span> <span m=''3147820''>I</span> <span m=''3147940''>run</span>
  <span m=''3148280''>a</span> <span m=''3148490''>n</span> <span m=''3148660''>times,</span>
  <span m=''3149050''>so I</span> <span m=''3149140''>produce</span> <span m=''3149630''>n</span>
  <span m=''3149850''>data</span> <span m=''3149930''>elements.</span> <span m=''3151720''>And</span>
  <span m=''3152080''>b</span> <span m=''3152280''>let''s</span> <span m=''3152440''>say</span>
  <span m=''3153010''>produces</span> <span m=''3153710''>one</span> <span m=''3153900''>data</span>
  <span m=''3153990''>element.</span> <span m=''3154950''>So</span> <span m=''3155210''>if</span>
  <span m=''3155320''>my</span> <span m=''3155470''>cache</span> <span m=''3155810''>can</span>
  <span m=''3155940''>only</span> <span m=''3156170''>hold</span> <span m=''3157120''>let''s</span>
  <span m=''3157250''>say</span> <span m=''3157720''>n</span> <span m=''3157970''>by</span>
  <span m=''3158100''>2</span> <span m=''3159350''>data</span> <span m=''3159560''>elements,</span>
  <span m=''3159980''>then</span> <span m=''3160670''>there''s</span> <span m=''3160830''>an</span>
  <span m=''3160910''>overflow.</span> <span m=''3162140''>So</span> <span m=''3162330''>what</span>
  <span m=''3162440''>that</span> <span m=''3162610''>means</span> <span m=''3162860''>is</span>
  <span m=''3163110''>not</span> <span m=''3163330''>everything''s</span> <span m=''3163740''>in</span>
  <span m=''3163810''>the</span> <span m=''3163880''>cache,</span> <span m=''3164650''>and</span>
  <span m=''3164770''>that''s</span> <span m=''3164910''>bad</span> <span m=''3165200''>because</span>
  <span m=''3165450''>of the</span> <span m=''3165560''>same</span> <span m=''3165840''>reasons</span>
  <span m=''3166150''>we</span> <span m=''3166260''>saw for the</span> <span m=''3166620''>instructions.</span>
  <span m=''3167550''>When</span> <span m=''3167710''>I</span> <span m=''3167750''>need</span>
  <span m=''3167960''>those</span> <span m=''3168180''>data</span> <span m=''3168360''>I</span>
  <span m=''3168450''>have</span> <span m=''3168610''>to</span> <span m=''3168730''>go</span>
  <span m=''3168870''>out</span> <span m=''3169030''>to</span> <span m=''3169140''>memory</span>
  <span m=''3169440''>and</span> <span m=''3169640''>get</span> <span m=''3169780''>them</span>
  <span m=''3169910''>again,</span> <span m=''3170440''>so it''s</span> <span m=''3170730''>extra</span>
  <span m=''3171010''>communication,</span> <span m=''3171760''>extra</span> <span
  m=''3172060''>redundancy.</span> </p><p><span m=''3172620''>AUDIENCE:</span> <span
  m=''3173115''>In this case where</span> <span m=''3173610''>you</span> <span m=''3174106''>don''t</span>
  <span m=''3174176''>need</span> <span m=''3174247''>to</span> <span m=''3174318''>store</span>
  <span m=''3174388''>the</span> <span m=''3174459''>a</span> <span m=''3174530''>variables</span>
  <span m=''3174601''>[UNINTELLIGIBLE PHRASE].</span> </p><p><span m=''3179550''>PROFESSOR:
  But</span> <span m=''3179750''>notice</span> <span m=''3180090''>these were</span>
  <span m=''3180660''>sequential</span> <span m=''3181780''>simple</span> <span m=''3182030''>case.</span>
  <span m=''3183000''>I</span> <span m=''3183300''>need</span> <span m=''3183610''>all</span>
  <span m=''3183850''>the</span> <span m=''3183960''>data</span> <span m=''3184250''>from</span>
  <span m=''3184500''>a</span> <span m=''3185170''>to</span> <span m=''3185310''>run</span>
  <span m=''3185590''>all the</span> <span m=''3185820''>iterations</span> <span m=''3186260''>for</span>
  <span m=''3186370''>b.</span> <span m=''3188210''>Then,</span> <span m=''3188730''>yeah,</span>
  <span m=''3189000''>this</span> <span m=''3189190''>goes</span> <span m=''3189390''>away.</span>
  <span m=''3190650''>So</span> <span m=''3190770''>let''s</span> <span m=''3190870''>say</span>
  <span m=''3190980''>this</span> <span m=''3191160''>goes</span> <span m=''3191350''>away,</span>
  <span m=''3192260''>but</span> <span m=''3192390''>still</span> <span m=''3192630''>b</span>
  <span m=''3192840''>produces</span> <span m=''3193340''>n</span> <span m=''3193570''>elements</span>
  <span m=''3194020''>and</span> <span m=''3194120''>that</span> <span m=''3194300''>overflows</span>
  <span m=''3194670''>the</span> <span m=''3194840''>cache.</span> </p><p><span m=''3199770''>So</span>
  <span m=''3200120''>there''s</span> <span m=''3200420''>a</span> <span m=''3200480''>third</span>
  <span m=''3200840''>example</span> <span m=''3201950''>where</span> <span m=''3202250''>I</span>
  <span m=''3202410''>don''t</span> <span m=''3202600''>fully</span> <span m=''3202820''>distribute</span>
  <span m=''3203230''>everything,</span> <span m=''3204090''>I</span> <span m=''3204210''>partially</span>
  <span m=''3204730''>distribute</span> <span m=''3205220''>some</span> <span m=''3205540''>of
  the</span> <span m=''3205640''>loops.</span> <span m=''3206520''>I</span> <span
  m=''3206560''>can</span> <span m=''3206660''>fully</span> <span m=''3206930''>scale</span>
  <span m=''3207280''>a</span> <span m=''3207410''>and</span> <span m=''3207550''>b</span>
  <span m=''3207690''>because</span> <span m=''3208000''>I</span> <span m=''3208060''>can</span>
  <span m=''3208230''>fit</span> <span m=''3208470''>those</span> <span m=''3209730''>instructions</span>
  <span m=''3210180''>in</span> <span m=''3210270''>the</span> <span m=''3210330''>cache.</span>
  <span m=''3211600''>That</span> <span m=''3211680''>gets</span> <span m=''3211860''>me</span>
  <span m=''3211970''>around</span> <span m=''3212260''>this</span> <span m=''3212400''>problem,</span>
  <span m=''3213910''>because</span> <span m=''3214260''>now</span> <span m=''3214540''>a</span>
  <span m=''3214870''>and b</span> <span m=''3215090''>are just</span> <span m=''3215290''>communicating</span>
  <span m=''3215750''>one</span> <span m=''3215930''>day</span> <span m=''3216040''>data</span>
  <span m=''3216230''>element.</span> <span m=''3217850''>But</span> <span m=''3218040''>c
  is</span> <span m=''3218270''>still</span> <span m=''3218440''>a</span> <span m=''3218510''>problem</span>
  <span m=''3218820''>because</span> <span m=''3219080''>I</span> <span m=''3219130''>still</span>
  <span m=''3219370''>have</span> <span m=''3219520''>to</span> <span m=''3219630''>run</span>
  <span m=''3219890''>b</span> <span m=''3220120''>n</span> <span m=''3220320''>times</span>
  <span m=''3220730''>in</span> <span m=''3220830''>the end</span> <span m=''3221640''>before</span>
  <span m=''3221930''>I</span> <span m=''3221990''>can</span> <span m=''3222130''>run</span>
  <span m=''3222320''>c so</span> <span m=''3222770''>there</span> <span m=''3222880''>are</span>
  <span m=''3223050''>n data</span> <span m=''3223430''>elements</span> <span m=''3224410''>in</span>
  <span m=''3224630''>flight.</span> <span m=''3226940''>So the</span> <span m=''3227280''>data</span>
  <span m=''3227860''>for</span> <span m=''3228110''>b</span> <span m=''3228510''>still</span>
  <span m=''3228760''>becomes</span> <span m=''3229040''>a</span> <span m=''3229100''>problem</span>
  <span m=''3230010''>in</span> <span m=''3230130''>terms</span> <span m=''3230370''>of</span>
  <span m=''3230480''>its</span> <span m=''3230620''>locality.</span> <span m=''3231500''>Is
  that</span> <span m=''3231940''>clear?</span> <span m=''3234810''>So,</span> <span
  m=''3235310''>any</span> <span m=''3235580''>ideas</span> <span m=''3235910''>on</span>
  <span m=''3236020''>how</span> <span m=''3236210''>I</span> <span m=''3236270''>can</span>
  <span m=''3236410''>improve</span> <span m=''3236680''>this?</span> </p><p><span
  m=''3237640''>AUDIENCE:</span> <span m=''3238730''>assuming you have the wrong cache
  line and you have to do one or two memory acceses to get the cache back.</span>
  </p><p><span m=''3250920''>PROFESSOR: So,</span> <span m=''3255210''>programs</span>
  <span m=''3255810''>typically</span> <span m=''3256130''>have</span> <span m=''3256340''>really</span>
  <span m=''3256550''>good</span> <span m=''3256690''>instruction</span> <span m=''3257120''>locality</span>
  <span m=''3257930''>just</span> <span m=''3258120''>because the</span> <span m=''3258420''>nature</span>
  <span m=''3258750''>of</span> <span m=''3258840''>the</span> <span m=''3258950''>way</span>
  <span m=''3259090''>we</span> <span m=''3259220''>run</span> <span m=''3259390''>them.
  We have</span> <span m=''3259690''>small</span> <span m=''3259960''>loops</span>
  <span m=''3260440''>and</span> <span m=''3260550''>they</span> <span m=''3260620''>iterate</span>
  <span m=''3260950''>over</span> <span m=''3261140''>and</span> <span m=''3261240''>over</span>
  <span m=''3261420''>again.</span> <span m=''3263350''>Data</span> <span m=''3263730''>is</span>
  <span m=''3263870''>actually</span> <span m=''3264260''>where</span> <span m=''3264420''>you</span>
  <span m=''3264550''>spend</span> <span m=''3264810''>most</span> <span m=''3265020''>of</span>
  <span m=''3265110''>your</span> <span m=''3265240''>time</span> <span m=''3266210''>in</span>
  <span m=''3266340''>the</span> <span m=''3266410''>memory</span> <span m=''3266650''>system.</span>
  <span m=''3267090''>It''s</span> <span m=''3267250''>fetching</span> <span m=''3267630''>data.</span>
  <span m=''3268320''>So</span> <span m=''3268600''>I</span> <span m=''3268970''>didn''t</span>
  <span m=''3269150''>actually</span> <span m=''3269420''>understand</span> <span
  m=''3269870''>why</span> <span m=''3270050''>you</span> <span m=''3270140''>think</span>
  <span m=''3271360''>data</span> <span m=''3271650''>is</span> <span m=''3271860''>less</span>
  <span m=''3272090''>expensive</span> <span m=''3272580''>than</span> <span m=''3272730''>instructions.</span>
  </p><p><span m=''3273340''>AUDIENCE:</span> <span m=''3273847''>What I''m saying</span>
  <span m=''3274355''>say you</span> <span m=''3274863''>want</span> <span m=''3275371''>to
  read an array,</span> <span m=''3275879''>read the</span> <span m=''3276387''>first,</span>
  <span m=''3276895''>say,</span> <span m=''3277403''>8</span> <span m=''3277911''>elements</span>
  <span m=''3278419''>to</span> <span m=''3278927''>8 words</span> <span m=''3279435''>in
  the cache box.</span> <span m=''3279942''>Well then you''d</span> <span m=''3280450''>get</span>
  <span m=''3280958''>7</span> <span m=''3281466''>hits,</span> <span m=''3282990''>so</span>
  <span m=''3283498''>every 8 iterations</span> <span m=''3284006''>you have to</span>
  <span m=''3284514''>do a rewrite.</span> </p><p><span m=''3285530''>PROFESSOR: Right.</span>
  <span m=''3286190''>So</span> <span m=''3286700''>that</span> <span m=''3286880''>assumes</span>
  <span m=''3287280''>that</span> <span m=''3287410''>you</span> <span m=''3287470''>have</span>
  <span m=''3287600''>really</span> <span m=''3287830''>good</span> <span m=''3287970''>spatial</span>
  <span m=''3288300''>locality,</span> <span m=''3289800''>because</span> <span m=''3290150''>you''ve</span>
  <span m=''3290300''>assumed</span> <span m=''3290650''>that</span> <span m=''3290830''>I''ve</span>
  <span m=''3290990''>brought</span> <span m=''3291230''>in</span> <span m=''3291390''>8</span>
  <span m=''3291570''>elements</span> <span m=''3292030''>and</span> <span m=''3292170''>I''m</span>
  <span m=''3292230''>going</span> <span m=''3292370''>to</span> <span m=''3292470''>use</span>
  <span m=''3292760''>every</span> <span m=''3293020''>one</span> <span m=''3293160''>of</span>
  <span m=''3293250''>them.</span> <span m=''3293780''>So</span> <span m=''3293930''>if</span>
  <span m=''3294010''>that''s</span> <span m=''3294180''>the</span> <span m=''3294260''>case</span>
  <span m=''3294500''>you have</span> <span m=''3294620''>really</span> <span m=''3294850''>good</span>
  <span m=''3294990''>spatial</span> <span m=''3295300''>locality</span> <span m=''3295910''>and</span>
  <span m=''3296060''>that''s,</span> <span m=''3296200''>in</span> <span m=''3296300''>fact,</span>
  <span m=''3296540''>what</span> <span m=''3296640''>you</span> <span m=''3296720''>want.</span>
  <span m=''3297690''>It''s</span> <span m=''3297820''>the</span> <span m=''3297890''>same</span>
  <span m=''3298120''>kind</span> <span m=''3298350''>of</span> <span m=''3299250''>thing</span>
  <span m=''3299410''>that</span> <span m=''3299530''>I</span> <span m=''3299580''>showed</span>
  <span m=''3299890''>for the</span> <span m=''3300160''>instruction</span> <span
  m=''3300560''>cache. The</span> <span m=''3301080''>first</span> <span m=''3301400''>thing</span>
  <span m=''3301590''>is a</span> <span m=''3301650''>miss, the</span> <span m=''3301980''>rest</span>
  <span m=''3302360''>are</span> <span m=''3302490''>hits.</span> <span m=''3304450''>The</span>
  <span m=''3304700''>reason</span> <span m=''3305180''>data</span> <span m=''3305560''>is</span>
  <span m=''3305800''>more</span> <span m=''3305960''>expensive,</span> <span m=''3306420''>you</span>
  <span m=''3306550''>simply</span> <span m=''3306850''>have</span> <span m=''3307090''>a</span>
  <span m=''3307160''>lot</span> <span m=''3307360''>more</span> <span m=''3307800''>data</span>
  <span m=''3308020''>reads</span> <span m=''3308810''>than</span> <span m=''3309130''>you</span>
  <span m=''3309540''>have</span> <span m=''3309810''>instructions.</span> <span m=''3310490''>Typically</span>
  <span m=''3310820''>you</span> <span m=''3310920''>have</span> <span m=''3311150''>small</span>
  <span m=''3311450''>loops,</span> <span m=''3312320''>hundreds</span> <span m=''3312650''>of</span>
  <span m=''3312730''>instructions</span> <span m=''3313440''>and</span> <span m=''3313580''>they</span>
  <span m=''3313640''>might</span> <span m=''3313810''>access</span> <span m=''3314110''>really</span>
  <span m=''3314380''>big</span> <span m=''3314580''>arrays</span> <span m=''3314930''>that</span>
  <span m=''3315120''>are</span> <span m=''3315440''>millions</span> <span m=''3316350''>of</span>
  <span m=''3316750''>data</span> <span m=''3316900''>references.</span> <span m=''3318160''>So</span>
  <span m=''3318280''>that</span> <span m=''3318400''>becomes</span> <span m=''3318650''>a</span>
  <span m=''3318700''>problem.</span> </p><p><span m=''3320230''>So</span> <span m=''3320360''>ideas</span>
  <span m=''3320610''>on</span> <span m=''3320710''>how</span> <span m=''3320850''>to</span>
  <span m=''3320940''>improve</span> <span m=''3321180''>this?</span> </p><p><span
  m=''3322250''>AUDIENCE:</span> <span m=''3322795''>That''s a loop?</span> </p><p><span
  m=''3323340''>PROFESSOR: That''s</span> <span m=''3323550''>a</span> <span m=''3323640''>loop.</span>
  <span m=''3324190''>So</span> <span m=''3324330''>what</span> <span m=''3324450''>would</span>
  <span m=''3324560''>you</span> <span m=''3324640''>do</span> <span m=''3324880''>in</span>
  <span m=''3325030''>the</span> <span m=''3325110''>smaller</span> <span m=''3325510''>loop?</span>
  </p><p><span m=''3325800''>AUDIENCE:</span> <span m=''3328270''>[INAUDIBLE PHRASE].</span>
  </p><p><span m=''3330740''>PROFESSOR: Something</span> <span m=''3330950''>like</span>
  <span m=''3331070''>that?</span> </p><p><span m=''3331330''>AUDIENCE:</span> <span
  m=''3332280''>Yeah.</span> </p><p><span m=''3333230''>PROFESSOR: OK.</span> <span
  m=''3335010''>So</span> <span m=''3335310''>in a</span> <span m=''3335400''>nested</span>
  <span m=''3335740''>loop,</span> <span m=''3336490''>you</span> <span m=''3336800''>have</span>
  <span m=''3337050''>a</span> <span m=''3337610''>smaller</span> <span m=''3338170''>loop</span>
  <span m=''3338510''>that</span> <span m=''3338690''>has a</span> <span m=''3339190''>small</span>
  <span m=''3339610''>number</span> <span m=''3339840''>of</span> <span m=''3339950''>iterations,</span>
  <span m=''3340530''>so</span> <span m=''3340630''>64.</span> <span m=''3343220''>So,</span>
  <span m=''3344040''>64</span> <span m=''3344510''>might</span> <span m=''3344710''>be</span>
  <span m=''3344870''>just</span> <span m=''3345100''>as</span> <span m=''3345220''>much</span>
  <span m=''3345510''>as</span> <span m=''3345640''>I</span> <span m=''3345730''>can</span>
  <span m=''3346010''>buffer</span> <span m=''3346640''>for the</span> <span m=''3346800''>data</span>
  <span m=''3347110''>in</span> <span m=''3347220''>the</span> <span m=''3347280''>cache.</span>
  <span m=''3348380''>Then</span> <span m=''3348540''>I</span> <span m=''3348870''>wrap</span>
  <span m=''3349220''>that</span> <span m=''3349440''>loop</span> <span m=''3349710''>with</span>
  <span m=''3350050''>one</span> <span m=''3350290''>outer</span> <span m=''3350500''>loop</span>
  <span m=''3350930''>that</span> <span m=''3351150''>completes</span> <span m=''3351530''>the</span>
  <span m=''3351610''>whole</span> <span m=''3351750''>number</span> <span m=''3351970''>of</span>
  <span m=''3352050''>iterations.</span> <span m=''3352860''>So if</span> <span m=''3353140''>I</span>
  <span m=''3353230''>had to do</span> <span m=''3353420''>n,</span> <span m=''3353850''>then</span>
  <span m=''3353980''>I</span> <span m=''3354040''>divide</span> <span m=''3354460''>n</span>
  <span m=''3354680''>by</span> <span m=''3354800''>64.</span> <span m=''3355950''>So</span>
  <span m=''3356040''>that</span> <span m=''3356190''>can</span> <span m=''3356290''>work</span>
  <span m=''3356520''>out</span> <span m=''3356660''>really</span> <span m=''3356900''>well.</span>
  </p><p><span m=''3358060''>So there''s</span> <span m=''3358330''>different</span>
  <span m=''3358590''>kinds</span> <span m=''3358930''>of</span> <span m=''3359140''>blocking</span>
  <span m=''3359530''>techniques</span> <span m=''3359930''>that</span> <span m=''3360060''>you</span>
  <span m=''3360190''>can</span> <span m=''3360340''>use</span> <span m=''3360690''>on</span>
  <span m=''3361280''>getting</span> <span m=''3361510''>your</span> <span m=''3361680''>data</span>
  <span m=''3362010''>to</span> <span m=''3362130''>fit</span> <span m=''3362330''>into</span>
  <span m=''3362920''>your</span> <span m=''3363130''>local</span> <span m=''3363440''>store</span>
  <span m=''3363800''>or</span> <span m=''3363980''>into</span> <span m=''3364150''>your</span>
  <span m=''3364320''>cache</span> <span m=''3365050''>to</span> <span m=''3365360''>exploit</span>
  <span m=''3366300''>these</span> <span m=''3366490''>spatial</span> <span m=''3366990''>and</span>
  <span m=''3367060''>temporal</span> <span m=''3367340''>properties.</span> <span
  m=''3368250''>Question?</span> </p><p><span m=''3368550''>AUDIENCE:</span> <span
  m=''3369062''>Would</span> <span m=''3369574''>it not be</span> <span m=''3370086''>better
  to</span> <span m=''3370598''>use</span> <span m=''3371110''>a</span> <span m=''3371622''>small</span>
  <span m=''3372135''>[UNINTELLIGIBLE]</span> <span m=''3372647''>size</span> <span
  m=''3373159''>so you could</span> <span m=''3373671''>run a, b, c sequentially?</span>
  <span m=''3377210''>PROFESSOR: You</span> <span m=''3377440''>could</span> <span
  m=''3377630''>do</span> <span m=''3377760''>that</span> <span m=''3377950''>as</span>
  <span m=''3378060''>well.</span> <span m=''3378430''>But</span> <span m=''3378670''>the</span>
  <span m=''3378850''>problem</span> <span m=''3379220''>with</span> <span m=''3379540''>running</span>
  <span m=''3379860''>a,</span> <span m=''3379950''>b,</span> <span m=''3380080''>c</span>
  <span m=''3380240''>sequentially</span> <span m=''3380770''>is</span> <span m=''3380910''>that</span>
  <span m=''3381620''>if</span> <span m=''3381780''>they''re</span> <span m=''3381900''>in</span>
  <span m=''3382070''>the</span> <span m=''3382160''>same</span> <span m=''3382430''>loop,</span>
  <span m=''3382930''>you</span> <span m=''3383170''>end</span> <span m=''3383330''>up</span>
  <span m=''3383500''>with</span> <span m=''3383930''>instructions</span> <span m=''3384460''>being</span>
  <span m=''3384640''>bad.</span> <span m=''3386050''>That</span> <span m=''3386220''>would</span>
  <span m=''3386690''>really,</span> <span m=''3387020''>this</span> <span m=''3387190''>case
  --</span> <span m=''3387440''>so</span> <span m=''3387550''>even</span> <span m=''3387740''>if</span>
  <span m=''3387850''>you</span> <span m=''3387920''>change</span> <span m=''3388220''>this</span>
  <span m=''3388370''>number</span> <span m=''3388830''>you</span> <span m=''3388970''>don''t</span>
  <span m=''3389090''>get</span> <span m=''3389200''>around</span> <span m=''3389570''>the</span>
  <span m=''3390270''>instructions.</span> </p><p><span m=''3394890''>So</span> <span
  m=''3395320''>you''re</span> <span m=''3395580''>going</span> <span m=''3395700''>to</span>
  <span m=''3395760''>see</span> <span m=''3395890''>more</span> <span m=''3396120''>optimizations</span>
  <span m=''3396880''>that</span> <span m=''3397420''>do</span> <span m=''3397650''>more</span>
  <span m=''3397960''>of</span> <span m=''3398040''>these</span> <span m=''3398280''>loop</span>
  <span m=''3398560''>tricks.</span> <span m=''3399990''>I</span> <span m=''3400040''>talk</span>
  <span m=''3400300''>about</span> <span m=''3400510''>unrolling</span> <span m=''3400950''>without</span>
  <span m=''3401220''>really</span> <span m=''3401670''>defining</span> <span m=''3402610''>what</span>
  <span m=''3402810''>unrolling</span> <span m=''3403230''>is</span> <span m=''3403450''>or</span>
  <span m=''3403680''>going</span> <span m=''3403960''>into</span> <span m=''3404150''>a</span>
  <span m=''3404210''>lot</span> <span m=''3404370''>of</span> <span m=''3404440''>details.</span>
  <span m=''3405930''>Loop</span> <span m=''3406130''>distribution,</span> <span m=''3406790''>loop</span>
  <span m=''3407040''>fision, some</span> <span m=''3407620''>of</span> <span m=''3407700''>the</span>
  <span m=''3407830''>things,</span> <span m=''3408170''>like</span> <span m=''3408480''>loop
  tiling, loop</span> <span m=''3409300''>blocking.</span> <span m=''3409960''>I</span>
  <span m=''3410420''>think</span> <span m=''3410600''>Simmon''s</span> <span m=''3410940''>going
  to</span> <span m=''3411090''>cover</span> <span m=''3411350''>some</span> <span
  m=''3411510''>of</span> <span m=''3411620''>these</span> <span m=''3412580''>next</span>
  <span m=''3412850''>week.</span> </p><p><span m=''3413620''>So</span> <span m=''3413800''>this</span>
  <span m=''3413960''>was</span> <span m=''3414130''>implemented,</span> <span m=''3414800''>this</span>
  <span m=''3414930''>was</span> <span m=''3415080''>done</span> <span m=''3415350''>by</span>
  <span m=''3416160''>another</span> <span m=''3416450''>Master</span> <span m=''3416890''>student</span>
  <span m=''3417420''>at</span> <span m=''3417640''>MIT</span> <span m=''3418520''>who</span>
  <span m=''3419070''>graduated</span> <span m=''3419580''>about</span> <span m=''3419900''>two</span>
  <span m=''3420060''>years</span> <span m=''3420310''>ago,</span> <span m=''3421620''>to</span>
  <span m=''3422040''>show</span> <span m=''3422470''>that</span> <span m=''3422640''>if</span>
  <span m=''3422790''>you</span> <span m=''3422970''>factor</span> <span m=''3423370''>in</span>
  <span m=''3423470''>cache</span> <span m=''3423790''>constraints</span> <span m=''3424230''>versus</span>
  <span m=''3424540''>ignoring</span> <span m=''3424910''>cache</span> <span m=''3425200''>constraints,</span>
  <span m=''3425890''>how</span> <span m=''3426010''>much</span> <span m=''3426150''>performance</span>
  <span m=''3426620''>you</span> <span m=''3426730''>can</span> <span m=''3426880''>get.</span>
  <span m=''3427650''>This</span> <span m=''3427800''>was</span> <span m=''3427950''>done</span>
  <span m=''3428160''>in the</span> <span m=''3428230''>context</span> <span m=''3428630''>of</span>
  <span m=''3428730''>StreamIt.</span> <span m=''3429580''>So,</span> <span m=''3429840''>in</span>
  <span m=''3429920''>fact,</span> <span m=''3430160''>some of</span> <span m=''3430320''>you</span>
  <span m=''3430410''>might</span> <span m=''3430530''>have</span> <span m=''3430640''>recognized</span>
  <span m=''3431790''>a</span> <span m=''3431960''>to</span> <span m=''3432060''>b</span>
  <span m=''3432220''>to</span> <span m=''3432310''>c</span> <span m=''3432540''>as</span>
  <span m=''3432710''>being</span> <span m=''3432930''>interconnected</span> <span
  m=''3433560''>as</span> <span m=''3434000''>pipeline</span> <span m=''3435540''>filters.</span>
  <span m=''3436950''>We</span> <span m=''3437450''>ran</span> <span m=''3437750''>it</span>
  <span m=''3437840''>on</span> <span m=''3438120''>different</span> <span m=''3438420''>processors,</span>
  <span m=''3438960''>so the</span> <span m=''3439160''>StrongARM</span> <span m=''3439690''>processor''s</span>
  <span m=''3440280''>really</span> <span m=''3440530''>small.</span> <span m=''3441550''>InOrder</span>
  <span m=''3441940''>processor</span> <span m=''3442520''>has</span> <span m=''3443010''>no</span>
  <span m=''3443390''>L1</span> <span m=''3443810''>cache</span> <span m=''3444930''>in</span>
  <span m=''3445060''>this</span> <span m=''3445180''>particular</span> <span m=''3445520''>model</span>
  <span m=''3445780''>that</span> <span m=''3445900''>we</span> <span m=''3446010''>used.</span>
  <span m=''3446520''>But it</span> <span m=''3446640''>had</span> <span m=''3447660''>a</span>
  <span m=''3447780''>really</span> <span m=''3448040''>long</span> <span m=''3448280''>latency
  --</span> <span m=''3449710''>sorry,</span> <span m=''3449880''>it had no</span>
  <span m=''3450000''>L2</span> <span m=''3450260''>cache.</span> <span m=''3451570''>It
  had</span> <span m=''3451780''>really</span> <span m=''3452010''>long</span> <span
  m=''3452210''>latency</span> <span m=''3452560''>to</span> <span m=''3452660''>memory.</span>
  <span m=''3454390''>Pentium,</span> <span m=''3455430''>an</span> <span m=''3455630''>x86</span>
  <span m=''3456150''>processor.</span> <span m=''3457710''>Reasonably</span> <span
  m=''3458090''>fast.</span> <span m=''3458450''>It</span> <span m=''3458520''>had</span>
  <span m=''3458730''>a</span> <span m=''3459410''>complicated</span> <span m=''3459670''>memory</span>
  <span m=''3459890''>system</span> <span m=''3460200''>and</span> <span m=''3460300''>a</span>
  <span m=''3460420''>lot,</span> <span m=''3460630''>a</span> <span m=''3460690''>lot</span>
  <span m=''3460900''>of</span> <span m=''3461400''>memory</span> <span m=''3461770''>overlap</span>
  <span m=''3462230''>in</span> <span m=''3462310''>terms</span> <span m=''3462550''>of</span>
  <span m=''3462620''>references.</span> <span m=''3463490''>Then</span> <span m=''3463700''>the</span>
  <span m=''3463800''>Itanium</span> <span m=''3464120''>processor,</span> <span m=''3464590''>which</span>
  <span m=''3464750''>had</span> <span m=''3464940''>a</span> <span m=''3464970''>huge</span>
  <span m=''3466280''>L2</span> <span m=''3466680''>cache</span> <span m=''3469050''>at</span>
  <span m=''3469490''>its</span> <span m=''3469710''>disposal.</span> </p><p><span
  m=''3470590''>So what</span> <span m=''3470770''>you</span> <span m=''3470930''>can</span>
  <span m=''3471060''>see</span> <span m=''3471300''>is</span> <span m=''3471500''>that</span>
  <span m=''3472250''>lower</span> <span m=''3472500''>bars</span> <span m=''3472920''>indicate</span>
  <span m=''3473340''>bigger</span> <span m=''3473580''>speed</span> <span m=''3473900''>ups.</span>
  <span m=''3476060''>This</span> <span m=''3476260''>is</span> <span m=''3476370''>normalized</span>
  <span m=''3476880''>run</span> <span m=''3477010''>time.</span> <span m=''3477680''>So</span>
  <span m=''3477790''>on</span> <span m=''3477920''>the</span> <span m=''3478000''>processor</span>
  <span m=''3478460''>where</span> <span m=''3478580''>you</span> <span m=''3478680''>don''t</span>
  <span m=''3478870''>actually</span> <span m=''3479250''>have</span> <span m=''3480350''>caches</span>
  <span m=''3480980''>to</span> <span m=''3481090''>save</span> <span m=''3481390''>you,</span>
  <span m=''3481990''>and</span> <span m=''3482250''>the</span> <span m=''3482310''>memory</span>
  <span m=''3482940''>communication is</span> <span m=''3483650''>really</span> <span
  m=''3483870''>expensive,</span> <span m=''3484730''>you</span> <span m=''3484900''>can</span>
  <span m=''3484990''>get</span> <span m=''3485100''>a</span> <span m=''3485160''>lot</span>
  <span m=''3485360''>of</span> <span m=''3485450''>benefit</span> <span m=''3485950''>from</span>
  <span m=''3486170''>doing</span> <span m=''3486410''>the</span> <span m=''3486490''>cache</span>
  <span m=''3486760''>aware</span> <span m=''3486990''>scaling,</span> <span m=''3487620''>that</span>
  <span m=''3487820''>loop</span> <span m=''3488060''>nesting</span> <span m=''3488890''>to</span>
  <span m=''3489030''>take</span> <span m=''3489230''>advantage</span> <span m=''3489660''>of</span>
  <span m=''3489800''>packing</span> <span m=''3490240''>instructions</span> <span
  m=''3490820''>instead</span> <span m=''3491060''>of</span> <span m=''3491120''>instruction</span>
  <span m=''3491520''>cache,</span> <span m=''3492100''>packing</span> <span m=''3492430''>data</span>
  <span m=''3492640''>into</span> <span m=''3492920''>data</span> <span m=''3493210''>cache</span>
  <span m=''3493870''>and</span> <span m=''3494140''>not</span> <span m=''3494290''>having</span>
  <span m=''3494550''>to</span> <span m=''3494640''>go</span> <span m=''3494720''>out</span>
  <span m=''3494840''>to</span> <span m=''3494930''>memory</span> <span m=''3495450''>if</span>
  <span m=''3495550''>you</span> <span m=''3495630''>don''t</span> <span m=''3495910''>to.</span>
  <span m=''3497100''>So</span> <span m=''3497330''>you</span> <span m=''3497440''>can</span>
  <span m=''3497580''>reduce</span> <span m=''3498350''>run</span> <span m=''3498610''>time</span>
  <span m=''3499250''>to</span> <span m=''3499450''>about</span> <span m=''3500050''>1/3</span>
  <span m=''3500580''>of</span> <span m=''3500740''>what</span> <span m=''3500890''>it</span>
  <span m=''3500980''>was</span> <span m=''3503120''>with</span> <span m=''3503470''>this</span>
  <span m=''3503790''>kind</span> <span m=''3503990''>of</span> <span m=''3504060''>cache</span>
  <span m=''3504320''>optimization.</span> </p><p><span m=''3506160''>On</span> <span
  m=''3506310''>the</span> <span m=''3506390''>Pentium3</span> <span m=''3507030''>where</span>
  <span m=''3507210''>you</span> <span m=''3507310''>have</span> <span m=''3507960''>a</span>
  <span m=''3508020''>cache</span> <span m=''3508380''>to</span> <span m=''3508470''>help</span>
  <span m=''3508650''>you</span> <span m=''3508780''>out,</span> <span m=''3510530''>the</span>
  <span m=''3510710''>benefits</span> <span m=''3511060''>are</span> <span m=''3511160''>there,</span>
  <span m=''3511410''>but</span> <span m=''3512180''>you</span> <span m=''3512270''>don''t</span>
  <span m=''3512450''>get</span> <span m=''3512720''>as</span> <span m=''3512980''>big</span>
  <span m=''3513140''>a</span> <span m=''3513180''>benefit</span> <span m=''3514300''>from</span>
  <span m=''3516330''>ignoring</span> <span m=''3516770''>the</span> <span m=''3516850''>cache</span>
  <span m=''3517130''>constraints</span> <span m=''3517500''>versus</span> <span m=''3518140''>being</span>
  <span m=''3518330''>aware</span> <span m=''3518550''>of</span> <span m=''3518610''>the</span>
  <span m=''3518680''>cache</span> <span m=''3518970''>constraints.</span> <span m=''3519670''>So</span>
  <span m=''3520150''>here</span> <span m=''3520490''>you''re</span> <span m=''3520590''>actually</span>
  <span m=''3520940''>doing</span> <span m=''3521220''>some</span> <span m=''3521430''>of</span>
  <span m=''3523000''>that</span> <span m=''3523360''>middle</span> <span m=''3523610''>column</span>
  <span m=''3524480''>whereas</span> <span m=''3524950''>here</span> <span m=''3525210''>we''re</span>
  <span m=''3525330''>doing</span> <span m=''3525570''>third</span> <span m=''3525880''>columns,</span>
  <span m=''3526360''>the</span> <span m=''3527590''>cache aware</span> <span m=''3528110''>fusion.</span>
  <span m=''3531890''>In</span> <span m=''3531960''>a</span> <span m=''3532200''>Itanium
  you</span> <span m=''3532340''>really</span> <span m=''3532600''>get</span> <span
  m=''3533420''>no</span> <span m=''3534540''>benefits</span> <span m=''3535000''>between</span>
  <span m=''3535340''>the</span> <span m=''3535430''>two.</span> <span m=''3536220''>Yep?</span>
  </p><p><span m=''3536580''>AUDIENCE:</span> <span m=''3537095''>Can you explain</span>
  <span m=''3537611''>what</span> <span m=''3538127''>the</span> <span m=''3540290''>left</span>
  <span m=''3540720''>columns</span> <span m=''3541110''>are?</span> </p><p><span
  m=''3542140''>PROFESSOR:</span> <span m=''3542630''>These?</span> </p><p><span m=''3544040''>AUDIENCE:</span>
  <span m=''3544160''>Yeah.</span> </p><p><span m=''3544280''>PROFESSOR:  So</span>
  <span m=''3544530''>this</span> <span m=''3544740''>is</span> <span m=''3546910''>tricky.</span>
  <span m=''3551020''>So</span> <span m=''3551230''>the</span> <span m=''3551310''>left</span>
  <span m=''3551530''>columns</span> <span m=''3551990''>are</span> <span m=''3552200''>doing</span>
  <span m=''3552690''>this.</span> </p><p><span m=''3553000''>AUDIENCE:</span> <span
  m=''3555495''>OK,</span> <span m=''3555994''>sort of</span> <span m=''3556493''>assuming</span>
  <span m=''3556992''>that</span> <span m=''3557491''>icache is there.</span> </p><p><span
  m=''3557990''>PROFESSOR: Right,</span> <span m=''3558260''>and</span> <span m=''3558400''>the</span>
  <span m=''3558470''>third</span> <span m=''3558760''>column</span> <span m=''3559080''>is</span>
  <span m=''3559200''>doing</span> <span m=''3559410''>this.</span> <span m=''3560500''>So</span>
  <span m=''3561320''>you</span> <span m=''3561710''>want</span> <span m=''3561910''>to</span>
  <span m=''3562000''>do</span> <span m=''3562130''>this</span> <span m=''3562340''>because</span>
  <span m=''3562660''>the</span> <span m=''3562840''>icache</span> <span m=''3563630''>locality</span>
  <span m=''3564160''>is</span> <span m=''3564360''>the best.</span> <span m=''3565000''>So</span>
  <span m=''3565140''>you</span> <span m=''3565270''>always</span> <span m=''3565540''>want</span>
  <span m=''3565720''>to</span> <span m=''3565790''>go</span> <span m=''3565910''>to</span>
  <span m=''3566030''>full</span> <span m=''3566560''>or</span> <span m=''3566700''>maximum</span>
  <span m=''3567140''>scaling.</span> <span m=''3569890''>I''m</span> <span m=''3570080''>actually</span>
  <span m=''3570790''>fudging</span> <span m=''3571090''>a</span> <span m=''3571150''>little</span>
  <span m=''3571430''>just</span> <span m=''3571640''>for</span> <span m=''3572150''>sake
  of</span> <span m=''3572470''>clarity.</span> <span m=''3573310''>Here</span> <span
  m=''3573600''>you''re</span> <span m=''3573710''>actually</span> <span m=''3574020''>doing</span>
  <span m=''3574300''>this</span> <span m=''3574960''>nesting</span> <span m=''3575970''>to</span>
  <span m=''3576320''>improve</span> <span m=''3576990''>both the</span> <span m=''3577250''>instruction</span>
  <span m=''3577780''>and</span> <span m=''3577940''>the</span> <span m=''3578000''>data</span>
  <span m=''3578220''>locality.</span> <span m=''3581440''>So</span> <span m=''3581540''>you</span>
  <span m=''3581660''>can</span> <span m=''3581770''>get</span> <span m=''3581940''>really</span>
  <span m=''3582170''>good</span> <span m=''3582310''>performance</span> <span m=''3582740''>improvement.</span>
  <span m=''3583160''>So</span> <span m=''3583330''>what</span> <span m=''3583450''>does</span>
  <span m=''3583560''>that</span> <span m=''3583700''>mean</span> <span m=''3583910''>for</span>
  <span m=''3584150''>your Cell</span> <span m=''3584700''>projects</span> <span m=''3585170''>or</span>
  <span m=''3586160''>for</span> <span m=''3586330''>Cell,</span> <span m=''3586680''>we''ll</span>
  <span m=''3586800''>talk</span> <span m=''3587040''>about</span> <span m=''3587240''>that</span>
  <span m=''3587630''>next</span> <span m=''3587950''>week</span> <span m=''3588130''>at</span>
  <span m=''3588280''>the</span> <span m=''3588420''>recitation.</span> <span m=''3592000''>Yeah?</span>
  </p><p><span m=''3592150''>AUDIENCE:</span> <span m=''3592624''>Is there some</span>
  <span m=''3593098''>big reasons</span> <span m=''3593572''>[UNINTELLIGIBLE PHRASE].</span>
  </p><p><span m=''3596400''>PROFESSOR: Well it just</span> <span m=''3596790''>means</span>
  <span m=''3596960''>that if</span> <span m=''3597130''>you</span> <span m=''3597370''>have
  caches</span> <span m=''3597760''>to</span> <span m=''3597850''>save you,</span>
  <span m=''3598710''>and</span> <span m=''3598960''>they''re</span> <span m=''3599060''>really</span>
  <span m=''3599310''>big</span> <span m=''3599450''>caches</span> <span m=''3599870''>and</span>
  <span m=''3600070''>they''re</span> <span m=''3600150''>really</span> <span m=''3600390''>efficient,</span>
  <span m=''3603950''>the</span> <span m=''3604330''>law of</span> <span m=''3604780''>diminishing</span>
  <span m=''3605160''>returns.</span> <span m=''3606990''>That''s</span> <span m=''3607160''>where</span>
  <span m=''3607270''>profiling</span> <span m=''3607700''>comes</span> <span m=''3607910''>in.</span>
  <span m=''3608370''>So</span> <span m=''3608500''>you</span> <span m=''3608560''>look</span>
  <span m=''3608690''>at the</span> <span m=''3608810''>profiling</span> <span m=''3609270''>results,</span>
  <span m=''3609660''>you look</span> <span m=''3609880''>at</span> <span m=''3609970''>your</span>
  <span m=''3610100''>cache</span> <span m=''3610400''>misses,</span> <span m=''3610740''>how</span>
  <span m=''3610860''>many</span> <span m=''3610980''>cache</span> <span m=''3611240''>misses</span>
  <span m=''3611490''>are</span> <span m=''3611560''>you</span> <span m=''3611670''>taking.</span>
  <span m=''3612360''>If</span> <span m=''3612690''>it''s</span> <span m=''3612850''>really</span>
  <span m=''3613120''>significant,</span> <span m=''3613680''>then</span> <span m=''3613850''>you</span>
  <span m=''3614110''>look</span> <span m=''3614310''>at</span> <span m=''3614440''>ways</span>
  <span m=''3614710''>to</span> <span m=''3614780''>improve</span> <span m=''3615110''>it.</span>
  <span m=''3616020''>If</span> <span m=''3616260''>your</span> <span m=''3616420''>cache</span>
  <span m=''3616710''>misses</span> <span m=''3616880''>are</span> <span m=''3617130''>really</span>
  <span m=''3617410''>low, you</span> <span m=''3617680''>missed rate is</span> <span
  m=''3618110''>really</span> <span m=''3618350''>low,</span> <span m=''3618620''>then
  it</span> <span m=''3619070''>doesn''t</span> <span m=''3619290''>make</span> <span
  m=''3619430''>sense</span> <span m=''3619630''>to</span> <span m=''3619840''>spend</span>
  <span m=''3620150''>time</span> <span m=''3620430''>and</span> <span m=''3620540''>energy</span>
  <span m=''3621090''>focusing on</span> <span m=''3621570''>that.</span> <span m=''3622120''>Good</span>
  <span m=''3622240''>question.</span> </p><p><span m=''3624830''>So,</span> <span
  m=''3625440''>any</span> <span m=''3625700''>other</span> <span m=''3625880''>questions?</span>
  </p><p><span m=''3628360''>So</span> <span m=''3628710''>summarizing</span> <span
  m=''3630410''>the</span> <span m=''3630570''>gamut</span> <span m=''3630930''>of</span>
  <span m=''3631610''>programming</span> <span m=''3632220''>for</span> <span m=''3632370''>performance.</span>
  <span m=''3633410''>So you</span> <span m=''3633770''>tune to</span> <span m=''3633840''>parallelism</span>
  <span m=''3634340''>first,</span> <span m=''3634730''>because</span> <span m=''3635040''>if</span>
  <span m=''3635170''>you</span> <span m=''3635230''>can''t</span> <span m=''3635410''>find
  the</span> <span m=''3635650''>concurrency,</span> <span m=''3636590''>your</span>
  <span m=''3636820''>Amdahl''s</span> <span m=''3637420''>law,</span> <span m=''3637630''>you''re</span>
  <span m=''3637790''>not</span> <span m=''3637930''>going</span> <span m=''3638140''>to</span>
  <span m=''3638350''>a</span> <span m=''3638440''>get</span> <span m=''3638570''>a</span>
  <span m=''3638600''>whole</span> <span m=''3638760''>lot</span> <span m=''3638910''>of</span>
  <span m=''3638980''>speed</span> <span m=''3639230''>up.</span> <span m=''3640440''>But</span>
  <span m=''3640620''>then</span> <span m=''3640820''>once</span> <span m=''3641090''>you</span>
  <span m=''3641600''>figured</span> <span m=''3642030''>out</span> <span m=''3642170''>what</span>
  <span m=''3642310''>the</span> <span m=''3642380''>parallelism</span> <span m=''3642730''>is,</span>
  <span m=''3643580''>then</span> <span m=''3643750''>what</span> <span m=''3643850''>you</span>
  <span m=''3643920''>want</span> <span m=''3644070''>to</span> <span m=''3644140''>do</span>
  <span m=''3644270''>is</span> <span m=''3644400''>really</span> <span m=''3644630''>get</span>
  <span m=''3644780''>the</span> <span m=''3644850''>performance</span> <span m=''3645320''>on</span>
  <span m=''3645450''>each</span> <span m=''3645740''>processor, the</span> <span
  m=''3646550''>single</span> <span m=''3646870''>track</span> <span m=''3647060''>performance</span>
  <span m=''3647480''>to</span> <span m=''3647560''>be</span> <span m=''3647680''>really</span>
  <span m=''3647920''>good. You</span> <span m=''3648190''>shouldn''t</span> <span
  m=''3648600''>ignore</span> <span m=''3648790''>that.</span> </p><p><span m=''3649870''>The</span>
  <span m=''3649940''>modern</span> <span m=''3650190''>processors</span> <span m=''3650660''>are</span>
  <span m=''3650790''>complex.</span> <span m=''3651630''>You</span> <span m=''3651960''>need</span>
  <span m=''3652170''>instructional</span> <span m=''3652570''>level</span> <span
  m=''3652760''>parallelism,</span> <span m=''3653070''>you</span> <span m=''3653150''>need</span>
  <span m=''3653470''>data</span> <span m=''3653700''>level</span> <span m=''3653950''>parallelism,</span>
  <span m=''3654820''>you</span> <span m=''3654920''>need</span> <span m=''3655370''>memory</span>
  <span m=''3655690''>hierarchy</span> <span m=''3656190''>optimizations,</span> <span
  m=''3657290''>and</span> <span m=''3657480''>so</span> <span m=''3657740''>you</span>
  <span m=''3657850''>should</span> <span m=''3658130''>consider</span> <span m=''3658970''>those</span>
  <span m=''3659210''>optimizations.</span> <span m=''3660230''>Here,</span> <span
  m=''3660460''>profiling</span> <span m=''3660960''>tools</span> <span m=''3661200''>could</span>
  <span m=''3661370''>really</span> <span m=''3661580''>help</span> <span m=''3661800''>you</span>
  <span m=''3661890''>figure</span> <span m=''3662210''>out</span> <span m=''3662640''>where</span>
  <span m=''3663750''>the</span> <span m=''3664260''>biggest</span> <span m=''3664550''>benefits</span>
  <span m=''3664970''>to</span> <span m=''3665070''>performance</span> <span m=''3665480''>will</span>
  <span m=''3665630''>come</span> <span m=''3665810''>from.</span> </p><p><span m=''3669570''>You</span>
  <span m=''3669670''>may</span> <span m=''3669870''>have</span> <span m=''3670110''>to,</span>
  <span m=''3670200''>in</span> <span m=''3670290''>fact,</span> <span m=''3670590''>change</span>
  <span m=''3670950''>everything.</span> <span m=''3671490''>You</span> <span m=''3671610''>may</span>
  <span m=''3671710''>have</span> <span m=''3671840''>to</span> <span m=''3671940''>change</span>
  <span m=''3672250''>your</span> <span m=''3672440''>algorithm,</span> <span m=''3672870''>your</span>
  <span m=''3673070''>data</span> <span m=''3673320''>structures,</span> <span m=''3673780''>your</span>
  <span m=''3673890''>program</span> <span m=''3674240''>structure.</span> <span m=''3674970''>So
  in the</span> <span m=''3675290''>MPEG</span> <span m=''3675600''>decoder</span>
  <span m=''3676020''>case,</span> <span m=''3676300''>for</span> <span m=''3676420''>example,</span>
  <span m=''3676830''>I</span> <span m=''3676910''>showed you</span> <span m=''3677280''>that</span>
  <span m=''3677460''>if</span> <span m=''3677570''>you</span> <span m=''3678040''>change</span>
  <span m=''3678540''>the</span> <span m=''3678990''>flag</span> <span m=''3679360''>that</span>
  <span m=''3679460''>says</span> <span m=''3679820''>don''t</span> <span m=''3680070''>use</span>
  <span m=''3680700''>double</span> <span m=''3680910''>precision</span> <span m=''3681520''>inverse</span>
  <span m=''3682050''>DCT,</span> <span m=''3682930''>use</span> <span m=''3683820''>a</span>
  <span m=''3683860''>numerical</span> <span m=''3684310''>hack,</span> <span m=''3685010''>then</span>
  <span m=''3685310''>you</span> <span m=''3685430''>can</span> <span m=''3685530''>get</span>
  <span m=''3685680''>performance</span> <span m=''3686090''>improvements</span> <span
  m=''3686620''>but</span> <span m=''3686790''>you''re</span> <span m=''3686920''>changing</span>
  <span m=''3687240''>your</span> <span m=''3687330''>algorithm</span> <span m=''3687720''>really.</span>
  <span m=''3689380''>You</span> <span m=''3689470''>really</span> <span m=''3689660''>want</span>
  <span m=''3689800''>to</span> <span m=''3689860''>focus</span> <span m=''3690150''>on</span>
  <span m=''3690320''>just the</span> <span m=''3690730''>biggest</span> <span m=''3691050''>nuggets</span>
  <span m=''3691850''>--</span> <span m=''3692120''>where</span> <span m=''3692920''>is</span>
  <span m=''3693040''>most</span> <span m=''3693270''>of the</span> <span m=''3693410''>performance</span>
  <span m=''3693760''>coming</span> <span m=''3694050''>in,</span> <span m=''3694560''>or</span>
  <span m=''3694760''>where''s</span> <span m=''3695110''>the</span> <span m=''3695220''>biggest</span>
  <span m=''3695650''>performance</span> <span m=''3696030''>bottleneck,</span> <span
  m=''3696210''>and</span> <span m=''3696600''>that''s</span> <span m=''3696790''>the</span>
  <span m=''3696870''>thing</span> <span m=''3697020''>you</span> <span m=''3697110''>want</span>
  <span m=''3697260''>optimize.</span> <span m=''3698060''>So</span> <span m=''3698290''>remember
  the</span> <span m=''3698900''>law of</span> <span m=''3699230''>diminishing</span>
  <span m=''3699630''>returns.</span> <span m=''3700200''>Don''t</span> <span m=''3700380''>spend</span>
  <span m=''3700560''>your</span> <span m=''3700660''>time on</span> <span m=''3701050''>doing</span>
  <span m=''3701340''>things</span> <span m=''3701700''>that</span> <span m=''3702240''>aren''t</span>
  <span m=''3702430''>going</span> <span m=''3702630''>to</span> <span m=''3702720''>get</span>
  <span m=''3702880''>you</span> <span m=''3703560''>anything</span> <span m=''3704240''>significant
  in</span> <span m=''3704780''>return.</span> </p><p><span m=''3706010''>That''s</span>
  <span m=''3706130''>it.</span> <span m=''3706450''>Any</span> <span m=''3706660''>questions?</span>
  <span m=''3711070''>OK.</span> <span m=''3711830''>How</span> <span m=''3711930''>are
  you</span> <span m=''3712160''>guys doing</span> <span m=''3712240''>with</span>
  <span m=''3712330''>the</span> <span m=''3712400''>projects?</span> <span m=''3716830''>So,</span>
  <span m=''3717120''>one</span> <span m=''3717280''>of</span> <span m=''3717440''>the</span>
  <span m=''3718750''>added</span> <span m=''3719090''>benefits</span> <span m=''3719570''>of</span>
  <span m=''3719900''>the</span> <span m=''3719990''>central</span> <span m=''3720340''>CBS</span>
  <span m=''3720760''>repository is</span> <span m=''3721630''>I</span> <span m=''3721760''>get</span>
  <span m=''3721940''>notifications</span> <span m=''3722640''>too</span> <span m=''3723380''>when
  you</span> <span m=''3723620''>submit</span> <span m=''3723940''>things.</span>
  <span m=''3724620''>So</span> <span m=''3724830''>I</span> <span m=''3724910''>know</span>
  <span m=''3725090''>of</span> <span m=''3725200''>only</span> <span m=''3725400''>two</span>
  <span m=''3725570''>projects</span> <span m=''3726140''>that</span> <span m=''3726280''>have</span>
  <span m=''3726450''>been</span> <span m=''3726930''>submitting</span> <span m=''3727410''>things</span>
  <span m=''3727690''>regularly.</span> <span m=''3728580''>So, I</span> <span m=''3729040''>hope</span>
  <span m=''3729230''>that''ll</span> <span m=''3729450''>pick</span> <span m=''3729630''>up</span>
  <span m=''3729780''>soon.</span> <span m=''3731950''>I</span> <span m=''3732200''>guess</span>
  <span m=''3732430''>a</span> <span m=''3732490''>few</span> <span m=''3732630''>minutes</span>
  <span m=''3732850''>to</span> <span m=''3732950''>finish</span> <span m=''3733500''>the
  quiz and</span> <span m=''3733820''>then</span> <span m=''3734170''>we''ll</span>
  <span m=''3734280''>see</span> <span m=''3734430''>you</span> <span m=''3734530''>next</span>
  <span m=''3734650''>week.</span> <span m=''3734930''>Have a good</span> <span m=''3735110''>weekend.</span>
  </p>'
type: course
uid: e12a04aff77fb12a74bf0285fef61fae

---
None