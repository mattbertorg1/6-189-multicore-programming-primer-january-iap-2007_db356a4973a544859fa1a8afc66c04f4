---
about_this_resource_text: '<p><strong>Topics covered: </strong>Cell profiling tools</p><p><strong>Instructor:</strong>
  Phil Sung</p>'
course_id: 6-189-multicore-programming-primer-january-iap-2007
embedded_media:
- id: r5.jpg
  parent_uid: cf036c4893311953f0687fffa8e76fda
  technical_location: https://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-189-multicore-programming-primer-january-iap-2007/recitations/r5-cell-profiling-tools/r5.jpg
  title: 'R5: Cell Profiling Tools'
  type: null
  uid: cf689d84aa4c74456b4ff77265d82e58
- id: Video-YouTube-Stream
  media_location: gIuL_WdfH74
  parent_uid: cf036c4893311953f0687fffa8e76fda
  title: Video-YouTube-Stream
  type: Video
  uid: 201b5755e9f16a747bc51fe79b784938
- id: Thumbnail-YouTube-JPG
  media_location: https://img.youtube.com/vi/gIuL_WdfH74/default.jpg
  parent_uid: cf036c4893311953f0687fffa8e76fda
  title: Thumbnail-YouTube-JPG
  type: Thumbnail
  uid: 5bc7f5afb1ac6474860687192c5be780
- id: Video-iTunesU-MP4
  media_location: https://itunes.apple.com/us/itunes-u/id341597759
  parent_uid: cf036c4893311953f0687fffa8e76fda
  title: Video-iTunes U-MP4
  type: Video
  uid: d99e09442389f19d914d4ceab4865ced
- id: Video-InternetArchive-MP4
  media_location: http://www.archive.org/download/MIT6.189IAP07/ocw-6.189-iap07-rec05_300k.mp4
  parent_uid: cf036c4893311953f0687fffa8e76fda
  title: Video-Internet Archive-MP4
  type: Video
  uid: 8158abb4e96b00b7eef415a3802a3115
- id: Thumbnail-OCW-JPG
  parent_uid: cf036c4893311953f0687fffa8e76fda
  title: Thumbnail-OCW-JPG
  type: Thumbnail
  uid: 0040186c96120d208ad5130b33319749
- id: 3Play-3PlayYouTubeid-MP4
  media_location: gIuL_WdfH74
  parent_uid: cf036c4893311953f0687fffa8e76fda
  title: 3Play-3Play YouTube id
  type: 3Play
  uid: 08f24af2c5fc60ae5fc3e59fe1b7ab0a
- id: gIuL_WdfH74.srt
  parent_uid: cf036c4893311953f0687fffa8e76fda
  technical_location: https://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-189-multicore-programming-primer-january-iap-2007/recitations/r5-cell-profiling-tools/gIuL_WdfH74.srt
  title: 3play caption file
  type: null
  uid: d92649eae1502cfd2a6b3c6b46de2fd0
- id: gIuL_WdfH74.pdf
  parent_uid: cf036c4893311953f0687fffa8e76fda
  technical_location: https://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-189-multicore-programming-primer-january-iap-2007/recitations/r5-cell-profiling-tools/gIuL_WdfH74.pdf
  title: 3play pdf file
  type: null
  uid: 8c4cd8f286d47e8375403d6bc2d816df
- id: Caption-3Play YouTube id-SRT
  parent_uid: cf036c4893311953f0687fffa8e76fda
  title: Caption-3Play YouTube id-SRT-English - US
  type: Caption
  uid: 727573eee74ef2eaf9b8f5cb8811b293
- id: Transcript-3Play YouTube id-PDF
  parent_uid: cf036c4893311953f0687fffa8e76fda
  title: Transcript-3Play YouTube id-PDF-English - US
  type: Transcript
  uid: 81365d0fae29bd8bf49ca6abb05890d2
inline_embed_id: 43766422r5:cellprofilingtools432814
layout: video
order_index: null
parent_uid: 1a7273101a37c171a13d06e2fa6799d5
related_resources_text: '<p class="instruction">Special software is required to use
  some of the files in this section: .<a href="/help/faq-technical-requirements/#zip">zip</a>,
  <a href="/help/faq-technical-requirements/#c">.c</a>, <a href="/help/faq-technical-requirements/#h">.h</a>,
  and <a href="/help/faq-technical-requirements/#s">.s</a>.</p> <p><strong>Lecture
  Notes:</strong><br /> Cell profiling tools (<a alt="Open in a new window." title="Open
  in a new window." target="_blank" href="./resolveuid/5d771ccccd2454a8dfcba12aa58804d3">PDF</a>)</p>
  <p><strong>Supporting Files:</strong><br /> rec5.zip (<a alt="Open in a new window."
  title="Open in a new window." target="_blank" href="./resolveuid/1e860c102aadbab7e450cc9957a60638">ZIP</a>)
  (The ZIP file contains: 2 .s files, common.h, make-obj-file, and 2 makefile files.)</p>'
short_url: r5-cell-profiling-tools
technical_location: https://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-189-multicore-programming-primer-january-iap-2007/recitations/r5-cell-profiling-tools
template_type: Tabbed
title: 'R5: Cell Profiling Tools'
transcript: '<p><span m=''60''>The</span> <span m=''180''>following</span> <span m=''620''>content</span>
  <span m=''1210''>is</span> <span m=''1330''>provided</span> <span m=''1770''>under</span>
  <span m=''2050''>a</span> <span m=''2090''>Creative</span> <span m=''2500''>Commons</span>
  <span m=''2900''>license.</span> <span m=''4019''>Your</span> <span m=''4200''>support</span>
  <span m=''4710''>will</span> <span m=''4860''>help</span> <span m=''5100''>MIT</span>
  <span m=''5560''>OpenCourseWare</span> <span m=''6350''>continue</span> <span m=''6860''>to</span>
  <span m=''6940''>offer</span> <span m=''7350''>high</span> <span m=''7590''>quality</span>
  <span m=''8109''>educational</span> <span m=''8740''>resources</span> <span m=''9360''>for</span>
  <span m=''9510''>free.</span> <span m=''10720''>To</span> <span m=''10730''>make</span>
  <span m=''10930''>a</span> <span m=''10980''>donation</span> <span m=''11660''>or</span>
  <span m=''11930''>view</span> <span m=''12370''>additional</span> <span m=''12790''>materials</span>
  <span m=''13340''>from</span> <span m=''13480''>hundreds</span> <span m=''13910''>of</span>
  <span m=''14020''>MIT</span> <span m=''14450''>courses,</span> <span m=''15570''>visit</span>
  <span m=''15780''>MIT</span> <span m=''16200''>OpenCourseWare</span> <span m=''17250''>at</span>
  <span m=''17410''>ocw.mit.edu.</span> </p><p><span m=''21420''>PROFESSOR: All right,</span>
  <span m=''22320''>everyone.</span> <span m=''22780''>Welcome</span> <span m=''22950''>back.</span>
  <span m=''25360''>Today</span> <span m=''25570''>we''re</span> <span m=''25660''>going</span>
  <span m=''25750''>to</span> <span m=''25800''>talk</span> <span m=''25980''>about</span>
  <span m=''26490''>the</span> <span m=''26800''>profiling</span> <span m=''27240''>tools</span>
  <span m=''27460''>available</span> <span m=''27820''>on</span> <span m=''27950''>Cell</span>
  <span m=''28250''>to</span> <span m=''28330''>help</span> <span m=''28520''>you</span>
  <span m=''28670''>evaluate</span> <span m=''29120''>how</span> <span m=''29230''>your</span>
  <span m=''29370''>programs</span> <span m=''29740''>are</span> <span m=''29850''>running.</span>
  <span m=''30550''>In</span> <span m=''31220''>the</span> <span m=''31270''>next</span>
  <span m=''31520''>hour</span> <span m=''31750''>I''ll</span> <span m=''31880''>talk</span>
  <span m=''32080''>about</span> <span m=''32680''>SIMD,</span> <span m=''33260''>which</span>
  <span m=''33410''>is</span> <span m=''33490''>how</span> <span m=''33600''>you</span>
  <span m=''33690''>can</span> <span m=''33790''>take</span> <span m=''33940''>advantage</span>
  <span m=''34330''>of</span> <span m=''34850''>the</span> <span m=''35170''>hardware</span>
  <span m=''35450''>support</span> <span m=''35740''>for</span> <span m=''35950''>data</span>
  <span m=''36630''>parallelization.</span> </p><p><span m=''39520''>First</span>
  <span m=''39800''>up,</span> <span m=''40070''>I''d</span> <span m=''40300''>like</span>
  <span m=''40550''>to</span> <span m=''41740''>follow</span> <span m=''42010''>up</span>
  <span m=''42150''>with</span> <span m=''42260''>some</span> <span m=''42900''>questions</span>
  <span m=''43370''>that</span> <span m=''43490''>we</span> <span m=''43600''>had</span>
  <span m=''43860''>last</span> <span m=''44090''>time</span> <span m=''44220''>about</span>
  <span m=''44530''>gdb,</span> <span m=''45520''>and</span> <span m=''45730''>then</span>
  <span m=''46670''>I''ll</span> <span m=''46860''>discuss</span> <span m=''47730''>some</span>
  <span m=''47910''>of</span> <span m=''47960''>the</span> <span m=''48050''>various</span>
  <span m=''48360''>methods</span> <span m=''48660''>for</span> <span m=''48780''>profiling</span>
  <span m=''49340''>on</span> <span m=''49510''>Cell.</span> <span m=''50330''>I''ll</span>
  <span m=''50420''>talk</span> <span m=''50570''>about</span> <span m=''50800''>the</span>
  <span m=''51000''>Cell</span> <span m=''51230''>simulator</span> <span m=''52120''>and</span>
  <span m=''52540''>using</span> <span m=''52860''>the</span> <span m=''52930''>decrementers,</span>
  <span m=''54130''>and</span> <span m=''54340''>then</span> <span m=''54580''>we''re</span>
  <span m=''54680''>going</span> <span m=''54760''>to</span> <span m=''54800''>talk</span>
  <span m=''54980''>about</span> <span m=''55850''>static</span> <span m=''56190''>profiling</span>
  <span m=''56740''>and</span> <span m=''57350''>instruction</span> <span m=''57810''>reordering,</span>
  <span m=''58230''>which</span> <span m=''58410''>I</span> <span m=''58960''>started</span>
  <span m=''59270''>to</span> <span m=''59310''>get</span> <span m=''59420''>into</span>
  <span m=''59780''>last</span> <span m=''59920''>time.</span> </p><p><span m=''62640''>So</span>
  <span m=''62800''>first</span> <span m=''63060''>up,</span> <span m=''63960''>we</span>
  <span m=''64030''>ran</span> <span m=''64200''>into</span> <span m=''64540''>some</span>
  <span m=''64810''>problems</span> <span m=''65120''>last</span> <span m=''65340''>time</span>
  <span m=''65519''>with</span> <span m=''65660''>gdb,</span> <span m=''66150''>various</span>
  <span m=''66500''>error</span> <span m=''66700''>messages.</span> <span m=''67980''>First</span>
  <span m=''68280''>thing,</span> <span m=''68830''>sometimes</span> <span m=''69280''>gbd</span>
  <span m=''70210''>is</span> <span m=''70360''>going</span> <span m=''70470''>to</span>
  <span m=''70510''>examine</span> <span m=''70950''>the</span> <span m=''71050''>wrong</span>
  <span m=''71300''>variable,</span> <span m=''71910''>as</span> <span m=''72070''>we</span>
  <span m=''72170''>saw</span> <span m=''72400''>when the</span> <span m=''72830''>names</span>
  <span m=''73120''>are</span> <span m=''73240''>ambiguous.</span> <span m=''74570''>One</span>
  <span m=''74790''>thing</span> <span m=''74910''>you</span> <span m=''75010''>can</span>
  <span m=''75120''>do</span> <span m=''75270''>to</span> <span m=''75320''>get</span>
  <span m=''75480''>around</span> <span m=''75780''>this--</span> <span m=''76770''>we</span>
  <span m=''77050''>had</span> <span m=''77380''>problems</span> <span m=''78440''>with</span>
  <span m=''78610''>ambiguity</span> <span m=''79080''>between</span> <span m=''80360''>variables,</span>
  <span m=''80820''>which</span> <span m=''80870''>have</span> <span m=''80990''>the</span>
  <span m=''81060''>same</span> <span m=''81280''>name</span> <span m=''81560''>where</span>
  <span m=''81730''>one</span> <span m=''81890''>of</span> <span m=''81950''>them</span>
  <span m=''82100''>was</span> <span m=''82230''>in</span> <span m=''82350''>the</span>
  <span m=''82690''>spu</span> <span m=''83110''>thread</span> <span m=''83370''>and</span>
  <span m=''83480''>one</span> <span m=''83620''>of</span> <span m=''83690''>them</span>
  <span m=''83840''>was</span> <span m=''83980''>in</span> <span m=''84040''>the</span>
  <span m=''84110''>ppu</span> <span m=''84570''>thread.</span> <span m=''85520''>And</span>
  <span m=''85790''>so</span> <span m=''86770''>to</span> <span m=''87070''>work</span>
  <span m=''87270''>around</span> <span m=''87530''>this,</span> <span m=''87840''>one</span>
  <span m=''88000''>thing</span> <span m=''88130''>you</span> <span m=''88240''>can</span>
  <span m=''88350''>do</span> <span m=''88530''>is</span> <span m=''88640''>use</span>
  <span m=''88980''>spu-gdb,</span> <span m=''90370''>which</span> <span m=''90570''>will</span>
  <span m=''90850''>just</span> <span m=''91050''>log</span> <span m=''91270''>on</span>
  <span m=''91420''>to</span> <span m=''91510''>a</span> <span m=''91580''>particular</span>
  <span m=''92040''>spu</span> <span m=''92480''>thread,</span> <span m=''93120''>then</span>
  <span m=''93260''>you</span> <span m=''93360''>can</span> <span m=''93500''>just</span>
  <span m=''94200''>look</span> <span m=''94510''>for</span> <span m=''96140''>variable</span>
  <span m=''96530''>names</span> <span m=''96780''>in</span> <span m=''96890''>that</span>
  <span m=''97080''>thread.</span> <span m=''98410''>You</span> <span m=''98530''>can</span>
  <span m=''98630''>also,</span> <span m=''98890''>of</span> <span m=''98970''>course,</span>
  <span m=''99220''>rename</span> <span m=''99510''>your</span> <span m=''99610''>variables.</span>
  </p><p><span m=''101600''>Second</span> <span m=''101780''>problem</span> <span
  m=''102070''>is</span> <span m=''102170''>that</span> <span m=''103520''>sometimes</span>
  <span m=''104040''>gdb</span> <span m=''104490''>will</span> <span m=''104920''>delete</span>
  <span m=''105200''>your</span> <span m=''105330''>breakpoints</span> <span m=''105920''>before</span>
  <span m=''106270''>you</span> <span m=''106500''>want it</span> <span m=''106810''>to</span>
  <span m=''106910''>delete</span> <span m=''107210''>them.</span> <span m=''108470''>Reason</span>
  <span m=''108790''>being,</span> <span m=''109620''>it</span> <span m=''109780''>will</span>
  <span m=''110270''>remove</span> <span m=''110600''>breakpoints</span> <span m=''111690''>whenever</span>
  <span m=''112140''>the</span> <span m=''112420''>program</span> <span m=''113070''>associated</span>
  <span m=''113630''>with</span> <span m=''113770''>a</span> <span m=''113810''>breakpoint</span>
  <span m=''114260''>has</span> <span m=''114400''>been</span> <span m=''114550''>unloaded.</span>
  <span m=''115530''>But</span> <span m=''115660''>sometimes</span> <span m=''116060''>you</span>
  <span m=''116170''>have</span> <span m=''116550''>more</span> <span m=''116750''>than</span>
  <span m=''116980''>one</span> <span m=''117230''>thread</span> <span m=''117530''>running</span>
  <span m=''120180''>the</span> <span m=''120240''>same</span> <span m=''120440''>program,</span>
  <span m=''121220''>and</span> <span m=''121440''>so</span> <span m=''122160''>the</span>
  <span m=''123160''>second</span> <span m=''123450''>one</span> <span m=''123610''>you</span>
  <span m=''123730''>won''t</span> <span m=''123860''>be</span> <span m=''123950''>able</span>
  <span m=''124090''>to</span> <span m=''124180''>break</span> <span m=''124410''>into.</span>
  </p><p><span m=''126620''>So</span> <span m=''126990''>again,</span> <span m=''128000''>you</span>
  <span m=''128130''>can</span> <span m=''128240''>use</span> <span m=''128520''>spu-gdb</span>
  <span m=''129289''>to</span> <span m=''129410''>log</span> <span m=''129620''>on
  to</span> <span m=''129840''>a</span> <span m=''129900''>particular</span> <span
  m=''130380''>thread</span> <span m=''130860''>if</span> <span m=''131000''>you</span>
  <span m=''131100''>want</span> <span m=''131260''>to</span> <span m=''132060''>do</span>
  <span m=''132200''>that.</span> <span m=''133440''>Another</span> <span m=''133610''>thing</span>
  <span m=''133750''>you</span> <span m=''133880''>can</span> <span m=''134000''>do</span>
  <span m=''134260''>is</span> <span m=''135780''>for</span> <span m=''135870''>example</span>
  <span m=''136170''>put</span> <span m=''136330''>a</span> <span m=''136480''>delay</span>
  <span m=''136830''>loop</span> <span m=''137740''>at</span> <span m=''137910''>the</span>
  <span m=''138070''>end</span> <span m=''138270''>of</span> <span m=''138360''>your</span>
  <span m=''138580''>spu</span> <span m=''139070''>thread</span> <span m=''139340''>in</span>
  <span m=''139450''>order</span> <span m=''139620''>to</span> <span m=''139720''>keep</span>
  <span m=''139910''>that</span> <span m=''140100''>thread</span> <span m=''140360''>running</span>
  <span m=''140640''>for</span> <span m=''140780''>as</span> <span m=''140870''>long</span>
  <span m=''141040''>as</span> <span m=''141130''>possible.</span> <span m=''142120''>It</span>
  <span m=''142270''>seems</span> <span m=''142490''>that</span> <span m=''142620''>as</span>
  <span m=''142720''>long</span> <span m=''142900''>as</span> <span m=''143000''>gdb</span>
  <span m=''143370''>doesn''t</span> <span m=''143640''>unload</span> <span m=''144070''>that</span>
  <span m=''144250''>thread,</span> <span m=''144540''>then</span> <span m=''144660''>it</span>
  <span m=''144720''>won''t</span> <span m=''144940''>delete</span> <span m=''145080''>your</span>
  <span m=''145270''>breakpoint.</span> </p><p><span m=''147520''>And</span> <span
  m=''147840''>finally,</span> <span m=''149500''>I</span> <span m=''149580''>saw</span>
  <span m=''149780''>this</span> <span m=''150340''>kind</span> <span m=''150500''>of</span>
  <span m=''150600''>cryptic</span> <span m=''150960''>error</span> <span m=''151190''>thread</span>
  <span m=''151490''>event</span> <span m=''151770''>breakpoint</span> <span m=''152330''>gdb</span>
  <span m=''152750''>should</span> <span m=''152940''>not</span> <span m=''153160''>stop.</span>
  <span m=''154250''>Indeed</span> <span m=''154490''>it shouldn''t.</span> <span
  m=''156110''>One</span> <span m=''156280''>thing,</span> <span m=''157670''>to</span>
  <span m=''157920''>get</span> <span m=''158060''>around</span> <span m=''158290''>this,</span>
  <span m=''158660''>it</span> <span m=''158780''>seems</span> <span m=''159040''>that</span>
  <span m=''159370''>this</span> <span m=''159540''>problem</span> <span m=''159750''>doesn''t</span>
  <span m=''159970''>happen</span> <span m=''160260''>on</span> <span m=''160660''>spu-gdb.</span>
  </p><p><span m=''162730''>So I''ll</span> <span m=''162950''>just</span> <span m=''163150''>recap</span>
  <span m=''163600''>how</span> <span m=''163750''>to</span> <span m=''163820''>use</span>
  <span m=''164160''>spu-gdb</span> <span m=''164980''>to</span> <span m=''165770''>debug</span>
  <span m=''166130''>your</span> <span m=''166240''>programs.</span> <span m=''167690''>Last</span>
  <span m=''167990''>time</span> <span m=''168140''>we</span> <span m=''168240''>were</span>
  <span m=''168350''>using</span> <span m=''168690''>mostly</span> <span m=''169110''>ppu-gdb,</span>
  <span m=''170400''>which</span> <span m=''170610''>will</span> <span m=''171140''>help</span>
  <span m=''171420''>you</span> <span m=''171520''>debug</span> <span m=''172340''>kind</span>
  <span m=''172520''>of</span> <span m=''172800''>both</span> <span m=''173030''>your</span>
  <span m=''173190''>PPU</span> <span m=''173620''>program</span> <span m=''174080''>and</span>
  <span m=''174370''>your</span> <span m=''174620''>SPU</span> <span m=''174990''>program</span>
  <span m=''175400''>together.</span> <span m=''176040''>And</span> <span m=''176160''>you''re</span>
  <span m=''176240''>able</span> <span m=''176470''>to</span> <span m=''176580''>switch</span>
  <span m=''176870''>between</span> <span m=''177270''>all</span> <span m=''177510''>the</span>
  <span m=''177570''>threads</span> <span m=''177920''>that</span> <span m=''178040''>are</span>
  <span m=''178140''>available.</span> <span m=''179190''>On</span> <span m=''179320''>the</span>
  <span m=''179410''>other</span> <span m=''179500''>hand,</span> <span m=''179690''>when
  you''re</span> <span m=''179840''>using</span> <span m=''180180''>spu-gdb,</span>
  <span m=''181340''>it''s</span> <span m=''181520''>just</span> <span m=''181700''>going</span>
  <span m=''181910''>to</span> <span m=''182010''>log</span> <span m=''182270''>on
  to</span> <span m=''182580''>a</span> <span m=''182650''>particular</span> <span
  m=''183390''>SPU</span> <span m=''183850''>thread.</span> <span m=''184900''>So</span>
  <span m=''185020''>what</span> <span m=''185160''>you</span> <span m=''185270''>do</span>
  <span m=''185510''>is</span> <span m=''185620''>you</span> <span m=''185790''>invoke</span>
  <span m=''186150''>your</span> <span m=''187690''>original</span> <span m=''188090''>people</span>
  <span m=''188330''>PPU</span> <span m=''188530''>program</span> <span m=''188970''>with</span>
  <span m=''189310''>SPU</span> <span m=''189870''>debug</span> <span m=''190300''>star</span>
  <span m=''190620''>equals</span> <span m=''190930''>1.</span> <span m=''191980''>And</span>
  <span m=''192140''>then</span> <span m=''192330''>you</span> <span m=''192480''>can</span>
  <span m=''192920''>background</span> <span m=''193370''>it.</span> </p><p><span
  m=''195190''>Now</span> <span m=''195360''>what</span> <span m=''195460''>happens</span>
  <span m=''195860''>is</span> <span m=''196520''>every</span> <span m=''196790''>time</span>
  <span m=''197440''>that</span> <span m=''198360''>your--</span> <span m=''199430''>every</span>
  <span m=''199580''>time</span> <span m=''199760''>that</span> <span m=''199880''>your</span>
  <span m=''200070''>SPU--</span> <span m=''200860''>sorry,</span> <span m=''201250''>every</span>
  <span m=''201450''>time</span> <span m=''201610''>that</span> <span m=''201710''>your</span>
  <span m=''201880''>program</span> <span m=''202380''>spawns</span> <span m=''202530''>a</span>
  <span m=''202620''>new</span> <span m=''202990''>SPU</span> <span m=''203220''>thread,</span>
  <span m=''203890''>it</span> <span m=''203980''>will</span> <span m=''204120''>print</span>
  <span m=''204330''>the</span> <span m=''204430''>process</span> <span m=''204830''>ID</span>
  <span m=''205470''>and</span> <span m=''205640''>then</span> <span m=''205760''>actually</span>
  <span m=''206020''>that</span> <span m=''206300''>thread,</span> <span m=''206800''>the</span>
  <span m=''206900''>spawned</span> <span m=''207230''>thread,</span> <span m=''207510''>will</span>
  <span m=''207650''>stop</span> <span m=''208020''>and</span> <span m=''208190''>wait</span>
  <span m=''208430''>for</span> <span m=''208570''>a</span> <span m=''208620''>debugger</span>
  <span m=''209000''>to</span> <span m=''209150''>attach</span> <span m=''209520''>to</span>
  <span m=''209670''>it.</span> <span m=''210510''>So</span> <span m=''210640''>at</span>
  <span m=''210720''>this</span> <span m=''210880''>point,</span> <span m=''211080''>you</span>
  <span m=''211200''>can</span> <span m=''211360''>run</span> <span m=''212530''>spu-gdb</span>
  <span m=''213300''>-p</span> <span m=''214360''>and</span> <span m=''214480''>then</span>
  <span m=''214610''>the</span> <span m=''214690''>process</span> <span m=''215080''>number</span>
  <span m=''215290''>that</span> <span m=''215450''>they</span> <span m=''215530''>give</span>
  <span m=''215730''>you.</span> <span m=''216390''>And</span> <span m=''216680''>when</span>
  <span m=''216790''>you</span> <span m=''216890''>attach</span> <span m=''217210''>to</span>
  <span m=''217330''>it,</span> <span m=''217420''>you</span> <span m=''217510''>can</span>
  <span m=''217650''>continue</span> <span m=''218130''>that</span> <span m=''218360''>thread</span>
  <span m=''218870''>to</span> <span m=''219130''>resume</span> <span m=''219460''>debugging.</span>
  <span m=''221180''>Any</span> <span m=''221330''>questions?</span> </p><p><span
  m=''229200''>OK,</span> <span m=''230510''>so</span> <span m=''230830''>the</span>
  <span m=''231080''>Cell</span> <span m=''231350''>simulator</span> <span m=''235210''>is</span>
  <span m=''235300''>one</span> <span m=''235440''>of</span> <span m=''235500''>the</span>
  <span m=''235580''>tools</span> <span m=''235910''>that</span> <span m=''236020''>we</span>
  <span m=''236130''>have</span> <span m=''236450''>available</span> <span m=''238270''>to</span>
  <span m=''238370''>help</span> <span m=''238550''>you</span> <span m=''238690''>debug.</span>
  <span m=''241190''>This</span> <span m=''241290''>is</span> <span m=''241400''>how</span>
  <span m=''241500''>you</span> <span m=''241640''>invoke</span> <span m=''241920''>it
  if</span> <span m=''242090''>you</span> <span m=''242200''>have</span> <span m=''242360''>it</span>
  <span m=''242420''>installed,</span> <span m=''242970''>opt/ibm/systemsim-cell/bin/systemsim,</span>
  <span m=''245660''>and</span> <span m=''246000''>you</span> <span m=''246080''>want</span>
  <span m=''246170''>to</span> <span m=''246210''>use</span> <span m=''246390''>-g</span>
  <span m=''246970''>to</span> <span m=''247080''>use</span> <span m=''247360''>the</span>
  <span m=''247670''>graphical</span> <span m=''248090''>interface.</span> <span m=''249050''>And</span>
  <span m=''249350''>a</span> <span m=''249400''>little</span> <span m=''249590''>window</span>
  <span m=''249840''>will</span> <span m=''249970''>pop</span> <span m=''250180''>up</span>
  <span m=''250300''>and</span> <span m=''250390''>you''ll</span> <span m=''250520''>click</span>
  <span m=''250780''>Go.</span> <span m=''252320''>The</span> <span m=''252460''>window</span>
  <span m=''252670''>looks</span> <span m=''252870''>like</span> <span m=''253040''>this.</span>
  <span m=''253450''>It</span> <span m=''253830''>actually,</span> <span m=''254340''>from</span>
  <span m=''254500''>here,</span> <span m=''254650''>you</span> <span m=''254750''>can</span>
  <span m=''254910''>have</span> <span m=''255080''>a</span> <span m=''255110''>lot</span>
  <span m=''255250''>of</span> <span m=''255330''>fine-grained</span> <span m=''255740''>control</span>
  <span m=''256130''>over</span> <span m=''256329''>how</span> <span m=''256459''>your</span>
  <span m=''256600''>program</span> <span m=''256930''>is</span> <span m=''257029''>running.</span>
  <span m=''257740''>In</span> <span m=''257839''>fact</span> <span m=''258200''>you</span>
  <span m=''258329''>can</span> <span m=''258470''>advance</span> <span m=''260959''>the</span>
  <span m=''261200''>state</span> <span m=''261410''>of</span> <span m=''261470''>the</span>
  <span m=''261519''>simulation</span> <span m=''262100''>cycle</span> <span m=''262420''>by</span>
  <span m=''262550''>cycle</span> <span m=''263280''>to</span> <span m=''263390''>look</span>
  <span m=''263530''>at</span> <span m=''263710''>what''s</span> <span m=''263910''>going</span>
  <span m=''264130''>on</span> <span m=''264320''>inside</span> <span m=''264840''>the</span>
  <span m=''264940''>simulated</span> <span m=''265470''>Cell</span> <span m=''265660''>system.</span>
  </p><p><span m=''270180''>And</span> <span m=''270710''>when</span> <span m=''270900''>you</span>
  <span m=''271000''>boot</span> <span m=''271200''>up</span> <span m=''271330''>this</span>
  <span m=''272030''>simulator,</span> <span m=''272520''>you</span> <span m=''272650''>can</span>
  <span m=''272760''>actually</span> <span m=''273040''>get</span> <span m=''273160''>a</span>
  <span m=''273210''>complete</span> <span m=''273560''>Linux</span> <span m=''273840''>environment</span>
  <span m=''274280''>in</span> <span m=''274350''>there</span> <span m=''275070''>with</span>
  <span m=''275250''>an</span> <span m=''275330''>x</span> <span m=''275510''>term.</span>
  <span m=''276660''>And</span> <span m=''277860''>what</span> <span m=''278000''>you</span>
  <span m=''278110''>can</span> <span m=''278200''>do</span> <span m=''278400''>in</span>
  <span m=''278460''>this</span> <span m=''278620''>Linux</span> <span m=''278900''>environment</span>
  <span m=''279290''>is</span> <span m=''279550''>you</span> <span m=''279710''>can</span>
  <span m=''279890''>copy</span> <span m=''280180''>over</span> <span m=''280360''>programs</span>
  <span m=''281040''>and</span> <span m=''281240''>then</span> <span m=''281400''>you</span>
  <span m=''281743''>can--</span> <span m=''282430''>you can</span> <span m=''282520''>copy</span>
  <span m=''282760''>over</span> <span m=''282870''>programs</span> <span m=''283200''>which</span>
  <span m=''283340''>were</span> <span m=''283470''>compiled</span> <span m=''283840''>for</span>
  <span m=''284030''>the</span> <span m=''284110''>Cell,</span> <span m=''284700''>and</span>
  <span m=''284870''>then</span> <span m=''285000''>you</span> <span m=''285110''>can</span>
  <span m=''285220''>run</span> <span m=''285420''>them.</span> <span m=''289090''>In</span>
  <span m=''289230''>order</span> <span m=''289420''>to</span> <span m=''289540''>transfer</span>
  <span m=''290810''>a</span> <span m=''290900''>program</span> <span m=''291420''>to</span>
  <span m=''291620''>your</span> <span m=''291800''>simulated</span> <span m=''292270''>system</span>
  <span m=''292590''>so</span> <span m=''292700''>that</span> <span m=''292830''>you</span>
  <span m=''292920''>can</span> <span m=''293030''>run</span> <span m=''293260''>it,</span>
  <span m=''293930''>you</span> <span m=''295500''>can</span> <span m=''295600''>use</span>
  <span m=''295820''>this</span> <span m=''296020''>function--</span> <span m=''296750''>or</span>
  <span m=''296870''>you</span> <span m=''296980''>can</span> <span m=''297080''>use</span>
  <span m=''297230''>this</span> <span m=''297440''>program</span> <span m=''297810''>call</span>
  <span m=''298080''>through</span> <span m=''298660''>which</span> <span m=''298810''>is</span>
  <span m=''298900''>available</span> <span m=''299290''>on</span> <span m=''299480''>the</span>
  <span m=''299560''>simulated</span> <span m=''300020''>system.</span> </p><p><span
  m=''300740''>And</span> <span m=''300930''>what</span> <span m=''301090''>it</span>
  <span m=''301190''>will</span> <span m=''301220''>do</span> <span m=''301430''>is</span>
  <span m=''301570''>it</span> <span m=''301630''>will</span> <span m=''302550''>grab</span>
  <span m=''302830''>onto</span> <span m=''303290''>a</span> <span m=''303360''>file</span>
  <span m=''303830''>which</span> <span m=''304070''>is</span> <span m=''304350''>on</span>
  <span m=''304570''>the</span> <span m=''304630''>host</span> <span m=''304900''>system</span>
  <span m=''305410''>and</span> <span m=''305690''>copy</span> <span m=''306010''>it</span>
  <span m=''306100''>in.</span> <span m=''306710''>And</span> <span m=''306920''>it
  will</span> <span m=''307080''>just</span> <span m=''309340''>put</span> <span m=''309460''>it</span>
  <span m=''309560''>on</span> <span m=''309770''>standard</span> <span m=''310100''>out</span>
  <span m=''310270''>so</span> <span m=''310350''>you</span> <span m=''310480''>can</span>
  <span m=''311340''>redirect</span> <span m=''311595''>it</span> <span m=''311850''>to</span>
  <span m=''311940''>whatever</span> <span m=''312210''>file</span> <span m=''312480''>you</span>
  <span m=''312590''>want.</span> <span m=''313160''>And</span> <span m=''313280''>then</span>
  <span m=''313490''>when</span> <span m=''313600''>you</span> <span m=''313670''>make</span>
  <span m=''313830''>it</span> <span m=''313900''>executable,</span> <span m=''314520''>then</span>
  <span m=''314860''>you</span> <span m=''315000''>can</span> <span m=''315110''>run</span>
  <span m=''315280''>it.</span> <span m=''316260''>All right,</span> <span m=''316630''>questions?</span>
  </p><p><span m=''321940''>While</span> <span m=''322110''>you''re</span> <span m=''322230''>in</span>
  <span m=''322300''>the</span> <span m=''322370''>simulator,</span> <span m=''322780''>you</span>
  <span m=''324320''>can</span> <span m=''324770''>view</span> <span m=''325060''>a</span>
  <span m=''325110''>lot</span> <span m=''325280''>of</span> <span m=''325370''>different</span>
  <span m=''325660''>things.</span> <span m=''327160''>You</span> <span m=''327300''>can</span>
  <span m=''327380''>get</span> <span m=''327480''>a</span> <span m=''327520''>lot</span>
  <span m=''328190''>of</span> <span m=''328350''>information</span> <span m=''328830''>about</span>
  <span m=''329110''>the</span> <span m=''329330''>state</span> <span m=''329590''>of</span>
  <span m=''329670''>the</span> <span m=''329730''>machine.</span> <span m=''331020''>In</span>
  <span m=''331110''>particular,</span> <span m=''331570''>you</span> <span m=''331670''>can</span>
  <span m=''331900''>look</span> <span m=''332130''>at</span> <span m=''332180''>the</span>
  <span m=''332260''>registers</span> <span m=''332860''>at</span> <span m=''332970''>any</span>
  <span m=''333110''>particular</span> <span m=''333500''>time,</span> <span m=''333840''>again</span>
  <span m=''334120''>with</span> <span m=''334750''>clock</span> <span m=''335000''>step</span>
  <span m=''335210''>by</span> <span m=''335260''>clock</span> <span m=''335540''>step.</span>
  <span m=''337890''>This</span> <span m=''338090''>might</span> <span m=''338240''>not</span>
  <span m=''338380''>be</span> <span m=''338510''>as</span> <span m=''338610''>interesting</span>
  <span m=''338970''>now</span> <span m=''339110''>that</span> <span m=''339230''>you</span>
  <span m=''339340''>have</span> <span m=''339840''>the</span> <span m=''340050''>debugger.</span>
  <span m=''340460''>And</span> <span m=''340530''>you</span> <span m=''340620''>can</span>
  <span m=''340730''>run</span> <span m=''340890''>the</span> <span m=''340970''>debugger</span>
  <span m=''341330''>on</span> <span m=''341420''>real</span> <span m=''341610''>hardware.</span>
  </p><p><span m=''342530''>But</span> <span m=''342680''>one</span> <span m=''342830''>thing</span>
  <span m=''342950''>which</span> <span m=''343810''>the</span> <span m=''343890''>Cell</span>
  <span m=''344110''>simulator</span> <span m=''344520''>does</span> <span m=''344740''>get</span>
  <span m=''344900''>you</span> <span m=''345590''>is</span> <span m=''346700''>these</span>
  <span m=''347230''>dynamic</span> <span m=''347670''>profiling</span> <span m=''348130''>tools.</span>
  <span m=''348820''>And</span> <span m=''349050''>what</span> <span m=''349210''>it</span>
  <span m=''349310''>will</span> <span m=''349320''>do</span> <span m=''349520''>is</span>
  <span m=''350680''>it</span> <span m=''350840''>will</span> <span m=''351730''>look</span>
  <span m=''351990''>at</span> <span m=''352150''>the</span> <span m=''352920''>state</span>
  <span m=''353190''>of</span> <span m=''353260''>the</span> <span m=''353330''>simulation</span>
  <span m=''353890''>and it will</span> <span m=''354140''>figure</span> <span m=''354370''>out</span>
  <span m=''354510''>where</span> <span m=''354860''>things</span> <span m=''355120''>are</span>
  <span m=''355220''>stalling,</span> <span m=''356100''>where</span> <span m=''356330''>the</span>
  <span m=''356440''>time</span> <span m=''357250''>is</span> <span m=''357440''>being</span>
  <span m=''357680''>spent</span> <span m=''358070''>by</span> <span m=''358210''>the</span>
  <span m=''358300''>processor.</span> <span m=''359310''>And</span> <span m=''359540''>you</span>
  <span m=''359620''>can</span> <span m=''359720''>get</span> <span m=''359890''>separate</span>
  <span m=''360200''>stats</span> <span m=''360560''>like</span> <span m=''360780''>these.</span>
  <span m=''361910''>Let''s</span> <span m=''362090''>see,</span> <span m=''362320''>it</span>
  <span m=''362400''>tells</span> <span m=''362580''>you,</span> <span m=''362870''>for</span>
  <span m=''362880''>example,</span> <span m=''363830''>total</span> <span m=''364090''>cycle</span>
  <span m=''364450''>count</span> <span m=''364930''>stalls</span> <span m=''365500''>for</span>
  <span m=''365710''>various</span> <span m=''366090''>reasons.</span> <span m=''367820''>You</span>
  <span m=''367930''>get</span> <span m=''368150''>all these</span> <span m=''368340''>statistics</span>
  <span m=''369260''>separately</span> <span m=''369760''>for</span> <span m=''370740''>the</span>
  <span m=''371150''>PPU</span> <span m=''371600''>and</span> <span m=''371900''>each</span>
  <span m=''372130''>SPU.</span> <span m=''373430''>So</span> <span m=''374020''>this</span>
  <span m=''374450''>can</span> <span m=''374550''>be</span> <span m=''374640''>very</span>
  <span m=''374850''>helpful</span> <span m=''375270''>if</span> <span m=''375390''>you''re</span>
  <span m=''375570''>trying</span> <span m=''375780''>to</span> <span m=''375860''>do,</span>
  <span m=''376090''>for</span> <span m=''376220''>example,</span> <span m=''377810''>you''re</span>
  <span m=''377910''>trying</span> <span m=''378120''>to</span> <span m=''378170''>figure</span>
  <span m=''378480''>out</span> <span m=''378530''>exactly</span> <span m=''378860''>what''s</span>
  <span m=''379030''>going</span> <span m=''379220''>on</span> <span m=''379530''>each</span>
  <span m=''379710''>SPU,</span> <span m=''380610''>do</span> <span m=''380810''>load</span>
  <span m=''380980''>balancing,</span> <span m=''382110''>whatever.</span> </p><p><span
  m=''386940''>And</span> <span m=''387100''>so</span> <span m=''387210''>these</span>
  <span m=''387410''>statistics</span> <span m=''387950''>will</span> <span m=''388110''>hold--</span>
  <span m=''389310''>these</span> <span m=''389460''>statistics</span> <span m=''389970''>will</span>
  <span m=''390160''>cover</span> <span m=''390770''>whatever</span> <span m=''391970''>length</span>
  <span m=''392250''>of</span> <span m=''392290''>the</span> <span m=''392370''>program</span>
  <span m=''392730''>you</span> <span m=''392840''>run.</span> <span m=''393550''>But
  you</span> <span m=''393690''>can</span> <span m=''393800''>also</span> <span m=''393980''>get</span>
  <span m=''394120''>more</span> <span m=''394360''>fine-grain</span> <span m=''394840''>statistics</span>
  <span m=''395420''>using</span> <span m=''395760''>these</span> <span m=''396190''>profiling</span>
  <span m=''396780''>functions.</span> <span m=''397690''>So</span> <span m=''397800''>if</span>
  <span m=''397860''>you</span> <span m=''398010''>include</span> <span m=''398510''>profile</span>
  <span m=''398960''>dot</span> <span m=''399160''>H in your</span> <span m=''399630''>program,</span>
  <span m=''400410''>then</span> <span m=''400560''>you</span> <span m=''400640''>get</span>
  <span m=''400760''>access</span> <span m=''401160''>to</span> <span m=''401390''>these</span>
  <span m=''401580''>functions,</span> <span m=''402300''>profile</span> <span m=''402880''>clear,</span>
  <span m=''403200''>start,</span> <span m=''403560''>and</span> <span m=''403700''>stop.</span>
  <span m=''404700''>And</span> <span m=''405110''>what</span> <span m=''405250''>these</span>
  <span m=''405410''>will</span> <span m=''405540''>do</span> <span m=''405840''>is</span>
  <span m=''406600''>they</span> <span m=''406800''>actually--</span> <span m=''408140''>when</span>
  <span m=''408320''>they</span> <span m=''408400''>get</span> <span m=''408580''>compiled</span>
  <span m=''408930''>into</span> <span m=''409060''>your</span> <span m=''409190''>program,</span>
  <span m=''409970''>there</span> <span m=''410210''>are</span> <span m=''410230''>no</span>
  <span m=''410450''>ops</span> <span m=''410690''>when</span> <span m=''410800''>you</span>
  <span m=''410900''>run</span> <span m=''411040''>them</span> <span m=''411190''>on</span>
  <span m=''411280''>a</span> <span m=''411360''>real</span> <span m=''411990''>Cell</span>
  <span m=''412230''>processor.</span> <span m=''413170''>But</span> <span m=''413380''>the</span>
  <span m=''413610''>simulator</span> <span m=''414010''>will</span> <span m=''414120''>be</span>
  <span m=''414220''>able</span> <span m=''414360''>to</span> <span m=''414450''>latch</span>
  <span m=''414730''>onto</span> <span m=''414970''>them</span> <span m=''415430''>and</span>
  <span m=''416590''>you</span> <span m=''416700''>can</span> <span m=''416790''>use</span>
  <span m=''417000''>those</span> <span m=''417240''>to</span> <span m=''417400''>start</span>
  <span m=''417710''>and</span> <span m=''417840''>stop</span> <span m=''418570''>regions</span>
  <span m=''418890''>of</span> <span m=''418980''>interest</span> <span m=''419740''>for</span>
  <span m=''421330''>profiling.</span> </p><p><span m=''425660''>Now</span> <span
  m=''426090''>the</span> <span m=''426430''>simulator</span> <span m=''427070''>comes</span>
  <span m=''427290''>with</span> <span m=''427420''>the</span> <span m=''427550''>SDK,</span>
  <span m=''428120''>and</span> <span m=''428270''>it''s</span> <span m=''428380''>a</span>
  <span m=''428420''>little</span> <span m=''428560''>bit</span> <span m=''428670''>cumbersome</span>
  <span m=''429090''>to</span> <span m=''429210''>install.</span> <span m=''429580''>So</span>
  <span m=''429700''>we</span> <span m=''430840''>haven''t</span> <span m=''431020''>made</span>
  <span m=''431170''>it</span> <span m=''431240''>available</span> <span m=''431690''>yet</span>
  <span m=''432060''>on</span> <span m=''432300''>the</span> <span m=''432430''>actual</span>
  <span m=''432720''>PS3</span> <span m=''433160''>hardware.</span> <span m=''434150''>You</span>
  <span m=''434270''>can</span> <span m=''434510''>run it</span> <span m=''434780''>on</span>
  <span m=''435000''>x86,</span> <span m=''435890''>and</span> <span m=''436240''>so</span>
  <span m=''436410''>if</span> <span m=''436470''>your</span> <span m=''436610''>group</span>
  <span m=''436820''>would</span> <span m=''436970''>like</span> <span m=''437180''>to</span>
  <span m=''437390''>get</span> <span m=''437610''>set</span> <span m=''437770''>up</span>
  <span m=''437900''>with</span> <span m=''438020''>that</span> <span m=''438420''>on</span>
  <span m=''439760''>one</span> <span m=''439890''>of</span> <span m=''439950''>your</span>
  <span m=''440070''>computers,</span> <span m=''440680''>or</span> <span m=''440990''>we''ll</span>
  <span m=''441170''>try</span> <span m=''441350''>and</span> <span m=''441430''>make</span>
  <span m=''441610''>it</span> <span m=''441770''>available</span> <span m=''442760''>on</span>
  <span m=''442990''>our</span> <span m=''443110''>hardware</span> <span m=''443440''>if</span>
  <span m=''443510''>there''s</span> <span m=''443670''>enough</span> <span m=''443840''>interest.</span>
  <span m=''444320''>So</span> <span m=''444600''>please</span> <span m=''444850''>let</span>
  <span m=''444990''>us</span> <span m=''445100''>know.</span> </p><p><span m=''451370''>OK,</span>
  <span m=''456350''>the</span> <span m=''456440''>next</span> <span m=''456620''>thing</span>
  <span m=''456740''>we''ll</span> <span m=''456850''>cover</span> <span m=''457180''>is</span>
  <span m=''457800''>using</span> <span m=''458180''>decrementers</span> <span m=''459250''>to</span>
  <span m=''459540''>profile</span> <span m=''459920''>your</span> <span m=''460040''>program.</span>
  <span m=''462070''>This</span> <span m=''462180''>is</span> <span m=''462270''>one</span>
  <span m=''462440''>way</span> <span m=''463580''>you</span> <span m=''463650''>can</span>
  <span m=''463750''>use</span> <span m=''463980''>dynamic</span> <span m=''464350''>profiling,</span>
  <span m=''464900''>which</span> <span m=''465200''>actually</span> <span m=''465560''>doesn''t</span>
  <span m=''465840''>require</span> <span m=''466190''>the</span> <span m=''466300''>simulator.</span>
  <span m=''466800''>So</span> <span m=''467930''>when</span> <span m=''468850''>you</span>
  <span m=''468920''>get</span> <span m=''469060''>information</span> <span m=''469470''>from</span>
  <span m=''469590''>the</span> <span m=''469650''>decrementers,</span> <span m=''470130''>you</span>
  <span m=''470250''>can</span> <span m=''470360''>run</span> <span m=''470610''>these</span>
  <span m=''470850''>programs</span> <span m=''471280''>on</span> <span m=''471980''>your</span>
  <span m=''472150''>actual</span> <span m=''472550''>Cell</span> <span m=''472750''>hardware.</span>
  <span m=''474000''>Basically</span> <span m=''474510''>the</span> <span m=''474600''>decrementer</span>
  <span m=''474940''>is</span> <span m=''475280''>just</span> <span m=''475670''>a</span>
  <span m=''476070''>counter</span> <span m=''476380''>that</span> <span m=''476540''>counts</span>
  <span m=''476800''>down</span> <span m=''477010''>at</span> <span m=''477060''>a</span>
  <span m=''477120''>constant</span> <span m=''477530''>rate.</span> <span m=''478490''>So</span>
  <span m=''478730''>you</span> <span m=''478860''>can</span> <span m=''478970''>use</span>
  <span m=''479150''>it</span> <span m=''479240''>as</span> <span m=''479360''>a</span>
  <span m=''479420''>clock</span> <span m=''480270''>to</span> <span m=''481070''>figure</span>
  <span m=''481340''>out</span> <span m=''481490''>how</span> <span m=''481690''>long</span>
  <span m=''482820''>different</span> <span m=''483210''>events</span> <span m=''483580''>are</span>
  <span m=''483680''>lasting.</span> </p><p><span m=''485490''>And</span> <span m=''486270''>the</span>
  <span m=''487480''>rate</span> <span m=''487740''>at</span> <span m=''487820''>which</span>
  <span m=''488050''>the</span> <span m=''488120''>decrementer</span> <span m=''488640''>counts</span>
  <span m=''488990''>down</span> <span m=''491230''>is</span> <span m=''492190''>not</span>
  <span m=''492480''>that</span> <span m=''492720''>fast.</span> <span m=''493360''>So</span>
  <span m=''494070''>you''re</span> <span m=''494160''>not</span> <span m=''494310''>going</span>
  <span m=''494400''>to</span> <span m=''494440''>be</span> <span m=''494570''>able</span>
  <span m=''494750''>to</span> <span m=''494860''>use</span> <span m=''495130''>it</span>
  <span m=''495330''>to</span> <span m=''495500''>time</span> <span m=''496540''>things</span>
  <span m=''496830''>on</span> <span m=''496940''>the</span> <span m=''497050''>order</span>
  <span m=''497370''>of</span> <span m=''498570''>a</span> <span m=''498680''>few</span>
  <span m=''498930''>clock</span> <span m=''499210''>cycles.</span> <span m=''502060''>It''s</span>
  <span m=''502270''>best</span> <span m=''502740''>for</span> <span m=''504410''>timing</span>
  <span m=''504820''>things</span> <span m=''505140''>which</span> <span m=''505390''>are</span>
  <span m=''505530''>maybe</span> <span m=''506150''>on</span> <span m=''506300''>the</span>
  <span m=''506390''>order</span> <span m=''506640''>of</span> <span m=''506870''>thousands</span>
  <span m=''507200''>of</span> <span m=''507300''>instructions</span> <span m=''507850''>in</span>
  <span m=''507970''>length.</span> <span m=''510190''>And</span> <span m=''510560''>how</span>
  <span m=''510710''>you</span> <span m=''510870''>use</span> <span m=''511150''>it</span>
  <span m=''511280''>is</span> <span m=''514919''>there</span> <span m=''515159''>are</span>
  <span m=''515190''>these</span> <span m=''515460''>SPU</span> <span m=''516159''>write</span>
  <span m=''516400''>channel</span> <span m=''516919''>and</span> <span m=''517720''>SPU</span>
  <span m=''518419''>read</span> <span m=''518820''>channel</span> <span m=''519169''>functions</span>
  <span m=''520070''>which</span> <span m=''520280''>give</span> <span m=''520409''>you</span>
  <span m=''520500''>access</span> <span m=''520880''>to</span> <span m=''520980''>some</span>
  <span m=''521179''>of</span> <span m=''521240''>the</span> <span m=''521360''>internals</span>
  <span m=''522010''>of</span> <span m=''522150''>the</span> <span m=''522230''>Cell</span>
  <span m=''522470''>processor.</span> </p><p><span m=''527000''>And</span> <span
  m=''527500''>so</span> <span m=''527700''>here''s</span> <span m=''527950''>an</span>
  <span m=''528030''>example</span> <span m=''528510''>setup</span> <span m=''528780''>you</span>
  <span m=''528900''>can</span> <span m=''528990''>use.</span> <span m=''530030''>Basically,</span>
  <span m=''530650''>first</span> <span m=''530900''>you</span> <span m=''530990''>call</span>
  <span m=''531490''>write</span> <span m=''531740''>channel,</span> <span m=''533000''>and</span>
  <span m=''533310''>you</span> <span m=''533420''>pass</span> <span m=''533680''>in</span>
  <span m=''534210''>this</span> <span m=''534940''>MFC_DECREMENTER_EVENT</span> <span
  m=''536480''>thing.</span> <span m=''537640''>And</span> <span m=''537910''>what</span>
  <span m=''538030''>that</span> <span m=''538160''>will</span> <span m=''538260''>do</span>
  <span m=''538520''>is</span> <span m=''538710''>initialize</span> <span m=''539600''>this</span>
  <span m=''540280''>decrementer</span> <span m=''540710''>counter</span> <span m=''541020''>for</span>
  <span m=''541130''>you.</span> <span m=''545030''>And</span> <span m=''545170''>then</span>
  <span m=''545570''>you</span> <span m=''545930''>read</span> <span m=''546110''>the</span>
  <span m=''546180''>value</span> <span m=''546550''>before</span> <span m=''547100''>and</span>
  <span m=''547320''>after</span> <span m=''548360''>the</span> <span m=''548450''>function</span>
  <span m=''548780''>you</span> <span m=''548870''>want</span> <span m=''548980''>to</span>
  <span m=''549030''>profile,</span> <span m=''550270''>and</span> <span m=''550670''>when</span>
  <span m=''550790''>you</span> <span m=''550890''>subtract,</span> <span m=''552370''>that</span>
  <span m=''552580''>just</span> <span m=''552740''>gives</span> <span m=''552900''>you</span>
  <span m=''554290''>the</span> <span m=''554430''>length</span> <span m=''555060''>or</span>
  <span m=''555220''>the</span> <span m=''555330''>time</span> <span m=''555870''>that</span>
  <span m=''556010''>was</span> <span m=''556140''>elapsed</span> <span m=''556580''>in</span>
  <span m=''556780''>some</span> <span m=''557040''>arbitrary</span> <span m=''557460''>units.</span>
  </p><p><span m=''559300''>And</span> <span m=''559470''>of</span> <span m=''559530''>course,</span>
  <span m=''559750''>it''s</span> <span m=''559870''>counting</span> <span m=''560140''>down,</span>
  <span m=''560390''>so</span> <span m=''560480''>you</span> <span m=''560560''>want</span>
  <span m=''560680''>to</span> <span m=''560720''>subtract</span> <span m=''561180''>the</span>
  <span m=''561390''>start</span> <span m=''561670''>from</span> <span m=''561810''>the</span>
  <span m=''561880''>end.</span> <span m=''564190''>And</span> <span m=''564550''>after</span>
  <span m=''564750''>you''re</span> <span m=''564820''>done</span> <span m=''565020''>using</span>
  <span m=''565360''>it,</span> <span m=''565460''>you</span> <span m=''567480''>can</span>
  <span m=''568400''>do</span> <span m=''568530''>another</span> <span m=''568800''>write</span>
  <span m=''568980''>channel</span> <span m=''569280''>to</span> <span m=''569410''>stop</span>
  <span m=''570080''>the</span> <span m=''570170''>counter</span> <span m=''570500''>from</span>
  <span m=''570940''>continuing.</span> <span m=''572282''>All</span> <span m=''572680''>right,</span>
  <span m=''572920''>any</span> <span m=''573050''>questions?</span> </p><p><span
  m=''581190''>OK,</span> <span m=''583820''>let''s</span> <span m=''584420''>continue</span>
  <span m=''584690''>talking</span> <span m=''584920''>about</span> <span m=''585370''>instruction</span>
  <span m=''585810''>reordering,</span> <span m=''586230''>which</span> <span m=''586420''>I</span>
  <span m=''586930''>started</span> <span m=''587290''>last</span> <span m=''587510''>time.</span>
  <span m=''588610''>So</span> <span m=''588730''>I''m</span> <span m=''588850''>going</span>
  <span m=''588940''>to</span> <span m=''589060''>kind</span> <span m=''589220''>of</span>
  <span m=''589280''>start</span> <span m=''589490''>from</span> <span m=''589610''>the</span>
  <span m=''589680''>beginning</span> <span m=''590000''>this</span> <span m=''590150''>time,</span>
  <span m=''590410''>and</span> <span m=''590540''>maybe</span> <span m=''590700''>it''ll</span>
  <span m=''590880''>be</span> <span m=''591160''>more</span> <span m=''591590''>coherent.</span>
  <span m=''594010''>So</span> <span m=''595490''>on</span> <span m=''595590''>the</span>
  <span m=''595660''>Cell</span> <span m=''595850''>architecture,</span> <span m=''596660''>when</span>
  <span m=''596810''>you''re</span> <span m=''596920''>looking</span> <span m=''597200''>at</span>
  <span m=''598150''>what</span> <span m=''598590''>instructions</span> <span m=''599020''>are</span>
  <span m=''599110''>being</span> <span m=''599280''>run,</span> <span m=''599600''>the</span>
  <span m=''600020''>instructions</span> <span m=''600650''>are</span> <span m=''600840''>mostly</span>
  <span m=''601130''>going</span> <span m=''601230''>to</span> <span m=''601270''>be</span>
  <span m=''601430''>of</span> <span m=''601530''>the</span> <span m=''601610''>form</span>
  <span m=''602870''>evaluate</span> <span m=''603490''>some</span> <span m=''603700''>function</span>
  <span m=''604150''>of</span> <span m=''604320''>some</span> <span m=''604490''>of</span>
  <span m=''604530''>the</span> <span m=''604600''>registers</span> <span m=''605420''>and</span>
  <span m=''605560''>write</span> <span m=''605740''>the</span> <span m=''605810''>result</span>
  <span m=''606380''>to</span> <span m=''606520''>some</span> <span m=''606730''>other</span>
  <span m=''606940''>register.</span> </p><p><span m=''608330''>And</span> <span m=''608560''>the</span>
  <span m=''608640''>assembly</span> <span m=''609060''>file</span> <span m=''609960''>are</span>
  <span m=''610200''>what</span> <span m=''610360''>you</span> <span m=''610500''>get</span>
  <span m=''610670''>when</span> <span m=''610800''>you</span> <span m=''611090''>run</span>
  <span m=''611310''>with</span> <span m=''611460''>GCC-S</span> <span m=''613280''>is</span>
  <span m=''613410''>just</span> <span m=''613580''>going</span> <span m=''613660''>to</span>
  <span m=''613700''>be</span> <span m=''614010''>a</span> <span m=''614430''>human-readable</span>
  <span m=''615380''>representation</span> <span m=''615960''>of</span> <span m=''616030''>these</span>
  <span m=''616180''>instructions.</span> <span m=''617550''>And</span> <span m=''618410''>I''ll</span>
  <span m=''618600''>show</span> <span m=''618700''>you</span> <span m=''618810''>how</span>
  <span m=''618940''>to</span> <span m=''619040''>read</span> <span m=''619240''>that</span>
  <span m=''619410''>actually</span> <span m=''619740''>later.</span> <span m=''622130''>And</span>
  <span m=''622300''>you</span> <span m=''622400''>can</span> <span m=''622510''>think</span>
  <span m=''622690''>of</span> <span m=''622770''>these</span> <span m=''622940''>instructions</span>
  <span m=''623540''>just</span> <span m=''623810''>as</span> <span m=''624280''>executing</span>
  <span m=''625360''>in</span> <span m=''625570''>series</span> <span m=''626090''>just</span>
  <span m=''626290''>in</span> <span m=''626360''>the</span> <span m=''626440''>order</span>
  <span m=''626740''>in</span> <span m=''626880''>which</span> <span m=''627070''>they</span>
  <span m=''627200''>appear</span> <span m=''627480''>in</span> <span m=''627560''>the</span>
  <span m=''627650''>assembly.</span> <span m=''628530''>So</span> <span m=''629310''>if</span>
  <span m=''629440''>you</span> <span m=''629560''>think</span> <span m=''629770''>of</span>
  <span m=''630330''>one</span> <span m=''630500''>instruction</span> <span m=''631450''>starting</span>
  <span m=''631920''>and</span> <span m=''631990''>then</span> <span m=''632120''>finishing,</span>
  <span m=''632550''>the</span> <span m=''632640''>next</span> <span m=''632870''>instruction</span>
  <span m=''633330''>comes</span> <span m=''633570''>in,</span> <span m=''634340''>finishes,</span>
  <span m=''636710''>that</span> <span m=''636890''>should</span> <span m=''637050''>be</span>
  <span m=''637880''>consistent</span> <span m=''638410''>with</span> <span m=''639670''>the</span>
  <span m=''639860''>actual</span> <span m=''640150''>behavior</span> <span m=''640540''>of
  the</span> <span m=''640620''>hardware.</span> </p><p><span m=''643340''>Now</span>
  <span m=''643830''>for</span> <span m=''643990''>real</span> <span m=''644180''>hardware,</span>
  <span m=''645470''>waiting</span> <span m=''645810''>for</span> <span m=''646030''>one</span>
  <span m=''646180''>instruction</span> <span m=''646630''>to</span> <span m=''646720''>finish</span>
  <span m=''647140''>before</span> <span m=''647410''>the</span> <span m=''647500''>next</span>
  <span m=''647730''>one</span> <span m=''647850''>starts</span> <span m=''648170''>is</span>
  <span m=''648290''>going</span> <span m=''648430''>to</span> <span m=''648470''>be</span>
  <span m=''648610''>too</span> <span m=''648810''>slow.</span> <span m=''649680''>So</span>
  <span m=''649700''>there</span> <span m=''649850''>are</span> <span m=''649870''>these</span>
  <span m=''650170''>various</span> <span m=''650500''>optimizations</span> <span
  m=''651300''>we</span> <span m=''651470''>pull</span> <span m=''652060''>or</span>
  <span m=''652540''>that</span> <span m=''652810''>they</span> <span m=''652940''>do</span>
  <span m=''653090''>on</span> <span m=''653190''>the</span> <span m=''653230''>hardware</span>
  <span m=''654120''>in</span> <span m=''654260''>order</span> <span m=''654460''>to</span>
  <span m=''655550''>run</span> <span m=''656010''>instructions</span> <span m=''656540''>sooner</span>
  <span m=''657090''>than</span> <span m=''657470''>when</span> <span m=''657640''>the</span>
  <span m=''657730''>previous</span> <span m=''658080''>instruction</span> <span m=''658540''>finishes.</span>
  <span m=''659870''>So</span> <span m=''660210''>the</span> <span m=''660320''>big</span>
  <span m=''660510''>one</span> <span m=''660650''>of</span> <span m=''660740''>these</span>
  <span m=''660980''>is</span> <span m=''661130''>pipelining,</span> <span m=''662800''>where</span>
  <span m=''662930''>you</span> <span m=''663000''>have</span> <span m=''663270''>multiple</span>
  <span m=''663680''>stages</span> <span m=''664100''>inside your</span> <span m=''664460''>processor,</span>
  <span m=''664960''>and</span> <span m=''665040''>you</span> <span m=''665130''>can</span>
  <span m=''665260''>run</span> <span m=''665850''>each</span> <span m=''666040''>instruction--</span>
  <span m=''667135''>you</span> <span m=''667490''>can</span> <span m=''667580''>push</span>
  <span m=''668010''>each</span> <span m=''668210''>instruction</span> <span m=''668670''>in</span>
  <span m=''668910''>before</span> <span m=''669220''>the</span> <span m=''669320''>previous</span>
  <span m=''669690''>one</span> <span m=''669870''>has</span> <span m=''670070''>completed.</span>
  </p><p><span m=''672270''>And</span> <span m=''674270''>in</span> <span m=''674430''>pipelining,</span>
  <span m=''675190''>you''re</span> <span m=''675320''>going</span> <span m=''675400''>to</span>
  <span m=''675440''>be</span> <span m=''675530''>subject</span> <span m=''675920''>to</span>
  <span m=''676200''>these</span> <span m=''676690''>dependencies</span> <span m=''677360''>between</span>
  <span m=''677680''>instructions.</span> <span m=''678230''>For</span> <span m=''678330''>example,</span>
  <span m=''679150''>if</span> <span m=''679350''>one</span> <span m=''679540''>instruction</span>
  <span m=''681000''>reads</span> <span m=''681360''>from</span> <span m=''681520''>a</span>
  <span m=''681550''>value</span> <span m=''681880''>that</span> <span m=''681960''>the</span>
  <span m=''682050''>previous</span> <span m=''683160''>instruction</span> <span m=''683600''>wrote,</span>
  <span m=''684260''>then</span> <span m=''684490''>clearly</span> <span m=''684850''>you</span>
  <span m=''684970''>can''t</span> <span m=''685240''>start</span> <span m=''685700''>the</span>
  <span m=''685930''>second</span> <span m=''686220''>instruction</span> <span m=''686700''>until</span>
  <span m=''687200''>after</span> <span m=''687580''>the</span> <span m=''687690''>first</span>
  <span m=''687970''>instruction</span> <span m=''688420''>has</span> <span m=''688550''>completed.</span>
  <span m=''692020''>The</span> <span m=''692120''>Cell</span> <span m=''692320''>processor</span>
  <span m=''692740''>also</span> <span m=''693020''>has--</span> <span m=''693990''>actually</span>
  <span m=''694260''>has</span> <span m=''694420''>multiple</span> <span m=''694840''>pipelines</span>
  <span m=''695450''>in</span> <span m=''695550''>which</span> <span m=''695740''>you</span>
  <span m=''695850''>can</span> <span m=''696090''>insert</span> <span m=''696420''>instructions</span>
  <span m=''697470''>and</span> <span m=''698200''>another</span> <span m=''698470''>optimization</span>
  <span m=''699120''>that</span> <span m=''699230''>they</span> <span m=''699320''>do</span>
  <span m=''699910''>is</span> <span m=''700580''>branch</span> <span m=''700840''>prediction</span>
  <span m=''701860''>in</span> <span m=''703630''>order</span> <span m=''703790''>to</span>
  <span m=''703910''>reduce</span> <span m=''704190''>stalls</span> <span m=''704620''>from</span>
  <span m=''705650''>branching.</span> </p><p><span m=''709340''>AUDIENCE: [INAUDIBLE].</span>
  </p><p><span m=''710600''>PROFESSOR: Pardon?</span> </p><p><span m=''710820''>AUDIENCE:
  Can you</span> <span m=''711286''>talk about</span> <span m=''711752''>static branch</span>
  <span m=''712218''>prediction?</span> </p><p><span m=''713150''>PROFESSOR: Yes,</span>
  <span m=''714230''>so</span> <span m=''715170''>static</span> <span m=''715480''>branch</span>
  <span m=''715720''>prediction</span> <span m=''716150''>means--</span> <span m=''716880''>or,</span>
  <span m=''717100''>rather</span> <span m=''717310''>the</span> <span m=''717400''>way</span>
  <span m=''717510''>it''s</span> <span m=''717630''>done</span> <span m=''717780''>on</span>
  <span m=''717870''>the</span> <span m=''717930''>Cell</span> <span m=''718270''>is</span>
  <span m=''718390''>that</span> <span m=''719490''>what''s</span> <span m=''720990''>predicted</span>
  <span m=''721370''>for</span> <span m=''721470''>the</span> <span m=''721560''>branch</span>
  <span m=''722050''>is</span> <span m=''722510''>not</span> <span m=''722730''>going</span>
  <span m=''722960''>to</span> <span m=''723600''>be</span> <span m=''723750''>affected</span>
  <span m=''724140''>by</span> <span m=''726530''>the</span> <span m=''726610''>history</span>
  <span m=''727090''>of</span> <span m=''727240''>which</span> <span m=''727480''>branches</span>
  <span m=''727810''>have</span> <span m=''727910''>been</span> <span m=''728050''>taken.</span>
  <span m=''729020''>And</span> <span m=''729170''>some</span> <span m=''729330''>other</span>
  <span m=''729450''>processors</span> <span m=''730250''>actually</span> <span m=''730690''>do</span>
  <span m=''731430''>use this</span> <span m=''731760''>information.</span> <span
  m=''736910''>All</span> <span m=''736990''>right,</span> <span m=''739010''>now</span>
  <span m=''741010''>the</span> <span m=''741070''>thing</span> <span m=''741220''>about</span>
  <span m=''741460''>pipelining</span> <span m=''742020''>is</span> <span m=''742160''>that</span>
  <span m=''742730''>because</span> <span m=''742960''>we</span> <span m=''743070''>still</span>
  <span m=''743260''>have</span> <span m=''743380''>to</span> <span m=''743480''>honor</span>
  <span m=''743760''>these</span> <span m=''743990''>dependencies</span> <span m=''744620''>between</span>
  <span m=''744980''>instructions,</span> <span m=''745980''>the</span> <span m=''746150''>order</span>
  <span m=''746440''>in</span> <span m=''746520''>which</span> <span m=''746690''>we</span>
  <span m=''746820''>evaluate</span> <span m=''747310''>instructions,</span> <span
  m=''748140''>that''s</span> <span m=''748350''>going</span> <span m=''748440''>to</span>
  <span m=''748480''>make</span> <span m=''748620''>a</span> <span m=''748680''>difference</span>
  <span m=''749270''>on</span> <span m=''749980''>how</span> <span m=''750180''>long</span>
  <span m=''750400''>the</span> <span m=''750480''>program</span> <span m=''750900''>runs.</span>
  </p><p><span m=''752940''>So</span> <span m=''753410''>let''s</span> <span m=''753600''>take</span>
  <span m=''753760''>the</span> <span m=''753840''>simple</span> <span m=''754140''>example</span>
  <span m=''754510''>where</span> <span m=''754640''>we</span> <span m=''754780''>have</span>
  <span m=''755320''>three</span> <span m=''755540''>instructions,</span> <span m=''756100''>a,</span>
  <span m=''756260''>b,</span> <span m=''756460''>and</span> <span m=''756580''>c,</span>
  <span m=''757290''>and</span> <span m=''758520''>we</span> <span m=''758640''>have</span>
  <span m=''758780''>this</span> <span m=''758940''>pipeline</span> <span m=''759270''>processor</span>
  <span m=''759750''>where</span> <span m=''759850''>we</span> <span m=''759980''>can</span>
  <span m=''760100''>insert</span> <span m=''760400''>instructions</span> <span m=''760930''>at</span>
  <span m=''761060''>these</span> <span m=''761280''>clock</span> <span m=''761560''>ticks.</span>
  <span m=''764120''>So</span> <span m=''764750''>suppose</span> <span m=''765270''>that</span>
  <span m=''765470''>c</span> <span m=''765690''>depends</span> <span m=''766070''>on</span>
  <span m=''766190''>b, and</span> <span m=''766530''>there</span> <span m=''766710''>are</span>
  <span m=''766740''>no</span> <span m=''766890''>other</span> <span m=''767750''>dependencies</span>
  <span m=''768420''>in</span> <span m=''768500''>the</span> <span m=''768570''>system.</span>
  <span m=''770900''>Then</span> <span m=''771110''>this</span> <span m=''771280''>sequence</span>
  <span m=''771600''>of</span> <span m=''771680''>instructions</span> <span m=''772150''>is</span>
  <span m=''772280''>going</span> <span m=''772380''>to</span> <span m=''772450''>take</span>
  <span m=''773690''>five</span> <span m=''773950''>cycles,</span> <span m=''774490''>because</span>
  <span m=''774700''>we</span> <span m=''774800''>can</span> <span m=''774930''>push</span>
  <span m=''775220''>b</span> <span m=''775480''>in</span> <span m=''776300''>after</span>
  <span m=''776580''>the</span> <span m=''776650''>first</span> <span m=''776880''>cycle,</span>
  <span m=''777250''>but</span> <span m=''777350''>we</span> <span m=''777450''>can''t</span>
  <span m=''777650''>push</span> <span m=''777870''>c</span> <span m=''778170''>in</span>
  <span m=''778290''>until</span> <span m=''778740''>two</span> <span m=''779270''>cycles</span>
  <span m=''779630''>after</span> <span m=''779820''>that.</span> <span m=''780580''>Is</span>
  <span m=''780640''>that</span> <span m=''780770''>clear?</span> <span m=''782050''>Questions?</span>
  </p><p><span m=''785410''>All</span> <span m=''785500''>right,</span> <span m=''786370''>now</span>
  <span m=''786570''>because</span> <span m=''786950''>c</span> <span m=''787260''>depends</span>
  <span m=''787610''>on</span> <span m=''787740''>b,</span> <span m=''788140''>it</span>
  <span m=''788540''>kind</span> <span m=''788670''>of</span> <span m=''788720''>makes</span>
  <span m=''788940''>sense</span> <span m=''789180''>to</span> <span m=''789280''>push</span>
  <span m=''789570''>b</span> <span m=''789890''>as</span> <span m=''790080''>far</span>
  <span m=''790400''>up</span> <span m=''790520''>as</span> <span m=''790660''>we</span>
  <span m=''790780''>can</span> <span m=''791470''>in</span> <span m=''791630''>order</span>
  <span m=''791840''>to</span> <span m=''792830''>ease</span> <span m=''793050''>this</span>
  <span m=''793200''>dependency.</span> <span m=''794310''>So</span> <span m=''794490''>if</span>
  <span m=''794570''>we</span> <span m=''794690''>execute</span> <span m=''795220''>b</span>
  <span m=''795490''>before</span> <span m=''795970''>a</span> <span m=''796490''>instead</span>
  <span m=''796810''>of</span> <span m=''796900''>after</span> <span m=''797220''>a--</span>
  <span m=''797710''>and</span> <span m=''798090''>remember</span> <span m=''798380''>we</span>
  <span m=''798490''>can</span> <span m=''798790''>reorder</span> <span m=''799210''>b</span>
  <span m=''799480''>and a</span> <span m=''799570''>however</span> <span m=''800010''>we</span>
  <span m=''800120''>want</span> <span m=''800350''>because</span> <span m=''800590''>there''s</span>
  <span m=''800790''>no</span> <span m=''800940''>dependencies</span> <span m=''801530''>between</span>
  <span m=''801850''>them--</span> <span m=''802620''>then</span> <span m=''802800''>we</span>
  <span m=''802900''>can</span> <span m=''803000''>start</span> <span m=''803320''>b</span>
  <span m=''804320''>at</span> <span m=''804600''>the</span> <span m=''804910''>first</span>
  <span m=''805210''>tick,</span> <span m=''805600''>then</span> <span m=''806410''>we</span>
  <span m=''806560''>put</span> <span m=''806730''>in</span> <span m=''806910''>a</span>
  <span m=''807110''>right</span> <span m=''807290''>after</span> <span m=''807500''>that,</span>
  <span m=''807740''>and</span> <span m=''807870''>then</span> <span m=''808170''>c.</span>
  <span m=''809350''>And</span> <span m=''809590''>now</span> <span m=''809760''>the</span>
  <span m=''809850''>sequence</span> <span m=''810190''>only</span> <span m=''810380''>takes</span>
  <span m=''810810''>four</span> <span m=''811080''>clock</span> <span m=''811350''>cycles.</span>
  <span m=''813210''>All</span> <span m=''813290''>right?</span> </p><p><span m=''814780''>So</span>
  <span m=''814970''>observe</span> <span m=''815360''>that,</span> <span m=''815610''>when</span>
  <span m=''815740''>we</span> <span m=''815850''>put</span> <span m=''816010''>in</span>
  <span m=''816160''>c</span> <span m=''816550''>in</span> <span m=''816660''>this</span>
  <span m=''817060''>third</span> <span m=''817290''>clock</span> <span m=''817550''>cycle,</span>
  <span m=''818790''>we</span> <span m=''818990''>actually</span> <span m=''819260''>couldn''t</span>
  <span m=''819500''>have</span> <span m=''819770''>put</span> <span m=''819930''>in</span>
  <span m=''820090''>the</span> <span m=''820200''>third</span> <span m=''820450''>instruction</span>
  <span m=''820970''>any</span> <span m=''821170''>sooner,</span> <span m=''823190''>no</span>
  <span m=''823330''>matter</span> <span m=''823540''>what</span> <span m=''823650''>the</span>
  <span m=''823760''>dependencies</span> <span m=''824340''>were.</span> <span m=''825580''>And</span>
  <span m=''825750''>so</span> <span m=''825960''>in</span> <span m=''826070''>general,</span>
  <span m=''826380''>we''re</span> <span m=''826480''>going</span> <span m=''826560''>to</span>
  <span m=''826620''>want</span> <span m=''826800''>that</span> <span m=''827620''>to</span>
  <span m=''827770''>be</span> <span m=''827890''>the</span> <span m=''827990''>case</span>
  <span m=''829050''>where</span> <span m=''829840''>we</span> <span m=''829990''>want</span>
  <span m=''830220''>instructions</span> <span m=''830800''>to</span> <span m=''830890''>be</span>
  <span m=''831030''>waiting</span> <span m=''832230''>on</span> <span m=''833070''>the</span>
  <span m=''833290''>pipeline</span> <span m=''833780''>rather</span> <span m=''834070''>than</span>
  <span m=''834320''>on</span> <span m=''834550''>dependencies.</span> <span m=''836690''>So</span>
  <span m=''837080''>that</span> <span m=''837220''>means</span> <span m=''837420''>in</span>
  <span m=''837510''>the</span> <span m=''837560''>first</span> <span m=''837840''>picture</span>
  <span m=''838170''>there''s</span> <span m=''838622''>this</span> <span m=''840090''>stall</span>
  <span m=''840580''>of</span> <span m=''841240''>one</span> <span m=''841470''>clock</span>
  <span m=''841750''>cycle,</span> <span m=''842370''>and</span> <span m=''842480''>we''re</span>
  <span m=''842570''>going</span> <span m=''842650''>to</span> <span m=''842690''>want</span>
  <span m=''842860''>to</span> <span m=''842940''>eliminate</span> <span m=''843440''>these</span>
  <span m=''843630''>kinds</span> <span m=''843890''>of</span> <span m=''843980''>stalls.</span>
  <span m=''845040''>All</span> <span m=''845120''>right?</span> </p><p><span m=''851180''>So</span>
  <span m=''851360''>what</span> <span m=''851450''>we''re</span> <span m=''851560''>going</span>
  <span m=''851650''>to</span> <span m=''851720''>do</span> <span m=''852000''>is</span>
  <span m=''852130''>we''re</span> <span m=''852220''>going</span> <span m=''852310''>to</span>
  <span m=''852350''>use</span> <span m=''852660''>these</span> <span m=''852850''>static</span>
  <span m=''853220''>profiling</span> <span m=''853730''>tools</span> <span m=''854010''>to</span>
  <span m=''854100''>figure</span> <span m=''854380''>out</span> <span m=''854530''>where</span>
  <span m=''854860''>stalls</span> <span m=''855210''>happen.</span> <span m=''857250''>Now</span>
  <span m=''857590''>the</span> <span m=''857670''>first</span> <span m=''857930''>thing</span>
  <span m=''858080''>we''re</span> <span m=''858210''>going</span> <span m=''858300''>to</span>
  <span m=''858360''>do--</span> <span m=''859510''>the</span> <span m=''859660''>first</span>
  <span m=''859860''>thing</span> <span m=''859960''>that</span> <span m=''860060''>we</span>
  <span m=''860150''>have</span> <span m=''860270''>to</span> <span m=''860360''>do</span>
  <span m=''860550''>is</span> <span m=''860910''>generate</span> <span m=''861300''>the</span>
  <span m=''861400''>assembly</span> <span m=''862010''>and</span> <span m=''862160''>the</span>
  <span m=''862250''>instruction</span> <span m=''862700''>schedule</span> <span m=''863040''>that</span>
  <span m=''863160''>goes</span> <span m=''863360''>with</span> <span m=''863540''>it.</span>
  <span m=''864660''>And</span> <span m=''864840''>so</span> <span m=''864920''>you</span>
  <span m=''865060''>can</span> <span m=''865150''>use</span> <span m=''865570''>GCC</span>
  <span m=''866940''>-S,</span> <span m=''867690''>and</span> <span m=''867870''>the</span>
  <span m=''867930''>same</span> <span m=''868130''>flag</span> <span m=''868330''>works</span>
  <span m=''868560''>with</span> <span m=''868710''>xlc</span> <span m=''869390''>to</span>
  <span m=''869490''>generate</span> <span m=''869850''>the</span> <span m=''869940''>assembly.</span>
  <span m=''871300''>And</span> <span m=''871530''>then</span> <span m=''871730''>we</span>
  <span m=''871840''>have</span> <span m=''872050''>this</span> <span m=''872370''>utility</span>
  <span m=''874800''>called</span> <span m=''875080''>spu_timing,</span> <span m=''875960''>which</span>
  <span m=''876130''>runs</span> <span m=''876410''>on</span> <span m=''876500''>the</span>
  <span m=''876570''>Cell,</span> <span m=''877510''>and</span> <span m=''877770''>which</span>
  <span m=''877940''>will</span> <span m=''878090''>tell</span> <span m=''878290''>you</span>
  <span m=''878580''>the</span> <span m=''878750''>instruction</span> <span m=''879230''>schedule.</span>
  </p><p><span m=''880410''>Basically</span> <span m=''880800''>it''ll</span> <span
  m=''880960''>take</span> <span m=''881180''>in</span> <span m=''881360''>your</span>
  <span m=''881520''>assembly</span> <span m=''881900''>file</span> <span m=''882490''>and</span>
  <span m=''882780''>tell</span> <span m=''882960''>you</span> <span m=''883130''>exactly</span>
  <span m=''883620''>when</span> <span m=''883930''>each</span> <span m=''884160''>instruction</span>
  <span m=''884610''>in</span> <span m=''884700''>that</span> <span m=''884880''>assembly</span>
  <span m=''885310''>gets</span> <span m=''885530''>scheduled.</span> <span m=''888720''>If</span>
  <span m=''888830''>you</span> <span m=''888910''>call</span> <span m=''889120''>it</span>
  <span m=''889180''>with</span> <span m=''889360''>-running-count,</span> <span m=''890490''>then</span>
  <span m=''890590''>it''ll</span> <span m=''890810''>tell</span> <span m=''891000''>you</span>
  <span m=''891880''>the</span> <span m=''892140''>running</span> <span m=''892430''>count</span>
  <span m=''892870''>of</span> <span m=''894020''>clock</span> <span m=''894250''>cycles</span>
  <span m=''894580''>at</span> <span m=''894660''>each</span> <span m=''894790''>stage,</span>
  <span m=''895250''>which</span> <span m=''895410''>means</span> <span m=''895590''>if</span>
  <span m=''895660''>you</span> <span m=''895750''>look</span> <span m=''895890''>at</span>
  <span m=''895950''>the</span> <span m=''896020''>last</span> <span m=''896340''>number,</span>
  <span m=''896590''>that</span> <span m=''896750''>will</span> <span m=''896840''>tell</span>
  <span m=''897010''>you</span> <span m=''897560''>how</span> <span m=''897890''>long</span>
  <span m=''898130''>your</span> <span m=''898260''>program</span> <span m=''898730''>took</span>
  <span m=''898960''>to</span> <span m=''899080''>run</span> <span m=''899300''>in</span>
  <span m=''899410''>clock</span> <span m=''899650''>cycles.</span> <span m=''900450''>And</span>
  <span m=''900560''>we''ll</span> <span m=''900670''>write</span> <span m=''900840''>the</span>
  <span m=''900950''>output</span> <span m=''901320''>to</span> <span m=''902930''>a</span>
  <span m=''903030''>file</span> <span m=''903330''>with the</span> <span m=''903410''>same</span>
  <span m=''903680''>name</span> <span m=''903920''>as</span> <span m=''904020''>the</span>
  <span m=''904140''>input</span> <span m=''904600''>but</span> <span m=''904750''>with</span>
  <span m=''905150''>dot</span> <span m=''905390''>timing</span> <span m=''905710''>at</span>
  <span m=''905800''>the</span> <span m=''905910''>end.</span> </p><p><span m=''908560''>Now</span>
  <span m=''908750''>if</span> <span m=''908820''>you''re</span> <span m=''908920''>using</span>
  <span m=''909210''>our</span> <span m=''909360''>Makefile,</span> <span m=''910070''>you</span>
  <span m=''910210''>can</span> <span m=''910330''>actually</span> <span m=''910640''>do</span>
  <span m=''910920''>all</span> <span m=''911090''>this,</span> <span m=''911910''>generate</span>
  <span m=''912240''>the</span> <span m=''912340''>assembly</span> <span m=''912810''>and</span>
  <span m=''913170''>the</span> <span m=''914580''>timing</span> <span m=''914890''>info,</span>
  <span m=''915170''>all</span> <span m=''915380''>in</span> <span m=''915430''>one</span>
  <span m=''915630''>step</span> <span m=''916220''>by</span> <span m=''916340''>doing</span>
  <span m=''916870''>SPU_TIMING=1</span> <span m=''918430''>and</span> <span m=''918550''>then</span>
  <span m=''919030''>make</span> <span m=''919750''>the</span> <span m=''920240''>name</span>
  <span m=''920490''>of</span> <span m=''920550''>the</span> <span m=''920620''>.s</span>
  <span m=''921040''>file,</span> <span m=''922090''>all</span> <span m=''922170''>right?</span>
  </p><p><span m=''927780''>Now</span> <span m=''927960''>if</span> <span m=''928010''>you''ll</span>
  <span m=''928160''>recall</span> <span m=''928540''>on</span> <span m=''928720''>Cell</span>
  <span m=''929500''>we''re</span> <span m=''929670''>going</span> <span m=''929750''>to</span>
  <span m=''929790''>have</span> <span m=''930090''>only</span> <span m=''930480''>in-order</span>
  <span m=''930850''>execution.</span> <span m=''931870''>The</span> <span m=''932940''>instructions</span>
  <span m=''933360''>are</span> <span m=''933430''>just</span> <span m=''933580''>going</span>
  <span m=''933660''>to</span> <span m=''933700''>execute</span> <span m=''934120''>in</span>
  <span m=''934270''>the</span> <span m=''934390''>order</span> <span m=''934570''>that</span>
  <span m=''934720''>they''re</span> <span m=''934840''>specified</span> <span m=''935350''>in</span>
  <span m=''935430''>the</span> <span m=''935530''>assembly.</span> <span m=''937990''>And</span>
  <span m=''940710''>because</span> <span m=''940920''>the</span> <span m=''941010''>Cell</span>
  <span m=''941250''>has</span> <span m=''941930''>dual</span> <span m=''942340''>pipelines,</span>
  <span m=''943120''>that</span> <span m=''943240''>means</span> <span m=''943460''>there''s</span>
  <span m=''943740''>two</span> <span m=''943890''>pipelines</span> <span m=''944280''>in</span>
  <span m=''944360''>which</span> <span m=''944540''>instructions</span> <span m=''945020''>can</span>
  <span m=''945140''>go,</span> <span m=''945430''>and</span> <span m=''946350''>the</span>
  <span m=''946700''>pipelines</span> <span m=''947160''>are</span> <span m=''947210''>going</span>
  <span m=''947290''>to</span> <span m=''947330''>be</span> <span m=''947450''>selected</span>
  <span m=''948210''>just</span> <span m=''948410''>based</span> <span m=''948680''>on</span>
  <span m=''948780''>the</span> <span m=''948870''>instruction</span> <span m=''949370''>type.</span>
  </p><p><span m=''951220''>And</span> <span m=''951390''>of</span> <span m=''951460''>course,</span>
  <span m=''952210''>two</span> <span m=''952380''>instructions</span> <span m=''952810''>are</span>
  <span m=''952940''>only</span> <span m=''953080''>going</span> <span m=''953170''>to</span>
  <span m=''953210''>go</span> <span m=''953360''>in</span> <span m=''953460''>simultaneously</span>
  <span m=''954210''>when</span> <span m=''954460''>the</span> <span m=''954570''>dependencies</span>
  <span m=''955200''>allow</span> <span m=''955450''>it.</span> </p><p><span m=''957930''>AUDIENCE:
  [INAUDIBLE].</span> </p><p><span m=''961280''>PROFESSOR: Right.</span> <span m=''964530''>So</span>
  <span m=''964720''>if</span> <span m=''964780''>you''re</span> <span m=''964880''>looking</span>
  <span m=''965100''>at</span> <span m=''965180''>the</span> <span m=''965280''>assembly,</span>
  <span m=''966980''>you''re</span> <span m=''967140''>going</span> <span m=''967220''>to</span>
  <span m=''967270''>see</span> <span m=''967430''>lots</span> <span m=''967710''>of</span>
  <span m=''968240''>lines</span> <span m=''968520''>of</span> <span m=''968620''>this</span>
  <span m=''968790''>form</span> <span m=''970150''>OP</span> <span m=''970550''>DESTINATION</span>
  <span m=''971290''>and</span> <span m=''971430''>then</span> <span m=''971610''>the</span>
  <span m=''971700''>source</span> <span m=''972720''>registers.</span> <span m=''974000''>So</span>
  <span m=''974260''>when</span> <span m=''974420''>you''re</span> <span m=''974530''>trying</span>
  <span m=''974700''>to</span> <span m=''974750''>figure</span> <span m=''974990''>out</span>
  <span m=''975070''>dependencies,</span> <span m=''976810''>it''s</span> <span m=''976980''>going</span>
  <span m=''977070''>to</span> <span m=''977110''>be</span> <span m=''977200''>helpful</span>
  <span m=''977590''>to</span> <span m=''977910''>be</span> <span m=''978020''>able</span>
  <span m=''978150''>to</span> <span m=''978210''>look</span> <span m=''978390''>at</span>
  <span m=''978460''>each</span> <span m=''978670''>line</span> <span m=''978870''>of</span>
  <span m=''978940''>the</span> <span m=''979020''>assembly and</span> <span m=''979440''>figure</span>
  <span m=''979680''>out</span> <span m=''980600''>what</span> <span m=''981110''>registers</span>
  <span m=''981640''>that</span> <span m=''981940''>line</span> <span m=''982270''>is</span>
  <span m=''982360''>reading</span> <span m=''982590''>from,</span> <span m=''982900''>and</span>
  <span m=''983050''>what</span> <span m=''983520''>registers</span> <span m=''984360''>that</span>
  <span m=''984600''>line</span> <span m=''984850''>is</span> <span m=''984950''>spreading</span>
  <span m=''985280''>to.</span> </p><p><span m=''986160''>And</span> <span m=''986410''>there''s</span>
  <span m=''986560''>also</span> <span m=''986820''>information</span> <span m=''987390''>in</span>
  <span m=''987520''>the</span> <span m=''988030''>assembly</span> <span m=''988390''>file</span>
  <span m=''989280''>I</span> <span m=''989370''>went</span> <span m=''989600''>into</span>
  <span m=''989650''>that</span> <span m=''989790''>last</span> <span m=''990000''>time,</span>
  <span m=''990730''>which</span> <span m=''990850''>tells</span> <span m=''991080''>you</span>
  <span m=''991280''>kind</span> <span m=''991470''>of</span> <span m=''991750''>for</span>
  <span m=''991950''>each</span> <span m=''992230''>chunk</span> <span m=''992500''>of</span>
  <span m=''992570''>assembly</span> <span m=''993630''>what</span> <span m=''993880''>the</span>
  <span m=''994140''>corresponding</span> <span m=''994930''>source</span> <span m=''996990''>file</span>
  <span m=''997300''>line</span> <span m=''997550''>is.</span> <span m=''1000990''>All</span>
  <span m=''1001050''>right,</span> <span m=''1001830''>and</span> <span m=''1002160''>the</span>
  <span m=''1002590''>actual</span> <span m=''1002970''>output</span> <span m=''1003290''>of</span>
  <span m=''1003430''>the</span> <span m=''1003700''>static</span> <span m=''1004020''>profiler,</span>
  <span m=''1005060''>like</span> <span m=''1005270''>I</span> <span m=''1005310''>said,</span>
  <span m=''1005590''>it</span> <span m=''1005670''>will</span> <span m=''1005950''>spit</span>
  <span m=''1006310''>out</span> <span m=''1006530''>a</span> <span m=''1006960''>schedule</span>
  <span m=''1007380''>of</span> <span m=''1008100''>when</span> <span m=''1008430''>each</span>
  <span m=''1008630''>instruction</span> <span m=''1009040''>runs.</span> <span m=''1012670''>And</span>
  <span m=''1013000''>in</span> <span m=''1013160''>the</span> <span m=''1013250''>schedule,</span>
  <span m=''1014550''>you''re</span> <span m=''1014670''>going</span> <span m=''1014750''>to</span>
  <span m=''1014800''>see</span> <span m=''1015400''>one</span> <span m=''1015590''>digit</span>
  <span m=''1015930''>for</span> <span m=''1016070''>each</span> <span m=''1017150''>cycle</span>
  <span m=''1017550''>that</span> <span m=''1017670''>the</span> <span m=''1017770''>instruction</span>
  <span m=''1018190''>is</span> <span m=''1018290''>running.</span> <span m=''1018870''>So</span>
  <span m=''1019400''>however</span> <span m=''1019690''>many</span> <span m=''1019890''>digits</span>
  <span m=''1020400''>there</span> <span m=''1020610''>are,</span> <span m=''1020730''>that''s</span>
  <span m=''1020940''>how</span> <span m=''1021010''>many</span> <span m=''1021190''>cycles</span>
  <span m=''1021590''>are</span> <span m=''1021660''>being</span> <span m=''1021860''>used.</span>
  </p><p><span m=''1023460''>And</span> <span m=''1024060''>in</span> <span m=''1025030''>front</span>
  <span m=''1025190''>of</span> <span m=''1025250''>some</span> <span m=''1025490''>of</span>
  <span m=''1025560''>the</span> <span m=''1025660''>instructions,</span> <span m=''1026839''>you''re</span>
  <span m=''1027270''>going</span> <span m=''1027349''>to</span> <span m=''1027390''>see</span>
  <span m=''1027579''>these</span> <span m=''1027900''>dashes</span> <span m=''1028339''>which</span>
  <span m=''1028520''>represent</span> <span m=''1029020''>stalls.</span> <span m=''1029930''>So</span>
  <span m=''1030190''>these</span> <span m=''1030579''>three</span> <span m=''1030780''>dashes</span>
  <span m=''1031150''>in</span> <span m=''1031290''>front</span> <span m=''1031520''>of</span>
  <span m=''1032190''>this</span> <span m=''1032530''>instruction</span> <span m=''1033020''>fm</span>
  <span m=''1033790''>means</span> <span m=''1034140''>that</span> <span m=''1036440''>based</span>
  <span m=''1036670''>on</span> <span m=''1036750''>the</span> <span m=''1036819''>pipeline,</span>
  <span m=''1037560''>you</span> <span m=''1037710''>could''ve</span> <span m=''1038300''>scheduled</span>
  <span m=''1038710''>this</span> <span m=''1038869''>instruction</span> <span m=''1039410''>up</span>
  <span m=''1039569''>here</span> <span m=''1039980''>right</span> <span m=''1040160''>after</span>
  <span m=''1041180''>the</span> <span m=''1041970''>previous</span> <span m=''1042310''>instruction</span>
  <span m=''1042730''>finished.</span> <span m=''1043569''>However,</span> <span m=''1043790''>because</span>
  <span m=''1044030''>you''re</span> <span m=''1044130''>waiting</span> <span m=''1044400''>on</span>
  <span m=''1044720''>particular</span> <span m=''1045150''>dependencies,</span> <span
  m=''1046420''>you''re</span> <span m=''1046700''>only</span> <span m=''1046880''>going</span>
  <span m=''1047089''>to</span> <span m=''1047170''>be</span> <span m=''1047319''>able</span>
  <span m=''1047500''>to</span> <span m=''1047609''>schedule</span> <span m=''1048030''>it</span>
  <span m=''1048560''>these</span> <span m=''1048860''>three</span> <span m=''1049050''>cycles</span>
  <span m=''1049420''>later.</span> <span m=''1049770''>So</span> <span m=''1049910''>that''s</span>
  <span m=''1050300''>a</span> <span m=''1050370''>three</span> <span m=''1050570''>cycle</span>
  <span m=''1050860''>stall.</span> </p><p><span m=''1055840''>And</span> <span m=''1056380''>the</span>
  <span m=''1056540''>static</span> <span m=''1057070''>profile</span> <span m=''1057410''>output</span>
  <span m=''1057720''>is</span> <span m=''1057810''>also</span> <span m=''1058030''>going</span>
  <span m=''1058130''>to</span> <span m=''1058170''>show</span> <span m=''1059220''>other</span>
  <span m=''1059400''>information.</span> <span m=''1059820''>The</span> <span m=''1059950''>original</span>
  <span m=''1060330''>assembly</span> <span m=''1060690''>appears</span> <span m=''1061020''>on</span>
  <span m=''1061110''>the</span> <span m=''1061180''>right-hand</span> <span m=''1061550''>side.</span>
  <span m=''1062660''>And</span> <span m=''1063570''>which</span> <span m=''1063890''>pipeline</span>
  <span m=''1064940''>the</span> <span m=''1065080''>instructions</span> <span m=''1065510''>are</span>
  <span m=''1065590''>going</span> <span m=''1065820''>into</span> <span m=''1066090''>is</span>
  <span m=''1066230''>going</span> <span m=''1066410''>to</span> <span m=''1066470''>show</span>
  <span m=''1066670''>up</span> <span m=''1066770''>on</span> <span m=''1066860''>the</span>
  <span m=''1066930''>left.</span> <span m=''1067870''>Any</span> <span m=''1068020''>questions</span>
  <span m=''1068350''>about</span> <span m=''1068570''>this</span> <span m=''1069160''>format?</span>
  </p><p><span m=''1070928''>AUDIENCE: [INAUDIBLE].</span> </p><p><span m=''1073310''>PROFESSOR:
  Dual-issue</span> <span m=''1073770''>just</span> <span m=''1073990''>means</span>
  <span m=''1074290''>that</span> <span m=''1074840''>these</span> <span m=''1075060''>instructions</span>
  <span m=''1075540''>are</span> <span m=''1075610''>going</span> <span m=''1075700''>to</span>
  <span m=''1075740''>be</span> <span m=''1075860''>executed</span> <span m=''1076420''>at</span>
  <span m=''1076510''>the</span> <span m=''1076590''>same</span> <span m=''1076830''>time.</span>
  </p><p><span m=''1079645''>AUDIENCE: So</span> <span m=''1080627''>can people</span>
  <span m=''1081118''>figure out,</span> <span m=''1081609''>for example,</span> <span
  m=''1082100''>what is  the</span> <span m=''1082591''>latency</span> <span m=''1083082''>for
  fm</span> <span m=''1083573''>instruction?</span> <span m=''1084064''>How many</span>
  <span m=''1084555''>circles does</span> <span m=''1085046''>fm</span> <span m=''1085537''>take?</span>
  <span m=''1091920''>[INAUDIBLE].</span> </p><p><span m=''1094866''>AUDIENCE: [INAUDIBLE].</span>
  </p><p><span m=''1097321''>PROFESSOR: Pardon?</span> </p><p><span m=''1097812''>AUDIENCE:
  What are the</span> <span m=''1098303''>numbers</span> <span m=''1098794''>on the</span>
  <span m=''1099285''>right?</span> </p><p><span m=''1100758''>PROFESSOR: Over</span>
  <span m=''1101250''>here?</span> <span m=''1102540''>All</span> <span m=''1102630''>right,</span>
  <span m=''1102860''>so</span> <span m=''1102950''>these</span> <span m=''1103140''>are</span>
  <span m=''1103190''>the</span> <span m=''1103350''>arguments</span> <span m=''1103870''>to</span>
  <span m=''1104290''>the</span> <span m=''1104530''>assembly</span> <span m=''1104900''>instructions.</span>
  <span m=''1105620''>So</span> <span m=''1105890''>remember</span> <span m=''1106100''>the</span>
  <span m=''1106200''>first</span> <span m=''1106420''>one</span> <span m=''1106500''>is</span>
  <span m=''1106580''>going</span> <span m=''1106660''>to</span> <span m=''1106700''>be</span>
  <span m=''1106770''>the</span> <span m=''1106860''>destination</span> <span m=''1107390''>register</span>
  <span m=''1108280''>and</span> <span m=''1109130''>the</span> <span m=''1109260''>other</span>
  <span m=''1109410''>ones</span> <span m=''1109650''>are</span> <span m=''1109740''>going</span>
  <span m=''1109830''>to</span> <span m=''1109880''>be</span> <span m=''1110100''>all</span>
  <span m=''1110310''>the</span> <span m=''1110700''>source</span> <span m=''1110950''>registers</span>
  <span m=''1111420''>that</span> <span m=''1111590''>that</span> <span m=''1111780''>instruction</span>
  <span m=''1112390''>is</span> <span m=''1112580''>going</span> <span m=''1112660''>to</span>
  <span m=''1112700''>use.</span> </p><p><span m=''1117950''>All</span> <span m=''1118040''>right,</span>
  <span m=''1121540''>so</span> <span m=''1121640''>again,</span> <span m=''1122740''>we</span>
  <span m=''1122870''>want</span> <span m=''1123010''>to</span> <span m=''1123050''>be</span>
  <span m=''1123140''>able</span> <span m=''1123290''>to</span> <span m=''1123640''>reorder</span>
  <span m=''1124140''>these</span> <span m=''1124340''>instructions</span> <span m=''1124970''>to</span>
  <span m=''1125300''>minimize</span> <span m=''1125710''>stalls.</span> <span m=''1127240''>And</span>
  <span m=''1128810''>what</span> <span m=''1128990''>you''re</span> <span m=''1129060''>going</span>
  <span m=''1129140''>to</span> <span m=''1129210''>do</span> <span m=''1129400''>is</span>
  <span m=''1129660''>you''re</span> <span m=''1129810''>going</span> <span m=''1129890''>to</span>
  <span m=''1129940''>try</span> <span m=''1130090''>and</span> <span m=''1130150''>look</span>
  <span m=''1130340''>for</span> <span m=''1130570''>instructions</span> <span m=''1131170''>that</span>
  <span m=''1131280''>are</span> <span m=''1131870''>going</span> <span m=''1132070''>to</span>
  <span m=''1132150''>take</span> <span m=''1132320''>a</span> <span m=''1132370''>long</span>
  <span m=''1132570''>time</span> <span m=''1133010''>potentially,</span> <span m=''1133640''>for</span>
  <span m=''1133790''>example,</span> <span m=''1134440''>loads</span> <span m=''1134970''>and</span>
  <span m=''1135190''>floating</span> <span m=''1135460''>point</span> <span m=''1135690''>instructions</span>
  <span m=''1136040''>are</span> <span m=''1136100''>going</span> <span m=''1136190''>to</span>
  <span m=''1136240''>take</span> <span m=''1136390''>a</span> <span m=''1136420''>long</span>
  <span m=''1136600''>time.</span> <span m=''1137460''>And</span> <span m=''1139190''>of</span>
  <span m=''1139330''>these</span> <span m=''1139520''>instructions</span> <span m=''1139990''>have</span>
  <span m=''1140180''>dependencies</span> <span m=''1141300''>then</span> <span m=''1141700''>those</span>
  <span m=''1141920''>dependencies</span> <span m=''1142450''>are</span> <span m=''1142530''>going</span>
  <span m=''1142750''>to</span> <span m=''1142800''>stall.</span> </p><p><span m=''1144750''>So</span>
  <span m=''1144970''>not</span> <span m=''1145140''>only</span> <span m=''1145320''>do</span>
  <span m=''1145420''>you</span> <span m=''1145500''>want</span> <span m=''1145610''>to</span>
  <span m=''1145650''>minimize</span> <span m=''1145970''>stalls,</span> <span m=''1147770''>you</span>
  <span m=''1147940''>also</span> <span m=''1148110''>want</span> <span m=''1148240''>to</span>
  <span m=''1148310''>dual</span> <span m=''1148600''>issue</span> <span m=''1148880''>instructions</span>
  <span m=''1149400''>whenever</span> <span m=''1149660''>possible,</span> <span m=''1150160''>although</span>
  <span m=''1150410''>that''s</span> <span m=''1150660''>a</span> <span m=''1150720''>little</span>
  <span m=''1150880''>bit</span> <span m=''1151070''>more</span> <span m=''1151340''>difficult</span>
  <span m=''1151840''>to</span> <span m=''1151940''>just</span> <span m=''1152150''>kind</span>
  <span m=''1152270''>of</span> <span m=''1152710''>eyeball.</span> <span m=''1154530''>But</span>
  <span m=''1154630''>anyway,</span> <span m=''1154920''>if</span> <span m=''1155000''>you</span>
  <span m=''1155090''>get</span> <span m=''1155220''>up</span> <span m=''1155330''>to</span>
  <span m=''1156830''>the</span> <span m=''1156980''>ideal</span> <span m=''1158270''>running</span>
  <span m=''1158510''>point,</span> <span m=''1159210''>where</span> <span m=''1159410''>you''re</span>
  <span m=''1159540''>able</span> <span m=''1159770''>to</span> <span m=''1159900''>dual</span>
  <span m=''1160150''>issue</span> <span m=''1160420''>every</span> <span m=''1160670''>instruction,</span>
  <span m=''1161490''>then</span> <span m=''1161600''>that</span> <span m=''1161710''>means</span>
  <span m=''1161890''>you''re</span> <span m=''1161990''>going</span> <span m=''1162070''>to</span>
  <span m=''1162110''>be</span> <span m=''1162370''>running</span> <span m=''1163370''>two</span>
  <span m=''1163760''>instructions</span> <span m=''1164320''>per</span> <span m=''1164480''>cycle,</span>
  <span m=''1164940''>or</span> <span m=''1165230''>it''s</span> <span m=''1165410''>going</span>
  <span m=''1165500''>to</span> <span m=''1165540''>take</span> <span m=''1165720''>1/2</span>
  <span m=''1166150''>cycle</span> <span m=''1166510''>per</span> <span m=''1166710''>instruction.</span>
  </p><p><span m=''1169170''>Anyway,</span> <span m=''1169840''>going</span> <span
  m=''1170090''>through</span> <span m=''1170450''>these</span> <span m=''1170690''>assembly</span>
  <span m=''1171050''>files,</span> <span m=''1171490''>and</span> <span m=''1171970''>figuring</span>
  <span m=''1172390''>out</span> <span m=''1172530''>where</span> <span m=''1172650''>the</span>
  <span m=''1172760''>dependencies</span> <span m=''1173420''>are,</span> <span m=''1173710''>which</span>
  <span m=''1173920''>instructions</span> <span m=''1174370''>you</span> <span m=''1174460''>can</span>
  <span m=''1174540''>move</span> <span m=''1174730''>around,</span> <span m=''1175330''>it''s</span>
  <span m=''1175480''>kind</span> <span m=''1175600''>of</span> <span m=''1175680''>tedious,</span>
  <span m=''1176080''>and</span> <span m=''1176160''>you''re</span> <span m=''1176240''>not</span>
  <span m=''1176380''>going</span> <span m=''1176460''>to</span> <span m=''1176500''>be</span>
  <span m=''1176580''>able</span> <span m=''1176790''>to</span> <span m=''1177670''>apply</span>
  <span m=''1178070''>these</span> <span m=''1178540''>techniques</span> <span m=''1179040''>to</span>
  <span m=''1179200''>your</span> <span m=''1179390''>entire</span> <span m=''1179710''>program.</span>
  <span m=''1180890''>So</span> <span m=''1182270''>if</span> <span m=''1182420''>you</span>
  <span m=''1182600''>only</span> <span m=''1182800''>have</span> <span m=''1183260''>limited</span>
  <span m=''1183600''>time,</span> <span m=''1183900''>what</span> <span m=''1184020''>you''re</span>
  <span m=''1184100''>going</span> <span m=''1184190''>to</span> <span m=''1184420''>have</span>
  <span m=''1184610''>to</span> <span m=''1184710''>do</span> <span m=''1184970''>is</span>
  <span m=''1185160''>try</span> <span m=''1185440''>these</span> <span m=''1185730''>on</span>
  <span m=''1186420''>the</span> <span m=''1186520''>most</span> <span m=''1186750''>critical</span>
  <span m=''1187150''>code</span> <span m=''1187420''>first.</span> <span m=''1187700''>And</span>
  <span m=''1187780''>that''s</span> <span m=''1188330''>usually</span> <span m=''1188830''>going</span>
  <span m=''1188930''>to</span> <span m=''1188980''>be</span> <span m=''1189880''>loop</span>
  <span m=''1190080''>bodies,</span> <span m=''1190590''>because</span> <span m=''1190870''>those</span>
  <span m=''1191070''>are</span> <span m=''1191120''>going</span> <span m=''1191210''>to</span>
  <span m=''1191250''>get</span> <span m=''1191370''>executed</span> <span m=''1191860''>many,</span>
  <span m=''1192150''>many</span> <span m=''1192250''>times.</span> <span m=''1192990''>And</span>
  <span m=''1193130''>any</span> <span m=''1193280''>savings</span> <span m=''1193690''>that</span>
  <span m=''1193800''>you</span> <span m=''1193880''>see</span> <span m=''1194080''>there</span>
  <span m=''1194610''>will</span> <span m=''1194720''>be</span> <span m=''1194860''>multiplied</span>
  <span m=''1195500''>many,</span> <span m=''1195850''>many</span> <span m=''1195960''>times</span>
  <span m=''1196200''>over.</span> </p><p><span m=''1199150''>So</span> <span m=''1200280''>I''m</span>
  <span m=''1200350''>going</span> <span m=''1200430''>to</span> <span m=''1200470''>go</span>
  <span m=''1200600''>through</span> <span m=''1200750''>an</span> <span m=''1200810''>example</span>
  <span m=''1201320''>of</span> <span m=''1202110''>one</span> <span m=''1202350''>possible</span>
  <span m=''1202770''>optimization</span> <span m=''1203450''>you</span> <span m=''1203560''>could</span>
  <span m=''1203690''>do.</span> <span m=''1208050''>So</span> <span m=''1208200''>we''ll</span>
  <span m=''1208360''>actually</span> <span m=''1208650''>go</span> <span m=''1208820''>through</span>
  <span m=''1209020''>these</span> <span m=''1209690''>same</span> <span m=''1209920''>files</span>
  <span m=''1210490''>in</span> <span m=''1212430''>the</span> <span m=''1212640''>exercise</span>
  <span m=''1213110''>about</span> <span m=''1213930''>two</span> <span m=''1214100''>minutes</span>
  <span m=''1214330''>from</span> <span m=''1214460''>now.</span> <span m=''1216130''>This</span>
  <span m=''1216320''>is</span> <span m=''1216460''>from</span> <span m=''1218250''>Lab</span>
  <span m=''1218540''>1.</span> <span m=''1219580''>And</span> <span m=''1219720''>this</span>
  <span m=''1220830''>is</span> <span m=''1220930''>one</span> <span m=''1221070''>of</span>
  <span m=''1221130''>the</span> <span m=''1221360''>code</span> <span m=''1221580''>snippets</span>
  <span m=''1222340''>or</span> <span m=''1222550''>the</span> <span m=''1222690''>assembly</span>
  <span m=''1222990''>snippets</span> <span m=''1223360''>from</span> <span m=''1224090''>the</span>
  <span m=''1225520''>SPU</span> <span m=''1225900''>program.</span> </p><p><span
  m=''1228050''>So</span> <span m=''1228980''>notice</span> <span m=''1229280''>that</span>
  <span m=''1229450''>over</span> <span m=''1229640''>here</span> <span m=''1229890''>we</span>
  <span m=''1230010''>have</span> <span m=''1230270''>these</span> <span m=''1231770''>load</span>
  <span m=''1232180''>instructions</span> <span m=''1232960''>followed</span> <span
  m=''1233340''>by</span> <span m=''1233760''>a, I</span> <span m=''1234090''>guess</span>
  <span m=''1234280''>this</span> <span m=''1234440''>is</span> <span m=''1234590''>a</span>
  <span m=''1234890''>shift</span> <span m=''1235220''>instruction.</span> <span m=''1237670''>And</span>
  <span m=''1237990''>there''s</span> <span m=''1238450''>two</span> <span m=''1239270''>pairs</span>
  <span m=''1239660''>of</span> <span m=''1239770''>these.</span> <span m=''1240370''>And
  in</span> <span m=''1240590''>each</span> <span m=''1240790''>one,</span> <span
  m=''1240970''>the</span> <span m=''1241040''>shift</span> <span m=''1241380''>instruction</span>
  <span m=''1242500''>is</span> <span m=''1242650''>going</span> <span m=''1242760''>to</span>
  <span m=''1242820''>depend</span> <span m=''1243270''>on</span> <span m=''1243560''>the</span>
  <span m=''1243850''>result</span> <span m=''1244270''>of</span> <span m=''1244370''>the</span>
  <span m=''1244450''>previous</span> <span m=''1244820''>load.</span> <span m=''1245300''>Does</span>
  <span m=''1245420''>everyone</span> <span m=''1245650''>see</span> <span m=''1245780''>that</span>
  <span m=''1246300''>from</span> <span m=''1246430''>the</span> <span m=''1246500''>arguments?</span>
  <span m=''1251180''>So</span> <span m=''1251330''>now</span> <span m=''1251480''>the</span>
  <span m=''1251560''>problem</span> <span m=''1251830''>is</span> <span m=''1251970''>that</span>
  <span m=''1252150''>because</span> <span m=''1252380''>the</span> <span m=''1252470''>shift</span>
  <span m=''1252790''>is</span> <span m=''1252880''>happening</span> <span m=''1253260''>right</span>
  <span m=''1253520''>after</span> <span m=''1253780''>the</span> <span m=''1253880''>load,</span>
  <span m=''1254490''>it''s</span> <span m=''1254660''>going</span> <span m=''1254750''>to</span>
  <span m=''1254790''>stall</span> <span m=''1255110''>for</span> <span m=''1255240''>a</span>
  <span m=''1255290''>long</span> <span m=''1255560''>time,</span> <span m=''1256280''>because</span>
  <span m=''1256970''>the</span> <span m=''1257260''>load</span> <span m=''1257520''>takes</span>
  <span m=''1258430''>six</span> <span m=''1258740''>cycles.</span> </p><p><span m=''1260650''>All</span>
  <span m=''1260740''>right,</span> <span m=''1260900''>so</span> <span m=''1261120''>what</span>
  <span m=''1261270''>can</span> <span m=''1261380''>we</span> <span m=''1261460''>do</span>
  <span m=''1261590''>over</span> <span m=''1261760''>here</span> <span m=''1262800''>in</span>
  <span m=''1262950''>order</span> <span m=''1263090''>to</span> <span m=''1263200''>reduce</span>
  <span m=''1263510''>stalling?</span> <span m=''1267110''>Yep?</span> </p><p><span
  m=''1267940''>AUDIENCE: Two loads</span> <span m=''1268415''>concurrently?</span>
  </p><p><span m=''1269840''>PROFESSOR: Yeah,</span> <span m=''1270780''>we</span>
  <span m=''1270890''>can</span> <span m=''1270960''>do</span> <span m=''1271060''>the</span>
  <span m=''1271160''>loads</span> <span m=''1271400''>concurrently,</span> <span
  m=''1272300''>and</span> <span m=''1272600''>in</span> <span m=''1272690''>general,</span>
  <span m=''1272950''>we</span> <span m=''1273040''>just</span> <span m=''1273200''>want</span>
  <span m=''1273300''>to</span> <span m=''1273340''>move</span> <span m=''1273530''>these</span>
  <span m=''1273700''>loads</span> <span m=''1273950''>up</span> <span m=''1274150''>as</span>
  <span m=''1274270''>high</span> <span m=''1274510''>as</span> <span m=''1274610''>we</span>
  <span m=''1274740''>can.</span> <span m=''1277660''>So</span> <span m=''1277960''>if</span>
  <span m=''1278130''>I</span> <span m=''1278300''>move</span> <span m=''1280940''>the</span>
  <span m=''1281110''>two</span> <span m=''1281290''>loads</span> <span m=''1281600''>up</span>
  <span m=''1281760''>to</span> <span m=''1282040''>the</span> <span m=''1282970''>top</span>
  <span m=''1283210''>of</span> <span m=''1283340''>this--</span> <span m=''1284030''>oops--</span>
  <span m=''1284680''>the</span> <span m=''1284780''>top</span> <span m=''1284990''>of</span>
  <span m=''1285080''>this</span> <span m=''1285980''>snippet,</span> <span m=''1287090''>then</span>
  <span m=''1287250''>we</span> <span m=''1287340''>have</span> <span m=''1288440''>two</span>
  <span m=''1288580''>loads</span> <span m=''1288900''>followed</span> <span m=''1289170''>by</span>
  <span m=''1289340''>all</span> <span m=''1289490''>the</span> <span m=''1289570''>instructions</span>
  <span m=''1290130''>that</span> <span m=''1290290''>came</span> <span m=''1290590''>after.</span>
  <span m=''1292180''>Now</span> <span m=''1292580''>the</span> <span m=''1292970''>first</span>
  <span m=''1293310''>shift</span> <span m=''1293650''>is</span> <span m=''1293750''>going</span>
  <span m=''1293850''>to</span> <span m=''1293910''>stall</span> <span m=''1294200''>by</span>
  <span m=''1294340''>only</span> <span m=''1294650''>two</span> <span m=''1294840''>cycles,</span>
  <span m=''1295890''>and</span> <span m=''1296170''>the</span> <span m=''1296220''>second</span>
  <span m=''1296490''>shift</span> <span m=''1296730''>is</span> <span m=''1296840''>not</span>
  <span m=''1297000''>going</span> <span m=''1297090''>to</span> <span m=''1297150''>stall</span>
  <span m=''1297820''>at</span> <span m=''1298100''>all.</span> <span m=''1299020''>All</span>
  <span m=''1299480''>right?</span> </p><p><span m=''1300290''>AUDIENCE: [INAUDIBLE]?</span>
  </p><p><span m=''1305400''>PROFESSOR: So,</span> <span m=''1306090''>pardon?</span>
  </p><p><span m=''1306665''>AUDIENCE: [INAUDIBLE].</span> </p><p><span m=''1307850''>PROFESSOR:
  So</span> <span m=''1307980''>the</span> <span m=''1308050''>question</span> <span
  m=''1308360''>is</span> <span m=''1308500''>what</span> <span m=''1308650''>would</span>
  <span m=''1308790''>this</span> <span m=''1309190''>change</span> <span m=''1309540''>look</span>
  <span m=''1309680''>like</span> <span m=''1309850''>in</span> <span m=''1309970''>code?</span>
  <span m=''1311170''>The</span> <span m=''1311340''>thing</span> <span m=''1311530''>is</span>
  <span m=''1311720''>that</span> <span m=''1312600''>kind</span> <span m=''1312760''>of</span>
  <span m=''1312820''>the</span> <span m=''1312930''>order</span> <span m=''1313190''>of</span>
  <span m=''1313270''>these</span> <span m=''1313550''>generate</span> <span m=''1313850''>instructions</span>
  <span m=''1314400''>is</span> <span m=''1314640''>going</span> <span m=''1314740''>to</span>
  <span m=''1314780''>be</span> <span m=''1314900''>dependent</span> <span m=''1315240''>on</span>
  <span m=''1315390''>the</span> <span m=''1315940''>compiler,</span> <span m=''1316680''>and</span>
  <span m=''1316840''>it''s</span> <span m=''1316970''>really</span> <span m=''1317170''>up</span>
  <span m=''1317250''>to</span> <span m=''1317330''>the</span> <span m=''1317400''>compiler</span>
  <span m=''1317850''>how</span> <span m=''1318050''>it</span> <span m=''1318150''>wants</span>
  <span m=''1318370''>to</span> <span m=''1318510''>order</span> <span m=''1318700''>these</span>
  <span m=''1318880''>instructions.</span> <span m=''1319890''>So</span> <span m=''1320110''>this</span>
  <span m=''1320320''>change</span> <span m=''1320620''>is</span> <span m=''1320710''>not</span>
  <span m=''1320870''>going</span> <span m=''1320950''>to</span> <span m=''1321000''>be</span>
  <span m=''1321380''>reflected</span> <span m=''1321840''>in</span> <span m=''1322020''>like</span>
  <span m=''1322350''>your</span> <span m=''1322580''>C</span> <span m=''1322800''>code.</span>
  <span m=''1324240''>And</span> <span m=''1324350''>that''s</span> <span m=''1324500''>why</span>
  <span m=''1324650''>you</span> <span m=''1324740''>have</span> <span m=''1324920''>to</span>
  <span m=''1325770''>do</span> <span m=''1325910''>these</span> <span m=''1326080''>optimizations</span>
  <span m=''1327050''>after</span> <span m=''1327350''>the</span> <span m=''1327540''>assembly
  is</span> <span m=''1327980''>generated.</span> <span m=''1330050''>Does that</span>
  <span m=''1330170''>make</span> <span m=''1330320''>sense?</span> </p><p><span m=''1331097''>AUDIENCE:
  [INAUDIBLE].</span> </p><p><span m=''1339050''>PROFESSOR: If</span> <span m=''1339220''>you</span>
  <span m=''1339330''>have</span> <span m=''1339550''>a</span> <span m=''1339870''>smart</span>
  <span m=''1340220''>compiler</span> <span m=''1340700''>then</span> <span m=''1341040''>it</span>
  <span m=''1341140''>might</span> <span m=''1341390''>do</span> <span m=''1341530''>some</span>
  <span m=''1342730''>kind</span> <span m=''1342900''>of</span> <span m=''1343180''>instruction</span>
  <span m=''1343720''>scheduling</span> <span m=''1344160''>in</span> <span m=''1344240''>order</span>
  <span m=''1344450''>to</span> <span m=''1344880''>minimize</span> <span m=''1345250''>stalls</span>
  <span m=''1345780''>using</span> <span m=''1346270''>this</span> <span m=''1346410''>methodology.</span>
  <span m=''1347010''>Yup?</span> </p><p><span m=''1347684''>AUDIENCE: I''m</span>
  <span m=''1348158''>quite impressed</span> <span m=''1348632''>with</span> <span
  m=''1349106''>XLC.</span> <span m=''1350054''>I compiled</span> <span m=''1350528''>the
  same</span> <span m=''1351476''>program</span> <span m=''1351950''>under</span>
  <span m=''1352900''>GCC</span> <span m=''1353500''>for</span> <span m=''1354390''>SPU</span>
  <span m=''1354610''>with</span> <span m=''1356510''>optimization</span> <span m=''1356980''>level</span>
  <span m=''1357250''>3</span> <span m=''1357520''>under XLC.</span> <span m=''1358260''>XLC</span>
  <span m=''1359046''>ran</span> <span m=''1361630''>in half</span> <span m=''1362000''>the
  time.</span> <span m=''1362760''>So</span> <span m=''1362990''>it was doing a</span>
  <span m=''1363230''>much</span> <span m=''1363450''>better</span> <span m=''1363630''>job</span>
  <span m=''1363990''>of</span> <span m=''1364485''>instruction</span> <span m=''1364980''>scheduling--</span>
  </p><p><span m=''1365475''>AUDIENCE: Than</span> <span m=''1365970''>GCC?</span>
  </p><p><span m=''1366080''>AUDIENCE: Than</span> <span m=''1366340''>GCC.</span>
  <span m=''1368780''>So</span> <span m=''1369270''>that''s</span> <span m=''1369760''>something,</span>
  <span m=''1370200''>if</span> <span m=''1370750''>you''ve</span> <span m=''1370860''>got</span>
  <span m=''1371040''>a</span> <span m=''1371310''>choice,</span> <span m=''1371950''>and</span>
  <span m=''1372447''>the</span> <span m=''1372944''>XLC compiler is</span> <span
  m=''1373441''>working for</span> <span m=''1373938''>you--</span> </p><p><span m=''1376430''>AUDIENCE:
  In</span> <span m=''1376910''>general,</span> <span m=''1378180''>this</span> <span
  m=''1378380''>kind</span> <span m=''1378660''>of</span> <span m=''1378800''>sort</span>
  <span m=''1378980''>of</span> <span m=''1379140''>low-level</span> <span m=''1379850''>assembly</span>
  <span m=''1380210''>hacking</span> <span m=''1380730''>for</span> <span m=''1381135''>instruction</span>
  <span m=''1381540''>ordering</span> <span m=''1382250''>is</span> <span m=''1382370''>not</span>
  <span m=''1382540''>something</span> <span m=''1383180''>you''ll</span> <span m=''1383360''>do,</span>
  <span m=''1383980''>just</span> <span m=''1384170''>because</span> <span m=''1384510''>compilers</span>
  <span m=''1384990''>are</span> <span m=''1385170''>getting</span> <span m=''1385450''>incredibly</span>
  <span m=''1385950''>good</span> <span m=''1386320''>at</span> <span m=''1387060''>doing</span>
  <span m=''1387210''>instruction</span> <span m=''1387670''>scheduling.</span> <span
  m=''1389090''>But</span> <span m=''1389140''>here</span> <span m=''1389650''>the</span>
  <span m=''1389720''>exercise</span> <span m=''1390080''>is for</span> <span m=''1390440''>you
  to</span> <span m=''1390710''>sort</span> <span m=''1390920''>of</span> <span m=''1391130''>get</span>
  <span m=''1391490''>familiar with</span> <span m=''1391830''>the tools</span> <span
  m=''1392260''>and understand</span> <span m=''1392690''>a</span> <span m=''1393320''>little</span>
  <span m=''1393480''>bit</span> <span m=''1393590''>more in</span> <span m=''1393800''>detail</span>
  <span m=''1394300''>as</span> <span m=''1394420''>to</span> <span m=''1394830''>what''s</span>
  <span m=''1395040''>going</span> <span m=''1395320''>on</span> <span m=''1395480''>at
  the</span> <span m=''1395680''>instruction</span> <span m=''1396140''>level</span>
  <span m=''1397190''>[INAUDIBLE]</span> <span m=''1397760''>pipelines.</span> </p><p><span
  m=''1399110''>Another</span> <span m=''1399580''>thing</span> <span m=''1399760''>to</span>
  <span m=''1399890''>note</span> <span m=''1400130''>here</span> <span m=''1400360''>is,</span>
  <span m=''1401010''>well,</span> <span m=''1401370''>two</span> <span m=''1401680''>things
  you could</span> <span m=''1401960''>consider</span> <span m=''1402450''>here,</span>
  <span m=''1403260''>how high</span> <span m=''1403620''>up can you</span> <span
  m=''1403790''>push the</span> <span m=''1404140''>limits?</span> <span m=''1406920''>And</span>
  <span m=''1407060''>related</span> <span m=''1407420''>to</span> <span m=''1407480''>that</span>
  <span m=''1407760''>is,</span> <span m=''1408150''>why</span> <span m=''1408300''>can''t
  you</span> <span m=''1408650''>completely</span> <span m=''1409090''>hide</span>
  <span m=''1409510''>the</span> <span m=''1409870''>latency</span> <span m=''1410400''>for</span>
  <span m=''1410490''>the</span> <span m=''1410600''>first</span> <span m=''1410920''>load,</span>
  <span m=''1411700''>and</span> <span m=''1412140''>hence</span> <span m=''1412620''>the</span>
  <span m=''1412870''>first</span> <span m=''1413090''>shift</span> <span m=''1413370''>still
  takes</span> <span m=''1413970''>two</span> <span m=''1414090''>seconds to</span>
  <span m=''1414360''>stall.</span> <span m=''1416550''>So</span> <span m=''1416680''>that''s</span>
  <span m=''1416940''>dependent</span> <span m=''1417380''>upon</span> <span m=''1417870''>how</span>
  <span m=''1418190''>much</span> <span m=''1418490''>slack do</span> <span m=''1418720''>you</span>
  <span m=''1418860''>have in your</span> <span m=''1419320''>schedule,</span> <span
  m=''1420220''>dependent</span> <span m=''1420580''>on</span> <span m=''1421000''>dependencies</span>
  <span m=''1421630''>and</span> <span m=''1422140''>where</span> <span m=''1422310''>the</span>
  <span m=''1422620''>loops starts.</span> </p><p><span m=''1423970''>So in</span>
  <span m=''1424290''>some</span> <span m=''1424420''>cases, you just</span> <span
  m=''1424820''>simply</span> <span m=''1425200''>can''t</span> <span m=''1425430''>hide</span>
  <span m=''1426390''>the</span> <span m=''1426550''>entire</span> <span m=''1426910''>latency.</span>
  <span m=''1428520''>So</span> <span m=''1428930''>it''s</span> <span m=''1429360''>part</span>
  <span m=''1429570''>of</span> <span m=''1429660''>considerations</span> <span m=''1430680''>you</span>
  <span m=''1430800''>have</span> <span m=''1430940''>to</span> <span m=''1431060''>consider.</span>
  <span m=''1431470''>But</span> <span m=''1431750''>[INAUDIBLE]</span> <span m=''1432220''>and</span>
  <span m=''1432500''>the compilers</span> <span m=''1432820''>are getting</span>
  <span m=''1433314''>really</span> <span m=''1433808''>good</span> <span m=''1434302''>at
  it.</span> </p><p><span m=''1437760''>PROFESSOR: And</span> <span m=''1438210''>in
  case</span> <span m=''1438340''>you''re</span> <span m=''1438440''>wondering,</span>
  <span m=''1438660''>I</span> <span m=''1438710''>think</span> <span m=''1438900''>this</span>
  <span m=''1439070''>code</span> <span m=''1439270''>was</span> <span m=''1439410''>compiled</span>
  <span m=''1439820''>using</span> <span m=''1440840''>XLC</span> <span m=''1441330''>on</span>
  <span m=''1441590''>no</span> <span m=''1441850''>optimizations,</span> <span m=''1442720''>which</span>
  <span m=''1442870''>is</span> <span m=''1442960''>why</span> <span m=''1443180''>there''s</span>
  <span m=''1443970''>this</span> <span m=''1444150''>really</span> <span m=''1444450''>easy</span>
  <span m=''1444710''>opportunity</span> <span m=''1445310''>for</span> <span m=''1445700''>optimization</span>
  <span m=''1446280''>here.</span> <span m=''1448450''>It</span> <span m=''1448510''>turns</span>
  <span m=''1448690''>out,</span> <span m=''1448820''>if</span> <span m=''1448940''>we</span>
  <span m=''1449050''>run</span> <span m=''1449310''>the</span> <span m=''1450640''>timing</span>
  <span m=''1450970''>utility</span> <span m=''1451440''>again,</span> <span m=''1452090''>we</span>
  <span m=''1452240''>saved</span> <span m=''1454170''>eight</span> <span m=''1454350''>cycles.</span>
  <span m=''1455570''>So</span> <span m=''1455590''>notice</span> <span m=''1455870''>that</span>
  <span m=''1456360''>on</span> <span m=''1456470''>the</span> <span m=''1456540''>previous</span>
  <span m=''1456830''>picture,</span> <span m=''1457490''>we''re</span> <span m=''1457650''>going</span>
  <span m=''1457890''>up</span> <span m=''1458040''>to</span> <span m=''1459400''>seven</span>
  <span m=''1459770''>in</span> <span m=''1459850''>that</span> <span m=''1460020''>column.</span>
  <span m=''1460910''>And</span> <span m=''1461170''>now</span> <span m=''1461660''>we''re</span>
  <span m=''1461840''>only</span> <span m=''1461980''>going</span> <span m=''1462230''>up</span>
  <span m=''1462340''>to</span> <span m=''1462440''>the</span> <span m=''1462530''>previous</span>
  <span m=''1463270''>nine,</span> <span m=''1465000''>all</span> <span m=''1465080''>right?</span>
  </p><p><span m=''1467630''>So</span> <span m=''1467870''>what</span> <span m=''1468000''>we''re</span>
  <span m=''1468080''>going</span> <span m=''1468170''>to</span> <span m=''1468240''>do</span>
  <span m=''1468440''>for</span> <span m=''1468570''>the</span> <span m=''1468700''>exercise</span>
  <span m=''1469200''>right</span> <span m=''1469350''>now</span> <span m=''1469860''>is</span>
  <span m=''1471470''>you</span> <span m=''1471620''>can</span> <span m=''1472080''>try</span>
  <span m=''1472300''>something</span> <span m=''1472540''>like</span> <span m=''1472700''>this.</span>
  <span m=''1473050''>What</span> <span m=''1473460''>we''re</span> <span m=''1473520''>going</span>
  <span m=''1473620''>to</span> <span m=''1473670''>try</span> <span m=''1473810''>and</span>
  <span m=''1473900''>do</span> <span m=''1474010''>is</span> <span m=''1474090''>just</span>
  <span m=''1474350''>improve</span> <span m=''1474720''>performance</span> <span
  m=''1475290''>by</span> <span m=''1475500''>rescheduling</span> <span m=''1476050''>instructions.</span>
  <span m=''1477490''>And</span> <span m=''1477750''>so</span> <span m=''1478050''>if</span>
  <span m=''1479360''>you</span> <span m=''1480350''>download</span> <span m=''1480650''>the</span>
  <span m=''1480710''>tarball,</span> <span m=''1481540''>you''ll</span> <span m=''1481730''>get</span>
  <span m=''1481920''>the</span> <span m=''1481990''>exact</span> <span m=''1482250''>same</span>
  <span m=''1482400''>file</span> <span m=''1482670''>I</span> <span m=''1482720''>was</span>
  <span m=''1482850''>working</span> <span m=''1483130''>on</span> <span m=''1483450''>before.</span>
  <span m=''1484520''>And</span> <span m=''1485020''>what</span> <span m=''1485410''>we''re</span>
  <span m=''1485590''>going</span> <span m=''1485670''>to</span> <span m=''1485720''>have</span>
  <span m=''1485850''>you</span> <span m=''1485970''>do</span> <span m=''1486170''>is</span>
  <span m=''1486310''>just</span> <span m=''1486550''>generate</span> <span m=''1486880''>the</span>
  <span m=''1486970''>assembly,</span> <span m=''1487450''>practice</span> <span m=''1487730''>generating</span>
  <span m=''1488110''>the</span> <span m=''1488200''>assembly,</span> <span m=''1489220''>modifying</span>
  <span m=''1489930''>it,</span> <span m=''1490560''>and</span> <span m=''1490790''>then</span>
  <span m=''1491430''>continuing</span> <span m=''1491890''>with</span> <span m=''1491990''>the</span>
  <span m=''1492060''>rest</span> <span m=''1492280''>of</span> <span m=''1492320''>the</span>
  <span m=''1492390''>build</span> <span m=''1492630''>process</span> <span m=''1493070''>to</span>
  <span m=''1493170''>get</span> <span m=''1493740''>a</span> <span m=''1494950''>new</span>
  <span m=''1495340''>object</span> <span m=''1495670''>file</span> <span m=''1495900''>that''s</span>
  <span m=''1496080''>based</span> <span m=''1496350''>on</span> <span m=''1496470''>your</span>
  <span m=''1496640''>modified</span> <span m=''1497060''>assembly.</span> </p><p><span
  m=''1498940''>All</span> <span m=''1499020''>right,</span> <span m=''1499200''>any</span>
  <span m=''1499320''>questions?</span> <span m=''1502730''>Now</span> <span m=''1502880''>you</span>
  <span m=''1503340''>just</span> <span m=''1503530''>need</span> <span m=''1503670''>to</span>
  <span m=''1504590''>find,</span> <span m=''1505110''>for</span> <span m=''1505210''>example,</span>
  <span m=''1505500''>one</span> <span m=''1506200''>opportunity</span> <span m=''1506800''>for</span>
  <span m=''1507110''>optimization.</span> <span m=''1507830''>And</span> <span m=''1507930''>you</span>
  <span m=''1508000''>can</span> <span m=''1508100''>do</span> <span m=''1508210''>the</span>
  <span m=''1508300''>exact</span> <span m=''1508580''>same</span> <span m=''1508780''>thing</span>
  <span m=''1508950''>that</span> <span m=''1509090''>I</span> <span m=''1509200''>did,</span>
  <span m=''1509380''>if</span> <span m=''1509470''>you</span> <span m=''1509580''>want.</span>
  <span m=''1510840''>And</span> <span m=''1512570''>so</span> <span m=''1512710''>the</span>
  <span m=''1512810''>key</span> <span m=''1512960''>is</span> <span m=''1513070''>just</span>
  <span m=''1513280''>after</span> <span m=''1513520''>you''ve</span> <span m=''1514270''>done</span>
  <span m=''1514470''>your</span> <span m=''1514620''>reordering,</span> <span m=''1515080''>you</span>
  <span m=''1515170''>want</span> <span m=''1515270''>to</span> <span m=''1515360''>re-run</span>
  <span m=''1515710''>the</span> <span m=''1515800''>timing</span> <span m=''1516100''>utility</span>
  <span m=''1516930''>to</span> <span m=''1517140''>see</span> <span m=''1517290''>how</span>
  <span m=''1517390''>many</span> <span m=''1517560''>cycles</span> <span m=''1517890''>you</span>
  <span m=''1517990''>saved.</span> <span m=''1518930''>Also</span> <span m=''1519170''>you</span>
  <span m=''1519290''>want</span> <span m=''1519420''>to,</span> <span m=''1519910''>of</span>
  <span m=''1520030''>course,</span> <span m=''1520290''>continue</span> <span m=''1520720''>the</span>
  <span m=''1520980''>build</span> <span m=''1521210''>process</span> <span m=''1521700''>to</span>
  <span m=''1521790''>get</span> <span m=''1521950''>the</span> <span m=''1522020''>final</span>
  <span m=''1523330''>executable</span> <span m=''1523840''>file.</span> <span m=''1524360''>And</span>
  <span m=''1524450''>you</span> <span m=''1524520''>want</span> <span m=''1524600''>to</span>
  <span m=''1524660''>run</span> <span m=''1524860''>that</span> <span m=''1525070''>just
  to</span> <span m=''1525330''>make</span> <span m=''1525520''>sure</span> <span
  m=''1525700''>that</span> <span m=''1526110''>your</span> <span m=''1526290''>code</span>
  <span m=''1526500''>is</span> <span m=''1526570''>still</span> <span m=''1526780''>correct.</span>
  </p><p><span m=''1528206''>AUDIENCE: Are we able</span> <span m=''1528704''>to get</span>
  <span m=''1529202''>this?</span> </p><p><span m=''1530696''>[SIDE CONVERSATIONS]</span>
  </p><p><span m=''1636400''>PROFESSOR: OK,</span> <span m=''1636600''>so</span> <span
  m=''1636810''>this</span> <span m=''1638330''>static</span> <span m=''1638700''>profiling</span>
  <span m=''1639170''>process</span> <span m=''1639650''>does</span> <span m=''1639840''>have</span>
  <span m=''1640010''>its</span> <span m=''1640130''>limitations.</span> <span m=''1641290''>The</span>
  <span m=''1641390''>first</span> <span m=''1641620''>is</span> <span m=''1642040''>that,</span>
  <span m=''1643430''>and</span> <span m=''1643580''>this</span> <span m=''1643700''>is</span>
  <span m=''1643800''>a</span> <span m=''1643860''>pretty</span> <span m=''1644400''>major</span>
  <span m=''1644710''>limitation,</span> <span m=''1645520''>the</span> <span m=''1645970''>static</span>
  <span m=''1646250''>profiler</span> <span m=''1647010''>assumes</span> <span m=''1647450''>that</span>
  <span m=''1647640''>none</span> <span m=''1647860''>of</span> <span m=''1647950''>the</span>
  <span m=''1648030''>branches</span> <span m=''1648500''>are</span> <span m=''1648630''>taken.</span>
  <span m=''1649240''>So</span> <span m=''1649350''>basically</span> <span m=''1649710''>it
  just</span> <span m=''1650570''>zips</span> <span m=''1650870''>through</span> <span
  m=''1651040''>the</span> <span m=''1651140''>entire</span> <span m=''1651540''>assembly</span>
  <span m=''1651900''>file</span> <span m=''1652300''>in</span> <span m=''1652370''>a</span>
  <span m=''1652410''>straight</span> <span m=''1652690''>line.</span> <span m=''1654210''>So</span>
  <span m=''1655380''>that</span> <span m=''1655570''>means</span> <span m=''1655920''>you''re</span>
  <span m=''1656070''>going</span> <span m=''1656160''>to</span> <span m=''1656200''>have</span>
  <span m=''1656300''>a</span> <span m=''1656360''>skewed</span> <span m=''1656740''>view</span>
  <span m=''1657030''>of</span> <span m=''1657240''>how</span> <span m=''1657430''>long</span>
  <span m=''1659590''>code</span> <span m=''1659890''>inside</span> <span m=''1660310''>conditionals</span>
  <span m=''1660870''>or</span> <span m=''1660970''>loop</span> <span m=''1661150''>bodies</span>
  <span m=''1661930''>is</span> <span m=''1662060''>going</span> <span m=''1662160''>to</span>
  <span m=''1662230''>take,</span> <span m=''1662800''>because</span> <span m=''1663000''>conditionals,</span>
  <span m=''1663650''>if</span> <span m=''1663750''>there''s</span> <span m=''1663900''>savings</span>
  <span m=''1664280''>in</span> <span m=''1664360''>there,</span> <span m=''1664520''>they</span>
  <span m=''1664640''>may</span> <span m=''1664790''>not</span> <span m=''1666410''>run</span>
  <span m=''1666570''>at</span> <span m=''1666640''>all.</span> <span m=''1667170''>And</span>
  <span m=''1667860''>loop</span> <span m=''1668080''>bodies,</span> <span m=''1668440''>any</span>
  <span m=''1668610''>savings</span> <span m=''1668970''>in</span> <span m=''1669050''>there</span>
  <span m=''1669250''>may</span> <span m=''1669390''>get</span> <span m=''1671120''>multiplied</span>
  <span m=''1671570''>many,</span> <span m=''1671850''>many</span> <span m=''1671940''>times.</span>
  </p><p><span m=''1673170''>So</span> <span m=''1673580''>if,</span> <span m=''1673730''>for</span>
  <span m=''1673850''>example,</span> <span m=''1674190''>you</span> <span m=''1674320''>see</span>
  <span m=''1674530''>that</span> <span m=''1674780''>you''ve</span> <span m=''1674950''>saved</span>
  <span m=''1675810''>eight</span> <span m=''1676040''>cycles</span> <span m=''1676650''>in</span>
  <span m=''1676740''>the</span> <span m=''1676820''>static</span> <span m=''1677180''>scheduling,</span>
  <span m=''1677660''>you''re</span> <span m=''1677760''>going</span> <span m=''1677850''>to</span>
  <span m=''1677890''>need</span> <span m=''1678060''>to</span> <span m=''1678150''>know</span>
  <span m=''1679270''>some</span> <span m=''1679400''>more</span> <span m=''1679550''>context,</span>
  <span m=''1680370''>that</span> <span m=''1680510''>is</span> <span m=''1680710''>whether</span>
  <span m=''1681070''>it''s</span> <span m=''1681180''>inside</span> <span m=''1681490''>a</span>
  <span m=''1681550''>loop</span> <span m=''1681710''>body</span> <span m=''1682150''>and</span>
  <span m=''1682310''>how</span> <span m=''1682420''>many</span> <span m=''1682630''>times
  you</span> <span m=''1683000''>expect</span> <span m=''1683350''>that</span> <span
  m=''1683510''>to</span> <span m=''1683610''>run.</span> <span m=''1684630''>So</span>
  <span m=''1684750''>you''re going to</span> <span m=''1684900''>need</span> <span
  m=''1685130''>a</span> <span m=''1685180''>little</span> <span m=''1685320''>more</span>
  <span m=''1685540''>information</span> <span m=''1686060''>to</span> <span m=''1686190''>get</span>
  <span m=''1686350''>a</span> <span m=''1686680''>good</span> <span m=''1686830''>idea</span>
  <span m=''1687080''>of</span> <span m=''1687150''>how</span> <span m=''1687380''>these</span>
  <span m=''1687650''>instruction</span> <span m=''1688040''>reorderings</span> <span
  m=''1688860''>are</span> <span m=''1688980''>actually</span> <span m=''1689290''>affecting</span>
  <span m=''1689930''>the</span> <span m=''1690030''>runtime</span> <span m=''1690350''>of</span>
  <span m=''1690430''>your</span> <span m=''1690510''>program.</span> </p><p><span
  m=''1692630''>And</span> <span m=''1692780''>also,</span> <span m=''1692950''>because</span>
  <span m=''1693200''>this</span> <span m=''1693360''>is</span> <span m=''1693820''>static</span>
  <span m=''1694180''>profiling,</span> <span m=''1694530''>which</span> <span m=''1694750''>means</span>
  <span m=''1694970''>you''re</span> <span m=''1695070''>not</span> <span m=''1695240''>using</span>
  <span m=''1695560''>an</span> <span m=''1695630''>actual</span> <span m=''1695980''>program</span>
  <span m=''1696430''>run</span> <span m=''1697080''>to</span> <span m=''1697570''>get</span>
  <span m=''1697750''>data,</span> <span m=''1698650''>you''re</span> <span m=''1698880''>not</span>
  <span m=''1699070''>going</span> <span m=''1699160''>to</span> <span m=''1699210''>get</span>
  <span m=''1700740''>behavior--</span> <span m=''1701560''>you''re</span> <span m=''1701710''>not</span>
  <span m=''1701940''>going</span> <span m=''1702020''>to</span> <span m=''1702310''>capture</span>
  <span m=''1702630''>any</span> <span m=''1702730''>behavior</span> <span m=''1703120''>that</span>
  <span m=''1703300''>depends</span> <span m=''1703730''>on</span> <span m=''1703980''>the</span>
  <span m=''1704110''>inputs</span> <span m=''1704450''>to</span> <span m=''1704530''>your</span>
  <span m=''1704630''>program.</span> <span m=''1705720''>So</span> <span m=''1705860''>for</span>
  <span m=''1705950''>example,</span> <span m=''1709320''>you</span> <span m=''1709430''>don''t</span>
  <span m=''1709610''>get</span> <span m=''1709730''>counts</span> <span m=''1710100''>of</span>
  <span m=''1710220''>how</span> <span m=''1710360''>many</span> <span m=''1710830''>times</span>
  <span m=''1711160''>each</span> <span m=''1711370''>loop</span> <span m=''1711540''>runs,</span>
  <span m=''1711970''>or</span> <span m=''1712350''>when</span> <span m=''1712780''>each</span>
  <span m=''1713120''>branch is</span> <span m=''1713500''>taken.</span> </p><p><span
  m=''1715810''>One</span> <span m=''1716020''>other</span> <span m=''1716200''>thing</span>
  <span m=''1716390''>to</span> <span m=''1716470''>worry</span> <span m=''1716670''>about,</span>
  <span m=''1717780''>which</span> <span m=''1718120''>isn''t</span> <span m=''1718370''>going</span>
  <span m=''1718460''>to</span> <span m=''1718500''>be</span> <span m=''1718640''>manifested</span>
  <span m=''1719700''>in</span> <span m=''1719740''>these</span> <span m=''1722950''>static</span>
  <span m=''1723230''>profiling</span> <span m=''1724330''>predictions,</span> <span
  m=''1725570''>is</span> <span m=''1726000''>branch</span> <span m=''1726390''>prediction.</span>
  <span m=''1727880''>Now</span> <span m=''1728060''>remember</span> <span m=''1728380''>the</span>
  <span m=''1728510''>static</span> <span m=''1728770''>profiler is</span> <span m=''1729190''>just</span>
  <span m=''1729360''>going</span> <span m=''1729460''>to</span> <span m=''1730280''>ignore</span>
  <span m=''1730680''>all</span> <span m=''1730860''>branches.</span> <span m=''1732110''>And</span>
  <span m=''1733150''>the</span> <span m=''1733270''>thing</span> <span m=''1733450''>is</span>
  <span m=''1733530''>that</span> <span m=''1733720''>branch</span> <span m=''1734010''>prediction,</span>
  <span m=''1735630''>because</span> <span m=''1737220''>branch</span> <span m=''1737470''>prediction</span>
  <span m=''1737790''>is</span> <span m=''1737870''>used</span> <span m=''1738260''>to</span>
  <span m=''1738720''>reduce</span> <span m=''1739030''>the</span> <span m=''1739120''>stall</span>
  <span m=''1739550''>after</span> <span m=''1740150''>a</span> <span m=''1740250''>branch
  is</span> <span m=''1740590''>taken</span> <span m=''1740890''>by</span> <span m=''1741470''>kind</span>
  <span m=''1741610''>of</span> <span m=''1741690''>pre-fetching</span> <span m=''1742170''>instructions</span>
  <span m=''1742780''>and</span> <span m=''1742890''>possibly</span> <span m=''1743220''>doing</span>
  <span m=''1743420''>other</span> <span m=''1743570''>things.</span> <span m=''1744370''>So</span>
  <span m=''1744490''>what</span> <span m=''1744640''>we''ll</span> <span m=''1744740''>do</span>
  <span m=''1744890''>is</span> <span m=''1745040''>guess</span> <span m=''1745350''>the</span>
  <span m=''1745480''>direction</span> <span m=''1746310''>that</span> <span m=''1746440''>the</span>
  <span m=''1746520''>branch</span> <span m=''1746790''>will</span> <span m=''1746920''>take.</span>
  <span m=''1747740''>And</span> <span m=''1747780''>then</span> <span m=''1747910''>we''ll</span>
  <span m=''1748040''>start</span> <span m=''1748550''>pre-fetching</span> <span m=''1749020''>instructions</span>
  <span m=''1749570''>from</span> <span m=''1749950''>the</span> <span m=''1750090''>expected</span>
  <span m=''1750640''>place</span> <span m=''1750960''>where</span> <span m=''1751480''>it''s</span>
  <span m=''1751780''>going</span> <span m=''1751870''>to</span> <span m=''1751950''>resume</span>
  <span m=''1752280''>after</span> <span m=''1752460''>the</span> <span m=''1752540''>branch.</span>
  </p><p><span m=''1754390''>And</span> <span m=''1754550''>the</span> <span m=''1754610''>thing</span>
  <span m=''1754830''>is,</span> <span m=''1755590''>if</span> <span m=''1755740''>your</span>
  <span m=''1755960''>branch</span> <span m=''1756550''>prediction</span> <span m=''1757040''>is</span>
  <span m=''1757190''>wrong,</span> <span m=''1758150''>then</span> <span m=''1759190''>you''re</span>
  <span m=''1759360''>going</span> <span m=''1759470''>to</span> <span m=''1759540''>incur</span>
  <span m=''1759970''>a</span> <span m=''1760060''>pretty</span> <span m=''1760270''>large</span>
  <span m=''1760540''>penalty.</span> <span m=''1761010''>And</span> <span m=''1761170''>the</span>
  <span m=''1761240''>penalty</span> <span m=''1761570''>is</span> <span m=''1761670''>on</span>
  <span m=''1761780''>the</span> <span m=''1761890''>order</span> <span m=''1762200''>of</span>
  <span m=''1762380''>20</span> <span m=''1762730''>cycles</span> <span m=''1764190''>while
  it</span> <span m=''1764470''>flushes</span> <span m=''1764810''>the</span> <span
  m=''1764880''>pipeline</span> <span m=''1765370''>and</span> <span m=''1765660''>starts</span>
  <span m=''1765940''>fetching</span> <span m=''1766270''>instructions</span> <span
  m=''1766730''>from</span> <span m=''1766850''>the</span> <span m=''1766930''>new</span>
  <span m=''1767050''>place.</span> <span m=''1767980''>On</span> <span m=''1768130''>the</span>
  <span m=''1768240''>other</span> <span m=''1768370''>hand,</span> <span m=''1768680''>if</span>
  <span m=''1768690''>branch</span> <span m=''1768960''>prediction</span> <span m=''1769330''>is</span>
  <span m=''1770000''>correct,</span> <span m=''1770670''>then</span> <span m=''1770950''>there''s</span>
  <span m=''1771850''>no</span> <span m=''1772020''>penalty</span> <span m=''1772410''>at</span>
  <span m=''1772490''>all,</span> <span m=''1772670''>actually.</span> <span m=''1773450''>So</span>
  <span m=''1773730''>the</span> <span m=''1773960''>next</span> <span m=''1774190''>instruction</span>
  <span m=''1774600''>will</span> <span m=''1774710''>just</span> <span m=''1774910''>resume</span>
  <span m=''1775580''>right</span> <span m=''1777100''>after</span> <span m=''1777310''>the</span>
  <span m=''1777390''>branch.</span> </p><p><span m=''1778340''>Anyway,</span> <span
  m=''1779120''>you</span> <span m=''1779230''>can</span> <span m=''1780050''>give</span>
  <span m=''1780280''>hints</span> <span m=''1780630''>to</span> <span m=''1780730''>the</span>
  <span m=''1780810''>compiler</span> <span m=''1781350''>to</span> <span m=''1781600''>tell</span>
  <span m=''1781860''>it</span> <span m=''1782410''>what</span> <span m=''1782680''>you</span>
  <span m=''1782860''>think</span> <span m=''1783280''>the</span> <span m=''1783460''>outcomes</span>
  <span m=''1784000''>of</span> <span m=''1784150''>branches</span> <span m=''1784490''>will</span>
  <span m=''1784630''>be.</span> <span m=''1785590''>And</span> <span m=''1786020''>this</span>
  <span m=''1786200''>can</span> <span m=''1786320''>help</span> <span m=''1786500''>in</span>
  <span m=''1786610''>some</span> <span m=''1786790''>circumstances.</span> <span
  m=''1788540''>Basically</span> <span m=''1788970''>there</span> <span m=''1789140''>are</span>
  <span m=''1789180''>these</span> <span m=''1791570''>macros</span> <span m=''1791950''>that</span>
  <span m=''1792050''>you</span> <span m=''1792180''>can</span> <span m=''1792290''>define.</span>
  <span m=''1793510''>And</span> <span m=''1794722''>what</span> <span m=''1795070''>you''re</span>
  <span m=''1795320''>going</span> <span m=''1795420''>to</span> <span m=''1795470''>use</span>
  <span m=''1795740''>is</span> <span m=''1795900''>this</span> <span m=''1796290''>built-in</span>
  <span m=''1796940''>expect</span> <span m=''1798240''>compiler</span> <span m=''1798710''>intrinsic,</span>
  <span m=''1799560''>and</span> <span m=''1799950''>what</span> <span m=''1800090''>that</span>
  <span m=''1800230''>means</span> <span m=''1800540''>is</span> <span m=''1801850''>if</span>
  <span m=''1801990''>you</span> <span m=''1802080''>put</span> <span m=''1802230''>that</span>
  <span m=''1802370''>inside</span> <span m=''1802790''>an</span> <span m=''1802960''>if,</span>
  <span m=''1803260''>it</span> <span m=''1803320''>will</span> <span m=''1803440''>mean,</span>
  <span m=''1804170''>you know,</span> <span m=''1805310''>run</span> <span m=''1805590''>the
  if</span> <span m=''1806090''>as if</span> <span m=''1806240''>the</span> <span
  m=''1806340''>condition</span> <span m=''1806780''>were</span> <span m=''1807060''>exp.</span>
  <span m=''1807740''>But</span> <span m=''1807850''>then</span> <span m=''1808330''>I''m</span>
  <span m=''1808470''>going</span> <span m=''1808580''>to</span> <span m=''1808640''>expect</span>
  <span m=''1809150''>that</span> <span m=''1809410''>the</span> <span m=''1809490''>value</span>
  <span m=''1809990''>of</span> <span m=''1810180''>this</span> <span m=''1811050''>condition</span>
  <span m=''1811430''>is</span> <span m=''1811510''>going</span> <span m=''1811610''>to</span>
  <span m=''1811650''>be,</span> <span m=''1811840''>for</span> <span m=''1811950''>example,</span>
  <span m=''1812310''>true</span> <span m=''1812560''>or</span> <span m=''1812650''>false.</span>
  <span m=''1813870''>All</span> <span m=''1813960''>right,</span> <span m=''1814090''>does</span>
  <span m=''1814200''>that</span> <span m=''1814310''>make</span> <span m=''1814440''>sense?</span>
  </p><p><span m=''1817100''>Anyway,</span> <span m=''1820200''>just</span> <span
  m=''1820430''>one</span> <span m=''1820580''>note</span> <span m=''1820760''>about</span>
  <span m=''1821090''>the</span> <span m=''1821500''>exercise</span> <span m=''1822020''>that</span>
  <span m=''1822140''>you</span> <span m=''1822210''>did.</span> <span m=''1822940''>I</span>
  <span m=''1823040''>believe</span> <span m=''1823340''>the</span> <span m=''1825010''>original</span>
  <span m=''1825350''>run</span> <span m=''1825540''>time</span> <span m=''1825870''>was</span>
  <span m=''1826330''>469</span> <span m=''1827330''>clock</span> <span m=''1827570''>cycles.</span>
  <span m=''1828560''>Actually,</span> <span m=''1828880''>if</span> <span m=''1828960''>you</span>
  <span m=''1829370''>run</span> <span m=''1829660''>XLC</span> <span m=''1830220''>with</span>
  <span m=''1831130''>05</span> <span m=''1831680''>optimizations,</span> <span m=''1832480''>it</span>
  <span m=''1832560''>will</span> <span m=''1832660''>reduce</span> <span m=''1833000''>that</span>
  <span m=''1833250''>to</span> <span m=''1833632''>188,</span> <span m=''1834780''>so</span>
  <span m=''1835210''>almost</span> <span m=''1836450''>280</span> <span m=''1837340''>cycles</span>
  <span m=''1837770''>of</span> <span m=''1837850''>savings.</span> </p><p><span m=''1839610''>All</span>
  <span m=''1839690''>right,</span> <span m=''1840830''>so</span> <span m=''1841230''>we''ll--</span>
  <span m=''1842850''>pardon?</span> </p><p><span m=''1843614''>AUDIENCE: The one</span>
  <span m=''1844098''>that</span> <span m=''1844582''>we</span> <span m=''1845066''>just</span>
  <span m=''1845550''>[INAUDIBLE].</span> </p><p><span m=''1847970''>PROFESSOR: No,</span>
  <span m=''1848460''>so</span> <span m=''1848880''>the</span> <span m=''1849010''>original</span>
  <span m=''1849330''>code</span> <span m=''1849620''>was--</span> <span m=''1850750''>the</span>
  <span m=''1850910''>original</span> <span m=''1851190''>assembly</span> <span m=''1851520''>was</span>
  <span m=''1851660''>compiled</span> <span m=''1852080''>on</span> <span m=''1852220''>O</span>
  <span m=''1852780''>0,</span> <span m=''1853150''>or</span> <span m=''1853330''>no</span>
  <span m=''1853480''>optimizations.</span> <span m=''1855270''>But</span> <span m=''1855410''>then</span>
  <span m=''1857600''>if</span> <span m=''1858210''>you''re</span> <span m=''1858320''>doing</span>
  <span m=''1858550''>an</span> <span m=''1858620''>optimization</span> <span m=''1859220''>by</span>
  <span m=''1859350''>hand,</span> <span m=''1859670''>it</span> <span m=''1859780''>saves</span>
  <span m=''1860130''>eight</span> <span m=''1860310''>cycles</span> <span m=''1860660''>off</span>
  <span m=''1860790''>of</span> <span m=''1860950''>O</span> <span m=''1861050''>0.</span>
  <span m=''1861470''>These</span> <span m=''1861630''>are</span> <span m=''1861690''>actually</span>
  <span m=''1861960''>pretty</span> <span m=''1862150''>easy</span> <span m=''1862370''>to</span>
  <span m=''1862420''>find.</span> <span m=''1863260''>And</span> <span m=''1863980''>the</span>
  <span m=''1864540''>05</span> <span m=''1864930''>optimization</span> <span m=''1865500''>level
  will</span> <span m=''1865850''>actually</span> <span m=''1866390''>shave</span>
  <span m=''1866680''>off</span> <span m=''1867880''>280</span> <span m=''1868540''>cycles.</span>
  </p><p><span m=''1870260''>So</span> <span m=''1870510''>we''ll</span> <span m=''1870670''>break</span>
  <span m=''1870900''>for</span> <span m=''1871070''>about</span> <span m=''1871450''>10</span>
  <span m=''1871590''>minutes,</span> <span m=''1871880''>and</span> <span m=''1871980''>then</span>
  <span m=''1872120''>after</span> <span m=''1872320''>the</span> <span m=''1872400''>break,</span>
  <span m=''1872730''>we''ll</span> <span m=''1872760''>do</span> <span m=''1874290''>SIMD</span>
  <span m=''1874750''>on</span> <span m=''1875120''>Cell.</span> </p>'
type: course
uid: cf036c4893311953f0687fffa8e76fda

---
None